(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return l});var a=n(13),i="".concat(a.b,"_").concat("prod","_"),r=!1;function o(){r=!0}function s(e,t){if(r)return!1;try{var n=JSON.stringify(t);localStorage.setItem("".concat(i).concat(e),n)}catch(a){return console.error(a),!1}return!0}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(r)return!1;try{Object.keys(localStorage).forEach(function(t){t.startsWith("".concat(i).concat(e))&&localStorage.removeItem(t)})}catch(t){return console.error(t),!1}return!0}function l(e,t){var n=t;try{var a=localStorage.getItem("".concat(i).concat(e));null!==a&&void 0!==a&&(n=JSON.parse(a))}catch(r){console.error(r)}return"function"===typeof n&&(n=n()),n}},100:function(e,t,n){"use strict";n.d(t,"d",function(){return s}),n.d(t,"b",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"c",function(){return d});var a=n(184),i=n(7),r=n(6),o=n(3),s=["Linear","Quad.easeIn","Quad.easeOut","Quad.easeInOut","Cubic.easeIn","Cubic.easeOut","Cubic.easeInOut","Quart.easeIn","Quart.easeOut","Quart.easeInOut","Quint.easeIn","Quint.easeOut","Quint.easeInOut","Sine.easeIn","Sine.easeOut","Sine.easeInOut","Expo.easeIn","Expo.easeOut","Expo.easeInOut","Circ.easeIn","Circ.easeOut","Circ.easeInOut","Back.easeIn","Back.easeOut","Back.easeInOut","Bounce.easeIn","Bounce.easeOut","Bounce.easeInOut"],c={delay_enabled:[!0],delay:[0,0,1e4],duration:[0,0,1e4],ease:["Linear",s],dx_enabled:[!1],dx:[0,-1e3,1e3],dy_enabled:[!1],dy:[0,-1e3,1e3],alpha_enabled:[!1],alpha:[1,0,1,.01],rotation_enabled:[!1],rotation:[0,-1080,1080,1],scaleX_enabled:[!1],scaleX:[1,0,10,.1],scaleY_enabled:[!1],scaleY:[1,0,10,.1],yoyo:[!1],loop:[0,-1,100,1],ignoresScenePause:[!1],refreshPhysics:[!1],destroyOnComplete:[!1],animated:[!0]};function l(e){Object.entries(e).forEach(function(t){var n=Object(o.a)(t,2),a=n[0],s=n[1];if(a.endsWith(".tween")){var l=a.substr(0,a.length-".tween".length);if(!Array.isArray(s)||1!==s.length||"object"!==typeof s[0])throw new Error("Expected ".concat(a," prop to have the shape [{\u2026}]; did you mean to end it in .tween?"));delete e[a];var u=Object(o.a)(s,1)[0],h=Object(r.a)({},u);if(Object.entries(c).forEach(function(t){var n=Object(o.a)(t,2),a=n[0],r=n[1];if(a in u)e["".concat(l,".").concat(a)]=[u[a]].concat(Object(i.a)(r.slice(1))),delete h[a];else if(a.endsWith("_enabled")){var s=a.substr(0,a.length-"_enabled".length);e["".concat(l,".").concat(a)]=[s in u]}else e["".concat(l,".").concat(a)]=r}),Object.keys(h).length)throw new Error("Got unexpected tween config settings: ".concat(Object.keys(h).join(", ")))}})}function u(e,t,n){var i=Object(a.a)({},t),r=i.massageProps;if(delete i.massageProps,Object.entries(i).forEach(function(e){var t=Object(o.a)(e,2),a=t[0],r=t[1];if(a.endsWith("_enabled")){var s=a.substr(0,a.length-"_enabled".length);r||n[s]||delete i[s],delete i[a]}}),i.targets=e,i.destroyOnComplete){delete i.destroyOnComplete;var s=i.onComplete;i.onComplete=s?function(){s.apply(void 0,arguments),e.destroy()}:function(){e.destroy()}}if("dx"in i){var c=i.dx;i.x=e.x+c}if("dy"in i){var l=i.dy;i.y=e.y+l}var u=i.x,h=i.y;if(i.refreshPhysics){delete i.refreshPhysics;var d=i.onUpdate;i.onUpdate=d?function(){d.apply(void 0,arguments),e.body&&e.refreshBody()}:function(){e.body&&e.refreshBody()}}if(r&&r(i),"dx"in i&&(!("x"in i)||i.x===u)){var m=i.dx;i.x=e.x+m}if(delete i.dx,"dy"in i&&(!("y"in i)||i.y===h)){var p=i.dy;i.y=e.y+p}return delete i.dy,i.rotation&&(i.rotation*=Math.PI/180),"animated"in i&&!i.animated&&(i.duration=0,delete i.loop,i.yoyo&&(delete i.x,delete i.y,delete i.dx,delete i.dy,delete i.rotation,delete i.scaleX,delete i.scaleY,delete i.yoyo,i.alpha=e.alpha)),delete i.animated,i}var h=!1;function d(e){if(!h){var t=e.__proto__,n=t.add;t.add=function(e){var t=n.call(this,e);return t.ignoresScenePause=e.ignoresScenePause,t},h=!0}}},101:function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"d",function(){return p}),n.d(t,"b",function(){return f}),n.d(t,"a",function(){return g});var a=n(184),i=n(7),r=n(6),o=n(3),s=n(11),c=n.n(s),l=[];function u(e){return l.find(function(t){return e.startsWith(t)})}var h=!1;function d(e,t){if(e.seed=t,e.rnd=new c.a.Math.RandomDataGenerator([t]),!h){var n=e.delay.__proto__;n.randomStaticValueEmit=function(e,t){var n=Math.floor(e.emitter.rnd.frac()*this.propertyValue.length);return this.propertyValue[n]},n.randomRangedValueEmit=function(e,t){var n=e.emitter.rnd.realInRange(this.start,this.end);return e&&e.data[t]&&(e.data[t].min=n),n},h=!0}}var m=!1;function p(e){return m||!e?m:(e.__proto__.preUpdate=function(e,t){for(var n=this.scene._paused.particles,a=t/this.timeScale,i=this.emitters.list,r=0;r<i.length;r+=1){var o=i[r];(!n||this.ignoresScenePause||o.ignoresScenePause||o.updatesOnceOnPause)&&o.active&&(o.preUpdate(e,a),n&&(o.updatesOnceOnPause=!1))}},m=!0)}var _={image:null,frequency:[0,0,2e4],lifespan:[1e3,0,2e4],accelerationX:[0,-1e3,1e3],accelerationY:[0,-1e3,1e3],alpha:[1,0,1],blendMode:["NORMAL",["NORMAL","ADD","MULTIPLY","SCREEN","ERASE"]],delay:[0,0,2e4],maxParticles:[0,0,1e3],particleBringToTop:[!0],quantity:[1,0,200,1],radial:[!0],rotate:[0,-1080,1080,1],scaleX:[1,0,100],scaleY:[1,0,100],speed:[0,0,1e3],speedX:[0,-1e3,1e3],speedY:[0,-1e3,1e3],tint:[16777215],tint_enabled:[!1],x:[0,-1e3,1e3],y:[0,-1e3,1e3],ignoresScenePause:[!1],updatesOnceOnPause:[!1],visible:[!0],preemit:[!1],preemitOnReload:[!1]};function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["set props/particleImages!"];Object.entries(e).forEach(function(n){var a=Object(o.a)(n,2),s=a[0],c=a[1];if("scene.particles"!==s){if(s.endsWith(".particle"))throw new Error("Found ".concat(s,"; did you mean ").concat(s,"s?"));if(s.endsWith(".particles")){var u=s.substr(0,s.length-".particles".length);if(!Array.isArray(c)||1!==c.length||"object"!==typeof c[0])throw new Error("Expected ".concat(s," prop to have the shape [{\u2026}]; did you mean to end it in .particles?"));delete e[s],l.push(u);var h=Object(o.a)(c,1)[0],d=Object(r.a)({},h);if(Object.entries(_).forEach(function(n){var a=Object(o.a)(n,2),r=a[0],s=a[1],c=r.replace(/^tint/,"tintColor"),l="image"===r?[t[0],t]:s;if(r in h)e["".concat(u,".").concat(c)]=[h[r]].concat(Object(i.a)(l.slice(1))),delete d[r];else if("preemitOnReload"===r&&h.preemit)e["".concat(u,".").concat(c)]=[!0].concat(Object(i.a)(l.slice(1)));else if(r.endsWith("_enabled")){var m=r.substr(0,r.length-"_enabled".length);e["".concat(u,".").concat(c)]=[m in h]}else e["".concat(u,".").concat(c)]=l}),Object.keys(d).length)throw new Error("Got unexpected particle config settings: ".concat(Object.keys(d).join(", ")))}}})}function g(e){var t=Object(a.a)({},e),n=t.massageProps;return delete t.onAdd,delete t.massageProps,delete t.image,t.tintColor_enabled&&(t.tint=t.tintColor,delete t.tintColor_enabled),0===t.speedX&&0===t.speedY?(delete t.speedX,delete t.speedY):0===t.speed&&delete t.speed,t.rotate&&"number"===typeof t.rotate&&(t.rotate*=Math.PI/180),n&&n(t),t}},13:function(e){e.exports={b:"nighty-night-nosferatu",c:{embed:!0,displayName:"Nighty Night, Nosferatu",authorName:"@sartak",authorURL:"https://shawn.dev",eventDescription:"created solo in 48 hours as part of",eventNamePre:"the",eventNameBold:"Ludum Dare 50",eventNamePost:"compo",eventURL:"https://ldjam.com/events/ludum-dare/50/nighty-night-nosferatu",themeDescription:"for the theme",themePre:"",themeItalic:'"Delay the inevitable"',themePost:"",repoURL:"https://github.com/sartak/nighty-night-nosferatu"},a:{links:[["https://labs.phaser.io/","labs"],["https://photonstorm.github.io/phaser3-docs/","phaser-docs"],["https://lodash.com/docs/4.17.11","lodash"],["https://sfbgames.itch.io/chiptone","chiptone"],["https://pernyblom.github.io/abundant-music/index.html","abundant"]]}}},1510:function(e,t,n){},1511:function(e,t,n){},1512:function(e,t,n){},1513:function(e,t,n){},1514:function(e,t,n){"use strict";n.r(t);var a=n(1),i=n.n(a),r=n(561),o=n.n(r),s=(n(603),n(17)),c=n(16),l=n(19),u=n(8),h=n(20),d=n(597),m=n(3),p=(n(604),n(605),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{id:"lds-spinner"},i.a.createElement("div",{className:"lds-spinner"},i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null),i.a.createElement("div",null)))}}]),t}(i.a.Component)),_=(n(606),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onMouseMove,n=e.volume,a=e.onVolumeChange,r=e.disableFullscreen,o=e.isFullscreen,s=e.enterFullscreen,c=e.exitFullscreen;return i.a.createElement("div",{className:"Controls",onMouseMove:t},i.a.createElement("div",{className:"volume"},i.a.createElement("span",{style:{fontSize:20,transform:"scale(".concat(.5+n/2,")")}},"\u266b"),"\xa0\xa0",i.a.createElement("input",{type:"range",min:"0",max:"100",value:100*n,onChange:function(e){return a(e.target.value/100)},onMouseUp:function(e){return e.target.blur()}})),r||i.a.createElement("div",{className:"fullscreen"},o?i.a.createElement("div",{className:"button",onClick:c},i.a.createElement("div",{className:"label exit"},"\u2573")):i.a.createElement("div",{className:"button",onClick:s},i.a.createElement("div",{className:"label enter"},"\u21c6"))))}}]),t}(i.a.Component)),f=n(6),g=n(7),v=n(179),b=n(11),y=n.n(b),O=n(60),E=n(183),w=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).call(this,{key:t.key()}))}return Object(h.a)(t,e),Object(c.a)(t,null,[{key:"key",value:function(){return"BootScene"}}]),Object(c.a)(t,[{key:"preload",value:function(){var e=this;Object(O.a)(Object(u.a)(t.prototype),"preload",this).call(this),this.game.preloadScenes.forEach(function(t){t.name!==e.name&&(new t).preload.call(e)})}},{key:"create",value:function(){var e=this;Object(O.a)(Object(u.a)(t.prototype),"create",this).call(this),this.game.initializeShaders(),setTimeout(function(){e.game.preloadComplete()})}},{key:"saveStateFieldName",value:function(){return null}}]),t}(E.a),S=n(2),k=n(42),j=n(88),C=n(13),T=n(51),P=n.n(T),D=n(46),M={LEFT:"_LCLeft",RIGHT:"_LCRight",UP:"_LCTop",DOWN:"_LCBottom",A:"_RCBottom",Y:"_RCTop",X:"_RCLeft",B:"_RCRight",L1:"_FBLeftTop",L2:"_FBLeftBottom",R1:"_FBRightTop",R2:"_FBRightBottom"},R={},x=function(){function e(t){var n=this;Object(s.a)(this,e),this._spec=t,this._scenes=new Map,this.keyboard={},this.gamepad={},this.pointerEvents=[],this.executedProps=[],this._ignoreAlls={},Object.keys(t).forEach(function(e){if(n[e])throw new Error("Conflicting command name ".concat(e));n[e]={held:!1,heldFrames:0,started:!1,continued:!1,heldDuration:0,releasedFrames:0,released:!1,releasedDuration:0,cooldown:0,coolingDown:!1,coolingDownTime:null}})}return Object(c.a)(e,[{key:"freezeCommandState",value:function(){var e=this,t={inputs:{},ignoreAlls:Object(f.a)({},this._ignoreAlls)};return Object.keys(this._spec).forEach(function(n){t.inputs[n]=Object(f.a)({},e[n])}),t}},{key:"thawCommandState",value:function(e){var t=this;Object.keys(this._spec).forEach(function(n){t[n]=Object(f.a)({},e.inputs[n])}),this._ignoreAlls=Object(f.a)({},e.ignoreAlls)}},{key:"getManager",value:function(e){return this._scenes.get(e)}},{key:"managerList",value:function(){return Object(g.a)(this._scenes.values())}},{key:"attachScene",value:function(e,t){this._scenes.set(e,{scene:e,commands:e.game.debug?[]:null,tickCount:0,suppressRepeatFrames:t})}},{key:"detachScene",value:function(e){this._scenes.delete(e)}},{key:"attachKey",value:function(e,t){var n=this,a=e.input.keyboard;a.on("keydown-".concat(t),function(e){var a=document.activeElement&&document.activeElement.tagName.toLowerCase();"input"!==a&&"select"!==a&&"textarea"!==a&&(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||(e.preventDefault(),n.keyboard[t]=!0))}),a.on("keyup-".concat(t),function(e){var a=document.activeElement&&document.activeElement.tagName.toLowerCase();"input"!==a&&"select"!==a&&"textarea"!==a&&(e.preventDefault(),n.keyboard[t]=!1)}),t in this.keyboard||(this.keyboard[t]=!1)}},{key:"detachKey",value:function(e,t){delete this.keyboard[t]}},{key:"attachInputs",value:function(e){var t=this;Object(D.d)(this._spec).forEach(function(n){t.attachKey(e,n)}),e.input.gamepad&&(e.input.gamepad.on("down",function(e,n){var a=R[n.index];a||Object.entries(M).forEach(function(t){var i=Object(m.a)(t,2),r=i[0],o=i[1];n===e[o]&&(a=R[n.index]=r)}),t.gamepad[a]=!0}),e.input.gamepad.on("up",function(e,n){var a=R[n.index];a||Object.entries(M).forEach(function(t){var i=Object(m.a)(t,2),r=i[0],o=i[1];n===e[o]&&(a=R[n.index]=r)}),t.gamepad[a]=!1}));var n=document.querySelector("#engine canvas");["pointerdown","pointerup"].forEach(function(a){e.input.on(a,function(e){document.activeElement&&document.activeElement.contains&&!document.activeElement.contains(n)?setTimeout(function(){document.activeElement.blur()}):t.pointerEvents.push({name:a,x:e.x,y:e.y})})})}},{key:"readRawGamepad",value:function(e){var t=this.gamepad,n=!1;e.forEach(function(e){var a=e.input.gamepad;a.total&&(n||(n=!0,t.total=0,t.LSTICKX=0,t.LSTICKY=0,t.RSTICKX=0,t.RSTICKY=0),t.total<a.total&&(t.total=a.total),a.gamepads.filter(function(e){return e}).forEach(function(e){var n=e.leftStick,a=e.rightStick;Math.abs(n.x)>Math.abs(t.LSTICKX)&&(t.LSTICKX=n.x),Math.abs(n.y)>Math.abs(t.LSTICKY)&&(t.LSTICKY=n.y),Math.abs(a.x)>Math.abs(t.RSTICKX)&&(t.RSTICKX=a.x),Math.abs(a.y)>Math.abs(t.RSTICKY)&&(t.RSTICKY=a.y)}))})}},{key:"heldCommands",value:function(e){var t=this,n=this.gamepad,a=this._spec,i={_repeat:0};return Object.entries(a).forEach(function(a){var r=Object(m.a)(a,2),o=r[0],s=r[1];if(!e||s.unignorable){var c=!1;s.input&&(s.input.forEach(function(e){var a;n.total?"gamepad.LSTICK.RAW"===e&&(Math.abs(n.LSTICKX)>.1||Math.abs(n.LSTICKY)>.1)?c=[n.LSTICKX,n.LSTICKY]:"gamepad.RSTICK.RAW"===e&&(Math.abs(n.RSTICKX)>.1||Math.abs(n.RSTICKY)>.1)?c=[n.RSTICKX,n.RSTICKY]:a="gamepad.LSTICK.UP"===e?n.LSTICKY<-.2:"gamepad.LSTICK.DOWN"===e?n.LSTICKY>.2:"gamepad.LSTICK.LEFT"===e?n.LSTICKX<-.2:"gamepad.LSTICK.RIGHT"===e?n.LSTICKX>.2:"gamepad.RSTICK.UP"===e?n.RSTICKY<-.2:"gamepad.RSTICK.DOWN"===e?n.RSTICKY>.2:"gamepad.RSTICK.LEFT"===e?n.RSTICKX<-.2:"gamepad.RSTICK.RIGHT"===e?n.RSTICKX>.2:P.a.get(t,e):a=P.a.get(t,e),a&&(c=!0)}),t[o].held=c,c&&(i[o]=c))}}),this.pointerEvents.length&&(e||(i._pointer=Object(g.a)(this.pointerEvents)),this.pointerEvents.length=0),this.executedProps.length&&(e||(i._executedProps=Object(g.a)(this.executedProps)),this.executedProps.length=0),i}},{key:"replayFrame",value:function(e){var t=this,n=this._spec;Object.entries(n).forEach(function(n){var a=Object(m.a)(n,2),i=a[0],r=a[1];e[i]&&r.unreplayable?t[i].held=!1:t[i].held=e[i]})}},{key:"mergeUnignorable",value:function(e){var t=this,n=this._spec;Object.entries(n).forEach(function(n){var a=Object(m.a)(n,2),i=a[0],r=a[1];e[i]&&r.unignorable&&!r.unreplayable&&(t[i].held=!0)})}},{key:"addFrameToList",value:function(e,t,n){if(!e&&t.length){var a=t[t.length-1],i=!0;if(n._pointer||a._pointer?i=!1:n._executedProps||a._executedProps?i=!1:Object.keys(this._spec).forEach(function(e){a[e]!==n[e]&&(i=!1)}),i)return t.pop(),void t.push(Object(f.a)({},a,{_repeat:a._repeat+1}))}t.push(n)}},{key:"ignoreAll",value:function(e,t){var n=this._ignoreAlls;if(void 0===e){var a=!1;return Object.values(n).forEach(function(e){e&&(a=!0)}),a}return void 0===t?n[e]:(n[e]=!!t,n[e])}},{key:"clearIgnoreAlls",value:function(){var e=this._ignoreAlls;Object.keys(e).forEach(function(t){e[t]=!1})}},{key:"processCommands",value:function(e,t,n){var a=this,i=this._spec,r=e.scene,o=this.ignoreAll();Object.entries(i).forEach(function(e){var t=Object(m.a)(e,2),i=t[0],s=t[1],c=a[i];if((!Object(S.b)("command.".concat(i,".enabled"))||o&&!s.unignorable)&&(c.held=!1),s.cooldown&&(c.coolingDownTime=Math.max(0,c.coolingDownTime-n),c.coolingDown=c.coolingDownTime>0,c.coolingDown&&(c.held=!1),c.held&&(c.coolingDownTime=Object(S.b)("command.".concat(i,".cooldown")))),c.held?(c.heldFrames+=1,c.heldDuration+=n,c.started=1===c.heldFrames,c.continued=c.heldFrames>1,c.released=!1,c.releasedFrames=0,c.releasedDuration=0):(c.held=!1,c.heldFrames=0,c.heldDuration=0,c.started=!1,c.continued=!1,c.released=1===c.releasedFrames,c.releasedFrames+=1,c.releasedDuration+=n),c.started&&s.execute)if("function"===typeof s.execute)s.execute(r,r.game);else{var l=P.a.get(r,s.execute);if(l)l.call(r);else{var u=P.a.get(r.game,s.execute);if(!u)throw new Error("Invalid execute for command '".concat(i,"'; expected a function or a scene/game method name, got ").concat(s.execute));u.call(r.game)}}}),!o&&t._pointer&&t._pointer.forEach(function(e){r.handlePointerEvent(e)}),this.replay&&t._executedProps&&t._executedProps.forEach(function(e){var t=Object(S.b)(e);"function"===typeof t?t():console.error("Recorded prop ".concat(e," is no longer a function? It's ").concat(t))})}},{key:"injectReplayFrame",value:function(){if(!this.replay)return null;if(this.replayFrameIndex>=this.replay.commands.length||this.replayTicks>=this.replay.postflightCutoff)return this.endedReplay(),null;var e=this.replay.commands[this.replayFrameIndex];return e._repeat?(this.replayRepeatRun+=1,this.replayRepeatRun>e._repeat&&(this.replayRepeatRun=0,this.replayFrameIndex+=1)):this.replayFrameIndex+=1,this.replayTicks+=1,this.replayFrame(e),this.heldCommands(!0),this.mergeUnignorable(e),Object(f.a)({},e,{_repeat:0})}},{key:"processInput",value:function(e,t,n,a){var i=this.getManager(e);if(i.scene.timeSightFrozen){var r=this.heldCommands(a);this.processCommands(i,r,n)}else{var o=this.injectReplayFrame()||this.heldCommands(a);i.commands&&this.addFrameToList(i.suppressRepeatFrames,i.commands,o),this.recording&&this.addFrameToList(i.suppressRepeatFrames,this.recording.commands,o),i.tickCount+=1,this.recording&&(this.recording.tickCount+=1),this.processCommands(i,o,n)}}},{key:"recordPropExecution",value:function(e){this.executedProps.push(e)}},{key:"beginRecording",value:function(e,t){var n=this.getManager(e);this.recording=t,t.commands=Object(g.a)(n.commands),t.originalPreflightCutoff=t.preflightCutoff=t.tickCount=n.tickCount}},{key:"stopRecording",value:function(){var e=this.recording;return delete this.recording,e.postflightCutoff=e.tickCount,e}},{key:"beginReplay",value:function(e,t){this.replay=e,this.replayFrameIndex=0,this.replayRepeatRun=0,this.replayTicks=0,this.replayOptions=t;var n=t.startTick||e.startTick||0;if(n)for(var a=0;a<n;a+=1)this.injectReplayFrame()}},{key:"endedReplay",value:function(){if(this.replay){var e=this.replayOptions.onEnd;delete this.replay,delete this.replayOptions,delete this.replayFrameIndex,delete this.replayRepeatRun,delete this.replayTicks,e&&e()}}},{key:"stopReplay",value:function(){if(this.replay){var e=this.replayOptions.onStop;delete this.replay,delete this.replayOptions,delete this.replayFrameIndex,delete this.replayRepeatRun,delete this.replayTicks,e&&e()}}},{key:"hasPreflight",value:function(){return!!this.replay&&(!(this.replayTicks>=this.replay.postflightCutoff)&&this.replayTicks<(this.replayOptions.preflightCutoff||this.replay.preflightCutoff))}},{key:"updateCommandsFromReload",value:function(e){var t=this._spec;this.updateSpecFromReload(t,e),this.updateInputsFromReload(t,e,!0),this.updateInputsFromReload(t,e,!1)}},{key:"updateSpecFromReload",value:function(e,t){this._spec=t;var n=[],a=[],i=[],r={};if(Object.entries(t).forEach(function(a){var o=Object(m.a)(a,2),s=o[0];o[1];if(e[s]){r[s]=!0;var c={};Object.entries(e[s]).forEach(function(e){var t=Object(m.a)(e,2),n=t[0],a=t[1];c[n]="function"===typeof a?String(a):a});var l={};Object.entries(t[s]).forEach(function(e){var t=Object(m.a)(e,2),n=t[0],a=t[1];l[n]="function"===typeof a?String(a):a}),JSON.stringify(c)!==JSON.stringify(l)&&i.push(s)}else n.push(s)}),Object.keys(e).forEach(function(e){r[e]||a.push(e)}),0!==n.length||0!==a.length||0!==i.length){var o=[];n.length&&o.push("+[".concat(n.join(", "),"]")),a.length&&o.push("-[".concat(a.join(", "),"]")),i.length&&o.push("\u0394[".concat(i.join(", "),"]")),console.info("Hot-loading command changes (".concat(o.join(", "),")"))}}},{key:"updateInputsFromReload",value:function(e,t,n){var a=this,i={},r={},o=n?D.d:D.e;o(t).forEach(function(e){i[e]=!0}),o(e,!0).forEach(function(e){r[e]=!0});var s=[];Object.keys(i).forEach(function(e){r[e]?delete r[e]:s.push(e)});var c=Object.keys(r);if(0!==s.length||0!==c.length){n&&this.managerList().forEach(function(e){s.forEach(function(t){a.attachKey(e.scene,t)}),c.forEach(function(t){a.detachKey(e.scene,t)})});var l=[];s.length&&l.push("+[".concat(s.join(", "),"]")),c.length&&l.push("-[".concat(c.join(", "),"]")),console.info("Hot-loading ".concat(n?"keyboard":"gamepad"," input changes (").concat(l.join(", "),")"))}}}]),e}(),A={type:y.a.AUTO,parent:"engine",width:800,height:600,tileWidth:24,tileHeight:24},L=function(e){function t(e,n){var a;Object(s.a)(this,t);var i=Object(f.a)({},A,e);if(a=Object(l.a)(this,Object(u.a)(t).call(this,i)),Object.entries(i).forEach(function(e){var t=Object(m.a)(e,2),n=t[0],i=t[1];n in a.config||(a.config[n]=i)}),a.debug=i.debug,a.scene.add("BootScene",w,!0,{seed:Date.now(),sceneId:String(Math.random())}),a.preloadScenes=n,a.scale.__proto__.onFullScreenChange=function(){},a.prop=S.b,a._replayPreflight=0,a._onDisableDebugUI=[],a._sceneInitCallbacks={},a.assets={},a.command=new x(S.a),a._initializeShaderStructures(S.g,S.f,S.h),a.focused=!0,a._sceneConstructors={},[w].concat(Object(g.a)(n)).forEach(function(e){a._sceneConstructors[e.name]=e}),i.debug){var r=Object(v.a)(a);window.scene=new Proxy({},{get:function(e,t){return r.topScene()[t]}}),window.prop=S.b}return a.events.on("step",function(){var e=a.topScene();if(a.readRawInput(),i.debug){if(a._replayPreflight>0)return;if(a.disableDebug||e._replay&&e._replay.timeSight||Object(k.f)(!1),Object(S.b)("engine.throttle"))for(var t=(new Date).getTime();(new Date).getTime()-t<50;);}}),a}return Object(h.a)(t,e),Object(c.a)(t,[{key:"shaderFragments",value:function(e){var t=this._shaderPipelines[e];return t?[].concat(Object(g.a)(t[0]),Object(g.a)(t[1])):null}},{key:"_initializeShaderStructures",value:function(e,t,n){this._shaderSource||(this._shaderSource={});var a=[].concat(Object(g.a)(e||[]),Object(g.a)(t||[])),i={},r=function(n,a){var r=[],o=[];a.forEach(function(a){var i=e.find(function(e){return Object(m.a)(e,1)[0]===a});if(i)r.push(i);else{var s=t.find(function(e){return Object(m.a)(e,1)[0]===a});if(!s)throw new Error("Unable to find shader '(".concat(a,"' in shader pipeline '").concat(n,"'"));o.push(s)}}),i[n]=[r,o]};Object.entries(n).forEach(function(e){var t=Object(m.a)(e,2),n=t[0],a=t[1];r(n,a)}),a.forEach(function(e){var t=Object(m.a)(e,1)[0];i[t]||r(t,[t])}),i.main||r("main",a.map(function(e){return Object(m.a)(e,1)[0]})),this._shaderPipelines=i}},{key:"changeVolume",value:function(e){this.volume=e,this.currentMusicPlayer&&this.currentMusicPlayer.setVolume(e*Object(S.b)("scene.musicVolume")),this.scene.scenes.forEach(function(t){t.changeVolume(e)})}},{key:"setFocused",value:function(e){this.focused!==e&&(this.focused=e)}},{key:"topScene",value:function(){var e=this.scene.scenes;return e[e.length-1]}},{key:"preloadComplete",value:function(){var e=document.getElementById("lds-spinner");e&&e.parentNode&&e.parentNode.removeChild(e),this._preloadedAssets=!0,this.tryLaunch()}},{key:"activateGame",value:function(e){this._activatedGame||(this._activatedGame=[]),e&&this._activatedGame.push(e),this.tryLaunch()}},{key:"tryLaunch",value:function(){var e=this;this._preloadedAssets&&this._activatedGame&&(this._launchedGame?this._activatedGame&&(this._activatedGame.forEach(function(e){e()}),delete this._activatedGame):this._launchingGame||(this._launchingGame=!0,console.warn("Welcome to ".concat(C.b,"!")),setTimeout(function(){e.renderer.type===y.a.CANVAS&&alert("It looks like this browser will offer a degraded experience. For best results, please use Chrome!");var t=document.getElementById("cover");t&&t.parentNode&&t.parentNode.removeChild(t),e.scene.remove(w.key()),e.launch();var n=e.topScene();n&&(n.willTransitionFrom(),n.timer(function(){return n.didTransitionFrom()}).ignoresScenePause=!0),e._activatedGame.forEach(function(e){e()}),delete e._activatedGame,e._launchedGame=!0})))}},{key:"onDisableDebugUI",value:function(e){this.disableDebug?e():this._onDisableDebugUI.push(e)}},{key:"disableDebugUI",value:function(){if(!this.disableDebug){this.disableDebug=!0,this._onDisableDebugUI.forEach(function(e){return e()});var e=document.querySelector(".development .Manage");e&&e.remove();var t=document.querySelector(".development .Replay");t&&t.remove();var n=document.querySelector(".development .Logging");n&&n.remove()}}},{key:"forceQuit",value:function(){this.stopRecording(),this.stopReplay(),this.destroy(!0,!0);var e=document.querySelector("#engine-container");e&&e.remove(),this.disableDebugUI(),(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())}},{key:"zeroPrefix",value:function(e,t){for(var n=e,a="",i=1;i<t;i+=1)n<10?a+="0":n/=10;return"".concat(a).concat(e)}},{key:"renderDateTime",value:function(e){var t=this,n=function(e){return t.zeroPrefix(e,2)};return[[e.getFullYear(),n(e.getMonth()+1),n(e.getDate())].join("-"),[e.getHours(),n(e.getMinutes()),n(e.getSeconds())].join(":")].join(" ")}},{key:"renderMillisecondDuration",value:function(e){var t=Math.floor(e/1e3/60);if(t>99)return"99:99.99+";var n=e/1e3-60*t;return"".concat(t,":").concat(this.zeroPrefix(n.toFixed(3),2))}},{key:"beginRecording",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.topScene(),n=new Date;this._recording=Object(f.a)({timestamp:n.getTime(),initData:t.scene.settings.data,sceneName:t.constructor.name,name:this.renderDateTime(n),commandState:this.command.freezeCommandState()},e),t.beginRecording(this._recording),this._recording.snapshot?this.stopRecording():this.onRecordBegin&&this.onRecordBegin(this._recording)}},{key:"stopRecording",value:function(){var e=this._recording;if(e)return this.topScene().stopRecording(),delete this._recording,this.onRecordStop&&this.onRecordStop(e),e}},{key:"beginReplay",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._replay=e;var a=n.startFromTransition,i=e.sceneTransitions;if(!a&&i)for(var r=0;r<i.length;r+=1)i[r].tickCount<=e.preflightCutoff&&(a=i[r]);var o=Math.max(e.preflightCutoff,a&&a.tickCount||0);this.transitionToSceneToBeginReplay(e,a).then(function(i){i.beginReplay(e,Object(f.a)({},n,{startFromTransition:a,preflightCutoff:o,onEnd:function(){t.endedReplay()},onStop:function(){t.stopReplay(!0)}})),t.onReplayBegin&&t.onReplayBegin(e)})}},{key:"transitionToSceneToBeginReplay",value:function(e,t){var n=this,a=this.topScene(),i="scene-".concat(Math.random()*Date.now()),r=t||e,o=r.sceneSaveState,s=r.sceneName,c=r.initData,l=r.commandState,u=JSON.parse(JSON.stringify(o)),h=(t||e).initData.seed,d=new Promise(function(e,t){n.onSceneInit(i,function(t){n.command.thawCommandState(l),t.willTransitionFrom(null,null),a._sceneTransition(a,t,null),e(t,null)})});return a.scene.add(i,this._sceneConstructors[s],!0,Object(f.a)({},c,{save:u,seed:h,transition:null})),d}},{key:"endedReplay",value:function(){if(this._replay){var e=this._replay;delete this._replay,this.onReplayEnd&&this.onReplayEnd(e)}}},{key:"stopReplay",value:function(e){if(this._replay){var t=this._replay;delete this._replay,e||this.topScene().stopReplay(),this.onReplayStop&&this.onReplayStop(t)}}},{key:"playMusic",value:function(e,t){if(t||this.currentMusicName!==e)if(this.currentMusicPlayer&&this.currentMusicPlayer.key&&this.currentMusicPlayer.destroy(),e)try{var n=this.sound.add(e);if(!n||!n.key)return void console.warn("Could not load music ".concat(e));n.play("",{loop:!0}),n.setVolume(this.volume*Object(S.b)("scene.musicVolume")),this.currentMusicPlayer=n,this.currentMusicName=e}catch(a){console.log("Could not play music ".concat(e,": ").concat(a))}else this.currentMusicName=e}},{key:"readRawInput",value:function(){var e=this.scene.scenes.filter(function(e){return e.input.gamepad});e&&this.command.readRawGamepad(e)}},{key:"cutoffTimeSightEnter",value:function(){var e=this.topScene();e&&e.cutoffTimeSightEnter()}},{key:"cutoffTimeSightChanged",value:function(e,t){var n=this.topScene();n&&n.cutoffTimeSightChanged(e,t)}},{key:"cutoffTimeSightLeave",value:function(){var e=this.topScene();e&&e.cutoffTimeSightLeave()}},{key:"shaderInstance",value:function(e){return this.renderer.type!==y.a.WEBGL?null:this.renderer.getPipeline(e)}},{key:"initializeShader",value:function(e,t){if(this.renderer.type===y.a.WEBGL&&(t||!this.renderer.hasPipeline(e))){var n=this.generateShaderSource(e);if(n){var a=new(this.shaderInstantiation(n))(this);if(!a||void 0===a.active)return;t&&this.renderer.removePipeline(e),this.renderer.addPipeline(e,a),a.setFloat2("resolution",this.config.width,this.config.height)}else this.renderer.removePipeline(e);this._shaderSource[e]=n}}},{key:"initializeShaders",value:function(){var e=this;Object.keys(this._shaderPipelines).forEach(function(t){e.initializeShader(t)})}},{key:"updateShaderFragments",value:function(e,t,n){this._initializeShaderStructures(e,t,n),this.recompileShaders()}},{key:"generateShaderSourceInternal",value:function(e){var t=this._shaderPipelines[e];if(!t)throw new Error("No definition found for shader pipeline ".concat(e,"; do you need to add it to shaderPipelines in props.js?"));var n=t.map(function(e){return e?e.filter(function(e){var t=Object(m.a)(e,1)[0];return Object(S.b)("shader.".concat(t,".enabled"))}).map(function(e){return Object(m.a)(e,3)[2]}).join("\n"):""}),a=Object(m.a)(n,2),i=a[0],r=a[1];if(i||r)return"\n      void main( void ) {\n        vec2 uv = outTexCoord;\n\n        ".concat(i,"\n\n        vec4 c = texture2D(uMainSampler, uv);\n\n        ").concat(r,"\n\n        gl_FragColor = vec4(c.rgb * c.a, c.a);\n      }\n    ")}},{key:"generateShaderSource",value:function(e){var t=this._shaderPipelines[e];if(!t)throw new Error("No definition found for shader pipeline ".concat(e,"; do you need to add it to shaderPipelines in props.js?"));var n=[],a=[];[].concat(Object(g.a)(t[0]),Object(g.a)(t[1])).forEach(function(e){var t=Object(m.a)(e,2),i=t[0],r=t[1];Object(S.b)("shader.".concat(i,".enabled"))&&Object.entries(r).forEach(function(e){var t=Object(m.a)(e,2),r=t[0],o=Object(m.a)(t[1],1)[0],s="".concat(i,"_").concat(r);n.push(s);var c=Object(m.a)(j.c[o],2)[1];a.push("uniform ".concat(c," ").concat(s,";\n"))})});var i=this.generateShaderSourceInternal(e);return i?(n.forEach(function(t){var n=new RegExp("\\b".concat(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"\\b"));i.match(n)||console.error("Shader program ".concat(e," doesn't appear use uniform '").concat(t,"'. (If this is a false positive, try adding this to your program: // ").concat(t))}),"\n      ".concat("\n      precision mediump float;\n    ","\n      ").concat("\n      uniform sampler2D uMainSampler;\n      varying vec2      outTexCoord;\n\n      uniform vec2 resolution;\n      uniform vec2 camera_scroll;\n      uniform float scene_time;\n    ","\n      ").concat(a.join(""),"\n      ").concat(i,"\n    ")):i}},{key:"recompileShader",value:function(e){if(this.renderer.type===y.a.WEBGL){var t=this._shaderSource[e],n=this.generateShaderSource(e);if(t!==n){console.info("Hot-loading shader ".concat(e)),this._shaderSource[e]=n,n?this.initializeShader(e,!0):this.renderer.removePipeline(e);var a=this.shaderInstance(e);this.scene.scenes.forEach(function(t){t.shaderName===e&&(t.shader=a,n?(t._shaderInitialize(),t._shaderUpdate(),t.camera.setPipeline(a)):t.camera.clearRenderToTexture())})}}}},{key:"recompileShaders",value:function(){var e=this;Object.keys(this._shaderPipelines).forEach(function(t){e.recompileShader(t)})}},{key:"disableShader",value:function(e){if(this.renderer.type===y.a.WEBGL){this._shaderSource[e]=null,this.renderer.removePipeline(e);var t=this.shaderInstance(e);this.scene.scenes.forEach(function(n){n.shaderName===e&&(n.shader=t,n.camera.clearRenderToTexture())})}}},{key:"disableShaders",value:function(){var e=this;Object.keys(this._shaderPipelines).forEach(function(t){e.disableShader(t)})}},{key:"shaderInstantiation",value:function(e){try{return new y.a.Class({Extends:y.a.Renderer.WebGL.Pipelines.TextureTintPipeline,initialize:function(t){try{y.a.Renderer.WebGL.Pipelines.TextureTintPipeline.call(this,{game:t,renderer:t.renderer,fragShader:e})}catch(n){console.error(n)}}})}catch(t){console.error(t)}}},{key:"onSceneInit",value:function(e,t){this._sceneInitCallbacks[e]||(this._sceneInitCallbacks[e]=[]),this._sceneInitCallbacks[e].push(t)}},{key:"sceneDidInit",value:function(e){var t=e.scene.key;this._sceneInitCallbacks[t]&&(this._sceneInitCallbacks[t].forEach(function(t){t(e)}),delete this._sceneInitCallbacks[t])}}]),t}(y.a.Game),I=function(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))},F=window.illuminated,B=F.Lamp,W=F.PolygonObject,U=F.DarkMask,K=F.Vec2,N=F.Lighting,Y=[24,12,4,1],X=Y.shift(),z=X,q=function(e){X>1&&Y.length&&(console.log("downsampling to ",Y[0]),X=z=Y.shift(),e())},V=function(e){function t(){var e;return Object(s.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this,{input:{gamepad:!0},physics:{arcade:{fps:60}}}))).downsamples=Y,e.performanceProps=Object(g.a)(Y.map(function(){return function(){return q(function(){return e.resampleSuns()})}})),e.mapsAreRectangular=!0,e.suns=[],e}return Object(h.a)(t,e),Object(c.a)(t,[{key:"initialSaveState",value:function(){return{createdAt:Date.now(),deaths:0,level:0}}},{key:"saveStateVersion",value:function(){return 1}},{key:"migrateSaveStateVersion1",value:function(e){}},{key:"init",value:function(e){Object(O.a)(Object(u.a)(t.prototype),"init",this).call(this,e)}},{key:"preload",value:function(){Object(O.a)(Object(u.a)(t.prototype),"preload",this).call(this)}},{key:"rotatedVecs",value:function(e){var t=this.lightX,n=this.lightY,a=[],i=e.originX,r=e.originY,o=e.rotation,s=e.width,c=e.height,l=e.x,u=e.y,h=e.scaleX,d=e.scaleY,p=e.overrideScaleX,_=e.overrideScaleY,f=s*(p||h),g=c*(_||d);return[[0,0],[0,g],[f,g],[f,0]].forEach(function(e){var s=Object(m.a)(e,2),c=s[0],h=s[1],d=y.a.Math.RotateAround({x:c-f*i,y:h-g*r},i,r,o),p=d.x,_=d.y;a.push(new K(p+l-t,_+u-n))}),a}},{key:"createLightCanvas",value:function(){var e=this.lightKey="light-"+Date.now(),t=this.lightWidth=1e3,n=this.lightHeight=800,a=this.lightX=(800-this.lightWidth)/2,i=this.lightY=(600-this.lightHeight)/2;this.lightTexture=this.textures.createCanvas(e,t,n),this.add.image(a,i,e).setOrigin(0,0).setDepth(-100)}},{key:"createSun",value:function(e,t,n,a){var i=this.add.image(e,t,"bead"),r=new B({position:new K(e-this.lightX,t-this.lightY),color:"rgba(".concat(a?0:255,", ").concat(0,", ").concat(a?255:0,", 0.8)"),distance:100,radius:10,samples:0}),o=new B({position:new K(e-this.lightX,t-this.lightY),color:"rgba(".concat(a?200:255,", ").concat(200,", ").concat(a?255:200,", 1)"),distance:1400,radius:10,samples:X}),s={bead:i,corona:r,ambient:o,lamps:[r,o],lightings:[new N({light:o,objects:n}),new N({light:r,objects:[]})],backwards:a};return this.suns.push(s),this.dark=new U({lights:P.a.flatMap(this.suns,function(e){return e.lamps})}),s}},{key:"resampleSuns",value:function(){(this.suns||[]).forEach(function(e){e.corona;e.ambient.samples=X})}},{key:"createHealthBar",value:function(e){var t=this.add.sprite(e.x,e.y,"hpbar"),n=this.add.sprite(e.x,e.y,"hpbar"),a={fill:n,border:t};n.setCrop(1,1,n.width-2,n.height-2),n.tint=16711680,t.tint=0,t.visible=n.visible=!1,e.healthBar=a}},{key:"updateHealthBarFor",value:function(e,t){var n=e.healthBar,a=n.fill,i=n.border;t<=0?i.visible=a.visible=!1:(i.visible=a.visible=!0,i.x=e.x,i.y=e.y-e.height,a.x=e.x,a.y=e.y-e.height,a.setCrop(1,1,a.width*t-2,a.height-2))}},{key:"createSmoker",value:function(e){var t={};this.particleSystem("effects.lightAsh",{follow:e,x:{min:-e.width/2,max:e.width/2},y:{min:-e.height/2,max:e.height/2},alpha:{start:1,end:0},scale:{start:.75,end:1.125},speedY:{min:.5*Object(S.b)("effects.lightAsh.speedY"),max:Object(S.b)("effects.lightAsh.speedY")},speedX:{min:-Object(S.b)("effects.lightAsh.speedX"),max:Object(S.b)("effects.lightAsh.speedX")},tint:[16172118,15489877,11184810],onAdd:function(e,n){t.particles=e,t.emitter=n,n.on=!1}}),e.smoker={lightAsh:t}}},{key:"createStars",value:function(e){this.particleSystem("effects.stars",{x:{min:-100,max:900},y:{min:-100,max:700},lifespan:{min:.5*Object(S.b)("effects.stars.lifespan"),max:2*Object(S.b)("effects.stars.lifespan")},scale:{start:0,end:1,ease:function(e){return e<.2?5*e:1-(e-.2)}},alpha:{start:0,end:.75,ease:function(e){return e<.2?5*e:1-(e-.2)}},tint:[16172118,15489877,11184810],onAdd:function(t,n){t.setDepth(-50),e.stars={particles:t,emitter:n}}})}},{key:"scheduleComet",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.randBetween("comet",1e4,1e5);this.timer(function(){t.comet(e)},n)}},{key:"comet",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.level,n=this.randBetween("comet",200,400);this.randFloat("comet")<.5&&(n*=-1);var a=this.randBetween("comet",3,10);this.randFloat("comet")<.5&&(a*=-1);var i=this.randBetween("comet",100,700),r=this.randBetween("comet",100,500),o=this.add.image(i,r,"dot");o.setScale(1.5,1.5),o.setDepth(-48),this.tweenPercent(1e3,function(e){var t=.03+e,s=i+n*t,c=r+a*t;o.x=s,o.y=c,o.setScale(1+.5*(1-e),1+.5*(1-e))}),this.timer(function(){o.destroy()},Object(S.b)("effects.comet.lifespan")),this.particleSystem("effects.comet",{scale:.5,alpha:.5,speedX:n,speedY:a,onAdd:function(n,a){n.x=i,n.y=r,n.setDepth(-49),t.comet={particles:n,emitter:a},e.timer(function(){a.stop()},1e3),e.timer(function(){n.destroy()},2e3)}})}},{key:"createLevel",value:function(e){var n=this.levelIds()[e],a=Object(O.a)(Object(u.a)(t.prototype),"createLevel",this).call(this,n);return a.index=e,a.player=a.groups.player.objects[0],a.player.setGravityY(Object(S.b)("player.gravityBase")),a.player.anims.play("idle"),a.player.overrideScaleX=.5,this.cameraFollow(a.player),this.createHealthBar(a.player),this.createSmoker(a.player),this.createStars(a),this.scheduleComet(a),a.blockingObjects=[],Object.entries(a.groups).forEach(function(e){var t,n=Object(m.a)(e,2),i=n[0],r=n[1],o=r.objects;r.shadow&&(t=a.blockingObjects).push.apply(t,Object(g.a)(o));switch(i){case"spinner":case"reverseSpinner":o.forEach(function(e){e.setImmovable(),"reverseSpinner"===i?(e.body.setAngularVelocity(-30),e.rotation=180):e.body.setAngularVelocity(30)});break;case"drawbridge":o.forEach(function(e){e.setImmovable(),e.body.pushable=!1,e.setOrigin(.95,.25),e.angle=Object(S.b)("effects.drawbridge.rotation"),e.body.enable=!1;var t=r.group.create(e.x+12,e.y,"drawbridgeAlt");t.setOrigin(.75,1-.95),t.setImmovable(),t.body.pushable=!1,t.visible=!1,e.alternate=t});break;case"button":o.forEach(function(e){e.setDepth(-5)})}}),a.shadowObjects=[a.player].concat(Object(g.a)(a.blockingObjects)),a}},{key:"create",value:function(e){var n,a=this;Object(O.a)(Object(u.a)(t.prototype),"create",this).call(this,e),n=void 0!==e.levelIndex?e.levelIndex:void 0!==this.save.level?this.save.level:0,n%=this.levelIds().length,this.save.level=n,this.saveState(),this.respawn=e.respawn;var i=this.createLevel(n);this.createLightCanvas(),i.illObjects=i.shadowObjects.map(function(e){var t=new W({points:a.rotatedVecs(e)});return e.occ=t,t}),this.createSun(0,0,i.illObjects),i.dualSun&&this.createSun(0,0,i.illObjects,!0),this.hud=this.createHud(),this.setupPhysics(),this.command.ignoreAll("winning",!1),this.command.ignoreAll("dying",!1),this.spawn()}},{key:"spawn",value:function(){var e=this,t=this.level,n=this.save;if(this.timer(function(){e.command.ignoreAll("winning",!1),e.command.ignoreAll("dying",!1)},300),t.lastLevel){var a;this.speak(400,300,t.hi,{duration:500,noOut:!0,onAdd:function(t){e.timer(function(){e.tween("effects.attract",t)},500)}});var i=n.deaths;switch(i){case 0:a="You won without dying!!! You are inevitable!";break;case 1:a="You perished only once!!";break;default:a="You delayed the inevitable, but perished ".concat(i," times.")}this.timer(function(){e.speak(400,400,a,{duration:500,noOut:!0,onAdd:function(t){e.timer(function(){e.tween("effects.attract",t)},500)}})},500)}else this.respawn||this.speak("@",t.hi,{dy:-50,fontSize:"18px"})}},{key:"createHud",value:function(){return{}}},{key:"setupPhysics",value:function(){var e=this,t=this.level,n=this.physics,a=t.player,i=t.groups,r=i.wall,o=i.ground,s=i.crumble,c=i.button,l=i.drawbridge;n.add.collider(a,r.group),n.add.collider(a,o.group),n.add.collider(a,l.group),n.add.collider(a,s.group,function(){return e.crumble.apply(e,arguments)}),n.add.collider(a,c.group,function(){return e.button.apply(e,arguments)})}},{key:"crumble",value:function(e,t){var n=this;t.crumbling||e.y+.6*e.height>=t.y||(t.crumbling=!0,t.anims.play("crumbling"),this.playSound("breaking"),this.tween("effects.firstCrumble",t,{onComplete:function(){n.tween("effects.crumble",t,{onComplete:function(){t.disableBody(!0,!1)}})}}))}},{key:"button",value:function(e,t){if(!(e.y+.6*e.height>=t.y)&&!e.pressingButton&&(e.pressingButton=!0,!t.toggling)){t.toggling=!0;var n=Object(m.a)(this.level.groups.drawbridge.objects,1)[0],a=n.alternate;this.playSound("drawbridge"),this.tween("effects.buttonPress",t,{onComplete:function(){t.toggling=!1}}),t.pressed?(t.pressed=!1,a.body.enable=!0,n.body.enable=!1,this.tween("effects.drawbridge",n,{})):(a.body.enable=!1,n.body.enable=!0,t.pressed=!0,this.tween("effects.drawbridge",n,{rotation:0}))}}},{key:"setupAnimations",value:function(){this.anims.create({key:"idle",frames:[{key:"player",frame:0}]}),this.anims.create({key:"run",frames:[{key:"player",frame:2},{key:"player",frame:1},{key:"player",frame:2},{key:"player",frame:3}],repeat:-1,frameRate:8}),this.anims.create({key:"fall",frames:[{key:"player",frame:5}]}),this.anims.create({key:"jump",frames:[{key:"player",frame:4}]}),this.anims.create({key:"crumbling",frames:[{key:"crumble",frame:1}]})}},{key:"processInput",value:function(e,t){var n=this.command,a=this.level.player,i=0,r=0,o=!1;a.body.touching.down&&(a.lastTouchDown=e);var s=a.lastTouchDown>e-75&&!a.isJumping;if(n.jump.started&&s&&(a.isJumping=!0,a.hasLiftedOff=!1,a.hasReleasedJump=!1,a.jumpStart=e,a.setVelocityY(a.body.velocity.y-Object(S.b)("player.baseJumpVelocity")),this.playSound("jump",3)),n.down.held&&(r=1),n.right.held?i=1:n.left.held&&(i=-1),n.lstick.held){var c=Object(m.a)(n.lstick.held,2);i=c[0],r=c[1],o=!0}else if(n.rstick.held){var l=Object(m.a)(n.rstick.held,2);i=l[0],r=l[1],o=!0}if(o&&(Math.abs(i)>.9?(i=i<0?-1:1,r=0):Math.abs(r)>.9&&(r=r<0?-1:1,i=0)),i||r){var u=function(e,t){var n=I(e,t);return[e/n,t/n]}(i,r),h=Object(m.a)(u,2);i=h[0],r=h[1]}else i=r=0;var d=a.body.velocity.x+i*Object(S.b)("player.speed");d*=1-Object(S.b)("player.drag"),a.setVelocityX(d),Math.abs(d)>0&&a.setFlipX(d<0);var p=a.body.velocity.y;a.body.touching.down||this.pressingButton?Math.abs(i)>0?a.anims.play("run",!0):a.anims.play("idle",!0):p>0?a.anims.play("fall",!0):p<0&&a.anims.play("jump",!0);var _=1,f=1,g=a.body.velocity,v=g.x,b=g.y,y=Math.abs(v)/1024,O=Math.abs(b)/1024;if(y+O>.1){var E=[(y-O)/(y+O),(O-y)/(y+O)];_=.1*(O=E[1])+1,f=.1*(y=E[0])+1}var w=a.scaleX+.1*(_-a.scaleX),k=a.scaleY+.1*(f-a.scaleY);a.setScale(w,k)}},{key:"processJumping",value:function(e,t){var n=this.command,a=this.level.player;n.jump.held||(a.hasReleasedJump=!0);var i=a.body.touching.down;i&&(a.lastTouchDown=e),i||(a.pressingButton=!1),!a.isJumping||a.hasLiftedOff||i||(a.hasLiftedOff=!0),a.isJumping&&a.hasLiftedOff&&i&&(a.hasLiftedOff=!1,a.isJumping=!1,this.playSound("land",!1,Math.min(.8,1.5*a.previousVelocityY/Object(S.b)("player.jumpTraumaDivisor"))),this.trauma(Math.min(Object(S.b)("player.maxJumpTrauma"),a.previousVelocityY/Object(S.b)("player.jumpTraumaDivisor"))));var r=a.body.velocity.y;a.isJumping&&!a.hasReleasedJump&&(e-a.jumpStart>Object(S.b)("player.maxJumpTime")?a.hasReleasedJump=!0:(r-=Object(S.b)("player.baseJumpVelocity"),r*=1-Object(S.b)("player.drag"),a.setVelocityY(r))),a.previousVelocityY=a.body.velocity.y}},{key:"sunPosition",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.percent,n=arguments.length>1?arguments[1]:void 0,a=n?"bwFirstPoint":"firstPoint",i=n?"bwLastPoint":"lastPoint",r=n?"bwSpline":"spline";if(!this[r]){var o=[];n?o.push(new y.a.Math.Vector2(0,750)):o.push(new y.a.Math.Vector2(10,600)),o.push(new y.a.Math.Vector2(100,200)),o.push(new y.a.Math.Vector2(400,10)),o.push(new y.a.Math.Vector2(700,200)),o.push(new y.a.Math.Vector2(800,750)),this[a]=o[0],this[i]=o[o.length-1],this[r]=new y.a.Curves.Spline(o)}return[(e=t<0?this[a]:this.winning||t>1?this[i]:this[r].getPoint(t)).x,e.y]}},{key:"spinnered",value:function(){var e=this.level,t=this.lightX,n=this.lightY,a=e.player,i=e.groups,r=i.spinner,o=i.reverseSpinner,s=a.getBounds();return[].concat(Object(g.a)(r.objects),Object(g.a)(o.objects)).some(function(e){var a=e.occ.points;return[[0,1],[1,2],[2,3],[3,0]].some(function(e){var i=Object(m.a)(e,2),r=i[0],o=i[1],c=a[r],l=a[o],u=new y.a.Geom.Line(c.x+t,c.y+n,l.x+t,l.y+n);return y.a.Geom.Intersects.LineToRectangle(u,s)})})}},{key:"crispingSun",value:function(){var e=this,t=this.suns,n=this.percent,a=this.lightX,i=this.lightY,r=this.level,o=r.player,s=r.blockingObjects,c=o.x,l=o.y,u=t.map(function(t){var a=t.backwards,i=e.sunPosition(a?1-n:n,a),r=Object(m.a)(i,2),o=r[0],s=r[1],u=new y.a.Geom.Line(o,s,c,l);return[t,u,y.a.Geom.Line.Length(u)]}).filter(function(e){var t=Object(m.a)(e,2),n=(t[0],t[1]);return!s.some(function(e){var t=e.occ.points;return[[0,1],[1,2],[2,3],[3,0]].some(function(e){var r=Object(m.a)(e,2),o=r[0],s=r[1],c=t[o],l=t[s],u=new y.a.Geom.Line(c.x+a,c.y+i,l.x+a,l.y+i);return y.a.Geom.Intersects.LineToLine(n,u)})})});if(u.length)return u}},{key:"moveShadowObjects",value:function(){var e=this;this.level.shadowObjects.forEach(function(t){t.occ.points=e.rotatedVecs(t)})}},{key:"fixedUpdate",value:function(e,t){var n=this.level,a=n.player,i=(this.t=(this.t||0)+t)*this.level.sunSpeed/1e3;this.percent=i/800;var r=Object(S.b)("player.invincible");this.processInput(e,t),this.processJumping(e,t),this.moveShadowObjects();n.stars.emitter.on=!0,n.stars.particles.visible=!0,this.playerDying?a.smoker.lightAsh.emitter.on=!1:(this.spinnered()&&this.playerDie(!0),this.crispingSuns=!this.winning&&this.percent<.9&&this.crispingSun(),this.level.dualSun&&this.percent<.1&&(this.crispingSuns=void 0),this.crispingSuns?(this.crispTime=Math.min(2e3,(this.crispTime||0)+t),a.smoker.lightAsh.emitter.on=!0):(this.crispTime=Math.max(0,(this.crispTime||0)-t),a.smoker.lightAsh.emitter.on=!1),this.crispPercent=this.crispTime/2e3,a.smoker.lightAsh.emitter.frequency=100*(1-this.crispPercent),this.crispingSuns&&e>(this.lastCrisp||0)+100&&(this.playSound("crisp",!1,Math.min(.8,this.crispPercent)),this.lastCrisp=e));var o=1,s=1;this.crispPercent>=.6&&(n.stars.emitter.on=!1,n.stars.particles.visible=!1),this.minTrauma=0,this.crispPercent>=1?r||this.playerDie(!0):!this.playerDying&&this.crispPercent>=.3&&(this.crispPercent>=.6?(this.crispingSuns&&(o=1.5,s=1.02),this.minTrauma=.2):this.minTrauma=.1,r&&(this.minTrauma=0,o=1,s=1),this.trauma(0));var c=this.crispingSuns&&!this.playerDying?.01:.4;this.timeScale=this.timeScale+(o-this.timeScale)*c,this.camera.zoom=this.camera.zoom+(s-this.camera.zoom)*(1.5*c);(a.x<-200||a.x>200+n.width||a.y<-200||a.y>200+n.height)&&this.playerDie(!1)}},{key:"unlightObject",value:function(e){var t=this.suns,n=e.occ;t.forEach(function(e){e.lightings.forEach(function(e){e.objects=e.objects.filter(function(e){return e!==n})})})}},{key:"playerDie",value:function(e){var t=this,n=this.level,a=this.save,i=n.player;this.playerDying||this.winning||(a.deaths=(a.deaths||0)+1,this.saveState(),this.playSound("explode"),this.playerDying=!0,this.unlightObject(i),this.shockwave(i.x,i.y),this.command.ignoreAll("dying",!0),this.trauma(1),i.disableBody(!0,!1),e&&(this.particleSystem("effects.playerAsh",{x:{min:i.x-.4*i.width,max:i.x+.4*i.width},y:{min:i.y-.4*i.height,max:i.y+.4*i.height},alpha:{start:1,end:0},scale:{start:.75,end:1},speedY:{min:.5*Object(S.b)("effects.playerAsh.speedY"),max:Object(S.b)("effects.playerAsh.speedY")},speedX:{min:-Object(S.b)("effects.playerAsh.speedX"),max:Object(S.b)("effects.playerAsh.speedX")},tint:[16172118,15489877,11184810],onAdd:function(e,n){t.timer(function(){n.stop()},2*Object(S.b)("effects.playerDie.duration"))}}),this.particleSystem("effects.playerSmoke",{x:{min:i.x-.4*i.width,max:i.x+.4*i.width},y:{min:i.y-.4*i.height,max:i.y+.4*i.height},alpha:{start:1,end:0},scale:{start:.5,end:1},rotate:{start:0,end:360},speedY:{min:.5*Object(S.b)("effects.playerSmoke.speedY"),max:Object(S.b)("effects.playerSmoke.speedY")},speedX:{min:-Object(S.b)("effects.playerSmoke.speedX"),max:Object(S.b)("effects.playerSmoke.speedX")},tint:[3355443,7829367,11184810,16751001],onAdd:function(e,n){t.timer(function(){n.stop()},2*Object(S.b)("effects.playerDie.duration"))}}),this.tween("effects.playerDieHealthBar",i.healthBar.fill),this.tween("effects.playerDieHealthBar",i.healthBar.border)),this.tween("effects.playerDie",i,{onComplete:function(){t.timer(function(){t.replaceWithSelf(!0,{respawn:!0},{animation:"crossFade",duration:200,delayNewSceneShader:!0,removeOldSceneShader:!0})},Object(S.b)("level.replaceDelay"))}}))}},{key:"renderUpdate",value:function(e,t){var n=this.level.player;this.renderLights(e,t),this.updateHealthBarFor(n,this.crispPercent)}},{key:"skipLevel",value:function(){var e=this.level;e.index===this.levelIds().length-1?this.goToLevel(0):this.goToLevel(e.index+1)}},{key:"prevLevel",value:function(){var e=this.level;0!==e.index&&this.goToLevel(e.index-1)}},{key:"goToLevel",value:function(e){this.replaceWithSelf(!0,{respawn:!1,levelIndex:e},{animation:"crossFade",duration:200,delayNewSceneShader:!0,removeOldSceneShader:!0})}},{key:"wonLevel",value:function(){var e=this,t=this.level,n=t.player,a=t.groups,i=a.wall,r=a.ground,o=a.spinner,s=a.reverseSpinner,c=a.crumble,l=a.drawbridge,u=a.button;if(!this.playerDying&&!this.winning){this.winning=!0,this.command.ignoreAll("winning",!0),this.playSound("night");var h=[n],d=[];[o,s,c,l,u].forEach(function(e){var t=e.objects;h.push.apply(h,Object(g.a)(t))}),[i,r].forEach(function(e){e.objects.forEach(function(e){var t=e.tiles;d.push.apply(d,Object(g.a)(t.map(function(e){return e.image})))})}),h.forEach(function(e){e.disableBody(!0,!1)}),[].concat(h,d).forEach(function(t){e.timer(function(){e.tween("effects.goodNight",t,{dy:e.randBetween("goodnight",.5,1)*Object(S.b)("effects.goodNight.dy")})},t===n?e.level.bye?3e3:2e3:e.randBetween("goodnight",0,1e3))}),this.save.level=t.index+1,this.saveState(),this.timer(function(){var n=function(){e.replaceWithSelf(!0,{respawn:!1,levelIndex:t.index+1},{animation:"crossFade",duration:200,delayNewSceneShader:!0,removeOldSceneShader:!0})};t.bye?e.speak(400,300,t.bye,{scrollFactor:0,onExit:n}):e.timer(n,1e3)},2e3)}}},{key:"renderLights",value:function(e,t){var n=this,a=this.lightTexture,i=this.lightWidth,r=this.lightHeight,o=this.lightX,s=this.lightY,c=this.suns,l=this.dark,u=this.crispPercent,h=this.percent;if(a){var d=a.context;a.refresh(),d.clearRect(0,0,i,r),c.forEach(function(t){var a=t.bead,i=t.lamps,r=t.ambient,l=t.corona,d=t.backwards,p=n.sunPosition(d?1-h:h,d),_=Object(m.a)(p,2),f=_[0],g=_[1],v=new K(f-o,g-s);i.forEach(function(e){e.position=v}),a.x=f,a.y=g;var b=(.3+.5*n.crispPercent)/c.length;(n.winning||n.percent>1)&&((b-=(n.winning?100:n.percent-1)*Object(S.b)("level.fadeOutFactor"))<=0&&(b=0,n.wonLevel()));var O=y.a.Display.Color.Interpolate.ColorWithColor({r:150,g:255,b:150},{r:255,g:100,b:100},100,100*u),E=O.r,w=O.g,k=O.b,j=.7+.3*(.5+Math.sin(e/500)/2);n.winning&&(j=b),r.color="rgba(".concat(E,", ").concat(w,", ").concat(k,", ").concat(b,")"),l.color=d?"rgba(0, 0, 255, ".concat(j,")"):"rgba(255, 0, 0, ".concat(j,")")}),c.forEach(function(e){e.lightings.forEach(function(e){e.compute(i,r)})}),l.compute(i,r),d.fillStyle="black",d.fillRect(0,0,i,r),d.globalCompositeOperation="lighter",c.forEach(function(e){e.lightings.forEach(function(e){e.render(d)})}),d.globalCompositeOperation="source-over",l.render(d)}}},{key:"textSize",value:function(e){return"24px"}},{key:"textColor",value:function(e){return this.level.lastLevel?"#f6c456":"rgb(255, 0, 0)"}},{key:"strokeColor",value:function(e){return"rgb(0, 0, 0)"}},{key:"strokeWidth",value:function(e){return 6}},{key:"cameraColor",value:function(){return 0}},{key:"musicName",value:function(){return this.level&&this.level.music}},{key:"launchTimeSight",value:function(){var e=this.level.player;Object(O.a)(Object(u.a)(t.prototype),"launchTimeSight",this).call(this),e.visible=!1}},{key:"renderTimeSightFrameInto",value:function(e,t,n,a,i){var r=this.level.player,o=[];this.timeSightX||(this.timeSightX=this.timeSightY=0);var s=this.timeSightX,c=this.timeSightY;if(i||Math.sqrt((r.x-s)*(r.x-s)+(r.y-c)*(r.y-c))>=28){var l=e.physics.add.sprite(r.x,r.y,"player");l.alpha=.4,o.push(l),this.timeSightX=r.x,this.timeSightY=r.y}return 0===o.length?null:(o.forEach(function(e){e.anims.stop()}),o)}},{key:"debugHandlePointerdown",value:function(e){var t=e.x,n=e.y;t+=this.camera.scrollX,n+=this.camera.scrollY,this.level.player.x=t,this.level.player.y=n}},{key:"_hotReloadCurrentLevel",value:function(){Object(O.a)(Object(u.a)(t.prototype),"_hotReloadCurrentLevel",this).call(this,{},{animation:"crossFade",duration:200,delayNewSceneShader:!0,removeOldSceneShader:!0}).then(function(e){})}},{key:"cleanShadows",value:function(){X>1?(z=X,X=1):X=z,this.resampleSuns()}},{key:"_hot",value:function(){}}]),t}(E.a),G={transparent:!0,"render.transparent":!0},H=function(e){function t(e){Object(s.a)(this,t);var n=Object(f.a)({},G,e);return Object(l.a)(this,Object(u.a)(t).call(this,n,[V]))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"launch",value:function(){this.scene.add("scene-".concat(Date.now()),V,!0,{seed:Date.now(),sceneId:String(Math.random())})}}]),t}(L),J=n(594),Q=n.n(J),$=n(10),Z=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).didVisibilityChange=function(){var e="hidden"===document.visibilityState;n.setState({focused:!e}),n.game.setFocused(!e)},n.didBlur=function(){n.setState({focused:!1}),n.game.setFocused(!1)},n.didFocus=function(){n.setState({focused:!0}),n.game.setFocused(!0)},n.state={activating:!1,activated:!1,focused:!0,volume:Object($.b)("volume",.66),scale:null},n.controls=i.a.createRef(),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.loadedGame,a=t.debug,i=this.state.volume;window.addEventListener("visibilitychange",this.didVisibilityChange),window.addEventListener("blur",this.didBlur),document.addEventListener("blur",this.didBlur),window.addEventListener("focus",this.didFocus),document.addEventListener("focus",this.didFocus),document.querySelector("body").classList.add("natural"),this.game=new H({debug:a}),this.game.changeVolume(i),n&&n(this.game,function(t){return e.activateGame(t)})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("visibilitychange",this.didVisibilityChange),window.removeEventListener("blur",this.didBlur),document.removeEventListener("blur",this.didBlur),window.removeEventListener("focus",this.didFocus),document.removeEventListener("focus",this.didFocus)}},{key:"onMouseMove",value:function(){var e=this;this.moveTimeout?clearTimeout(this.moveTimeout):document.querySelector("body").classList.add("mouseMoved"),this.moveTimeout=setTimeout(function(){e.clearMove(!1)},3e3)}},{key:"setVolume",value:function(e){this.setState({volume:e}),this.game.changeVolume(e),Object($.d)("volume",e)}},{key:"activateGame",value:function(e){var t=this;this.state.activated?e&&e():(this.setState({activating:!0}),this.game.activateGame(function(){t.setState({activated:!0}),t.clearMove(!0),e&&e()}))}},{key:"clearMove",value:function(e){var t=this;this.moveTimeout&&(clearTimeout(this.moveTimeout),this.moveTimeout=null,e&&this.controls.current&&this.controls.current.style&&(this.controls.current.style.transition="none",setTimeout(function(){t.controls.current.style.transition=""})),document.querySelector("body").classList.remove("mouseMoved"))}},{key:"enterFullscreen",value:function(){var e=this,t=document.querySelector("body"),n=document.querySelector("#engine");t&&n&&(t.classList.add("scaled"),t.classList.remove("natural"),n.style.overflow="",this.resizeHandler=function(){var t=e.game.config,n=t.width,a=t.height,i=.95*Math.min(window.innerWidth/n,window.innerHeight/a);e.setState({scale:i})},this.resizeHandler(),window.addEventListener("resize",this.resizeHandler),this.fullscreenHandler||(this.fullscreenHandler=function(){document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||e.exitFullscreen(!0)},document.addEventListener("webkitfullscreenchange",this.fullscreenHandler,!1),document.addEventListener("mozfullscreenchange",this.fullscreenHandler,!1),document.addEventListener("fullscreenchange",this.fullscreenHandler,!1),document.addEventListener("MSFullscreenChange",this.fullscreenHandler,!1)),t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen?t.webkitRequestFullScreen():t.msRequestFullscreen&&t.msRequestFullscreen())}},{key:"exitFullscreen",value:function(e){var t=document.querySelector("body"),n=document.querySelector("#engine");t&&n&&(t.classList.add("natural"),t.classList.remove("scaled"),n.style.overflow="hidden",this.setState({scale:null}),this.moveTimeout&&(clearTimeout(this.moveTimeout),this.moveTimeout=null),window.removeEventListener("resize",this.resizeHandler),window.removeEventListener("mousemove",this.moveHandler)),e||(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())}},{key:"render",value:function(){var e=this,t=this.state,n=t.activating,a=t.scale,r=t.volume,o=t.focused,s=this.props.disableFullscreen,c=[];return c.push(n?"activated":"activate"),c.push(o?"focused":"blurred"),i.a.createElement("div",{className:c.join(" "),id:"engine-container"},i.a.createElement("div",{id:"engine",onMouseMove:function(){return e.onMouseMove()},onClick:function(){return e.activateGame()},style:a?{transform:"scale(".concat(a,")")}:{},ref:function(t){e.gameContainerRef||(e.gameContainerRef=t)}},i.a.createElement("div",{style:{backgroundImage:"url(".concat(Q.a,")")},id:"cover"}),i.a.createElement(p,null)),i.a.createElement(_,{ref:this.controls,onMouseMove:function(){return e.onMouseMove()},volume:r,onVolumeChange:function(t){return e.setVolume(t)},disableFullscreen:s,isFullscreen:a,enterFullscreen:function(){return e.enterFullscreen()},exitFullscreen:function(){return e.exitFullscreen()}}))}}]),t}(i.a.Component),ee=(n(1510),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={search:Object($.b)("search","")},n.ref=i.a.createRef(),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.state.search,t=Object(k.a)();this.ref.current.append(t.domElement),""!==e&&Object(k.g)(e,!0)}},{key:"copyChangedProps",value:function(){var e=document.createElement("textarea");e.value=Object(k.e)(),document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}},{key:"render",value:function(){var e=this,t=this.state.search;return i.a.createElement("div",{className:"Manage"},i.a.createElement("input",{type:"search",className:"search",placeholder:"Filter props\u2026",value:t,onChange:function(t){var n=""===e.state.search;e.setState({search:t.target.value}),Object(k.g)(t.target.value,n),Object($.d)("search",t.target.value)}}),i.a.createElement("input",{type:"button",className:"copy",value:"Copy changes",onClick:function(){return e.copyChangedProps()}}),i.a.createElement("input",{type:"button",className:"reset",value:"Reset to saved",onClick:function(){return Object(k.d)()}}),i.a.createElement("div",{className:""===t?"":"searching",ref:this.ref}))}}]),t}(i.a.Component)),te=n(50),ne=(n(1511),n(1512),function(e){return Math.floor(2*e)/2}),ae=function(e){return Math.ceil(2*e)/2},ie=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).didResize=function(){n.forceUpdate()},n.state={dragging:null,lastDrag:null},n.trackRef=i.a.createRef(),n.cursorRef=i.a.createRef(),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.setState({refreshDimensions:!0}),window.addEventListener("resize",this.didResize),window.game.updateReplayCursor=function(t,n){e.updateCursor(t,n)}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.didResize),delete window.game.updateReplayCursor}},{key:"updateCursor",value:function(e,t){var n=this.props.replayTimestamp;if(this.cursorRef.current&&this.trackRef.current)if(e&&t&&t.timestamp===n){var a=this.props,i=a.min,r=a.max,o=this.trackRef.current.getBoundingClientRect().width,s=Math.max(0,Math.min(1,(e-i)/(r-i)));this.cursorRef.current.style.left="".concat(ne(s*o),"px"),this.cursorRef.current.style.display="block"}else this.cursorRef.current.style.display="none"}},{key:"render",value:function(){var e=this,t=this.props,n=t.min,a=t.max,r=t.value1,o=t.value2,s=t.onChange1,c=t.onChange2,l=t.onMouseUp,u=t.onMouseEnter,h=t.onMouseMove,d=t.onMouseLeave,m=t.onBeginChange,p=t.onEndChange,_=t.notches,f=t.highlight1,g=t.highlight2,v=t.cursor,b=this.state,y=b.dragging,O=b.lastDrag,E=this.trackRef.current&&this.trackRef.current.getBoundingClientRect(),w=E?E.left:0,S=E?E.width:100,k=Math.max(0,Math.min(1,(r-n)/(a-n))),j=Math.max(0,Math.min(1,(o-n)/(a-n))),C=Math.max(0,Math.min(1,(f-n)/(a-n))),T=Math.max(0,Math.min(1,(g-n)/(a-n))),P=Math.max(0,Math.min(1,(v-n)/(a-n)));return i.a.createElement("div",{className:"DoubleEnder",onMouseUp:l,onMouseEnter:u,onMouseMove:h,onMouseLeave:d},i.a.createElement("div",{className:"track",ref:this.trackRef}),i.a.createElement("div",{style:{left:"".concat(ne(k*S),"px"),right:"".concat(ae(S-j*S),"px")},className:"track selected"}),i.a.createElement("div",{style:{left:"".concat(ne(C*S),"px"),right:"".concat(ae(S-T*S),"px")},className:"track highlighted"}),i.a.createElement("div",{style:{left:"".concat(ne(P*S),"px"),display:null===v?"none":"block"},className:"cursor highlighted",ref:this.cursorRef}),_.map(function(e){var t=e.value,s=e.title,c=t>=r&&t<=o||t>=o&&t<=r,l=t>=f&&t<=g||t>=g&&t<=f,u=Math.max(0,Math.min(1,(t-n)/(a-n))),h=["notch"];return l?h.push("highlighted"):c&&h.push("selected"),i.a.createElement("div",{key:t,title:s,className:h.join(" "),style:{left:"".concat(ne(u*S),"px")}}," ")}),[1,2].map(function(t){var l=t,u=1===l?r:o,h=1===l?2:1,d=1===h?r:o,_=Math.max(0,Math.min(1,(u-n)/(a-n)));return i.a.createElement("div",{key:l,style:{left:"".concat(ne(_*(S-16)),"px"),zIndex:l===O?5:4},className:"slider slider".concat(l," ").concat(y===l?"dragging":""),onMouseDown:function(t){var i=t.clientX-t.target.getBoundingClientRect().left;m&&m();var r=1===l?s:c;e._dragListener=function(t){var o=t.clientX,u=n+(o-w-i)/(S-16)*(a-n),m=Math.min(a,Math.max(n,u));1===l&&m>d||2===l&&m<d?(r&&r(d),h=1===(l=h)?2:1,r=1===l?s:c,e.setState({dragging:l,lastDrag:l})):r&&r(m)},e._upListener=function(t){e._dragListener(t),window.removeEventListener("mousemove",e._dragListener),delete e._dragListener,window.removeEventListener("mouseup",e._upListener),delete e._upListener,e.setState({dragging:null}),p&&p()},window.addEventListener("mousemove",e._dragListener),window.addEventListener("mouseup",e._upListener),e.setState({dragging:l,lastDrag:l})}})}))}}]),t}(i.a.Component),re=["metadata","commands","sceneSaveState","sceneTransitions"],oe=function(e){function t(e){var n;Object(s.a)(this,t),n=Object(l.a)(this,Object(u.a)(t).call(this,e));var a=Object($.b)("replays",[]);return a.forEach(function(e){e.preflight&&(e.commands=[].concat(Object(g.a)(e.preflight),Object(g.a)(e.commands||[])),e.preflightCutoff=e.preflight.reduce(function(e,t){return e+(t._repeat||1)},0),delete e.preflight),"tickCount"in e||(e.tickCount=e.commands.reduce(function(e,t){return e+(t._repeat||1)},0)),"originalPreflightCutoff"in e||(e.originalPreflightCutoff=e.preflightCutoff),"postflightCutoff"in e||(e.postflightCutoff=e.tickCount)}),n.state={replays:a,activeRecording:null,activeReplay:Object($.b)("activeReplay",null),tweaking:Object($.b)("tweaking",null),editing:Object($.b)("editing",null),repeat:Object($.b)("repeat",!0)},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.beginAutoReplay(),this.installGameCallbacks()}},{key:"componentDidUpdate",value:function(e){this.props.activateGame!==e.activateGame&&(this.installGameCallbacks(),this.beginAutoReplay())}},{key:"setEditing",value:function(e){this.setState({editing:e}),Object($.d)("editing",e)}},{key:"setActiveReplay",value:function(e){this.setState({activeReplay:e}),Object($.d)("activeReplay",e)}},{key:"beginReplay",value:function(e,t){var n=this,a=this.props.activateGame,i=this.state.editing;a(function(){var a,r=n.state.activeReplay;r&&(r.timestamp===e.timestamp&&!r.timeSight&&e.timeSight&&(a=window.game.topScene()._replayLatestTransition),window.game.stopReplay()),t&&i!==e.timestamp&&n.setEditing(null),window.game.beginReplay(e,{startFromTransition:a})})}},{key:"stopReplay",value:function(){(0,this.props.activateGame)(function(){window.game.stopReplay()})}},{key:"beginRecording",value:function(e){var t=this.props.activateGame;this.setEditing(null),t(function(){window.game.beginRecording(e)})}},{key:"stopRecording",value:function(){(0,this.props.activateGame)(function(){window.game.stopRecording()})}},{key:"trashRecording",value:function(){this._trashNextRecording=!0,this.stopRecording()}},{key:"toggleTimeSight",value:function(){var e=this.state.activeReplay;this.beginReplay(Object(f.a)({},e,{timeSight:!e.timeSight}),!0)}},{key:"toggleRepeat",value:function(){this.setState(function(e){var t=e.repeat;return setTimeout(function(){Object($.d)("repeat",!t)}),{repeat:!t}})}},{key:"saveReplays",value:function(){var e=this;setTimeout(function(){var t=e.state,n=t.replays,a=t.activeReplay,i=t.editing;Object($.d)("replays",n),Object($.d)("editing",i),Object($.d)("activeReplay",a)})}},{key:"finishEdit",value:function(e,t){this.setEditing(null),this.saveReplays()}},{key:"beginAutoReplay",value:function(){var e=this.props.activateGame,t=this.state.activeReplay;e&&t&&this.beginReplay(t)}},{key:"installGameCallbacks",value:function(){var e=this,t=window.game;t&&!t.onRecordBegin&&(t.onRecordBegin=function(t){e.setState({activeRecording:t})},t.onRecordStop=function(t){e.setState({activeRecording:null}),e._trashNextRecording?delete e._trashNextRecording:e.setState(function(n){var a=n.replays,i=[t].concat(Object(g.a)(a));return setTimeout(function(){Object($.d)("replays",i),t.snapshot||e.beginReplay(t)}),{replays:i}})},t.onReplayBegin=function(t){t.snapshot||e.setActiveReplay(t)},t.onReplayEnd=function(t){e.state.repeat&&!t.snapshot?setTimeout(function(){e.beginReplay(e.state.activeReplay)}):e.setActiveReplay(null)},t.onReplayStop=function(t){e.setActiveReplay(null)})}},{key:"updateReplay",value:function(e,t,n){var a=this,i=e.timestamp;this.setState(function(e){var r,o=e.activeReplay,s={replays:e.replays.map(function(e){return e.timestamp===i?r=Object(f.a)({},e,t):e})};return o&&o.timestamp===i&&(s.activeReplay=Object(f.a)({},o,t)),r&&n&&setTimeout(function(){a.beginReplay(Object(f.a)({},r,{timeSight:o&&o.timeSight}))}),s})}},{key:"editName",value:function(e,t,n){this.updateReplay(e,{name:t},n)}},{key:"editPreflightCutoff",value:function(e,t,n){var a=t>.99*e.postflightCutoff;this.updateReplay(e,{preflightCutoff:t,snapshot:a},n)}},{key:"editPostflightCutoff",value:function(e,t,n){var a=e.preflightCutoff>.99*t;this.updateReplay(e,{postflightCutoff:t,snapshot:a},n)}},{key:"editCutoffs",value:function(e,t,n,a){var i=t>.99*n;this.updateReplay(e,{preflightCutoff:t,postflightCutoff:n,snapshot:i},a)}},{key:"deleteReplay",value:function(e){var t=this,n=e.timestamp;this.setState(function(e){var a=e.activeReplay,i=e.replays.filter(function(e){return e.timestamp!==n});return setTimeout(function(){Object($.d)("replays",i)}),a&&a.timestamp===n&&setTimeout(function(){return t.stopReplay()}),{replays:i}})}},{key:"copyReplay",value:function(e){var t=Object(f.a)({},e,{timestamp:Date.now(),name:"Copy of ".concat(e.name)});this.setState(function(e){var n=e.replays,a=[t].concat(Object(g.a)(n));return setTimeout(function(){Object($.d)("replays",a)}),{replays:a}})}},{key:"cutoffTimeSightEnter",value:function(){window.game.cutoffTimeSightEnter()}},{key:"cutoffTimeSightChanged",value:function(e,t){window.game.cutoffTimeSightChanged(e,t)}},{key:"cutoffTimeSightLeave",value:function(){window.game.cutoffTimeSightLeave()}},{key:"tweakReplay",value:function(e){var t=Object(f.a)({},e),n={replay:e};re.forEach(function(e){"metadata"!==e&&(n[e]=JSON.stringify(t[e],null,2),delete t[e])}),n.metadata=JSON.stringify(t,null,2),re.forEach(function(e){n["".concat(e,"_original")]=n[e]}),this.setState({tweaking:n}),Object($.d)("tweaking",n)}},{key:"updateTweak",value:function(e,t){this.setState(function(n){var a,i=n.tweaking,r=Object(f.a)({},i,(a={},Object(te.a)(a,e,t),Object(te.a)(a,"".concat(e,"_error"),null),Object(te.a)(a,"".concat(e,"_changed"),t!==i["".concat(e,"_original")]),a));return setTimeout(function(){return Object($.d)("tweaking",r)}),{tweaking:r}})}},{key:"revertTweak",value:function(e){this.updateTweak(e,this.state.tweaking["".concat(e,"_original")])}},{key:"discardTweaks",value:function(){setTimeout(function(){Object($.d)("tweaking",null)}),this.setState({tweaking:null})}},{key:"saveTweaks",value:function(){var e=this;this.setState(function(t){var n,a=t.tweaking,i=!1,r=Object(f.a)({},a);return re.forEach(function(e){try{var t=JSON.parse(a[e]);"metadata"===e?n=t:n&&(n[e]=t),r["".concat(e,"_error")]=null}catch(o){console.error(o),i=!0,r["".concat(e,"_error")]=o.toString()}}),i?(setTimeout(function(){Object($.d)("tweaking",r)}),{tweaking:r}):(setTimeout(function(){e.updateReplay(a.replay,n,!1),setTimeout(function(){Object($.d)("tweaking",null)})}),{tweaking:null})})}},{key:"renderEditReplay",value:function(e){var t=this,n=this.state.activeReplay,a=null,r=null,o=window.game,s=o&&o.topScene(),c=s&&s.command?s.command.replayTicks:null;if(n&&n.timestamp!==e.timestamp&&(c=null),n&&n.timestamp===e.timestamp&&n.timeSight){c=null;var l=e.sceneTransitions;if(l&&0!==l.length){var u=s&&s._replayLatestTransition;if(s)if(u){var h=u&&u.tickCount||0,d=e.postflightCutoff;a=Math.max(h,e.preflightCutoff);for(var m=0;m<l.length;m+=1)if(l[m].tickCount>=h){m+1<l.length&&(d=l[m+1].tickCount);break}r=Math.min(d,e.postflightCutoff)}else a=e.preflightCutoff,r=Math.min(e.postflightCutoff,l[0].tickCount);else{a=e.preflightCutoff;for(var p=0;p<l.length;p+=1)if(l[p].tickCount>a){r=Math.min(e.postflightCutoff,l[p].tickCount);break}}}else a=e.preflightCutoff,r=e.postflightCutoff;a>r&&(a=r=null)}return i.a.createElement("form",{onSubmit:function(n){n.preventDefault(),t.finishEdit(e)}},i.a.createElement("input",{type:"text",autoFocus:!0,value:e.name,onChange:function(n){return t.editName(e,n.target.value)}}),i.a.createElement("span",{className:"play button",title:"Load snapshot (load state)",onClick:function(){return t.beginReplay(Object(f.a)({},e,{snapshot:!0,commands:[]}))}},"\ud83c\udf86"),i.a.createElement("span",{className:"tweak button",title:"Tweak replay",onClick:function(){return t.tweakReplay(e)}},"\u2139"),i.a.createElement("span",{className:"copy button",title:"Copy replay",onClick:function(){return t.copyReplay(e)}},"\ud83d\udd03"),i.a.createElement("span",{className:"delete button",title:"Delete replay",onClick:function(){return t.deleteReplay(e)}},"\ud83d\udeae"),i.a.createElement("span",{className:"detail"},e.preflightCutoff,"-",e.postflightCutoff,e.postflightCutoff!==e.tickCount&&" / ".concat(e.tickCount)),i.a.createElement("br",null),i.a.createElement(ie,{min:0,max:e.tickCount,value1:e.preflightCutoff,value2:e.postflightCutoff,highlight1:a,highlight2:r,cursor:c,notches:(e.sceneTransitions||[]).map(function(e){return{value:e.tickCount,title:"Scene transition"}}),replayTimestamp:e.timestamp,onMouseEnter:function(a){t._inCutoffs=!0,n&&n.timeSight&&n.timestamp===e.timestamp&&t.cutoffTimeSightEnter()},onMouseLeave:function(a){t._inCutoffs=!1,n&&n.timeSight&&n.timestamp===e.timestamp&&(t._changingCutoffs||t.cutoffTimeSightLeave(),t.saveReplays())},onBeginChange:function(e){t._changingCutoffs=!0},onEndChange:function(a){t._changingCutoffs=!1,n&&n.timeSight&&n.timestamp===e.timestamp?(t._inCutoffs||t.cutoffTimeSightLeave(),t.saveReplays()):setTimeout(function(){var n=t.state.replays.find(function(t){return t.timestamp===e.timestamp});t.beginReplay(n),t.saveReplays()})},onChange1:function(a){t.editPreflightCutoff(e,Math.floor(a)),n&&n.timeSight&&n.timestamp===e.timestamp&&setTimeout(function(){t.cutoffTimeSightChanged(Math.floor(a),t.state.activeReplay.postflightCutoff)})},onChange2:function(a){t.editPostflightCutoff(e,Math.floor(a)),n&&n.timeSight&&n.timestamp===e.timestamp&&setTimeout(function(){t.cutoffTimeSightChanged(t.state.activeReplay.preflightCutoff,Math.floor(a))})}}),(e.preflightCutoff!==e.originalPreflightCutoff||e.postflightCutoff!==e.tickCount)&&i.a.createElement("input",{type:"button",onClick:function(n){n.preventDefault(),t.editCutoffs(e,e.originalPreflightCutoff,e.tickCount,!0)},value:"\u293a"}))}},{key:"renderTweaking",value:function(){var e=this,t=this.state.tweaking;return i.a.createElement("div",{className:"Replay tweaking"},i.a.createElement("div",{className:"controls tweaking"},i.a.createElement("span",{className:"button",title:"Cancel tweaks",onClick:function(){return e.discardTweaks()}},"\ud83d\udeae"),i.a.createElement("span",{className:"button",title:"Save tweaks",onClick:function(){return e.saveTweaks()}},"\ud83c\udd99")),i.a.createElement("div",{className:"fields"},re.map(function(n){return i.a.createElement("div",{key:n,className:"field ".concat(t["".concat(n,"_error")]?"error":""," ").concat(t["".concat(n,"_changed")]?"changed":"")},i.a.createElement("label",null,n," ",i.a.createElement("span",{style:{visibility:t["".concat(n,"_changed")]?"visible":"hidden"},className:"button",title:"Discard these tweaks",onClick:function(){return e.revertTweak(n)}},"\ud83d\udeae")),t["".concat(n,"_error")]&&i.a.createElement("span",{className:"info"},t["".concat(n,"_error")]),i.a.createElement("textarea",{value:t[n],onChange:function(t){return e.updateTweak(n,t.target.value)}}))})))}},{key:"render",value:function(){var e=this,t=this.state,n=t.replays,a=t.activeRecording,r=t.activeReplay,o=t.editing,s=t.repeat;return t.tweaking?this.renderTweaking():i.a.createElement("div",{className:"Replay"},i.a.createElement("div",{className:"controls ".concat(r?"active-replay":""," ").concat(r&&r.timeSight?"timeSight":"")},r&&i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{className:"button repeat ".concat(s?"repeat-on":"repeat-off"),title:s?"Disable automatic repeat":"Enable automatic repeat",onClick:function(){return e.toggleRepeat()}},"\ud83d\udd01"),i.a.createElement("span",{className:"button",title:"Stop replay",onClick:function(){return e.stopReplay()}},"\u23f9"),r.timeSight&&i.a.createElement("span",{className:"button",title:"Disable timeSight",onClick:function(){return e.toggleTimeSight()}},"\ud83d\udcfa"),!r.timeSight&&i.a.createElement("span",{className:"button",title:"Enable timeSight",onClick:function(){return e.toggleTimeSight()}},"\u269b")),!r&&(a?i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{className:"recording button",title:"Stop recording",onClick:function(){return e.stopRecording()}},"\u23fa\ufe0f"),i.a.createElement("span",{className:"button",title:"Discard recording",onClick:function(){return e.trashRecording()}},"\ud83d\udeae")):i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{className:"record button",title:"Start recording replay",onClick:function(){return e.beginRecording()}},"\ud83c\udfa6"),i.a.createElement("span",{className:"snapshot button",title:"Take snapshot (save state)",onClick:function(){return e.beginRecording({snapshot:!0})}},"\ud83c\udf86")))),i.a.createElement("ul",{className:"replays"},n.map(function(t){return i.a.createElement("li",{className:"\n                replay\n                ".concat(r&&r.timestamp===t.timestamp?"active":"","\n                ").concat(o===t.timestamp?"editing":"","\n              "),key:t.timestamp},i.a.createElement("span",{className:"drag"},"\u22ee\u22ee"),r&&r.timeSight&&r.timestamp===t.timestamp&&i.a.createElement("span",{className:"play button",title:"Restart timeSight",onClick:function(){return e.beginReplay(Object(f.a)({},t,{timeSight:!0}),!0)}},"\u269b"),r&&!r.timeSight&&r.timestamp===t.timestamp&&i.a.createElement("span",{className:"play button",title:"Restart replay",onClick:function(){return e.beginReplay(t,!0)}},"\ud83d\udcfa"),(!r||r.timestamp!==t.timestamp)&&!t.snapshot&&i.a.createElement("span",{className:"play button",title:"Start replay",onClick:function(){return e.beginReplay(t,!0)}},"\u25b6\ufe0f"),(!r||r.timestamp!==t.timestamp)&&t.snapshot&&i.a.createElement("span",{className:"play button",title:"Load snapshot (load state)",onClick:function(){return e.beginReplay(t,!0)}},"\ud83c\udf86"),o===t.timestamp&&e.renderEditReplay(t),i.a.createElement("span",{className:"name",onClick:function(){return e.beginReplay(t,!0)}},t.name),i.a.createElement("span",{className:"edit button",title:"Edit replay",onClick:function(){return e.setEditing(t.timestamp)}},"\u2139"))})))}}]),t}(i.a.Component),se=(n(1513),function(e){function t(e){var n;Object(s.a)(this,t),n=Object(l.a)(this,Object(u.a)(t).call(this,e));var a=Object($.b)("log",[]).map(function(e){return Object(f.a)({},e,{recent:!1,old:!0})});return n.state={log:a},n.logId=1+Number(a.map(function(e){return e.id}).reduce(function(e,t){return e>t?e:t},0)),n.timers=[],n.ref=i.a.createRef(),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.original={};var t=this;["trace","debug","log","info","warn","error"].forEach(function(n){var a=e.original[n]=console[n];console[n]=function(){for(var e=arguments.length,i=new Array(e),r=0;r<e;r++)i[r]=arguments[r];var o=t.extractContext.apply(t,i);return t.prependLog(i.join(" "),n,o),a.apply(void 0,i)}})}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.game;!e.game&&n&&n.onDisableDebugUI(function(){t.removeLogging()})}},{key:"componentWillUnmount",value:function(){this.removeLogging()}},{key:"removeLogging",value:function(){this.timers.forEach(function(e){clearTimeout(e)}),Object.entries(this.original).forEach(function(e){var t=Object(m.a)(e,2),n=t[0],a=t[1];console[n]=a})}},{key:"extractContext",value:function(e){if(e instanceof Error){var t=e.stack.match(/ at (\w+) \(http/);if(t)return t[1]}return null}},{key:"prependLog",value:function(e,t,n){var a=this,i=e.replace(/^Error: /,"");if(!i.match(/https:\/\/phaser\.io/)){var r=this.logId+=1,o=setTimeout(function(){a.setState(function(e){return{log:e.log.map(function(e){return e.id===r?Object(f.a)({},e,{recent:!0}):e})}})},500);this.timers.push(o);var s=setTimeout(function(){a.setState(function(e){return{log:e.log.map(function(e){return e.id===r?Object(f.a)({},e,{recent:!1,old:!0}):e})}})},5e3);this.timers.push(s),this.ref.current.scrollTop=0,this.setState(function(e){var a=e.log,o=[{msg:i,level:t,id:r,context:n}].concat(Object(g.a)(a.filter(function(e,t){return t<19})));return setTimeout(function(){Object($.d)("log",o)}),{log:o}})}}},{key:"render",value:function(){var e=this.state.log;return i.a.createElement("div",{className:"Logging",ref:this.ref},i.a.createElement("ol",null,e.map(function(e){var t=e.msg,n=e.level,a=e.id,r=e.recent,o=e.old,s=e.context;return i.a.createElement("li",{key:a,className:"".concat(n," ").concat(r?"recent":""," ").concat(o?"old":"")},i.a.createElement("span",{className:"level"},n),i.a.createElement("span",{className:"msg"},t),s&&i.a.createElement("span",{className:"context"},s))})))}}]),t}(i.a.Component)),ce=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).loadedGame=function(e,t){window.game=e,n.setState({game:e,activateGame:t})},n.state={game:null,activateGame:null},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.state,t=e.game,n=e.activateGame;return i.a.createElement("div",{className:"development"},i.a.createElement(Z,{debug:!0,loadedGame:this.loadedGame}),i.a.createElement(se,{game:t}),i.a.createElement("div",{className:"sidebar"},i.a.createElement("ul",{className:"links"},C.a.links.map(function(e){var t=Object(m.a)(e,2),n=t[0],a=t[1];return i.a.createElement("li",{key:n},i.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:n},a))})),i.a.createElement(ee,null),i.a.createElement(oe,{activateGame:n})))}}]),t}(i.a.Component),le=(n(560),n(595)),ue=n.n(le),he=n(596),de=n.n(he),me=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"production"},i.a.createElement(Z,null),i.a.createElement("div",{className:"game-metadata"},i.a.createElement("h1",null,C.c.displayName),C.c.authorName&&i.a.createElement("h3",null,"by",i.a.createElement("br",null),C.c.authorURL?i.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:C.c.authorURL},C.c.authorName):C.c.authorName,i.a.createElement("br",null),C.c.authorTwitter&&i.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://twitter.com/".concat(C.c.authorTwitter)},i.a.createElement("img",{src:de.a,alt:"@".concat(C.c.authorTwitter," on Twitter")})),C.c.authorTwitch&&i.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:"https://twitch.tv/".concat(C.c.authorTwitch)},i.a.createElement("img",{src:ue.a,alt:"".concat(C.c.authorTwitch," on Twitch")}))),i.a.createElement("p",null,C.c.eventDescription&&i.a.createElement(i.a.Fragment,null,C.c.eventDescription,i.a.createElement("br",null)),C.c.eventNamePre," ",i.a.createElement("strong",null,C.c.eventNameBold)," ",C.c.eventNamePost),C.c.eventURL&&i.a.createElement("p",null,i.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:C.c.eventURL},C.c.eventURL)),i.a.createElement("p",null,C.c.themeDescription&&i.a.createElement(i.a.Fragment,null,C.c.themeDescription,i.a.createElement("br",null)),C.c.themePre," ",i.a.createElement("em",null,C.c.themeItalic)," ",C.c.themePost),C.c.repoURL&&i.a.createElement("p",null,"code at",i.a.createElement("br",null),i.a.createElement("a",{className:"url",target:"_blank",rel:"noopener noreferrer",href:C.c.repoURL},C.c.repoURL))))}}]),t}(i.a.Component),pe=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"production embed"},i.a.createElement(Z,{disableFullscreen:!0}))}}]),t}(i.a.Component),_e=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.debug;return C.c.embed?i.a.createElement(pe,null):e?i.a.createElement(ce,null):i.a.createElement(me,null)}}]),t}(i.a.Component),fe=Object(d.hot)(_e);o.a.render(i.a.createElement(fe,{debug:!1}),document.getElementById("root"))},183:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return SuperScene});var _home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(87),_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7),_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(3),_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(6),_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(17),_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(16),_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(19),_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(8),_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(20),phaser__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(11),phaser__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(phaser__WEBPACK_IMPORTED_MODULE_9__),deep_equal__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(281),deep_equal__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(deep_equal__WEBPACK_IMPORTED_MODULE_10__),_props__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(2),_lib_manage_gui__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(42),_lib_particles__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(101),_lib_transitions__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(59),_lib_sprites__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(563),_lib_anims__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(564),_lib_camera__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(565),_lib_tweens__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(100),_lib_shaders__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(88),_lib_store__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(10),_lib_level_parser__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(186),_assets_maps_txt__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(566),_assets_maps_txt__WEBPACK_IMPORTED_MODULE_22___default=__webpack_require__.n(_assets_maps_txt__WEBPACK_IMPORTED_MODULE_22__),_assets_index__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(567),_lib_assets__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(593),baseConfig={},SuperScene=function(_Phaser$Scene){function SuperScene(e){var t;Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_4__.a)(this,SuperScene);var n=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},baseConfig,e);return(t=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__.a)(this,Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__.a)(SuperScene).call(this,n))).rnd={},t.timeScale=1,t.sounds=[],t.timers=[],t.performanceFrames=0,t.performanceAcceptable=!0,t.scene_time=0,t.shockwave_time=0,t._trauma=0,t._traumaShake=0,t._paused={physics:!1,particles:!1,timers:!1,tweens:!1,anims:!1},t._renderDelta=0,t}return Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_8__.a)(SuperScene,_Phaser$Scene),Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_5__.a)(SuperScene,[{key:"init",value:function(e){var t=this,n=this.game.config,a=n.tileWidth,i=n.tileHeight,r=n.width,o=n.height;if(this.tileWidth=a,this.tileHeight=i,this.halfWidth=a/2,this.halfHeight=a/2,!e.seed)throw new Error('You must provide a "seed" (e.g. Date.now()) to '.concat(this.constructor.name));if(!e.sceneId)throw new Error('You must provide a "sceneId" (e.g. Date.now()) to '.concat(this.constructor.name));this.sceneId=e.sceneId,this.command=this.game.command,this.command.attachScene(this,e._timeSightTarget),this.camera=this.cameras.main;var s=this.cameraColor();if(null!==s&&this.camera.setBackgroundColor(s),Object(_lib_camera__WEBPACK_IMPORTED_MODULE_17__.a)(this.camera),e.save?this.save=e.save:!this.save&&this.saveStateFieldName()&&(this.save=Object(_lib_store__WEBPACK_IMPORTED_MODULE_20__.b)(this.saveStateFieldName(),function(){var e=t.initialSaveState();return e.version=t.saveStateVersion(),e})),this.save&&(this.save=this.migrateSaveState(this.save)),this.save||(this.save={}),this._initialSave=JSON.parse(JSON.stringify(this.save)),this.physics&&this.physics.world&&(Object(_lib_sprites__WEBPACK_IMPORTED_MODULE_15__.a)(this),Object(_lib_tweens__WEBPACK_IMPORTED_MODULE_18__.c)(this.tweens),Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("scene.debugDraw")&&this.physics.world.createDebugGraphic(),this.fixedUpdate)){var c=this.scene.systems.tweens;c.systems.events.off("update",c.update,c);var l=this.physics,u=l.world,h=u.step,d=0;l.time=l.dt=0,u.step=function(e){for(var n=e/u.timeScale;!t._didRenderDelta||t._renderDelta>0;){var a=1e3*n;if(d+=a,l.dt=a,l.time=d,t.scene_time=d,t._didRenderDelta?t._renderDelta-=1e3*e:(t._renderDelta=0,t._didRenderDelta=!0),t.game._stepExceptions>100)return;try{var i=t.isTopScene();if(t.timeSightFrozen)return i&&t.command.processInput(t,d,a,!0),t.updateTweens(d,a),void t.timeSightMouseDrag();t._paused.physics||h.call(u,n),i&&t.command.processInput(t,d,a),t.game.updateReplayCursor&&t.game.updateReplayCursor(t.command.replayTicks,t._replay),t._paused.physics||t.fixedUpdate(d,a),t.updateTimers(d,a),t.performanceProps&&t.performanceProps.length&&t.recoverPerformance(),t.updateTweens(d,a),t.game._stepExceptions=0}catch(r){console.error(r),t.game._stepExceptions=(t.game._stepExceptions||0)+1,t.game._stepExceptions>100&&console.error("Too many errors; pausing update cycle until hot reload")}}}}if(this.sound.pauseOnBlur=!1,this.particleSystems=[],this.sys.events.on("destroy",this.destroy,this),["_recording","_replay","_replayOptions"].forEach(function(n){t[n]=e[n],delete e[n]}),this._recording&&this._recording.sceneTransitions.push({tickCount:this._recording.tickCount,timestamp:Date.now(),seed:e.seed,sceneName:this.constructor.name,initData:this.scene.settings.data,sceneSaveState:JSON.parse(JSON.stringify(this._initialSave)),parentSceneId:e.parentSceneId,sceneId:this.sceneId,commandState:this.command.freezeCommandState()}),this._replay)for(var m=this._replay.sceneTransitions,p=this.command.replayTicks,_=0;_<m.length&&m[_].tickCount<=p;_+=1)this._replayLatestTransition=m[_];var f=Math.floor(r/(a+2)),g=Math.floor(o/(i+3));this.xBorder=(r-f*a)/2,this.yBorder=(o-g*i)/2,this.game.sceneDidInit(this)}},{key:"saveStateFieldName",value:function(){return"game_".concat(this.constructor.name)}},{key:"saveStateVersion",value:function(){return 0}},{key:"migrateSaveState",value:function(e){var t=this.saveStateVersion();if(e.version===t)return e;var n=JSON.parse(JSON.stringify(e));for(n.version||(n.version=0);n.version<t;){var a="migrateSaveStateVersion".concat(n.version);if(console.debug(a),!this[a])throw new Error("Missing migration method ".concat(a));this[a](n),n.version+=1}return n}},{key:"initialSaveState",value:function(){return{}}},{key:"saveState",value:function(){Object(_lib_store__WEBPACK_IMPORTED_MODULE_20__.d)(this.saveStateFieldName(),this.save)}},{key:"isTopScene",value:function(){return this.game.topScene()===this}},{key:"vendRNG",value:function(e){if(!e)throw new Error("You must provide a name for each RNG sequence");if(!this.rnd[e]){var t=this.scene.settings.data.seed;this.rnd[e]=new phaser__WEBPACK_IMPORTED_MODULE_9___default.a.Math.RandomDataGenerator([t,e])}return this.rnd[e]}},{key:"randFloat",value:function(e){return this.vendRNG(e).frac()}},{key:"randBetween",value:function(e,t,n){return this.randFloat(e)*(n-t)+t}},{key:"randElement",value:function(e,t){return t[Math.floor(this.randBetween(e,0,t.length))]}},{key:"create",value:function(){this.command.attachInputs(this),this.startedAt=new Date,this.setupAnimations&&this.setupAnimations();var e=this.scene.settings.data.transition;e&&e.delayNewSceneShader||this._setupShader()}},{key:"setShader",value:function(e){this.shaderName=e,this._setupShader()}},{key:"_setupShader",value:function(){"shaderName"in this||(this.shaderName="main"),this.shaderName&&(this.game.initializeShader(this.shaderName),this.shader=this.game.shaderInstance(this.shaderName),this.shader&&(this._shaderInitialize(!0),this._shaderUpdate(),this.camera.setRenderToTexture(this.shader)))}},{key:"preload",value:function(){this.load.text("_mapsFile",_assets_maps_txt__WEBPACK_IMPORTED_MODULE_22___default.a),Object(_lib_assets__WEBPACK_IMPORTED_MODULE_24__.a)(this,_assets_index__WEBPACK_IMPORTED_MODULE_23__)}},{key:"levelIds",value:function(){return this.game._ldMapFiles||(this.game._ldMapFiles=Object(_lib_level_parser__WEBPACK_IMPORTED_MODULE_21__.b)(this.cache.text.get("_mapsFile"))),this.game._ldMapFiles.map(function(e){return Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(e,2)[1].id})}},{key:"loadLevel",value:function(e){this.game._ldMapFiles||(this.game._ldMapFiles=Object(_lib_level_parser__WEBPACK_IMPORTED_MODULE_21__.b)(this.cache.text.get("_mapsFile")));var t,n=this.game._ldMapFiles,a=n[e];if(a?t=e:(t=n.findIndex(function(t){return t[1].id===e}),a=n[t]),!a)throw new Error("Cannot find level with id ".concat(e));var i=a,r=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(i,2),o=r[0],s=r[1],c=Object(_lib_level_parser__WEBPACK_IMPORTED_MODULE_21__.a)(o,this.mapsAreRectangular),l=c.map,u=c.mapText,h=c.lookups,d=this.tileWidth,m=this.tileHeight,p=l.length,_=m*p,f=Math.max.apply(Math,Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(l.map(function(e){return e.length}))),g=d*f,v=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},s,{heightInTiles:p,widthInTiles:f,height:_,width:g,map:l,mapText:u,mapLookups:h,index:t});return v.background&&(v.background=this.add.sprite(0,0,v.background),v.background.setPosition(.5*v.background.width,.5*v.background.height)),v.underground&&this.createUnderground(v.underground),v}},{key:"createUnderground",value:function(e){if(this.game.debug){var t=this.add.image(0,0,e),n=t.width,a=t.height;t.destroy();var i=function(e){return e&&!(e&e-1)};i(n)&&i(a)||console.error("Underground ".concat(e," is ").concat(n,"x").concat(a,"; please use an image having powers-of-two dimensions for best rendering"))}var r=this.game.config,o=r.width,s=r.height,c=o+10*r.tileWidth,l=s+10*r.tileHeight,u=this.add.tileSprite(c/2,l/2,c,l,e);u.tilePositionX=0,u.tilePositionY=0,this.underground=u}},{key:"executeScript",value:function(e){var t=this,n=e.execute,a=e.delay;if(a)this.timer(function(){t.executeScript(Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},e,{delay:0}))},a);else if(n)if("object"===typeof n){var i=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toArray__WEBPACK_IMPORTED_MODULE_0__.a)(n),r=i[0],o=i.slice(1);this[r].apply(this,Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(o))}else this[n]()}},{key:"textSize",value:function(){return"24px"}},{key:"textColor",value:function(){return"rgb(255, 0, 0)"}},{key:"strokeColor",value:function(){return"rgb(0, 0, 0)"}},{key:"strokeWidth",value:function(){return 6}},{key:"cameraColor",value:function(){return 0}},{key:"text",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this.add.text(e,t,n,Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({fontFamily:'"Avenir Next", "Avenir", "Helvetica Neue", "Helvetica", "Arial"',fontWeight:"bold",fontSize:this.textSize(a),color:this.textColor(a)},a));return null!==a.stroke&&(void 0===a.stroke?i.setStroke(this.strokeColor(a),this.strokeWidth(a)):i.setStroke.apply(i,Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(a.stroke))),i}},{key:"speak",value:function(){for(var e=this,t=0,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var r,o=a.shift();if(o&&!Number.isInteger(o)){var s=this.level.mapLookups[o];void 0===(o=r=s.map(function(e){return e.object}).find(function(e){return e}))&&(o=s[0].xCoord,r=s[0].yCoord)}else r=a.shift();null!==o&&void 0!==o||(o=this.game.config.width/2),null!==r&&void 0!==r||(r=this.game.config.height/2);var c=a.shift();Array.isArray(c)||(c=[c]);var l=a.shift()||{};c.forEach(function(n,a){var i=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({inTime:200,outTime:200,duration:null,extraDelay:200,dy:null,dx:null,ox:0,oy:0,noOut:!1,follow:!0,scrollFactor:null,onAdd:null,onExit:null},l,"object"===typeof n?n:{text:n}),s=i.duration,c=i.inTime,u=i.outTime,h=i.text,d=i.extraDelay,m=i.dx,p=i.dy,_=i.ox,f=i.oy,g=i.noOut,v=i.follow,b=i.scrollFactor,y=i.onAdd,O=i.onExit,E=null===s?100*h.length:s,w=null===m?0:m,S=null===p?-e.game.config.tileHeight:p;e.timer(function(){var t=o,n=r,a="object"===typeof t?t:null,i="object"===typeof n?n:null;a&&(t=a.x,v||(a=null)),i&&(n=i.y,v||(i=null)),t+=_,n+=f;var s=e.text(t,n,h,l),d=s.width/2,m=s.height/2;s.x-=d,s.y-=m;var p=s.x,k=s.y;s.alpha=0,null!==b&&s.setScrollFactor(b),y&&y(s),e.tweenPercent(c,function(e){s.alpha=e,a&&(s.x=(void 0===a.xCoord?a.x:a.xCoord)-d+w,p=s.x),i&&(s.y=(void 0===i.yCoord?i.y:i.yCoord)-m+S,k=s.y),s.x=p-w*(1-e)+_,s.y=k-S*(1-e)+f},null,0,"Cubic.easeOut"),e.timer(function(){e.tweenPercent(E,function(e){a&&(s.x=(void 0===a.xCoord?a.x:a.xCoord)-d+w,p=s.x),i&&(s.y=(void 0===i.yCoord?i.y:i.yCoord)-m+S,k=s.y),s.x=p+_,s.y=k+f},null,0,"Cubic.easeOut")},c),g||e.timer(function(){e.tweenPercent(u,function(e){s.alpha=1-e,a&&(s.x=(void 0===a.xCoord?a.x:a.xCoord)-d+w,p=s.x),i&&(s.y=(void 0===i.yCoord?i.y:i.yCoord)-m+S,k=s.y),s.x=p-w*e+_,s.y=k-S*e+f},function(){O&&O(),s.destroy()},0,"Cubic.easeOut")},c+E)},d+t),t+=d+E+c+u})}},{key:"createLevel",value:function(e){var t=this.level=this.loadLevel(e);return this.addMap(),t}},{key:"createTileForGroup",value:function(e,t,n){var a,i=this.level,r=this.tileWidth,o=this.tileHeight,s=this.halfWidth,c=this.halfHeight,l=i.groups[e];if(l.image?a=l.group.create(t,n,l.image):(a=this.add.rectangle(t,n,r,o),l.group.add(a)),l.objects.push(a),l.isCircle){var u=(c+s)/2;a.setCircle(u)}return a}},{key:"addMap",value:function(){var e=this,t=this.level,n=this.tileWidth,a=this.tileHeight,i=this.halfWidth,r=this.halfHeight,o=t.groups={};Object.values(_props__WEBPACK_IMPORTED_MODULE_11__.i).forEach(function(t){var n;t&&(t.group&&(n=t.isStatic?e.physics.add.staticGroup():e.physics.add.group(),o[t.group]=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({tiles:[],objects:[]},t,{group:n})))});var s={};return t.map.forEach(function(t,n){t.forEach(function(t,n){var a=t.glyph,o=t.group,c=e.positionToScreenCoordinate(t.x,t.y),l=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(c,2),u=l[0],h=l[1];if(t.xCoord=u,t.yCoord=h,o){if(t.combine){var d=!0===t.combine?a:t.combine;return s[d]||(s[d]=[]),void s[d].push(t)}var m=e.createTileForGroup(o,u+i,h+r);m.tiles=[t],t.object=m}else if(t.image){var p=e.add.image(u+i,h+r,t.image);p.tile=t,t.image=p}t.combine&&console.warn("Cannot combine tile of type ".concat(t.glyph,"; needs a group"))})}),Object.values(s).forEach(function(o){var s=o[0].preferCombineVertical,c=s?0:1,l=s?1:0,u=s?1:0,h=s?0:1,d=t.groups[o[0].group];s?o.sort(function(e,t){return e.x-t.x||e.y-t.y}):o.sort(function(e,t){return e.y-t.y||e.x-t.x});var m=e.level.map[0].map(function(e){return[]});m.push([]),o.forEach(function(e){var t=e.x,n=e.y;m[t][n]=e});var p={};o.forEach(function(e){var t=e.x,n=e.y,a=e.combineWith,i="".concat(t,"/").concat(n);if(a){var r=e.dxNext,o=e.dyNext,s=m[t+r][n+o];s&&!s.combineWith&&(s.combineWith=a,s.dxNext=r,s.dyNext=o,p[a].push(s))}else{var d=m[t+c][n+l];if(d&&!d.combineWith)d.combineWith=i,d.dxNext=c,d.dyNext=l,p[i]=[e,d];else{var _=m[t+u][n+h];_&&!_.combineWith?(_.combineWith=i,_.dxNext=u,_.dyNext=h,p[i]=[e,_]):p[i]=[e]}}}),Object.entries(p).forEach(function(t){var o=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(t,2),s=(o[0],o[1]),c=s[0],l=s[s.length-1],u=e.positionToScreenCoordinate(c.x,c.y),h=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(u,2),m=h[0],p=h[1],_=e.positionToScreenCoordinate(l.x,l.y),f=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(_,2),g=f[0],v=f[1],b=g-m+n,y=v-p+a,O=e.add.rectangle(m+.5*b,p+.5*y,b,y);d.group.add(O),d.objects.push(O),O.tiles=s,s.forEach(function(t){var n=e.add.image(t.xCoord+i,t.yCoord+r,t.image);n.tile=t,t.image=n,t.object=O})})}),t}},{key:"setCameraBounds",value:function(){var e=this.level;if(Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("scene.camera.hasBounds")){if(e&&e.width&&e.height){var t=e.width,n=e.height;this.xBorder&&(t+=2*this.xBorder),this.yBorder&&(n+=2*this.yBorder),this.camera.setBounds(0,0,t,n)}}else this.camera.removeBounds()}},{key:"setCameraDeadzone",value:function(){this.camera.setDeadzone(Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("scene.camera.deadzoneX"),Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("scene.camera.deadzoneY"))}},{key:"setCameraLerp",value:function(){this.camera.setLerp(Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("scene.camera.lerp"))}},{key:"firstUpdate",value:function(e,t){var n=this;if(this.setCameraBounds(),this.setCameraDeadzone(),this.setCameraLerp(),this.level&&this.level.scripts){var a=0;this.level.scripts.forEach(function(e){e.delay&&(a+=e.delay),n.executeScript(Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},e,{delay:a}))})}}},{key:"update",value:function(e,t){this._firstUpdated||(this.firstUpdate(e,t),this._firstUpdated=!0,this._renderDelta=0),this._renderDelta+=t,this.physics&&this.physics.world.isPaused&&!this.timeSightFrozen&&this.isTopScene()&&this.command.processInput(this,e,t,!0),this.renderUpdate&&this.renderUpdate(e,t),this.shader&&this._shaderUpdate(),this.positionBackground(),this.positionUnderground()}},{key:"positionBackground",value:function(){var e=this.level,t=this.game,n=this.xBorder,a=this.yBorder,i=this.camera;if(e){var r=e.background,o=e.width,s=e.height;if(r){var c=t.config,l=c.width,u=c.height,h=r.width,d=r.height,m=i.scrollX,p=i.scrollY,_=o-l+2*n;if(0===_)r.x=.5*h;else{var f=m/_;r.x=n+.5*h+f*(o-h)}var g=s-u+2*a;if(0===g)r.y=.5*d;else{var v=p/g;r.y=a+.5*d+v*(s-d)}}}}},{key:"positionUnderground",value:function(){var e=this.underground,t=this.camera,n=this.tileWidth,a=this.tileHeight;e&&(e.x=t.scrollX+e.width/2-5*n,e.y=t.scrollY+e.height/2-5*a,e.tilePositionX=t.scrollX%n,e.tilePositionY=t.scrollY%a)}},{key:"_shaderInitialize",value:function _shaderInitialize(initializeListeners){var _this7=this,shaderInitialize=this.shaderInitialize;this.game.shaderFragments(this.shaderName).forEach(function(e){var t=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(e,2),n=t[0],a=t[1];Object.entries(a).forEach(function(e){var t=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(e,2),a=t[0],i=t[1],r="".concat(n,"_").concat(a),o=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(i,3),s=o[0],c=o[1];if(null===o[2])shaderInitialize&&shaderInitialize[r]&&r in _this7||!initializeListeners&&r in _this7||(_this7[r]=c);else{var l,u=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(_lib_shaders__WEBPACK_IMPORTED_MODULE_19__.c[s],3)[2],h=Object(_lib_shaders__WEBPACK_IMPORTED_MODULE_19__.a)(n,a,i);1===h.length?l=Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)(h[0]):(l=[],h.forEach(function(e){var t,n=Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)(e);Array.isArray(n)?(t=l).push.apply(t,Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(n)):l.push(n)})),"rgb"!==s&&"rgba"!==s||(l=l.map(function(e,t){return t<3?e/255:e})),_this7.shader[u](r,l)}})});var shader=this.shader,camera=this.camera;shader||(this._shaderUpdate=function(){});var shaderUpdate=["(function () {","  shader.setFloat2('camera_scroll', camera.scrollX / ".concat(this.game.config.width,", camera.scrollY / ").concat(this.game.config.height,");"),"  shader.setFloat1('scene_time', this.scene_time);"];this.game.shaderFragments(this.shaderName).forEach(function(e){var t=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(e,2),n=t[0],a=t[1];Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("shader.".concat(n,".enabled"))&&Object.entries(a).forEach(function(e){var t=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(e,2),a=t[0],i=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(t[1],3),r=i[0],o=i[2],s="".concat(n,"_").concat(a);if(null===o){var c=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__.a)(_lib_shaders__WEBPACK_IMPORTED_MODULE_19__.c[r],3)[2];"bool"===r?shaderUpdate.push("  shader.".concat(c,"('").concat(s,"', this['").concat(s,"'] ? 1.0 : 0.0);")):shaderUpdate.push("  shader.".concat(c,"('").concat(s,"', this['").concat(s,"']);"))}})}),shaderUpdate.push("})"),this._shaderUpdate=eval(shaderUpdate.join("\n"))}},{key:"replaceWithSceneNamed",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=this.game;if(this.scene.settings)if(this.scene.settings.data._timeSightTarget)this.endedReplay();else{var o,s=this.scene.settings.data.seed;!0===t?s=this.randFloat("replaceWithSceneNamed"):t&&(s=t),this._replay&&(this._replay.sceneTransitions||[]).forEach(function(e){e.parentSceneId===n.sceneId&&(o=e.sceneId)}),o||(o=String(this.randFloat("sceneId")));var c="scene-".concat(this.randFloat("sceneId")*Date.now());if(!this._isTransitioning){this._isTransitioning=!0;var l=this,u=this._replay,h=this._replayOptions,d=this._recording,m=this._transitionProps(i),p=new Promise(function(e,t){n.game.onSceneInit(c,function(t){n.willTransitionTo(t,m),t.willTransitionFrom(l,m),n._sceneTransition(l,t,m),e(t,m)})});return this.scene.add(c,r._sceneConstructors[e],!0,Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},this.scene.settings.data,{_replay:u,_replayOptions:h,_recording:d,sceneId:o,parentSceneId:this.sceneId},a,{transition:m,seed:s})),p}console.error("replaceWithSceneName called again even though this scene is already transitioning. Ignoring.")}}},{key:"replaceWithSelf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.replaceWithSceneNamed(this.constructor.name,e,t,n)}},{key:"_sceneTransition",value:function(e,t,n){var a=this,i=n||{},r=i.animation,o=i.ease,s=i.duration,c=i.onUpdate,l=i.oldPauseTime,u=i.newUnpauseTime,h=function(){console.error("Transition did not instantiate newUnpauseFn")},d=!0,m=!1,p=function(a){m||(m=!0,void 0!==a&&(d=a),n&&n.onCutover&&n.onCutover(e,t,n),"cutover"===l&&Object(_lib_transitions__WEBPACK_IMPORTED_MODULE_14__.a)(e,n,n.oldPause),"cutover"===u&&h(),t.playMusicIfSet(),d&&t.game.scene.bringToTop(t.scene.key))},_=!1,f=function(){_||(m||(console.error("completeTransition called, but cutoverPrimary hasn't been yet"),p()),n&&n.onComplete&&n.onComplete(e,t,n),"complete"===l&&Object(_lib_transitions__WEBPACK_IMPORTED_MODULE_14__.a)(e,n,n.oldPause),"complete"===u&&h(),_=!0,t.timer(function(){e.didTransitionTo(t,n),t.didTransitionFrom(e,n),e.scene.remove()}).ignoresScenePause=!0,n&&(t.timer(function(){n&&n.onWaitEnd&&n.onWaitEnd(e,t,n),"waitEnd"===u&&h()},n.wait).ignoresScenePause=!0))};if(n){var g;if(n.removeOldSceneShader&&(e.shader=null,e.camera.clearRenderToTexture()),"function"===typeof r)g=function(){return r(e,t,p,f,n)};else if("fadeInOut"===r)d=!0,t.camera.setBackgroundColor(0),e.camera.setBackgroundColor(0),t.camera.alpha=0,e.camera.alpha=1,g=function(){a.tweenInOut(s/2,s/2,function(a,i){(i?e.camera.alpha=1-a:t.camera.alpha=1-a,c)&&c(i?a/2:1-a/2,e,t,n)},function(e){e.ignoresScenePause=!0,p()},function(){t.camera.alpha=1,e.camera.alpha=0,f()},0,o).ignoresScenePause=!0};else if("crossFade"===r)!e.shader&&t.shader?(e.game.scene.bringToTop(e.scene.key),d=!1):e.shader&&!t.shader?(t.game.scene.bringToTop(t.scene.key),d=!1):d=!0,t.camera.alpha=0,e.camera.alpha=1,g=function(){a.tweenPercent(s,function(a){t.camera.alpha=a,e.camera.alpha=1-a,a>=.5&&p(),c&&c(a,e,t,n)},function(){t.camera.alpha=1,e.camera.alpha=0,!n.suppressShaderCheck&&!n.delayNewSceneShader&&e.shader&&t.shader&&console.error("crossFade transitions do not render correctly if the both scenes have a shader; provide delayNewSceneShader, removeOldSceneShader, or suppressShaderCheck to the transition, or use fadeInOut animation"),f()},0,o).ignoresScenePause=!0};else if("pushRight"===r||"pushLeft"===r||"pushUp"===r||"pushDown"===r){var v=this.game.config,b=v.height,y=v.width;d=!0,e.camera.x=0,e.camera.y=0;var O=0,E=0;"pushRight"===r?(t.camera.x=-y,O=1):"pushLeft"===r?(t.camera.x=y,O=-1):"pushUp"===r?(t.camera.y=-b,E=-1):"pushDown"===r&&(t.camera.y=b,E=1),g=function(){a.tweenPercent(s,function(a){t.camera.x=O*(a-1)*y,e.camera.x=O*a*y,t.camera.y=E*(a-1)*b,e.camera.y=E*a*b,a>=.5&&p(),c&&c(a,e,t,n)},function(){t.camera.x=0,t.camera.y=0,f()},0,o).ignoresScenePause=!0}}else{if("wipeRight"!==r&&"wipeLeft"!==r&&"wipeUp"!==r&&"wipeDown"!==r)return console.error("Invalid transition animation '".concat(r,"'")),p(),void f();var w,S,k=this.game.config,j=k.height,C=k.width;if(d=!1,"wipeRight"===r||"wipeDown"===r){t.camera.alpha=0,w=t.cameras.add(0,0,C,j);var T=t.cameraColor();null!==T&&w.setBackgroundColor(T),w.scrollX=t.camera.scrollX,w.scrollY=t.camera.scrollY,"wipeRight"===r?w.width=1:w.height=1}else{e.game.scene.bringToTop(e.scene.key),e.camera.alpha=0,S=e.cameras.add(0,0,C,j);var P=e.cameraColor();null!==P&&S.setBackgroundColor(P),S.scrollX=e.camera.scrollX,S.scrollY=e.camera.scrollY,e.shader&&S.setRenderToTexture(e.shader)}var D=!0;g=function(){a.tweenPercent(s,function(a){w&&D&&(t.shader&&w.setRenderToTexture(t.shader),D=!1),"wipeRight"===r?w.setSize(Math.max(1,a*C),j):"wipeLeft"===r?S.setSize(Math.max(1,(1-a)*C),j):"wipeUp"===r?S.setSize(C,Math.max(1,(1-a)*j)):"wipeDown"===r&&w.setSize(C,Math.max(1,a*j)),a>=.5&&p(),c&&c(a,e,t,n)},function(){w&&(t.cameras.main.alpha=1,t.camera.scrollX=w.scrollX,t.camera.scrollY=w.scrollY,t.cameras.remove(w)),n.suppressShaderCheck||(!n.delayNewSceneShader&&t.shader&&w&&console.error("".concat(r," transitions do not render correctly if the new scene has a shader; provide delayNewSceneShader or suppressShaderCheck to the transition, or use a different animation")),e.shader&&S&&console.error("".concat(r," transitions do not render correctly if the old scene has a shader; provide removeOldSceneShader or suppressShaderCheck to the transition, or use a different animation"))),f()},0,o).ignoresScenePause=!0}}d&&e.game.scene.bringToTop(e.scene.key),"begin"===l&&Object(_lib_transitions__WEBPACK_IMPORTED_MODULE_14__.a)(e,n,n.oldPause),"begin"!==u&&(h=Object(_lib_transitions__WEBPACK_IMPORTED_MODULE_14__.a)(t,n,n.newPause));var M=g;if(g=function(){n&&n.onDelayEnd&&n.onDelayEnd(e,t,n),"delayEnd"===l&&Object(_lib_transitions__WEBPACK_IMPORTED_MODULE_14__.a)(e,n,n.oldPause),"delayEnd"===u&&h(),M()},n.delay)this.timer(g,n.delay).ignoresScenePause=!0;else g()}else p(),f()}},{key:"preemitEmitter",value:function(e){for(var t=e.lifespan.staticValueEmit(),n=e.quantity.staticValueEmit(),a=e.frequency,i=t;i>0;i-=a)for(var r=0;r<n;r+=1){e.emitParticle(1).update(i,i/1e3,[])}}},{key:"sleep",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.pauseEverythingForSleep(e);var a=this.timer(function(){t.unpauseEverythingForSleep(e)},e);a.ignoresScenePause=!0,n&&(a.ignoresTimeScale=!0)}},{key:"beginReplay",value:function(e,t){var n=this,a=this.command,i=this.game,r=i.loop;this._replay=e,this._replayOptions=t,this._replayLatestTransition=t.startFromTransition;var o=t.startTick||this._replayLatestTransition&&this._replayLatestTransition.tickCount||0;a.beginReplay(e,Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},t,{startTick:o,onEnd:function(){n.game.topScene().endedReplay()},onStop:function(){n.game.topScene().stopReplay(!0)}}));var s=window.performance.now(),c=1e3/this.physics.world.fps;i._replayPreflight+=1;var l=this.command.getManager(this);for(r.sleep(),this.scene.setVisible(!1);a.hasPreflight();)if(e.timeSightFrameCallback&&e.timeSightFrameCallback(this,s,c,l,!0,!1,!1),s+=c,r.step(s),i._stepExceptions>100)return void console.error("Too many errors in preflight; bailing out\u2026");r.resetDelta(),i._replayPreflight-=1;var u=i.topScene();if(e.timeSight)u.calculateTimeSight();else if(e.timeSightFrameCallback){var h;i._replayPreflight+=1,u._timeSightTargetEnded=function(){e.timeSightFrameCallback(u,s,c,l,!1,!0,!0)},"postflightCutoff"in e&&(h=e.postflightCutoff.postflightCutoff,delete e.postflightCutoff);for(;!u._timeSightTargetDone;){var d=void 0!==h&&this.command.replayTicks>=h;if(e.timeSightFrameCallback(u,s,c,l,!1,d,!1),s+=c,r.step(s),i._stepExceptions>100)return void console.error("Too many errors in timeSight; bailing out\u2026")}u.scene.remove(),i._replayPreflight-=1}else u.scene.setVisible(!0),r.wake()}},{key:"calculateTimeSight",value:function(){var e=this;console.info("Calculating timeSight"),this._timeSightFrames=[],this.scene.setActive(!1),this.scene.setVisible(!1),this.launchTimeSight();var t="scene-".concat(Math.random()*Date.now()),n=this.game.scene.add(t,this.constructor,!0,Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},this.scene.settings.data,{_timeSightTarget:!0}));this.game.scene.bringToTop(t);var a=0;n.beginReplay(Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},this._replay,{timeSight:!1,startTick:(this._replayLatestTransition?this._replayLatestTransition.tickCount:0)||0,timeSightFrameCallback:function(t,n,i,r,o,s,c){a+=i,e.timeSightTargetStep(t,a,n,i,r,o,s,c)&&(a=0)}}),{onEnd:function(){n._timeSightTargetDone=!0,e.scene.setVisible(!0),e.scene.setActive(!0),e.game.loop.wake(),e.beginTimeSightAlphaAnimation()}})}},{key:"timeSightTargetStep",value:function(e,t,n,a,i,r,o,s){var c=this,l=e.renderTimeSightFrameInto(this,t,n,a,s);if(l&&l.length){Object(_lib_manage_gui__WEBPACK_IMPORTED_MODULE_12__.f)(!0);var u={objects:l,props:Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},_props__WEBPACK_IMPORTED_MODULE_11__.c),commands:Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(i.commands),tickCount:i.tickCount,isPreflight:r,isPostflight:o};return l.forEach(function(e){e.scene!==c&&console.error("renderTimeSightFrameInto rendered this object into the wrong scene: ".concat(JSON.stringify(e))),e._timeSightAlpha=e.alpha,e._timeSightFrame=u,(r||o)&&(e.alpha=0)}),this._timeSightFrames.push(u),u}}},{key:"beginTimeSightAlphaAnimation",value:function(){var e,t=this,n=this._timeSightFrames.filter(function(e){return!e.isPreflight&&!e.isPostflight});n.length&&(Object(_lib_manage_gui__WEBPACK_IMPORTED_MODULE_12__.b)(n[0].props),this.game.updateReplayCursor&&this.game.updateReplayCursor(),e=function(a,i){var r=a.objects,o=a.props;Object(_lib_manage_gui__WEBPACK_IMPORTED_MODULE_12__.b)(o),r.forEach(function(r,o){r._timeSightAlphaTween=t.tweens.add({targets:r,alpha:.7,duration:200,onComplete:function(){r._timeSightAlphaTween=t.tweens.add({targets:r,alpha:r._timeSightAlpha,duration:200,onComplete:function(){0===o&&(a.timer=t.time.addEvent({delay:100*n.length+1e3,callback:function(){return e(a,i)}}))}})}})})},n.forEach(function(n,a){n.timer=t.time.addEvent({delay:100*a+1e3,callback:function(){e(n,a)}})}),this._timeSightMouseInput?n.forEach(function(e){e.objects.forEach(function(e){e.alpha=e._timeSightAlpha})}):(this._timeSightMouseInput=!0,this.input.topOnly=!0,n.forEach(function(e){e.objects.forEach(function(e){e.setInteractive()})}),this.input.on("gameobjectover",function(e,a){var i;t._timeSightRemoveFocusTimer&&t._timeSightRemoveFocusTimer.destroy(),t.game.canvas.style.cursor="pointer",n.forEach(function(e){e.timer&&e.timer.destroy(),e.objects.forEach(function(t){t._timeSightAlphaTween&&t._timeSightAlphaTween.stop(),t.alpha=t._timeSightAlpha,t===a&&(i=e,t.alpha=1)})}),i&&(Object(_lib_manage_gui__WEBPACK_IMPORTED_MODULE_12__.b)(i.props),t.game.updateReplayCursor&&t.game.updateReplayCursor(i.tickCount,t._replay))}),this.input.on("gameobjectout",function(e,n){t._timeSightRemoveFocusTimer&&t._timeSightRemoveFocusTimer.destroy(),t._timeSightRemoveFocusTimer=t.time.addEvent({delay:100,callback:function(){t.game.canvas.style.cursor="",t.beginTimeSightAlphaAnimation()}})}),this.input.on("gameobjectdown",function(e,n){t._timeSightRemoveFocusTimer&&t._timeSightRemoveFocusTimer.destroy(),t.game.canvas.style.cursor="";var a=t._replay,i=n._timeSightFrame.commands,r=i.reduce(function(e,t){return e+(t._repeat||1)},0);t.game.stopReplay(),t.game.beginReplay(Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},a,t._replayLatestTransition||{},{timeSight:!1,snapshot:!0,commands:i,preflightCutoff:r}),{startFromTransition:t._replayLatestTransition,startTick:-1})})))}},{key:"endedReplay",value:function(){if(this._replay){var e=this._replayOptions.onEnd,t=this._replay;delete this._replay,delete this._replayOptions,t.timeSight?this.replaceWithSelf(!1):(this._timeSightTargetEnded&&this._timeSightTargetEnded(),e&&e())}}},{key:"stopReplay",value:function(e){if(this._replay){var t=this._replayOptions.onStop,n=this._replay;delete this._replay,delete this._replayOptions,n.timeSight?this.replaceWithSelf(!1):(e||this.command.stopReplay(),t&&t())}}},{key:"launchTimeSight",value:function(){this.timeSightFrozen=!0,[].concat(Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(this.tweens._active),Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__.a)(this.tweens._add)).forEach(function(e){return e._skipFreezeTimeSight||e.stop()}),this.add.displayList.list.filter(function(e){return"Sprite"===e.type}).map(function(e){return e._skipFreezeTimeSight||e.anims.stop()});var e=this.add.displayList.list.filter(function(e){return"ParticleEmitterManager"===e.type});this.time.addEvent({callback:function(){e.forEach(function(e){e._skipFreezeTimeSight||e.pause()})}})}},{key:"cutoffTimeSightEnter",value:function(){var e=this._timeSightFrames;e&&(this._timeSightRemoveFocusTimer&&this._timeSightRemoveFocusTimer.destroy(),e.forEach(function(e){e.timer&&e.timer.destroy(),e.objects.forEach(function(e){e._timeSightAlphaTween&&e._timeSightAlphaTween.stop(),e.alpha=e._timeSightAlpha})}),this.cutoffTimeSightChanged(this._replay.preflightCutoff,this._replay.postflightCutoff))}},{key:"cutoffTimeSightChanged",value:function(e,t){var n=this,a=this._timeSightFrames;a&&(this._replay.preflightCutoff=e,this._replay.postflightCutoff=t,a.forEach(function(a,i){var r=a.tickCount+((n._replayLatestTransition?n._replayLatestTransition.tickCount:0)||0);a.isPreflight=r<e,a.isPostflight=r>t,a.objects.forEach(function(e){e.alpha=a.isPreflight||a.isPostflight?e._timeSightAlpha:1})}))}},{key:"cutoffTimeSightLeave",value:function(){var e=this._timeSightFrames;e&&(e.forEach(function(e){e.objects.forEach(function(t){t.alpha=e.isPreflight||e.isPostflight?0:t._timeSightAlpha})}),this.beginTimeSightAlphaAnimation())}},{key:"propDidChange",value:function(e,t){this.replayParticleSystems(e)}},{key:"propDidFinishChange",value:function(e,t){if(this._replay&&this._replay.timeSight){var n=this._replay;this.game.stopReplay(),this.game.beginReplay(n,{startFromTransition:this._replayLatestTransition})}}},{key:"beginRecording",value:function(e){this._recording=e,e.sceneSaveState=JSON.parse(JSON.stringify(this._initialSave)),e.sceneTransitions=[],e.sceneId=this.sceneId,this.command.beginRecording(this,e)}},{key:"stopRecording",value:function(){var e=this._recording;return delete this._recording,this.command.stopRecording(),e}},{key:"replayParticleSystems",value:function(e){var t=this,n=this.particleSystems;this.particleSystems=[],n.forEach(function(n){var a=n.particles,i=n.emitter,r=n.name,o=n.options;if(a.active&&!a.moribund)if(!e||e.startsWith(r)){var s=i.seed;i.killAll(),i.stop(),a.destroy(),t.particleSystem(r,o,s)}else t.particleSystems.push(n)})}},{key:"_builtinHot",value:function(){if(console.info("Hot-loading ".concat(this.constructor.name)),this.game._stepExceptions>100)return console.info("Resetting after recovering from errors"),void(this.game._stepExceptions=0);if(this._replay&&this._replay.timeSight){var e=this._replay;this.game.stopReplay(),this.game.beginReplay(e,{startFromTransition:this._replayLatestTransition})}else this.replayParticleSystems();this.setupAnimations?this.reloadAnimations():this.removeAnimations(),this.game.recompileShaders(),this.playMusic()}},{key:"_hotReloadCurrentLevel",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.replaceWithSelf.apply(this,[!1].concat(t))}},{key:"removeAnimations",value:function(){var e=this;this.physics&&this.physics.world&&this.physics.world.bodies&&this.physics.world.bodies.entries&&this.physics.world.bodies.entries.forEach(function(e){e.gameObject&&e.gameObject.anims&&(e.gameObject.anims.pause(),e.gameObject.anims.stop(),e.gameObject.anims.remove())}),Object.keys(this.anims.anims.entries).forEach(function(t){e.anims.remove(t)})}},{key:"reloadAnimations",value:function(){var e=this;Object.keys(this.anims.anims.entries).forEach(function(t){e.anims.remove(t)}),this.setupAnimations(),this.physics&&this.physics.world&&this.physics.world.bodies&&this.physics.world.bodies.entries&&this.physics.world.bodies.entries.forEach(function(t){if(t.gameObject&&t.gameObject.anims&&t.gameObject.anims.currentAnim){var n=t.gameObject.anims.currentAnim.key;t.gameObject.anims.stop(),t.gameObject.anims.currentAnim=null,e.timer(function(){return t.gameObject.anims.play(n)}).ignoresScenePause=!0}})}},{key:"particleSystem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("".concat(e,".image"));var a=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},Object(_props__WEBPACK_IMPORTED_MODULE_11__.e)("".concat(e,".")),t),i=a.onAdd,r=a.image,o=this.add.particles(r),s=Object(_lib_particles__WEBPACK_IMPORTED_MODULE_13__.a)(a),c=o.createEmitter(s);Object(_lib_particles__WEBPACK_IMPORTED_MODULE_13__.c)(c,n||this.randFloat("particles")),i&&i(o,c),(a.preemit||n&&a.preemitOnReload)&&this.preemitEmitter(c),c.ignoresScenePause=s.ignoresScenePause,c.updatesOnceOnPause=s.updatesOnceOnPause,this.particleSystems.push({particles:o,emitter:c,name:e,options:t})}},{key:"tween",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!==e&&Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("".concat(e,".duration"));var a=null===e?Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},n):Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},Object(_props__WEBPACK_IMPORTED_MODULE_11__.e)("".concat(e,".")),n),i=Object(_lib_tweens__WEBPACK_IMPORTED_MODULE_18__.a)(t,a,n);return this.tweens.add(i)}},{key:"_transitionProps",value:function(e){if(!e)return e;var t,n="object"===typeof e?e.name:e,a="object"===typeof e?e:{};return n?(Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("".concat(n,".animation")),t=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},Object(_props__WEBPACK_IMPORTED_MODULE_11__.e)("".concat(n,".")),a)):t=Object(_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__.a)({},_lib_transitions__WEBPACK_IMPORTED_MODULE_14__.b,a),Object(_lib_transitions__WEBPACK_IMPORTED_MODULE_14__.c)(t,a)}},{key:"tweenPercent",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Linear",r=this.tweens.addCounter({from:a,to:100,ease:i,duration:e,onUpdate:function(){var e=r.getValue()/100;t(e)},onComplete:n});return r}},{key:"tweenPercentExclusive",value:function(e,t,n,a){var i=this,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Linear",o=0;return this[e]&&(o=this[e].getValue(),this[e].stop()),this[e]=this.tweenPercent(t*(1-o/100),n,function(){a&&a.apply(void 0,arguments),delete i[e]},o,r),this[e]}},{key:"tweenInOut",value:function(e,t,n,a,i){var r,o=this,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"Linear",l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:c;return r=this.tweens.addCounter({from:s,to:100,ease:c,duration:e,onUpdate:function(){var e=r.getValue()/100;n(e,!0)},onComplete:function(){r=o.tweens.addCounter({from:100,to:0,ease:l,duration:t,onUpdate:function(){var e=r.getValue()/100;n(e,!1)},onComplete:i}),a&&a(r)}})}},{key:"tweenInOutExclusive",value:function(e,t,n,a,i,r){var o=this,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"Linear",c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:s,l=0;return this[e]&&(l=this[e].getValue(),this[e].stop()),this[e]=this.tweenInOut(t*(1-l/100),n,a,function(t){if(i){for(var n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];i.apply(void 0,[t].concat(a))}o[e]=t},function(){r&&r.apply(void 0,arguments),delete o[e]},l,s,c),this[e]}},{key:"tweenSustain",value:function(e,t,n,a,i,r,o){var s,c=this,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"Linear",h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:u;return s=this.tweens.addCounter({from:l,to:100,ease:u,duration:e,onUpdate:function(){var e=s.getValue()/100;a(e,"in")},onComplete:function(){s=c.tweens.addCounter({from:0,to:100,duration:t,onUpdate:function(){var e=s.getValue()/100;a(1,"sustain",e)},onComplete:function(){s=c.tweens.addCounter({from:100,to:0,ease:h,duration:n,onUpdate:function(){var e=s.getValue()/100;a(e,"out")},onComplete:o}),r&&r(s)}}),i&&i(s)}})}},{key:"tweenSustainExclusive",value:function(e,t,n,a,i,r,o,s){var c=this,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"Linear",u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:l,h=0;return this[e]&&(h=this[e].getValue(),this[e].stop()),this[e]=this.tweenSustain(t*(1-h/100),n,a,i,function(t){if(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];r.apply(void 0,[t].concat(a))}c[e]=t},function(t){if(o){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];o.apply(void 0,[t].concat(a))}c[e]=t},function(){s&&s.apply(void 0,arguments),delete c[e]},h,l,u),this[e]}},{key:"trauma",value:function(e){!this.minTrauma&&!e||this._trauma||(this._traumaStart=this.time.now);var t=Math.min(Math.max((this._trauma||0)+e,0),1);this.minTrauma&&(t=Math.max(this.minTrauma,t));var n=Math.pow(t,Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("scene.trauma.exponent"));if(this._trauma=t,this._traumaShake=n,n&&Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("scene.trauma.legacy")&&Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("scene.trauma.enabled")){var a=this.game.config,i=a.width,r=a.height,o=new phaser__WEBPACK_IMPORTED_MODULE_9___default.a.Math.Vector2(n*Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("scene.trauma.dx")/i,n*Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("scene.trauma.dy")/r);this.camera.shake(100,o)}}},{key:"playSound",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.scene.isVisible()&&!this.game._replayPreflight){var i=e;t&&(i+=1+Math.floor(this.randBetween("sound/".concat(i),0,t)));var r=this.sound.add(i);if(r&&r.key){this.sounds.push(r),r.on("complete",function(){n.sounds=n.sounds.filter(function(e){return e!==r})});try{r.requestedVolume=a,r.setVolume(a*this.game.volume*Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("scene.soundVolume")),r.timeScale=1,r.play()}catch(o){console.warn("Could not play sound ".concat(i,": ").concat(o))}}else console.warn("Could not load sound ".concat(i))}}},{key:"changeVolume",value:function(e){var t=this.sounds,n=e*Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("scene.soundVolume");t.forEach(function(e){return e.setVolume(e.requestedVolume*n)})}},{key:"playMusic",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.musicName(),t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.game.playMusic(e,t)}},{key:"playMusicIfSet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.musicName(),t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e)return this.playMusic(e,t)}},{key:"musicName",value:function(){return null}},{key:"timer",value:function(e,t){var n={callback:e,time:t};return this.timers.push(n),n}},{key:"updateTimers",value:function(e,t){var n=this,a=this.timers,i=this.timers=[],r=this._paused.timers;!r&&this._trauma&&this.trauma(Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("scene.trauma.decay")*t*-1),a.forEach(function(e){!r||e.ignoresScenePause?e.time&&(e.ignoresTimeScale?e.time-=t*n.timeScale:e.time-=t,e.time>0)?i.push(e):e.callback():i.push(e)})}},{key:"updateTweens",value:function(e,t){var n=this.scene.systems.tweens,a=this._paused.tweens,i=t/n.timeScale;n._active.forEach(function(t){a&&!t.ignoresScenePause||t.update(e,i)&&(n._destroy.push(t),n._toProcess+=1)})}},{key:"recoverPerformance",value:function(){var e=this;if(this.performanceFrames+=1,this.performanceAcceptable||(this.performanceAcceptable=this.game.loop.actualFps>50),!(this.performanceFrames<200))if(this.performanceFrames=0,this.performanceAcceptable)this.performanceAcceptable=!1;else if(this.performanceProps.length){var t=this.performanceProps.shift();Array.isArray(t)||(t=[t]);var n=function(t){t.length&&(e.game.debug&&Object(_lib_manage_gui__WEBPACK_IMPORTED_MODULE_12__.c)(),t.forEach(function(t){var n=Object(_lib_particles__WEBPACK_IMPORTED_MODULE_13__.e)(t);n&&(Object(_props__WEBPACK_IMPORTED_MODULE_11__.e)("".concat(n,"."),!0),e.replayParticleSystems(n))}))},a=!0,i=[],r=function(t,r){i.push(t);var o=_props__WEBPACK_IMPORTED_MODULE_11__.d[t];(e.game.debug?_props__WEBPACK_IMPORTED_MODULE_11__.c[t]=r:_props__WEBPACK_IMPORTED_MODULE_11__.d[t][0]=r,o.length>1&&null!==o[1])&&("function"===typeof o[o.length-1]&&(0,o[o.length-1])(r,e,e.game));a||n([t])};t.forEach(function(t){"string"===typeof t?"disableShaders"===t?e.game.disableShaders():r(t,!Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)(t)):"function"===typeof t&&t(r)}),a=!1,console.log("Performance seems iffy; applying ".concat(t.join(", "))),n(i)}}},{key:"handlePointerEvent",value:function(e){var t=e.name.charAt(0).toUpperCase()+e.name.slice(1),n="handle".concat(t);if(this[n])this[n](e);else if(Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("config.debug")){var a="debugHandle".concat(t);this[a]&&this[a](e)}}},{key:"cameraFollow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e){var a=Object(_props__WEBPACK_IMPORTED_MODULE_11__.b)("scene.camera.lerp");this.camera.startFollow(e,!0,a,a,t,n)}else this.camera.stopFollow()}},{key:"shockwave",value:function(e,t){this.shockwave_time=this.scene_time,this.shockwave_center=[e/this.game.config.width,t/this.game.config.height]}},{key:"positionToScreenCoordinate",value:function(e,t){var n=this.xBorder,a=this.yBorder;return[e*this.tileWidth+n,t*this.tileHeight+a]}},{key:"positionToScreenCoordinateHalf",value:function(e,t){var n=this.xBorder,a=this.yBorder,i=this.tileWidth,r=this.tileHeight;return[e*i+n+this.halfWidth,t*r+a+this.halfHeight]}},{key:"timeSightMouseDrag",value:function(){var e=this.game.input.activePointer;e.isDown?(this.cameraFollow(),this._timeSightMouseDragX&&(this.camera.scrollX+=this._timeSightMouseDragX-e.position.x),this._timeSightMouseDragY&&(this.camera.scrollY+=this._timeSightMouseDragY-e.position.y),this._timeSightMouseDragX=e.position.x,this._timeSightMouseDragY=e.position.y):(delete this._timeSightMouseDragX,delete this._timeSightMouseDragY)}},{key:"willTransitionTo",value:function(e,t){}},{key:"willTransitionFrom",value:function(e,t){}},{key:"didTransitionTo",value:function(e,t){}},{key:"didTransitionFrom",value:function(e,t){t&&t.delayNewSceneShader&&this._setupShader(),this.playMusic()}},{key:"pauseInputForTransition",value:function(e){this.command.ignoreAll("_transition",!0)}},{key:"unpauseInputForTransition",value:function(e){this.command.ignoreAll("_transition",!1)}},{key:"pauseInputForSleep",value:function(e){this.command.ignoreAll("_sleep",!0)}},{key:"unpauseInputForSleep",value:function(e){this.command.ignoreAll("_sleep",!1)}},{key:"pausePhysicsForTransition",value:function(e){this.pauseInputForTransition(e),this._paused.physics=!0,this.pauseAllAnimations()}},{key:"pausePhysicsForSleep",value:function(e){this.pauseInputForSleep(e),this._paused.physics=!0,this.pauseAllAnimations()}},{key:"unpausePhysicsForTransition",value:function(e){this.unpauseInputForTransition(e),this._paused.physics=!1,this.resumeAllAnimations()}},{key:"unpausePhysicsForSleep",value:function(e){this.unpauseInputForSleep(e),this._paused.physics=!1,this.resumeAllAnimations()}},{key:"pauseEverythingForTransition",value:function(e){this.pausePhysicsForTransition(e),this._paused.timers=!0,this.pauseAllParticleSystems(),this.pauseAllTweens()}},{key:"unpauseEverythingForTransition",value:function(e){this.unpausePhysicsForTransition(e),this._paused.timers=!1,this.resumeAllParticleSystems(),this.resumeAllTweens()}},{key:"pauseEverythingForSleep",value:function(e){this.pausePhysicsForSleep(e),this._paused.timers=!0,this.pauseAllParticleSystems(),this.pauseAllTweens()}},{key:"unpauseEverythingForSleep",value:function(e){this.unpausePhysicsForSleep(e),this._paused.timers=!1,this.resumeAllParticleSystems(),this.resumeAllTweens()}},{key:"pauseAllParticleSystems",value:function(){this._paused.particles=!0,this.particleSystems.length&&Object(_lib_particles__WEBPACK_IMPORTED_MODULE_13__.d)(this.particleSystems[0].particles)}},{key:"pauseAllTweens",value:function(){this._paused.tweens=!0}},{key:"pauseAllAnimations",value:function(){var e=this;this._paused.anims=!0,this._injectedAnimsUpdate||this.physics&&this.physics.world&&this.physics.world.bodies&&this.physics.world.bodies.entries&&this.physics.world.bodies.entries.forEach(function(t){t.gameObject&&t.gameObject.anims&&Object(_lib_anims__WEBPACK_IMPORTED_MODULE_16__.a)(t.gameObject.anims)&&(e._injectedAnimsUpdate=!0)})}},{key:"resumeAllParticleSystems",value:function(){this._paused.particles=!1,this.particleSystems.forEach(function(e){e.particles.resume()})}},{key:"resumeAllTweens",value:function(){this._paused.tweens=!1}},{key:"resumeAllAnimations",value:function(){this._paused.anims=!1}},{key:"destroy",value:function(){this.command.detachScene(this)}},{key:"timeScale",get:function(){return this._timeScale},set:function(e){this._timeScale=e,this.physics&&(this.physics.world.timeScale=e,this.physics.world.bodies.entries.forEach(function(t){t.gameObject&&t.gameObject.anims&&t.gameObject.anims.setTimeScale(e)}))}}]),SuperScene}(phaser__WEBPACK_IMPORTED_MODULE_9___default.a.Scene)},186:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return h});var a,i=n(6),r=n(50),o=n(3),s=n(7),c=n(281),l=n.n(c);function u(e){var t=[],n=e.split("\n");if(0===n.length)return t;n.push("");var a=[],i=[],r=!0,o=!1;return n.forEach(function(e,n){if(""===e){if(r)return;if(r=!0,a.length&&i.length){var c=JSON.parse(i.join("\n"));c.id||console.warn("Config line ".concat(n,": level is missing an 'id'")),t.push([Object(s.a)(a),c]),a=[],i=[],o=!1}else a.length&&(o=!0)}else r=!1,o?i.push(e):a.push(e)}),t}function h(e,t){var n={},r=[];e.forEach(function(e,t){var o=[];e.split("").forEach(function(e,r){if(!(e in a))throw new Error("Unknown glyph at (".concat(r,", ").concat(t,"): ").concat(e));var s=Object(i.a)({x:r,y:t,glyph:e},a[e]);o.push(s),n[e]||(n[e]=[]),n[e].push(s)}),r.push(o)}),t&&r.forEach(function(e,t){if(t!==r.length-1&&e.length!==r[t+1].length)throw new Error("Inconsistent row width at ".concat(t+1,". Expected ").concat(e.length,", got ").concat(r[t+1].length))});var o=e.join("\n");return{map:r,mapText:o,lookups:n}}!function(e){var t=a;if(a=function(e){return Object.entries(e).forEach(function(t){var n=Object(o.a)(t,2),a=n[0],c=n[1];if(c&&c._inherit){var l=Object(r.a)({},a,!0),u=[Object(i.a)({},c)],h=c._inherit;if(!(h in e))throw new Error("Inherited from nonexistent parent: ".concat(a," \u2192 ").concat(h));for(;e[h];){if(l[h])throw new Error("Loop detected in tileDefinitions _inherit: ".concat([].concat(Object(s.a)(Object.keys(l)),[a]).join(" \u2192 ")));l[h]=!0,u.unshift(e[h]),h=e[h]._inherit}Object.assign.apply(Object,[c].concat(u))}}),e}(e),!t)return null;var n=[],c={};Object.keys(t).forEach(function(e){c[e]=!0}),Object.keys(a).forEach(function(e){var i=t[e],r=a[e];e in t&&delete c[e],l()(i,r)||n.push(e)}),n.push.apply(n,Object(s.a)(Object.keys(c)))}(n(2).i)},2:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"g",function(){return o}),n.d(t,"f",function(){return s}),n.d(t,"h",function(){return c}),n.d(t,"d",function(){return l}),n.d(t,"i",function(){return u}),n.d(t,"c",function(){return h}),n.d(t,"e",function(){return d});var a=n(6),i=n(46),r={jump:{input:["keyboard.UP","keyboard.Z","keyboard.Y","keyboard.W","keyboard.COLON","keyboard.SEMICOLON","keyboard.SPACE","gamepad.UP","gamepad.A","gamepad.B","gamepad.X","gamepad.Y"]},down:{input:["keyboard.DOWN","gamepad.DOWN","keyboard.S"]},left:{input:["keyboard.LEFT","gamepad.LEFT","keyboard.A"]},right:{input:["keyboard.RIGHT","gamepad.RIGHT","keyboard.D"]},lstick:{input:["gamepad.LSTICK.RAW"],joystick:!0},rstick:{input:["gamepad.RSTICK.RAW"],joystick:!0},comet:{input:["keyboard.M"],execute:"comet",unignorable:!0},shadows:{input:["keyboard.C"],execute:"cleanShadows",unignorable:!0},restart:{input:["keyboard.R"],execute:function(e){return e.replaceWithSelf()},debug:!0,unignorable:!0,unreplayable:!0},quit:{input:["keyboard.Q"],execute:"forceQuit",debug:!0,unignorable:!0,unreplayable:!0},recordCycle:{input:["gamepad.R1"],unreplayable:!0,debug:!0,unignorable:!0,execute:function(e,t){var n=t._replay,i=t._recording;n&&n.timeSight?t.stopReplay():n?setTimeout(function(){t.stopReplay(),t.beginReplay(Object(a.a)({},n,{timeSight:!0}))}):i?t.stopRecording():t.beginRecording()}},skip:{input:["keyboard.N"],execute:"skipLevel",unignorable:!0,unreplayable:!0},prev:{input:["keyboard.P"],execute:"prevLevel",unignorable:!0,unreplayable:!0},win:{input:["keyboard.T"],execute:"wonLevel",debug:!0,unignorable:!0,unreplayable:!0}},o=["shockwave"],s=null,c={},l=Object(a.a)({},Object(i.c)(r,o,s),{"command.ignore_all.spawn":[!1,null,function(e){return e.command.ignoreAll("spawn")}],"command.ignore_all.dying":[!1,null,function(e){return e.command.ignoreAll("dying")}],"command.ignore_all.winning":[!1,null,function(e){return e.command.ignoreAll("winning")}],"player.speed":[150,1,1e3],"player.drag":[.3,0,1],"player.gravityBase":[3e3,1,1e4],"player.baseJumpVelocity":[300,1,1e3],"player.touchingDown":[!1,null,"level.player.body.touching.down"],"player.isJumping":[!1,null,"level.player.isJumping"],"player.hasLiftedOff":[!1,null,"level.player.hasLiftedOff"],"player.hasReleasedJump":[!1,null,"level.player.hasReleasedJump"],"player.jumpStart":[0,null,"level.player.jumpStart"],"player.maxJumpTime":[200,0,1e4],"player.maxJumpTrauma":[.5,0,1],"player.jumpTraumaDivisor":[3e3,0,1e4],"player.invincible":[!1],"sun.downsamplesLeft":[0,null,function(e){return e.downsamples&&e.downsamples.length}],"level.replaceDelay":[2e3,0,1e4],"level.fadeOutFactor":[10,0,100],"effects.firstCrumble.tween":[{duration:200,ease:"Cubic.easeInOut",scaleX:1.05,dy:3,scaleY:.95,refreshPhysics:!0,yoyo:!0}],"effects.crumble.tween":[{duration:800,ease:"Quad.easeOut",dy:10,refreshPhysics:!0,scaleX:1.1,scaleY:.9,alpha:0}],"effects.attract.tween":[{duration:1e3,ease:"Cubic.easeInOut",dy:16,loop:999,yoyo:!0}],"effects.goodNight.tween":[{duration:1e3,ease:"Cubic.easeIn",dy:100,alpha:0}],"effects.playerDie.tween":[{duration:200,alpha:0}],"effects.playerDieHealthBar.tween":[{duration:200,dy:100,alpha:0}],"effects.buttonPress.tween":[{duration:500,ease:"Cubic.easeInOut",dy:16,refreshPhysics:!0,yoyo:!0}],"effects.drawbridge.tween":[{duration:1500,ease:"Bounce.easeOut",rotation:-90}],"effects.playerAsh.particles":[{image:"dot",blendMode:"ADD",accelerationY:2e3,lifespan:500,speedX:500,speedY:-1e3,frequency:1,quantity:5}],"effects.lightAsh.particles":[{image:"dot",blendMode:"ADD",accelerationY:2e3,lifespan:250,speedX:250,speedY:-500,frequency:100,quantity:1}],"effects.playerSmoke.particles":[{image:"smoke",blendMode:"ADD",accelerationY:-100,lifespan:1e3,speedX:100,speedY:-100,frequency:1,quantity:1}],"effects.stars.particles":[{image:"dot",blendMode:"ADD",lifespan:2e3,frequency:1e3,quantity:25,preemit:!0}],"effects.comet.particles":[{image:"dot",lifespan:250,frequency:1,quantity:10}]});l["scene.musicVolume"][0]=.66,l["scene.camera.lerp"][0]=.005,l["scene.camera.deadzoneX"][0]=200,l["scene.camera.deadzoneY"][0]=200;var u={".":null,"#":{image:"solid",group:"wall",combine:"#",isStatic:!0,shadow:!0},"|":{image:"translucent",group:"ground",combine:"|",preferCombineVertical:!0,isStatic:!0},I:{image:"solid",group:"wall",combine:"I",preferCombineVertical:!0,isStatic:!0,shadow:!0},_:{image:"translucent",group:"ground",combine:"_",isStatic:!0},"/":{image:"spinner",group:"spinner",shadow:!0},"\\":{image:"spinner",group:"reverseSpinner",shadow:!0},"@":{image:"player",group:"player"},"~":{image:"crumble",group:"crumble",isStatic:!0},n:{image:"button",group:"button",isStatic:!0},"=":{image:"drawbridge",group:"drawbridge",shadow:!0}};Object(i.g)(l,["dot","smoke"]);var h=new i.a(l),d=Object(i.f)(l,h);t.b=Object(i.b)(l,h)},42:function(e,t,n){"use strict";n.d(t,"a",function(){return b}),n.d(t,"c",function(){return C}),n.d(t,"f",function(){return D}),n.d(t,"b",function(){return M}),n.d(t,"g",function(){return R}),n.d(t,"e",function(){return x}),n.d(t,"d",function(){return A});var a,i=n(7),r=n(87),o=n(3),s=n(51),c=n.n(s),l=n(562),u=n(2),h=n(10),d=n(46),m={},p={},_=new Map,f={},g=(u.b,u.c),v=new Proxy({},{get:function(e,t){return g[t]},set:function(e,t,n){return g[t]=n,!0}});function b(){return a||(a=new l.a({autoPlace:!1}),Object.keys(u.d).forEach(function(e){return O(e)}),Object.keys(u.d).forEach(function(e){return j(e,u.d[e],!1,e in d.h||"".concat(e,"_enabled")in d.h)})),a}function y(e){return e.charAt(0).toUpperCase()+e.slice(1)}function O(e){for(var t=e.split("."),n="",i=a;t.length>1;){var r=t.shift();if(n+=".".concat(r),!m[n])m[n]=i.addFolder(r.split(/[-_ ]/).map(y).join(" ")),_.set(m[n],i),m[n].domElement.querySelector("li.title").addEventListener("click",function(){P()});i=m[n]}return i}var E=0;function w(){E||Object(h.d)("changedProps",f)}function S(e){f[e]=[u.c[e],u.d[e][0]],document.body.classList.add("changed-props")}function k(e){delete f[e],Object.keys(f).length||document.body.classList.remove("changed-props")}function j(e,t,n,a){var o=Object(r.a)(u.d[e]),s=o[0],c=o.slice(1),l=O(e);if(null===v[e])throw new Error("Prop ".concat(e," must not be initialized to null"));if(!e.endsWith("_enabled")){var h,d="".concat(e,"_enabled");if(c.length>=1&&null===c[0])(h=e.match(/color$/i)?l.addColor(v,e).listen():l.add(v,e).listen()).domElement.closest(".cr").classList.add("listen"),h.domElement.querySelectorAll("input, select").forEach(function(e){e.tabIndex=-1,e.onclick=function(e){e.preventDefault()}}),c.length>1&&"function"===typeof c[c.length-1]&&(h.__ldListenCallback=c[c.length-1]);else{var m;c.length>=1&&"function"===typeof c[c.length-1]&&(m=c.pop()),h=e.match(/color$/i)?l.addColor.apply(l,[v,e].concat(Object(i.a)(c))):l.add.apply(l,[v,e].concat(Object(i.a)(c))),m&&(h.__ldChangeCallback=m),"function"===typeof s&&(h.__ldActionCallback=s);var f,g,b=h.domElement.closest(".cr"),y=d in u.d?u.d[d][0]:null;if(d in u.c){g=u.c[d];var E=document.createElement("div");E.classList.add("toggle"),(f=document.createElement("input")).setAttribute("type","checkbox"),g&&(f.setAttribute("checked","checked"),f.checked=!0),E.appendChild(f),b.classList.add("disableable"),h.domElement.parentNode.appendChild(E),h.__ldEnabledSpec=u.d[d],f.onchange=function(t){t.preventDefault();var n=t.target.checked;u.c[d]=n,f.__suppressChange=!0;try{h.__onChange(u.c[e]),h.__onFinishChange(u.c[e])}catch(a){throw f.__suppressChange=!1,a}f.__suppressChange=!1}}if("function"!==typeof s){var j=document.createElement("div");j.classList.add("reset");var C=document.createElement("input");C.setAttribute("type","button"),C.value="\u293a",j.appendChild(C),h.domElement.parentNode.appendChild(j),C.onclick=function(t){t&&(t.preventDefault(),t.stopPropagation()),u.c[e]=s,f&&(f.__suppressChange=!0,u.c[d]=y,y?(f.setAttribute("checked","checked"),f.checked=!0):(f.removeAttribute("checked"),f.checked=!1)),h.updateDisplay();try{h.__onChange(u.c[e]),h.__onFinishChange(u.c[e])}catch(n){throw f&&(f.__suppressChange=!1),n}f&&(f.__suppressChange=!1)}}"function"!==typeof s&&(h.onFinishChange(function(t){try{window.game.topScene().propDidFinishChange(e,t),w()}catch(n){console.error(n)}}),h.onChange(function(t){var n;try{f&&!f.__suppressChange&&(u.c[d]=!0,f.setAttribute("checked","checked"),f.checked=!0);var a=window.game,i=a.topScene();i.propDidChange(e,t);var r=!1;f&&(u.c[d]!==y?(r=!0,S(d)):k(d)),t!==s?(r=!0,S(e)):k(e),w(),r?b.classList.add("changed"):b.classList.remove("changed"),h.__ldChangeCallback&&(n=h.__ldChangeCallback(t,i,a))}catch(o){console.error(o)}return n}),a&&(S(e),b.classList.add("changed")))}var T=h.domElement.closest(".cr");if(T.title=e,T.dataset.prop=e,p[e]=h,h.__ldSpec=t,n)for(var P=l;P;)P.open(),P=_.get(P);return h}var D=e.substr(0,e.length-"_enabled".length);if(!(D in u.d))throw new Error("Prop ".concat(e," does not have corresponding ").concat(D))}function C(){a.updateDisplay(),Object.values(m).forEach(function(e){return e.updateDisplay()})}var T=[];function P(){T.length=0,document.querySelectorAll(".Manage ul:not(.closed) > li.listen:not(.filtered)").forEach(function(e){var t=e.dataset.prop,n=u.d[t];T.push([t,n])})}function D(e){var t=window.game,n=t.topScene(),a=function(e){var a=Object(o.a)(e,2),i=a[0],r=a[1];if(null===r[1])if(r[2]){if("string"===typeof r[2])u.c[i]=c.a.get(t,r[2])||c.a.get(n,r[2]);else if("function"===typeof r[2])try{u.c[i]=r[2](t.topScene(),t)}catch(s){console.error(s)}}else u.c[i]=c.a.get(t,i)||c.a.get(n,i)};e?Object.entries(u.d).forEach(a):T.forEach(a)}function M(e){Object.entries(u.d).forEach(function(t){var n=Object(o.a)(t,2),a=n[0];null===n[1][1]&&(u.c[a]=e[a])})}function R(e,t){e;var n=function(e){var t=e.split(""),n=!1,a=t.map(function(e){return e!==e.toLowerCase()&&(n=!0),".*+?^${}()|[]\\".includes(e)?"\\".concat(e):e}).join(".*");if(e.startsWith("/")){try{return new RegExp(e.substring(1),n?"":"i")}catch(i){console.error(i)}return new RegExp("(?!)")}return new RegExp(a,n?"":"i")}(e),a=document.querySelector(".Manage .dg.main");""===e?(Object.values(m).forEach(function(e){return e.close()}),a.querySelectorAll(".filtered").forEach(function(e){e.classList.remove("filtered")})):(Object.values(m).forEach(function(e){t&&e.open(),e.domElement.classList.add("filtered")}),a.querySelectorAll("li[data-prop]").forEach(function(t){var a=!0;if("change"===e.toLowerCase()?t.classList.contains("changed")&&(a=!1):t.dataset.prop.match(n)&&(a=!1),a)t.classList.add("filtered");else for(var i=t;i;)i.classList.remove("filtered"),i=i.parentNode.closest(".filtered")})),P()}function x(){return Object.entries(f).map(function(e){var t=Object(o.a)(e,2),n=t[0],a=Object(o.a)(t[1],1)[0];return"propSpecs['".concat(n,"'][0] = ").concat(JSON.stringify(a),";")}).join("\n")}function A(){E+=1,document.querySelectorAll(".Manage .cr.changed .reset input").forEach(function(e){e.onclick()}),E-=1,w()}},46:function(e,t,n){"use strict";n.d(t,"h",function(){return _}),n.d(t,"c",function(){return v}),n.d(t,"d",function(){return O}),n.d(t,"e",function(){return E}),n.d(t,"g",function(){return w}),n.d(t,"a",function(){return S}),n.d(t,"f",function(){return k}),n.d(t,"b",function(){return j});var a,i=n(7),r=n(3),o=n(6),s=n(50),c=n(11),l=n.n(c),u=n(101),h=n(100),d=n(59),m=n(10),p=n(88),_=Object(m.b)("changedProps",{}),f=(a={},Object(s.a)(a,l.a.AUTO,"auto"),Object(s.a)(a,l.a.CANVAS,"canvas"),Object(s.a)(a,l.a.WEBGL,"webgl"),a),g=!1;function v(e,t,n){return g||Object.keys(e).forEach(function(t){e[t].debug&&delete e[t]}),Object(o.a)({"engine.time":[.01,null,"loop.time"],"engine.frameTime":[.01,null,"loop.delta"],"engine.actualFps":[.01,null,"loop.actualFps"],"engine.targetFps":[.01,null,"loop.targetFps"],"engine.renderer":[f[l.a.AUTO],null,function(e,t){return f[t.renderer.type]}],"engine.focused":[!1,null,"scene.game.focused"],"engine.throttle":[!1],"engine.stepping":[!1,function(e,t,n){return e?n.loop.sleep():n.loop.wake()}],"engine.step":[function(e,t){return t.prop("engine.stepping")&&t.loop.tick()}],"engine.clearLocalStorage":[function(){Object(m.c)(),Object(m.a)(),window.location=window.location}],"engine.clearGameState":[function(){Object(m.c)("game_"),Object(m.a)(),window.location=window.location}],"engine.disableDebugUI":[function(e,t){return t.disableDebugUI()}],"config.debug":[g,null,function(){return g}],"config.width":[0,null,function(e,t){return t.config.width}],"config.height":[0,null,function(e,t){return t.config.height}],"config.tileWidth":[0,null,function(e,t){return t.config.tileWidth}],"config.tileHeight":[0,null,function(e,t){return t.config.tileHeight}],"config.xBorder":[0,null,function(e,t){return e.xBorder}],"config.yBorder":[0,null,function(e,t){return e.xBorder}],"scene.count":["",null,"scene.scenes.length"],"scene.commandScenes":["",null,function(e){return e.command._scenes.size}],"scene.class":["",null,function(e){return e.constructor.name}],"scene.sceneId":["",null,"sceneId"],"scene.parentSceneId":["",null,"scene.settings.data.parentSceneId"],"scene.key":["",null,"scene.key"],"scene.seed":["",null,"scene.settings.data.seed"],"scene.scene_time":[.01,null,"scene_time"],"scene.music":["",null,"currentMusicName"],"scene.timeScale":[.01,null,"timeScale"],"scene.shaderName":["",null,"shaderName"],"scene.physicsFps":[.01,null,"physics.world.fps"],"scene.images":[0,null,function(e){return e.add.displayList.list.filter(function(e){return"Image"===e.type}).length}],"scene.sprites":[0,null,function(e){return e.add.displayList.list.filter(function(e){return"Sprite"===e.type}).length}],"scene.particles":[0,null,function(e){return e.add.displayList.list.filter(function(e){return"ParticleEmitterManager"===e.type}).length}],"scene.text":[0,null,function(e){return e.add.displayList.list.filter(function(e){return"Text"===e.type}).length}],"scene.sounds":[0,null,"sounds.length"],"scene.timers":[0,null,"timers.length"],"scene.physicsColliders":[0,null,"physics.world.colliders._active.length"],"scene.musicVolume":[1,0,1,function(e,t,n){n.changeVolume(n.volume)}],"scene.soundVolume":[1,0,1,function(e,t,n){n.changeVolume(n.volume)}],"scene.debugDraw":[!1,function(e,t){e?t.physics.world.createDebugGraphic():t.physics.world.debugGraphic.destroy()}],"scene.replaceWithSelf":[function(e){return e.replaceWithSelf(!1)}],"scene.camera.width":[0,null,"camera.width"],"scene.camera.height":[0,null,"camera.height"],"scene.camera.alpha":[.1,null,"camera.alpha"],"scene.camera.zoom":[.1,null,"camera.zoom"],"scene.camera.rotation":[.1,null,"camera.rotation"],"scene.camera.x":[0,null,"camera.x"],"scene.camera.y":[0,null,"camera.y"],"scene.camera.scrollX":[0,null,"camera.scrollX"],"scene.camera.scrollY":[0,null,"camera.scrollY"],"scene.camera.centerX":[0,null,"camera.centerX"],"scene.camera.centerY":[0,null,"camera.centerY"],"scene.camera.boundsX":[0,null,"camera._bounds.x"],"scene.camera.boundsY":[0,null,"camera._bounds.y"],"scene.camera.boundsWidth":[0,null,"camera._bounds.width"],"scene.camera.boundsHeight":[0,null,"camera._bounds.height"],"scene.camera.useBounds":[!0,null,"camera.useBounds"],"scene.camera.follow":["",null,C(function(e){return e.level},function(e){return e.camera._follow})],"scene.camera.followOffsetX":[0,null,"camera.followOffset.x"],"scene.camera.followOffsetY":[0,null,"camera.followOffset.y"],"scene.camera.lerp":[1,0,1,function(e,t){t.setCameraLerp()}],"scene.camera.deadzoneX":[0,0,1e3,function(e,t){t.setCameraDeadzone()}],"scene.camera.deadzoneY":[0,0,1e3,function(e,t){t.setCameraDeadzone()}],"scene.camera.hasBounds":[!0,function(e,t){t.setCameraBounds()}],"scene.trauma.amount":[.01,null,"_trauma"],"scene.trauma.shakeAmount":[.01,null,"_traumaShake"],"scene.trauma.decay":[.001,0,1],"scene.trauma.exponent":[2,0,4],"scene.trauma.dx":[30,0,100],"scene.trauma.dy":[30,0,100],"scene.trauma.dt":[.17,0,1],"scene.trauma.speed":[.2,0,1],"scene.trauma.easeIn":[100,0,1e3],"scene.trauma.legacy":[!1],"scene.trauma.mild":[function(e){return e.trauma(.2)}],"scene.trauma.minor":[function(e){return e.trauma(.5)}],"scene.trauma.major":[function(e){return e.trauma(.8)}],"scene.trauma.max":[function(e){return e.trauma(100)}],"scene.trauma.enabled":[!0]},function(e){var t={};return O(e).sort().forEach(function(e){t["command.keyboard.".concat(e)]=[!1,null]}),t}(e),{"command.gamepad.total":[0,null],"command.gamepad.A":[!1,null],"command.gamepad.B":[!1,null],"command.gamepad.X":[!1,null],"command.gamepad.Y":[!1,null],"command.gamepad.L1":[!1,null],"command.gamepad.L2":[!1,null],"command.gamepad.R1":[!1,null],"command.gamepad.R2":[!1,null],"command.gamepad.UP":[!1,null],"command.gamepad.DOWN":[!1,null],"command.gamepad.LEFT":[!1,null],"command.gamepad.RIGHT":[!1,null],"command.gamepad.LSTICKX":[.01,null],"command.gamepad.LSTICKY":[.01,null],"command.gamepad.RSTICKX":[.01,null],"command.gamepad.RSTICKY":[.01,null],"command.ignore_all.any":[!1,null,function(e){return e.command.ignoreAll()}],"command.ignore_all._transition":[!1,null,function(e){return e.command.ignoreAll("_transition")}],"command.ignore_all._sleep":[!1,null,function(e){return e.command.ignoreAll("_sleep")}]},function(e){var t={};return Object.entries(e).forEach(function(e){var n=Object(r.a)(e,2),a=n[0],i=n[1];if(t["command.".concat(a,".held")]=[!1,null],t["command.".concat(a,".started")]=[!1,null],t["command.".concat(a,".continued")]=[!1,null],t["command.".concat(a,".released")]=[!1,null],t["command.".concat(a,".heldFrames")]=[0,null],t["command.".concat(a,".releasedFrames")]=[0,null],t["command.".concat(a,".heldDuration")]=[0,null],t["command.".concat(a,".releasedDuration")]=[0,null],i.cooldown&&(t["command.".concat(a,".cooldown")]=[i.cooldown,0,1e5],t["command.".concat(a,".coolingDown")]=[!1,null,function(e){return e.command[a].coolingDown}],t["command.".concat(a,".coolingDownTime")]=[.01,null,function(e){return e.command[a].coolingDownTime}]),i.joystick&&(t["command.".concat(a,".x")]=[.01,null,function(e){return e.command[a].held[0]}],t["command.".concat(a,".y")]=[.01,null,function(e){return e.command[a].held[1]}]),t["command.".concat(a,".enabled")]=[!0],i.execute){var o="function"===typeof i.execute?function(e,t){return i.execute(e,t)}:function(e,t){return e[i.execute](e,t)};t["command.".concat(a,".execute")]=[o]}}),t}(e),Object(p.b)(t,n))}var b=["gamepad.A","gamepad.B","gamepad.X","gamepad.Y","gamepad.L1","gamepad.L2","gamepad.R1","gamepad.R2","gamepad.UP","gamepad.DOWN","gamepad.LEFT","gamepad.RIGHT","gamepad.LSTICK.UP","gamepad.LSTICK.DOWN","gamepad.LSTICK.LEFT","gamepad.LSTICK.RIGHT","gamepad.RSTICK.UP","gamepad.RSTICK.DOWN","gamepad.RSTICK.LEFT","gamepad.RSTICK.RIGHT","gamepad.LSTICK.RAW","gamepad.RSTICK.RAW"].concat(Object(i.a)(Object.keys(l.a.Input.Keyboard.KeyCodes).map(function(e){return"keyboard.".concat(e)}))).reduce(function(e,t){return e[t]=!0,e},{});function y(e,t,n){var a=[];return Object.entries(e).forEach(function(e){var i=Object(r.a)(e,2),o=i[0],s=i[1];s.input&&s.input.forEach(function(e){b[e]?e.startsWith(t)&&a.push(e.substr(t.length)):n||console.error("Unknown input path ".concat(e," for command ").concat(o))})}),a}function O(e,t){return y(e,"keyboard.",t)}function E(e,t){return y(e,"gamepad.",t)}function w(e,t){Object(u.b)(e,t),Object(h.b)(e,t),Object(d.d)(e,t)}function S(e){var t=this;Object.entries(e).forEach(function(e){var n=Object(r.a)(e,2),a=n[0],i=n[1];if(!Array.isArray(i))throw new Error("Invalid spec for prop ".concat(a,"; expected array, got ").concat(i));var o=Object(r.a)(i,1)[0];if("function"===typeof o){var s=o;o=function(){try{var e=window.game,t=e.topScene();t.command.recordPropExecution(a),s(t,e)}catch(n){console.error(n)}}}if(a in _){var c=Object(r.a)(_[a],2),l=c[0],u=c[1];JSON.stringify(o)===JSON.stringify(u)?o=l:delete _[a]}t[a]=o})}function k(e,t){if(g)return function(e){var n={};return Object.entries(t).forEach(function(t){var a=Object(r.a)(t,2),i=a[0],o=a[1];if(i.startsWith(e)){var s=i.substr(e.length);n[s]=o}}),n};var n={};return function(t,a){if(a&&(t?delete n[t]:Object.keys(n).forEach(function(e){return delete n[e]})),!n[t]){var i={};Object.entries(e).forEach(function(e){var n=Object(r.a)(e,2),a=n[0],o=n[1];if(a.startsWith(t)){var s=Object(r.a)(o,1)[0],c=a.substr(t.length);i[c]=s}}),n[t]=i}return n[t]}}function j(e,t){if(g){var n=t;return function(e,t){if(!t){if(!(e in n))throw new Error("Invalid prop named ".concat(e));return n[e]}n=t}}return function(t){return e[t][0]}}function C(e,t){var n,a;return function(){var i=t.apply(void 0,arguments);if(i===n)return a;if(n=i,!i)return a=i;if("object"===typeof i&&i.name)return a=i.name;var r=e.apply(void 0,arguments);if(r&&"object"===typeof r)for(var o in r){if(r[o]===i)return a=o}return a="object"===typeof i&&i.texture&&i.texture.key?i.texture.key:void 0}}},560:function(e,t,n){},563:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=!1;function i(e){if(!a){var t=e.physics.add.__proto__,n=t.sprite;t.sprite=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var i=n.call.apply(n,[this].concat(t));return i&&i.anims&&(i.anims.setTimeScale(i.scene.timeScale),i.anims.ignoresScenePause=!1),i},a=!0}}},564:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var a=!1;function i(e){if(a||!e)return a;var t=e.__proto__,n=t.update;return t.update=function(){if(!this.parent.scene._paused.anims||this.ignoresScenePause||this.currentAnim&&this.currentAnim.ignoresScenePause){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n.call.apply(n,[this].concat(t))}},a=!0}},565:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var a=n(185),i=n.n(a),r=n(2),o=new i.a("X"),s=new i.a("Y"),c=new i.a("T"),l=!1;function u(e){if(l||!e)return l;var t=e.__proto__,n=t.preRender;return t.preRender=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];if(n.call.apply(n,[this].concat(t)),!Object(r.b)("scene.trauma.legacy")&&Object(r.b)("scene.trauma.enabled")){var i=this.width,l=this.height,u=this.scene,h=u._traumaShake,d=u.time,m=u.timeScale,p=u._traumaStart,_=d.now;if(h){var f=_-p,g=f*Object(r.b)("scene.trauma.speed")/Math.pow(m,2),v=Math.min(1,f/(Object(r.b)("scene.trauma.easeIn")*m)),b=v*h*Object(r.b)("scene.trauma.dx")*o.noise2D(p,g),y=v*h*Object(r.b)("scene.trauma.dy")*s.noise2D(p,g),O=v*h*Object(r.b)("scene.trauma.dt")*c.noise2D(p,g),E=i/2,w=l/2;this.matrix.translate(E,w),this.matrix.rotate(O),this.matrix.translate(-E,-w),this.matrix.translate(b,y)}}},l=!0}},566:function(e,t,n){e.exports=n.p+"static/media/maps.8b4011d1.txt"},567:function(e,t,n){"use strict";n.r(t),n.d(t,"imageAssets",function(){return Z}),n.d(t,"spriteAssets",function(){return ee}),n.d(t,"musicAssets",function(){return te}),n.d(t,"soundAssets",function(){return ne});var a=n(568),i=n.n(a),r=n(569),o=n.n(r),s=n(570),c=n.n(s),l=n(571),u=n.n(l),h=n(572),d=n.n(h),m=n(573),p=n.n(m),_=n(574),f=n.n(_),g=n(575),v=n.n(g),b=n(576),y=n.n(b),O=n(577),E=n.n(O),w=n(578),S=n.n(w),k=n(579),j=n.n(k),C=n(580),T=n.n(C),P=n(581),D=n.n(P),M=n(582),R=n.n(M),x=n(583),A=n.n(x),L=n(584),I=n.n(L),F=n(585),B=n.n(F),W=n(586),U=n.n(W),K=n(587),N=n.n(K),Y=n(588),X=n.n(Y),z=n(589),q=n.n(z),V=n(590),G=n.n(V),H=n(591),J=n.n(H),Q=n(592),$=n.n(Q),Z={dot:i.a,bead:S.a,smoke:E.a,hpbar:o.a,button:f.a,drawbridge:v.a,drawbridgeAlt:y.a,spinner:j.a,translucent:u.a,solid:d.a},ee={player:{file:c.a,frameWidth:32,frameHeight:32},crumble:{file:p.a,frameWidth:74,frameHeight:24}},te={a:T.a,b:D.a,c:R.a,d:A.a},ne={explode:I.a,jump1:B.a,jump2:U.a,jump3:N.a,land:X.a,crisp:q.a,night:G.a,breaking:$.a,drawbridge:J.a}},568:function(e,t,n){e.exports=n.p+"static/media/dot.4b22b40e.png"},569:function(e,t,n){e.exports=n.p+"static/media/hpbar.043a32f4.png"},570:function(e,t,n){e.exports=n.p+"static/media/player.4dbc163f.png"},571:function(e,t,n){e.exports=n.p+"static/media/translucent.6e5072b6.png"},572:function(e,t,n){e.exports=n.p+"static/media/solid.0160712b.png"},573:function(e,t,n){e.exports=n.p+"static/media/crumble.667252ac.png"},574:function(e,t,n){e.exports=n.p+"static/media/button.ce98be2b.png"},575:function(e,t,n){e.exports=n.p+"static/media/drawbridge.47b5b6a3.png"},576:function(e,t,n){e.exports=n.p+"static/media/drawbridgeAlt.46940f8e.png"},577:function(e,t,n){e.exports=n.p+"static/media/smoke.ed2b177b.png"},578:function(e,t,n){e.exports=n.p+"static/media/bead.c1362c20.png"},579:function(e,t,n){e.exports=n.p+"static/media/spinner.4f869c95.png"},580:function(e,t,n){e.exports=n.p+"static/media/a.b1ad1e13.mp3"},581:function(e,t,n){e.exports=n.p+"static/media/b.7ebbb69e.mp3"},582:function(e,t,n){e.exports=n.p+"static/media/c.09259550.mp3"},583:function(e,t,n){e.exports=n.p+"static/media/d.85b63039.mp3"},584:function(e,t,n){e.exports=n.p+"static/media/explode.0b012912.wav"},585:function(e,t,n){e.exports=n.p+"static/media/jump1.e14ce3ec.wav"},586:function(e,t,n){e.exports=n.p+"static/media/jump2.c834a042.wav"},587:function(e,t,n){e.exports=n.p+"static/media/jump3.437195c5.wav"},588:function(e,t,n){e.exports=n.p+"static/media/land.83a53280.wav"},589:function(e,t,n){e.exports=n.p+"static/media/crisp.e9aff6f1.wav"},59:function(e,t,n){"use strict";n.d(t,"b",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"c",function(){return h}),n.d(t,"a",function(){return d});var a=n(7),i=n(6),r=n(3),o=["nothing","input","physics","everything"],s=["begin","delayEnd","cutover","complete","waitEnd"],c={animation:["fadeInOut",["fadeInOut","crossFade","pushLeft","pushRight","pushUp","pushDown","wipeLeft","wipeRight","wipeUp","wipeDown"]],delay_enabled:[!0],delay:[0,0,1e4],duration:[1e3,0,1e4],ease:["Linear",n(100).d],wait_enabled:[!0],wait:[0,0,1e4],oldPause:["input",o],oldPauseTime:["begin",s.filter(function(e){return"waitEnd"!==e})],newPause:["input",o],newUnpauseTime:["waitEnd",s],delayNewSceneShader:[!1],removeOldSceneShader:[!1],suppressShaderCheck:[!1],animated:[!0]},l={};function u(e){Object.entries(e).forEach(function(t){var n=Object(r.a)(t,2),o=n[0],s=n[1];if(o.endsWith(".transition")){var l=o.substr(0,o.length-".transition".length);if(!Array.isArray(s)||1!==s.length||"object"!==typeof s[0])throw new Error("Expected ".concat(o," prop to have the shape [{\u2026}]; did you mean to end it in .transition?"));delete e[o];var u=Object(r.a)(s,1)[0],h=Object(i.a)({},u);if(Object.entries(c).forEach(function(t){var n=Object(r.a)(t,2),i=n[0],o=n[1];if(i in u)e["".concat(l,".").concat(i)]=[u[i]].concat(Object(a.a)(o.slice(1))),delete h[i];else if(i.endsWith("_enabled")){var s=i.substr(0,i.length-"_enabled".length);e["".concat(l,".").concat(i)]=[s in u]}else e["".concat(l,".").concat(i)]=o}),e["".concat(l,".execute")]=[function(e,t){e.replaceWithSelf(!1,null,l)}],Object.keys(h).length)throw new Error("Got unexpected transition config settings: ".concat(Object.keys(h).join(", ")))}})}function h(e,t){var n=e.massageProps;return delete e.massageProps,Object.entries(e).forEach(function(n){var a=Object(r.a)(n,2),i=a[0],o=a[1];if(i.endsWith("_enabled")){var s=i.substr(0,i.length-"_enabled".length);o||t[s]||delete e[s],delete e[i]}}),n&&n(e),"animated"in e&&!e.animated&&(e.duration=0),delete e.animated,e}function d(e,t,n){return"nothing"===n?function(){}:"input"===n?(e.pauseInputForTransition(t),function(){e.unpauseInputForTransition(t)}):"physics"===n?(e.pausePhysicsForTransition(t),function(){e.unpausePhysicsForTransition(t)}):"everything"===n?(e.pauseEverythingForTransition(t),function(){e.unpauseEverythingForTransition(t)}):(console.error("Invalid transition pause '".concat(n,"'")),function(){})}Object.entries(c).forEach(function(e){var t=Object(r.a)(e,2),n=t[0],a=Object(r.a)(t[1],1)[0];l[n]=a})},590:function(e,t,n){e.exports=n.p+"static/media/night.91eec8db.wav"},591:function(e,t,n){e.exports=n.p+"static/media/drawbridge.66a092f2.wav"},592:function(e,t,n){e.exports=n.p+"static/media/break.c2acd27f.wav"},593:function(e,t,n){"use strict";n.d(t,"a",function(){return c});n(6);var a=n(3),i=n(7),r={imageAssets:"image",spriteAssets:"spritesheet",musicAssets:"audio",soundAssets:"audio"},o={imageAssets:function(e,t){e.load.textureManager.remove(t)},musicAssets:function(e,t){e.cache.audio.remove(t)}};function s(e,t,n,a){var o,s=e.game,c=r[t],l=function(e,t,n){if("spriteAssets"===e){if("string"===typeof n){var a=t.config,i=a.spriteWidth,r=a.spriteHeight;if(i&&r)return[n,{frameWidth:i,frameHeight:r}];var o=t.config;return[n,{frameWidth:o.tileWidth,frameHeight:o.tileHeight}]}return[n.file,n]}return[n]}(t,s,a);(o=e.load)[c].apply(o,[n].concat(Object(i.a)(l))),s.assets[t][n]=a}function c(e,t){var n=e.game;Object.entries(t).forEach(function(t){var i=Object(a.a)(t,2),o=i[0],c=i[1];r[o]?(n.assets[o]||(n.assets[o]={}),Object.entries(c).forEach(function(t){var n=Object(a.a)(t,2),i=n[0],r=n[1];s(e,o,i,r)})):console.error("No loader for assets of type ".concat(o))})}o.spriteAssets=o.imageAssets,o.soundAssets=o.musicAssets},594:function(e,t,n){e.exports=n.p+"static/media/cover.eac6fbb9.png"},595:function(e,t,n){e.exports=n.p+"static/media/twitchLogo.754c9f3b.png"},596:function(e,t,n){e.exports=n.p+"static/media/twitterLogo.5ee804a1.png"},598:function(e,t,n){e.exports=n(1514)},603:function(e,t,n){},604:function(e,t,n){},605:function(e,t,n){},606:function(e,t,n){},88:function(e,t,n){"use strict";n.d(t,"c",function(){return c}),n.d(t,"a",function(){return l}),n.d(t,"b",function(){return h});var a=n(7),i=n(87),r=n(3),o=[["shockwave",{time:["float",0,null],center:["vec2",[.5,.5],null],scale:["float",10,0,500],range:["float",.8,0,10],thickness:["float",.1,0,10],speed:["float",3,0,50],inner:["float",.09,0,1],dropoff:["float",40,0,500]},"\n      float shockwave_dt = (scene_time - shockwave_time) / 3333.0;\n      if (shockwave_time > 0.0 && shockwave_dt < 10.0) {\n        float dist = distance(uv, shockwave_center - camera_scroll);\n        float t = shockwave_dt * shockwave_speed;\n        if (dist <= t + shockwave_thickness && dist >= t - shockwave_thickness && dist >= shockwave_inner) {\n          float diff = dist - t;\n          float scaleDiff = 1.0 - pow(abs(diff * shockwave_scale), shockwave_range);\n          float diffTime = diff * scaleDiff;\n          vec2 diffTexCoord = normalize(uv - (shockwave_center - camera_scroll));\n          uv += (diffTexCoord * diffTime) / (t * dist * shockwave_dropoff);\n        }\n      }\n  "]],s=[["blur",{amount:["float",0,null]},"\n      if (blur_amount > 0.0) {\n        float b = blur_amount / resolution.x;\n        c *= 0.2270270270;\n        c += texture2D(uMainSampler, vec2(uv.x - 4.0*b, uv.y - 4.0*b)) * 0.0162162162;\n        c += texture2D(uMainSampler, vec2(uv.x - 3.0*b, uv.y - 3.0*b)) * 0.0540540541;\n        c += texture2D(uMainSampler, vec2(uv.x - 2.0*b, uv.y - 2.0*b)) * 0.1216216216;\n        c += texture2D(uMainSampler, vec2(uv.x - 1.0*b, uv.y - 1.0*b)) * 0.1945945946;\n        c += texture2D(uMainSampler, vec2(uv.x + 1.0*b, uv.y + 1.0*b)) * 0.1945945946;\n        c += texture2D(uMainSampler, vec2(uv.x + 2.0*b, uv.y + 2.0*b)) * 0.1216216216;\n        c += texture2D(uMainSampler, vec2(uv.x + 3.0*b, uv.y + 3.0*b)) * 0.0540540541;\n        c += texture2D(uMainSampler, vec2(uv.x + 4.0*b, uv.y + 4.0*b)) * 0.0162162162;\n      }\n  "],["aberration",{red:["vec2",[0,0],null],green:["vec2",[0,0],null],blue:["vec2",[0,0],null]},"\n    c.r += texture2D(uMainSampler, vec2(uv.x - aberration_red.x, uv.y - aberration_red.y)).r;\n    c.r -= texture2D(uMainSampler, vec2(uv.x + aberration_red.x, uv.y + aberration_red.y)).r;\n\n    c.g += texture2D(uMainSampler, vec2(uv.x - aberration_green.x, uv.y - aberration_green.y)).g;\n    c.g -= texture2D(uMainSampler, vec2(uv.x + aberration_green.x, uv.y + aberration_green.y)).g;\n\n    c.b += texture2D(uMainSampler, vec2(uv.x - aberration_blue.x, uv.y - aberration_blue.y)).b;\n    c.b -= texture2D(uMainSampler, vec2(uv.x + aberration_blue.x, uv.y + aberration_blue.y)).b;\n  "],["tint",{color:["rgba",[1,1,1,1]]},"\n      c.r *= tint_color.r * tint_color.a;\n      c.g *= tint_color.g * tint_color.a;\n      c.b *= tint_color.b * tint_color.a;\n  "]],c={float:[1,"float","setFloat1"],bool:[1,"float","setFloat1"],vec2:[2,"vec2","setFloat2v","x","y"],vec3:[3,"vec3","setFloat3v","x","y","z"],vec4:[4,"vec4","setFloat4v","x","y","z","w"],rgb:[3,"vec3","setFloat3v","r","g","b"],rgba:[4,"vec4","setFloat4v","r","g","b","a"]};function l(e,t,n){var a=Object(r.a)(n,1)[0];a||(a="float");var o=Object(i.a)(c[a]),s=o[0],l=o.slice(3);if("rgb"===a){var u="";return t.match(/color$/i)||(u="_color"),["shader.".concat(e,".").concat(t).concat(u)]}return"rgba"===a?["shader.".concat(e,".").concat(t,"_color"),"shader.".concat(e,".").concat(t,"_alpha")]:1===s?["shader.".concat(e,".").concat(t)]:l.map(function(n,a){return"shader.".concat(e,".").concat(t,"_").concat(n)})}function u(e,t){var n=s,i=o,c="shaderColorFragments",l="shaderCoordFragments";if(!e)return[];if(t){var u=[i,n];n=u[0],i=u[1];var h=[l,c];c=h[0],l=h[1]}if(0!==e.length)for(var d=0;d<e.length;d+=1)"string"===typeof e[d]&&function(){var t=e[d],a=n.find(function(e){var n=Object(r.a)(e,1)[0];return t===n});a?e[d]=a:(console.error("Unable to find builtin ".concat(c," '").concat(t,"'; available are: ").concat(n.map(function(e){return Object(r.a)(e,1)[0]}).join(", "))),i.find(function(e){var n=Object(r.a)(e,1)[0];return t===n})&&console.error("Perhaps you meant the builtin ".concat(l," '").concat(t,"'?")),e.splice(d,1),d-=1)}();else e.push.apply(e,Object(a.a)(n))}function h(e,t){var n={};return u(e,!0),u(t,!1),[].concat(Object(a.a)(e||[]),Object(a.a)(t||[])).forEach(function(e){var t=Object(r.a)(e,2),o=t[0],s=t[1];n["shader.".concat(o,".enabled")]=[!0,function(e,t,n){return n.recompileShaders()}],Object.entries(s).forEach(function(e){var t=Object(r.a)(e,2),s=t[0],l=t[1],u=Object(i.a)(l),h=u[0],d=u.slice(1),m="".concat(o,"_").concat(s);if(h||(h="float"),!c[h])throw new Error("Unknown type ".concat(h," for shader ").concat(m));var p=Object(i.a)(c[h]),_=p[0],f=p[2],g=p.slice(3);if(s.match(/color$/i)&&"rgb"!==h&&"rgba"!==h)throw new Error("Shader uniform ".concat(m," ends with /color$/i but it isn't using type rgb or rgba"));if("rgb"===h){if(d.length>2||0===d.length||!Array.isArray(d[0])||3!==d[0].length||2===d.length&&null!==d[1])throw new Error("Expected rgb shader uniform ".concat(m," to have shape ['rgb', [0.95, 0.25, 0.5]] or ['rgb', [0.95, 0.25, 0.5], null]"));var v="";s.match(/color$/i)||(v="_color"),null===d[1]?d.push(function(e){return e[m]?e[m].map(function(e){return 255*e}):void 0}):d.push(function(e,t,n){if(t.shader){var a=n.prop("shader.".concat(o,".").concat(s).concat(v)).map(function(e){return e/255});t.shader[f](m,a)}}),d[0]=d[0].map(function(e){return 255*e}),n["shader.".concat(o,".").concat(s).concat(v)]=d}else if("rgba"===h){if(d.length>2||0===d.length||!Array.isArray(d[0])||4!==d[0].length||2===d.length&&null!==d[1])throw new Error("Expected rgbs shader uniform ".concat(m," to have shape ['rgba', [0.95, 0.25, 0.5, 1]] or ['rgb', [0.95, 0.25, 0.5, 1], null]"));var b=[d[0].filter(function(e,t){return t<3})],y=[d[0][3]];if(null===d[1])b.push(null),y.push(null),b.push(function(e){return e[m]?e[m].filter(function(e,t){return t<3}).map(function(e){return 255*e}):void 0}),y.push(function(e){return e[m]?e[m][3]:void 0});else{y.push(0,1);var O=function(e,t,n){t.shader&&t.shader[f](m,[].concat(Object(a.a)(n.prop("shader.".concat(o,".").concat(s,"_color")).map(function(e){return e/255})),[n.prop("shader.".concat(o,".").concat(s,"_alpha"))]))};b.push(O),y.push(O)}b[0]=b[0].map(function(e){return 255*e}),n["shader.".concat(o,".").concat(s,"_color")]=b,n["shader.".concat(o,".").concat(s,"_alpha")]=y}else"bool"===h?(null===d[1]?d.push(function(e){return e[m]}):"function"!==typeof d[d.length-1]&&d.push(function(e,t){return t.shader&&t.shader[f](m,e?1:0)}),n["shader.".concat(o,".").concat(s)]=d):1===_?(null===d[1]?d.push(function(e){return e[m]}):"function"!==typeof d[d.length-1]&&d.push(function(e,t){return t.shader&&t.shader[f](m,e)}),0===d[0]&&null===d[1]&&(d[0]=.1),n["shader.".concat(o,".").concat(s)]=d):g.forEach(function(e,t){var i=Object(a.a)(d);i[0]=i[0][t],null===i[1]?i.push(function(e){return e[m]?e[m][t]:void 0}):"function"!==typeof i[i.length-1]&&i.push(function(e,t,n){if(t.shader){var a=g.map(function(e){return n.prop("shader.".concat(o,".").concat(s,"_").concat(e))});t.shader[f](m,a)}}),0===i[0]&&null===i[1]&&(i[0]=.1),n["shader.".concat(o,".").concat(s,"_").concat(e)]=i})})}),n}}},[[598,1,2]]]);
//# sourceMappingURL=main.daf47dd8.chunk.js.map