{"version":3,"sources":["scaffolding/lib/store.js","scaffolding/lib/tweens.js","scaffolding/lib/particles.js","scaffolding/Spinner.jsx","scaffolding/Controls.jsx","scaffolding/boot-scene.js","scaffolding/CommandManager.js","scaffolding/SuperGame.js","scaffolding/lib/vector.js","play-scene.js","game.js","scaffolding/Engine.jsx","scaffolding/Manage.jsx","scaffolding/DoubleEnder.jsx","scaffolding/Replay.jsx","scaffolding/Logging.jsx","scaffolding/Development.jsx","scaffolding/Production.jsx","scaffolding/Embed.jsx","scaffolding/App.jsx","scaffolding/index.jsx","scaffolding/SuperScene.js","scaffolding/lib/level-parser.js","props.js","scaffolding/lib/manage-gui.js","scaffolding/lib/props.js","scaffolding/lib/sprites.js","scaffolding/lib/anims.js","scaffolding/lib/camera.js","assets/maps.txt","assets/index.js","assets/dot.png","assets/hpbar.png","assets/player.png","assets/translucent.png","assets/solid.png","assets/crumble.png","assets/button.png","assets/drawbridge.png","assets/drawbridgeAlt.png","assets/smoke.png","assets/bead.png","assets/spinner.png","assets/a.mp3","assets/b.mp3","assets/c.mp3","assets/d.mp3","assets/explode.wav","assets/jump1.wav","assets/jump2.wav","assets/jump3.wav","assets/land.wav","assets/crisp.wav","scaffolding/lib/transitions.js","assets/night.wav","assets/drawbridge.wav","assets/break.wav","scaffolding/lib/assets.js","assets/cover.png","scaffolding/twitchLogo.png","scaffolding/twitterLogo.png","scaffolding/lib/shaders.js"],"names":["__webpack_require__","d","__webpack_exports__","freezeStorage","saveField","removeAllFields","loadField","_package_json__WEBPACK_IMPORTED_MODULE_0__","prefix","concat","project","frozen","name","value","payload","JSON","stringify","localStorage","setItem","e","console","error","subprefix","arguments","length","undefined","Object","keys","forEach","key","startsWith","removeItem","defaultValue","getItem","parse","tweenEases","defaultTweenProps","delay_enabled","delay","duration","ease","dx_enabled","dx","dy_enabled","dy","alpha_enabled","alpha","rotation_enabled","rotation","scaleX_enabled","scaleX","scaleY_enabled","scaleY","yoyo","loop","ignoresScenePause","refreshPhysics","destroyOnComplete","animated","expandTweenProps","props","entries","_ref","_ref2","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__","spec","endsWith","substr","Array","isArray","Error","config","seen","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__","_ref3","_ref4","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__","slice","targetKey","join","massageTweenProps","target","_ref5","options","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__","massageProps","_ref6","_ref7","main","targets","onComplete","apply","destroy","x","y","originalX","originalY","onUpdate","body","refreshBody","Math","PI","injected","injectTweenManagerAdd","tweens","proto","__proto__","origAdd","add","tween","call","this","ParticleProps","particlePropFromProp","prop","find","p","injectedEmitterOpSeededRandom","injectEmitterOpSeededRandom","emitter","seed","rnd","Phaser","RandomDataGenerator","randomStaticValueEmit","particle","randomIndex","floor","frac","propertyValue","randomRangedValueEmit","realInRange","start","end","data","min","injectedParticleEmitterManagerPreUpdate","injectParticleEmitterManagerPreUpdate","manager","preUpdate","time","origDelta","isPaused","scene","_paused","particles","delta","timeScale","emitters","list","i","updatesOnceOnPause","active","defaultParticleProps","image","frequency","lifespan","accelerationX","accelerationY","blendMode","maxParticles","particleBringToTop","quantity","radial","rotate","speed","speedX","speedY","tint","tint_enabled","visible","preemit","preemitOnReload","expandParticleProps","particleImages","push","propKey","replace","massageParticleProps","onAdd","tintColor_enabled","tintColor","Spinner","react_default","a","createElement","id","className","React","Component","Controls","_this$props","onMouseMove","volume","onVolumeChange","disableFullscreen","isFullscreen","enterFullscreen","exitFullscreen","style","fontSize","transform","type","max","onChange","onMouseUp","blur","onClick","BootScene","classCallCheck","possibleConstructorReturn","getPrototypeOf","_this","get","prototype","game","preloadScenes","sceneClass","preload","_this2","initializeShaders","setTimeout","preloadComplete","SuperScene","GamepadButtons","LEFT","RIGHT","UP","DOWN","A","Y","X","B","L1","L2","R1","R2","ButtonName","CommandManager","_spec","_scenes","Map","keyboard","gamepad","pointerEvents","executedProps","_ignoreAlls","held","heldFrames","started","continued","heldDuration","releasedFrames","released","releasedDuration","cooldown","coolingDown","coolingDownTime","state","inputs","ignoreAlls","objectSpread","_this3","toConsumableArray","values","suppressRepeatFrames","set","commands","debug","tickCount","delete","code","_this4","input","on","tag","document","activeElement","tagName","toLowerCase","altKey","ctrlKey","metaKey","shiftKey","preventDefault","_this5","commandKeys","attachKey","button","buttonName","index","slicedToArray","method","canvas","querySelector","pointer","contains","scenes","seenGamepad","rawGamepad","total","LSTICKX","LSTICKY","RSTICKX","RSTICKY","gamepads","filter","pad","rawPad","leftStick","rightStick","abs","onlyUnignorable","_this6","frame","_repeat","unignorable","path","keyHeld","_","_pointer","_executedProps","_this7","_ref8","unreplayable","_this8","_ref9","_ref10","prevFrame","isSame","pop","newValue","ignoreAny","ignore","dt","_this9","ignoreAll","_ref11","_ref12","command","execute","scenePath","gamePath","event","handlePointerEvent","replay","propName","fn","replayFrameIndex","replayTicks","postflightCutoff","endedReplay","replayRepeatRun","replayFrame","heldCommands","mergeUnignorable","getManager","timeSightFrozen","processCommands","injectReplayFrame","addFrameToList","recording","originalPreflightCutoff","preflightCutoff","replayOptions","startTick","onEnd","onStop","next","prev","updateSpecFromReload","updateInputsFromReload","addCommands","removeCommands","updateCommands","_ref13","_ref14","prevJson","_ref15","_ref16","String","nextJson","_ref17","_ref18","changes","info","isKeyboard","_this10","nextKeys","prevKeys","keyLister","gamepadKeys","addKeys","removeKeys","managerList","detachKey","baseConfig","AUTO","parent","width","height","tileWidth","tileHeight","SuperGame","subConfig","Date","now","sceneId","random","scale","onFullScreenChange","_replayPreflight","_onDisableDebugUI","_sceneInitCallbacks","assets","_initializeShaderStructures","shaderCoordFragments","shaderColorFragments","shaderPipelines","focused","_sceneConstructors","assertThisInitialized","window","Proxy","topScene","events","readRawInput","disableDebug","_replay","timeSight","updatePropsFromStep","begin","getTime","pipelineName","bothFragmentTypes","_shaderPipelines","coordFragments","colorFragments","pipelines","_shaderSource","allFragments","out","setupPipeline","fragmentNames","coords","colors","fragmentName","coordFragment","colorFragment","map","newVolume","currentMusicPlayer","setVolume","changeVolume","isFocused","spinner","getElementById","parentNode","removeChild","_preloadedAssets","tryLaunch","callback","_activatedGame","_launchedGame","_launchingGame","warn","renderer","CANVAS","alert","cover","remove","launch","willTransitionFrom","timer","didTransitionFrom","manage","log","stopRecording","stopReplay","engine","disableDebugUI","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","number","zeros","n","o","date","zero","zeroPrefix","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","m","s","toFixed","_recording","timestamp","initData","settings","sceneName","constructor","renderDateTime","commandState","freezeCommandState","beginRecording","snapshot","onRecordBegin","onRecordStop","startFromTransition","sceneTransitions","transitionToSceneToBeginReplay","then","newScene","beginReplay","onReplayBegin","oldScene","sceneKey","sceneSaveState","save","returnPromise","Promise","resolve","reject","onSceneInit","thawCommandState","_sceneTransition","transition","onReplayEnd","skipDownward","onReplayStop","forceRestart","currentMusicName","music","sound","play","readRawGamepad","cutoffTimeSightEnter","cutoffTimeSightChanged","cutoffTimeSightLeave","shaderName","WEBGL","getPipeline","hasPipeline","source","generateShaderSource","shader","shaderInstantiation","removePipeline","addPipeline","setFloat2","initializeShader","nextCoord","nextColor","nextPipelines","recompileShaders","_bothFragmentTypes$ma","fragments","_bothFragmentTypes$ma2","shaderCoordSource","shaderColorSource","uniformNames","uniformDeclarations","_ref19","uniforms","_ref20","_ref21","uniformName","uniformType","shaderTypeMeta","userShaderBody","generateShaderSourceInternal","regex","RegExp","match","oldSource","newSource","shaderInstance","_shaderInitialize","_shaderUpdate","camera","setPipeline","clearRenderToTexture","recompileShader","disableShader","fragShader","Class","Extends","Renderer","WebGL","Pipelines","TextureTintPipeline","initialize","cb","Game","Distance","sqrt","pow","Illuminated","illuminated","Lamp","PolygonObject","DarkMask","Vec2","Lighting","Downsamples","AmbientSamples","shift","OldAmbient","Downsample","t","PlayScene","physics","arcade","fps","downsamples","performanceProps","resampleSuns","mapsAreRectangular","suns","createdAt","deaths","level","rect","lightX","lightY","vecs","originX","originY","offsetX","offsetY","overrideScaleX","overrideScaleY","w","h","_Phaser$Math$RotateAr","RotateAround","newX","newY","lightKey","lightWidth","lightHeight","lightTexture","textures","createCanvas","setOrigin","setDepth","objects","backwards","bead","corona","position","color","distance","radius","samples","ambient","lamps","lightings","light","dark","lights","flatMap","owner","border","sprite","fill","healthBar","setCrop","percent","player","lightAsh","particleSystem","follow","smoker","stars","randBetween","comet","randFloat","setScale","tweenPercent","nx","ny","stop","levelId","levelIds","groups","setGravityY","anims","cameraFollow","createHealthBar","createSmoker","createStars","scheduleComet","blockingObjects","_level$blockingObject","group","shadow","obj","setImmovable","setAngularVelocity","pushable","angle","enable","alternate","create","shadowObjects","levelIndex","saveState","respawn","createLevel","createLightCanvas","illObjects","occ","points","rotatedVecs","createSun","dualSun","hud","createHud","setupPhysics","spawn","lastLevel","label","speak","hi","noOut","wall","ground","crumble","drawbridge","collider","block","crumbling","playSound","disableBody","pressingButton","toggling","pressed","frames","repeat","frameRate","stickInput","touching","down","lastTouchDown","canJump","isJumping","jump","hasLiftedOff","hasReleasedJump","jumpStart","setVelocityY","velocity","right","left","lstick","_command$lstick$held","rstick","_command$rstick$held","_NormalizeVector","NormalizeVector","_NormalizeVector2","vx","setVelocityX","setFlipX","vy","targetX","targetY","_player$body$velocity","sx","sy","touchingDown","previousVelocityY","trauma","firstKey","lastKey","splineKey","Vector2","Curves","Spline","winning","getPoint","reverseSpinner","bounds","getBounds","some","i1","i2","p1","p2","edge","Geom","Line","Intersects","LineToRectangle","playerX","playerY","touchingSunrays","sun","_this8$sunPosition","sunPosition","_this8$sunPosition2","sunX","sunY","ray","Length","sunray","LineToLine","sunSpeed","invincible","processInput","processJumping","moveShadowObjects","playerDying","spinnered","playerDie","crispingSuns","crispingSun","crispTime","crispPercent","lastCrisp","desiredTimeScale","desiredZoom","minTrauma","factor","zoom","lighting","explode","unlightObject","shockwave","replaceWithSelf","animation","delayNewSceneShader","removeOldSceneShader","renderLights","updateHealthBarFor","goToLevel","_this11","dynamic","images","tiles","object","bye","ciao","scrollFactor","onExit","_this12","ctx","context","refresh","clearRect","_this12$sunPosition","_this12$sunPosition2","pos","lamp","wonLevel","Display","Color","Interpolate","ColorWithColor","r","g","b","coronaAlpha","sin","compute","fillStyle","fillRect","globalCompositeOperation","render","phantomDt","isLast","timeSightX","timeSightY","prevX","prevY","phantom","scrollX","scrollY","transparent","render.transparent","Engine","didVisibilityChange","hidden","visibilityState","setState","setFocused","didBlur","didFocus","activating","activated","controls","createRef","loadedGame","addEventListener","classList","activateGame","removeEventListener","moveTimeout","clearTimeout","clearMove","instant","current","overflow","resizeHandler","_this6$game$config","innerWidth","innerHeight","fullscreenHandler","requestFullscreen","mozRequestFullScreen","webkitRequestFullScreen","msRequestFullscreen","skipBrowserFullscreen","moveHandler","_this$state","classes","ref","container","gameContainerRef","backgroundImage","Spinner_Spinner","Controls_Controls","v","Manage","search","gui","initializeManage","append","domElement","updateSearch","tempNode","serializeChangedProps","appendChild","select","execCommand","placeholder","isStarted","copyChangedProps","resetChangedProps","semiFloor","semiCeil","ceil","DoubleEnder","didResize","forceUpdate","dragging","lastDrag","trackRef","cursorRef","refreshDimensions","updateReplayCursor","updateCursor","replayTimestamp","trackWidth","getBoundingClientRect","cursorPercent","display","_this$props2","value1","value2","onChange1","onChange2","onMouseEnter","onMouseLeave","onBeginChange","onEndChange","notches","highlight1","highlight2","cursor","trackDimensions","trackLeft","percent1","percent2","highlightPercent1","highlightPercent2","title","isSelected","isHighlighted","opposite","oppositeValue","zIndex","onMouseDown","clientX","_dragListener","rawValue","_upListener","ReplayEditFields","Replay","replays","preflight","reduce","cutoff","activeRecording","activeReplay","tweaking","editing","beginAutoReplay","installGameCallbacks","prevProps","clearOtherEditing","_replayLatestTransition","setEditing","_trashNextRecording","_this3$state","skipFocus","saveReplays","newReplays","setActiveReplay","newReplay","newState","updateReplay","metadata","field","_objectSpread2","defineProperty","updateTweak","sawError","toString","latestTransition","firstTick","lastTick","onSubmit","finishEdit","autoFocus","editName","tweakReplay","copyReplay","deleteReplay","DoubleEnder_DoubleEnder","_inCutoffs","_changingCutoffs","editPreflightCutoff","postflight","editPostflightCutoff","editCutoffs","discardTweaks","saveTweaks","visibility","revertTweak","renderTweaking","Fragment","toggleRepeat","toggleTimeSight","trashRecording","renderEditReplay","Logging","line","recent","old","logId","Number","timers","original","component","_len","args","_key","extractContext","prependLog","onDisableDebugUI","removeLogging","msg","stack","originalMsg","scrollTop","newLog","Development","Engine_Engine","Logging_Logging","developmentDisplay","links","href","rel","Manage_Manage","Replay_Replay","Production","productionDisplay","displayName","authorName","authorURL","authorTwitter","src","twitterLogo","alt","authorTwitch","twitchLogo","eventDescription","eventNamePre","eventNameBold","eventNamePost","eventURL","themeDescription","themePre","themeItalic","themePost","repoURL","Embed","App","embed","Embed_Embed","Development_Development","Production_Production","hot","ReactDOM","scaffolding_App","process","subconfig","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_4__","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_3__","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_6__","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_7__","sounds","performanceFrames","performanceAcceptable","scene_time","shockwave_time","_trauma","_traumaShake","_renderDelta","_this$game$config","halfWidth","halfHeight","attachScene","_timeSightTarget","cameras","cameraColor","setBackgroundColor","injectCameraShake","saveStateFieldName","initialSaveState","version","saveStateVersion","migrateSaveState","_initialSave","world","injectAddSpriteTimeScale","createDebugGraphic","fixedUpdate","systems","off","update","originalStep","step","originalDelta","_didRenderDelta","_stepExceptions","isTopScene","updateTweens","timeSightMouseDrag","updateTimers","recoverPerformance","pauseOnBlur","particleSystems","sys","parentSceneId","mapWidth","mapHeight","xBorder","yBorder","sceneDidInit","originalSave","vendRNG","attachInputs","startedAt","setupAnimations","_setupShader","setRenderToTexture","load","text","mapsFile","preloadAssets","_ldMapFiles","parseMaps","cache","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","mapFiles","findIndex","_spec2","lines","_parseLevelLines","parseLevelLines","mapText","lookups","heightInTiles","widthInTiles","mapLookups","background","setPosition","underground","createUnderground","template","isPowerOfTwo","_this$game$config2","tileSprite","tilePositionX","tilePositionY","script","executeScript","_execute","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toArray__WEBPACK_IMPORTED_MODULE_0__","fontFamily","fontWeight","textSize","textColor","stroke","setStroke","strokeColor","strokeWidth","yc","xc","isInteger","xCoord","yCoord","_inTime$outTime$durat","inTime","outTime","extraDelay","ox","oy","dx1","dy1","xl","yl","xo","yo","lx","ly","setScrollFactor","loadLevel","addMap","groupName","rectangle","isCircle","setCircle","tileDefinitions","isStatic","staticGroup","combine","row","tile","glyph","_this5$positionToScre","positionToScreenCoordinate","_this5$positionToScre2","combiner","createTileForGroup","preferCombineVertical","dxPrimary","dyPrimary","dxSecondary","dySecondary","sort","chains","combineWith","dxNext","dyNext","primary","secondary","chainTiles","first","last","_this5$positionToScre3","_this5$positionToScre4","x0","y0","_this5$positionToScre5","_this5$positionToScre6","x1","y1","boundsWidth","boundsHeight","setBounds","removeBounds","setDeadzone","setLerp","setCameraBounds","setCameraDeadzone","setCameraLerp","scripts","_firstUpdated","firstUpdate","renderUpdate","positionBackground","positionUnderground","levelWidth","levelHeight","_game$config","gameWidth","gameHeight","backgroundWidth","backgroundHeight","xDivisor","xFactor","yDivisor","yFactor","initializeListeners","shaderInitialize","shaderFragments","_spec3","listenerInitial","initialValue","setter","propNames","propNamesForUniform","_initialValue","c","shaderUpdate","_ref12$","listenerIfNull","eval","reseed","originalTransition","_isTransitioning","_replayOptions","_transitionProps","willTransitionTo","replaceWithSceneNamed","oldPauseTime","newUnpauseTime","newUnpauseFn","swapScenes","_hasCutover","cutoverPrimary","overrideSwapScenes","onCutover","applyPause","oldPause","playMusicIfSet","bringToTop","_hasCompleted","completeTransition","didTransitionTo","onWaitEnd","wait","animate","tweenInOut","firstHalf","followupTween","suppressShaderCheck","_this$game$config3","newCamera","oldCamera","_this$game$config4","firstCall","setSize","newPause","oldAnimate","onDelayEnd","maxLifespan","staticValueEmit","j","emitParticle","ignoreTimeScale","pauseEverythingForSleep","unpauseEverythingForSleep","ignoresTimeScale","performance","sleep","setVisible","hasPreflight","timeSightFrameCallback","resetDelta","calculateTimeSight","_timeSightTargetEnded","_timeSightTargetDone","isPostflight","wake","_timeSightFrames","setActive","launchTimeSight","targetScene","objectDt","frameTime","frameDt","isPreflight","timeSightTargetStep","beginTimeSightAlphaAnimation","_this13","renderTimeSightFrameInto","manageableProps","_timeSightAlpha","_timeSightFrame","loopAlpha","_this14","activeFrames","overrideProps","_timeSightAlphaTween","addEvent","_timeSightMouseInput","topOnly","setInteractive","activeObject","matchedFrame","_timeSightRemoveFocusTimer","_active","_add","_skipFreezeTimeSight","displayList","node","pause","_this15","f","tick","replayParticleSystems","changedKey","_this16","moribund","killAll","reloadAnimations","removeAnimations","playMusic","_len2","_key2","_this17","bodies","gameObject","_this18","currentAnim","reloadSeed","propsWithPrefix","emitterProps","createEmitter","preemitEmitter","params","baseTransitionProps","massageTransitionProps","startPoint","addCounter","from","to","getValue","fieldName","_this19","inDuration","outDuration","onMidpoint","_this20","inEase","outEase","_this21","_len3","_key3","sustainDuration","onSustain","onOut","_this22","_this23","tweenSustain","_len4","_key4","_len5","_key5","amount","_traumaStart","newTrauma","shake","_this$game$config5","intensity","baseName","variants","_this24","isVisible","requestedVolume","multiplier","musicName","_this25","newTimers","origDt","_destroy","_toProcess","_this26","actualFps","applyPropChanges","refreshUI","particleProp","batch","changedProps","setProp","propSpecs","changeCallback","change","disableShaders","camelName","charAt","toUpperCase","debugMethod","lerp","startFollow","stopFollow","shockwave_center","activePointer","isDown","_timeSightMouseDragX","_timeSightMouseDragY","pauseInputForTransition","pauseAllAnimations","pauseInputForSleep","unpauseInputForTransition","resumeAllAnimations","unpauseInputForSleep","pausePhysicsForTransition","pauseAllParticleSystems","pauseAllTweens","unpausePhysicsForTransition","resumeAllParticleSystems","resumeAllTweens","pausePhysicsForSleep","unpausePhysicsForSleep","_this27","_injectedAnimsUpdate","injectAnimationUpdate","resume","detachScene","_timeScale","setTimeScale","Scene","tileSpecs","content","maps","allLines","split","mapLines","configLines","prevLineIsEmpty","parsingConfig","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__","isRectangular","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","newDefinitions","previousTileSpecs","specs","_inherit","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__","nodes","unshift","assign","flattenInheritance","leftoverKeys","oldValue","deepEqual","updateTileDefinitions","joystick","shadows","restart","quit","recordCycle","skip","win","builtinPropSpecs","command.ignore_all.spawn","command.ignore_all.dying","command.ignore_all.winning","player.speed","player.drag","player.gravityBase","player.baseJumpVelocity","player.touchingDown","player.isJumping","player.hasLiftedOff","player.hasReleasedJump","player.jumpStart","player.maxJumpTime","player.maxJumpTrauma","player.jumpTraumaDivisor","player.invincible","sun.downsamplesLeft","level.replaceDelay","level.fadeOutFactor","effects.firstCrumble.tween","effects.crumble.tween","effects.attract.tween","effects.goodNight.tween","effects.playerDie.tween","effects.playerDieHealthBar.tween","effects.buttonPress.tween","effects.drawbridge.tween","effects.playerAsh.particles","effects.lightAsh.particles","effects.playerSmoke.particles","effects.stars.particles","effects.comet.particles",".","#","|","I","/","\\","@","~","=","preprocessPropSpecs","ManageableProps","makePropsWithPrefix","PropLoader","folders","controllers","parentOfFolder","proxiedManageableProps","manageablePropsProxy","dat","autoPlace","addNestedFolder","addController","savedChangedProps","upcase","word","sections","folderKey","folder","section","addFolder","regenerateListenPropsCache","batchSaveChangedProps","saveChangedProps","setChangedProp","setUnchangedProp","open","saved","_propSpecs$key","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toArray__WEBPACK_IMPORTED_MODULE_1__","originalValue","controller","enabledKey","addColor","listen","closest","querySelectorAll","tabIndex","onclick","__ldListenCallback","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","__ldChangeCallback","__ldActionCallback","enabledCheckbox","enabledValue","crNode","originalEnabled","setAttribute","checked","__ldEnabledSpec","onchange","__suppressChange","__onChange","__onFinishChange","err","resetButton","stopPropagation","removeAttribute","updateDisplay","onFinishChange","propDidFinishChange","ret","propDidChange","isChanged","dataset","__ldSpec","listenPropsCache","skipCache","updateProp","newProps","query","queryRegex","characters","hasUppercase","subsequence","character","includes","substring","queryize","close","isFiltered","rendererName","_rendererName","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__","engine.time","engine.frameTime","engine.actualFps","engine.targetFps","engine.renderer","engine.focused","engine.throttle","engine.stepping","engine.step","engine.clearLocalStorage","location","engine.clearGameState","engine.disableDebugUI","config.debug","config.width","config.height","config.tileWidth","config.tileHeight","config.xBorder","config.yBorder","scene.count","scene.commandScenes","size","scene.class","scene.sceneId","scene.parentSceneId","scene.key","scene.seed","scene.scene_time","scene.music","scene.timeScale","scene.shaderName","scene.physicsFps","scene.images","scene.sprites","scene.particles","scene.text","scene.sounds","scene.timers","scene.physicsColliders","scene.musicVolume","scene.soundVolume","scene.debugDraw","debugGraphic","scene.replaceWithSelf","scene.camera.width","scene.camera.height","scene.camera.alpha","scene.camera.zoom","scene.camera.rotation","scene.camera.x","scene.camera.y","scene.camera.scrollX","scene.camera.scrollY","scene.camera.centerX","scene.camera.centerY","scene.camera.boundsX","scene.camera.boundsY","scene.camera.boundsWidth","scene.camera.boundsHeight","scene.camera.useBounds","scene.camera.follow","objectIdentifier","_follow","scene.camera.followOffsetX","scene.camera.followOffsetY","scene.camera.lerp","scene.camera.deadzoneX","scene.camera.deadzoneY","scene.camera.hasBounds","scene.trauma.amount","scene.trauma.shakeAmount","scene.trauma.decay","scene.trauma.exponent","scene.trauma.dx","scene.trauma.dy","scene.trauma.dt","scene.trauma.speed","scene.trauma.easeIn","scene.trauma.legacy","scene.trauma.mild","scene.trauma.minor","scene.trauma.major","scene.trauma.max","scene.trauma.enabled","commandKeyProps","command.gamepad.total","command.gamepad.A","command.gamepad.B","command.gamepad.X","command.gamepad.Y","command.gamepad.L1","command.gamepad.L2","command.gamepad.R1","command.gamepad.R2","command.gamepad.UP","command.gamepad.DOWN","command.gamepad.LEFT","command.gamepad.RIGHT","command.gamepad.LSTICKX","command.gamepad.LSTICKY","command.gamepad.RSTICKX","command.gamepad.RSTICKY","command.ignore_all.any","command.ignore_all._transition","command.ignore_all._sleep","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__","commandProps","shaderProps","knownInputs","Input","Keyboard","KeyCodes","keysWithPrefix","skipWarning","inputPath","expandTransitionProps","recordPropExecution","_savedChangedProps$ke","clearCache","getContainer","getObject","cacheInput","cacheOutput","texture","origUpdate","simplex_noise__WEBPACK_IMPORTED_MODULE_0__","simplex_noise__WEBPACK_IMPORTED_MODULE_0___default","_props__WEBPACK_IMPORTED_MODULE_1__","noiseX","SimplexNoise","noiseY","noiseT","origPreRender","preRender","easeIn","noise2D","matrix","translate","module","exports","imageAssets","spriteAssets","musicAssets","soundAssets","_dot_png__WEBPACK_IMPORTED_MODULE_0__","_dot_png__WEBPACK_IMPORTED_MODULE_0___default","_hpbar_png__WEBPACK_IMPORTED_MODULE_1__","_hpbar_png__WEBPACK_IMPORTED_MODULE_1___default","_player_png__WEBPACK_IMPORTED_MODULE_2__","_player_png__WEBPACK_IMPORTED_MODULE_2___default","_translucent_png__WEBPACK_IMPORTED_MODULE_3__","_translucent_png__WEBPACK_IMPORTED_MODULE_3___default","_solid_png__WEBPACK_IMPORTED_MODULE_4__","_solid_png__WEBPACK_IMPORTED_MODULE_4___default","_crumble_png__WEBPACK_IMPORTED_MODULE_5__","_crumble_png__WEBPACK_IMPORTED_MODULE_5___default","_button_png__WEBPACK_IMPORTED_MODULE_6__","_button_png__WEBPACK_IMPORTED_MODULE_6___default","_drawbridge_png__WEBPACK_IMPORTED_MODULE_7__","_drawbridge_png__WEBPACK_IMPORTED_MODULE_7___default","_drawbridgeAlt_png__WEBPACK_IMPORTED_MODULE_8__","_drawbridgeAlt_png__WEBPACK_IMPORTED_MODULE_8___default","_smoke_png__WEBPACK_IMPORTED_MODULE_9__","_smoke_png__WEBPACK_IMPORTED_MODULE_9___default","_bead_png__WEBPACK_IMPORTED_MODULE_10__","_bead_png__WEBPACK_IMPORTED_MODULE_10___default","_spinner_png__WEBPACK_IMPORTED_MODULE_11__","_spinner_png__WEBPACK_IMPORTED_MODULE_11___default","_a_mp3__WEBPACK_IMPORTED_MODULE_12__","_a_mp3__WEBPACK_IMPORTED_MODULE_12___default","_b_mp3__WEBPACK_IMPORTED_MODULE_13__","_b_mp3__WEBPACK_IMPORTED_MODULE_13___default","_c_mp3__WEBPACK_IMPORTED_MODULE_14__","_c_mp3__WEBPACK_IMPORTED_MODULE_14___default","_d_mp3__WEBPACK_IMPORTED_MODULE_15__","_d_mp3__WEBPACK_IMPORTED_MODULE_15___default","_explode_wav__WEBPACK_IMPORTED_MODULE_16__","_explode_wav__WEBPACK_IMPORTED_MODULE_16___default","_jump1_wav__WEBPACK_IMPORTED_MODULE_17__","_jump1_wav__WEBPACK_IMPORTED_MODULE_17___default","_jump2_wav__WEBPACK_IMPORTED_MODULE_18__","_jump2_wav__WEBPACK_IMPORTED_MODULE_18___default","_jump3_wav__WEBPACK_IMPORTED_MODULE_19__","_jump3_wav__WEBPACK_IMPORTED_MODULE_19___default","_land_wav__WEBPACK_IMPORTED_MODULE_20__","_land_wav__WEBPACK_IMPORTED_MODULE_20___default","_crisp_wav__WEBPACK_IMPORTED_MODULE_21__","_crisp_wav__WEBPACK_IMPORTED_MODULE_21___default","_night_wav__WEBPACK_IMPORTED_MODULE_22__","_night_wav__WEBPACK_IMPORTED_MODULE_22___default","_drawbridge_wav__WEBPACK_IMPORTED_MODULE_23__","_drawbridge_wav__WEBPACK_IMPORTED_MODULE_23___default","_break_wav__WEBPACK_IMPORTED_MODULE_24__","_break_wav__WEBPACK_IMPORTED_MODULE_24___default","dot","smoke","hpbar","drawbridgeAlt","translucent","solid","file","frameWidth","frameHeight","jump1","jump2","jump3","land","crisp","night","breaking","drawbridgeSound","transitionPauses","transitionPauseTimes","defaultTransitionProps","wait_enabled","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","pauseEverythingForTransition","unpauseEverythingForTransition","loaderMethod","unloadFunction","textureManager","audio","loadAsset","_scene$load","spriteWidth","spriteHeight","_game$config2","massageInput","_home_shawn_devel_nighty_night_nosferatu_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__","builtinCoordFragments","center","range","thickness","inner","dropoff","builtinColorFragments","red","green","blue","float","bool","vec2","vec3","vec4","rgb","rgba","_shaderTypeMeta$type","count","subvariables","sub","injectBuiltinFragment","isCoord","primaryName","secondaryName","replacement","splice","_shaderTypeMeta$type2","colorConfig","alphaConfig"],"mappings":"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","file":"static/js/main.daf47dd8.chunk.js","sourcesContent":["import {name as project} from '../../../package.json';\n\nconst debug = !process.env.NODE_ENV || process.env.NODE_ENV === 'development';\nconst prefix = `${project}_${debug ? 'debug' : 'prod'}_`;\n\nlet frozen = false;\nexport function freezeStorage() {\n  frozen = true;\n}\n\nexport function saveField(name, value) {\n  if (frozen) {\n    return false;\n  }\n\n  try {\n    const payload = JSON.stringify(value);\n    localStorage.setItem(`${prefix}${name}`, payload);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(e);\n    return false;\n  }\n\n  return true;\n}\n\nexport function removeField(name) {\n  if (frozen) {\n    return false;\n  }\n\n  try {\n    localStorage.removeItem(`${prefix}${name}`);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(e);\n    return false;\n  }\n\n  return true;\n}\n\nexport function removeAllFields(subprefix = '') {\n  if (frozen) {\n    return false;\n  }\n\n  try {\n    Object.keys(localStorage).forEach((key) => {\n      if (key.startsWith(`${prefix}${subprefix}`)) {\n        localStorage.removeItem(key);\n      }\n    });\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(e);\n    return false;\n  }\n\n  return true;\n}\n\nexport function loadField(name, defaultValue) {\n  let value = defaultValue;\n\n  try {\n    const payload = localStorage.getItem(`${prefix}${name}`);\n    if (payload !== null && payload !== undefined) {\n      value = JSON.parse(payload);\n    }\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(e);\n  }\n\n  if (typeof value === 'function') {\n    value = value();\n  }\n\n  return value;\n}\n","export const tweenEases = [\n  'Linear',\n  'Quad.easeIn',\n  'Quad.easeOut',\n  'Quad.easeInOut',\n  'Cubic.easeIn',\n  'Cubic.easeOut',\n  'Cubic.easeInOut',\n  'Quart.easeIn',\n  'Quart.easeOut',\n  'Quart.easeInOut',\n  'Quint.easeIn',\n  'Quint.easeOut',\n  'Quint.easeInOut',\n  'Sine.easeIn',\n  'Sine.easeOut',\n  'Sine.easeInOut',\n  'Expo.easeIn',\n  'Expo.easeOut',\n  'Expo.easeInOut',\n  'Circ.easeIn',\n  'Circ.easeOut',\n  'Circ.easeInOut',\n  'Back.easeIn',\n  'Back.easeOut',\n  'Back.easeInOut',\n  'Bounce.easeIn',\n  'Bounce.easeOut',\n  'Bounce.easeInOut',\n];\n\nconst defaultTweenProps = {\n  delay_enabled: [true],\n  delay: [0, 0, 10000],\n  duration: [0, 0, 10000],\n  ease: ['Linear', tweenEases],\n\n  dx_enabled: [false],\n  dx: [0, -1000, 1000],\n  dy_enabled: [false],\n  dy: [0, -1000, 1000],\n  alpha_enabled: [false],\n  alpha: [1.0, 0, 1, 0.01],\n  rotation_enabled: [false],\n  rotation: [0, -1080, 1080, 1],\n  scaleX_enabled: [false],\n  scaleX: [1.0, 0, 10, 0.1],\n  scaleY_enabled: [false],\n  scaleY: [1.0, 0, 10, 0.1],\n\n  yoyo: [false],\n  loop: [0, -1, 100, 1],\n  ignoresScenePause: [false],\n  refreshPhysics: [false],\n  destroyOnComplete: [false],\n  animated: [true],\n};\n\nexport function expandTweenProps(props) {\n  Object.entries(props).forEach(([name, spec]) => {\n    if (!name.endsWith('.tween')) {\n      return;\n    }\n\n    const prefix = name.substr(0, name.length - '.tween'.length);\n\n    if (!Array.isArray(spec) || spec.length !== 1 || typeof spec[0] !== 'object') {\n      throw new Error(`Expected ${name} prop to have the shape [{}]; did you mean to end it in .tween?`);\n    }\n\n    delete props[name];\n\n    const [config] = spec;\n\n    const seen = {...config};\n\n    Object.entries(defaultTweenProps).forEach(([key, value]) => {\n      if (key in config) {\n        props[`${prefix}.${key}`] = [config[key], ...value.slice(1)];\n        delete seen[key];\n      } else if (key.endsWith('_enabled')) {\n        const targetKey = key.substr(0, key.length - '_enabled'.length);\n        props[`${prefix}.${key}`] = [targetKey in config];\n      } else {\n        props[`${prefix}.${key}`] = value;\n      }\n    });\n\n    if (Object.keys(seen).length) {\n      throw new Error(`Got unexpected tween config settings: ${Object.keys(seen).join(', ')}`);\n    }\n  });\n}\n\nexport default function massageTweenProps(target, {...props}, options) {\n  const {massageProps} = props;\n\n  delete props.massageProps;\n\n  Object.entries(props).forEach(([key, config]) => {\n    if (key.endsWith('_enabled')) {\n      const main = key.substr(0, key.length - '_enabled'.length);\n      if (!config && !options[main]) {\n        delete props[main];\n      }\n      delete props[key];\n    }\n  });\n\n  props.targets = target;\n\n  if (props.destroyOnComplete) {\n    delete props.destroyOnComplete;\n    const {onComplete} = props;\n    if (onComplete) {\n      props.onComplete = (...args) => {\n        onComplete(...args);\n        target.destroy();\n      };\n    } else {\n      props.onComplete = () => {\n        target.destroy();\n      };\n    }\n  }\n\n  if ('dx' in props) {\n    const {dx} = props;\n    props.x = target.x + dx;\n  }\n\n  if ('dy' in props) {\n    const {dy} = props;\n    props.y = target.y + dy;\n  }\n\n  const originalX = props.x;\n  const originalY = props.y;\n\n  if (props.refreshPhysics) {\n    delete props.refreshPhysics;\n    const {onUpdate} = props;\n    if (onUpdate) {\n      props.onUpdate = (...args) => {\n        onUpdate(...args);\n        if (target.body) {\n          target.refreshBody();\n        }\n      };\n    } else {\n      props.onUpdate = () => {\n        if (target.body) {\n          target.refreshBody();\n        }\n      };\n    }\n  }\n\n  if (massageProps) {\n    massageProps(props);\n  }\n\n  if ('dx' in props && (!('x' in props) || props.x === originalX)) {\n    const {dx} = props;\n    props.x = target.x + dx;\n  }\n  delete props.dx;\n\n  if ('dy' in props && (!('y' in props) || props.y === originalY)) {\n    const {dy} = props;\n    props.y = target.y + dy;\n  }\n  delete props.dy;\n\n  // convert degrees to radians\n  if (props.rotation) {\n    props.rotation *= Math.PI / 180;\n  }\n\n  if ('animated' in props && !props.animated) {\n    props.duration = 0;\n    delete props.loop;\n\n    // yoyo ends up where we began, so just don't animate anything\n    if (props.yoyo) {\n      delete props.x;\n      delete props.y;\n      delete props.dx;\n      delete props.dy;\n      delete props.rotation;\n      delete props.scaleX;\n      delete props.scaleY;\n\n      delete props.yoyo;\n\n      // make sure we animate \"something\"\n      props.alpha = target.alpha;\n    }\n  }\n  delete props.animated;\n\n  return props;\n}\n\nlet injected = false;\nexport function injectTweenManagerAdd(tweens) {\n  if (injected) {\n    return;\n  }\n\n  // eslint-disable-next-line no-proto\n  const proto = tweens.__proto__;\n\n  const origAdd = proto.add;\n  proto.add = function(config) {\n    const tween = origAdd.call(this, config);\n    tween.ignoresScenePause = config.ignoresScenePause;\n    return tween;\n  };\n\n  injected = true;\n}\n","import Phaser from 'phaser';\n\nconst ParticleProps = [];\nexport function particlePropFromProp(prop) {\n  return ParticleProps.find((p) => prop.startsWith(p));\n}\n\nlet injectedEmitterOpSeededRandom = false;\nexport function injectEmitterOpSeededRandom(emitter, seed) {\n  emitter.seed = seed;\n  emitter.rnd = new Phaser.Math.RandomDataGenerator([seed]);\n\n  if (injectedEmitterOpSeededRandom) {\n    return;\n  }\n\n  // eslint-disable-next-line no-proto\n  const proto = emitter.delay.__proto__;\n\n  proto.randomStaticValueEmit = function(particle, key) {\n    const randomIndex = Math.floor(particle.emitter.rnd.frac() * this.propertyValue.length);\n    return this.propertyValue[randomIndex];\n  };\n\n  proto.randomRangedValueEmit = function(particle, key) {\n    const value = particle.emitter.rnd.realInRange(this.start, this.end);\n\n    if (particle && particle.data[key]) {\n      particle.data[key].min = value;\n    }\n\n    return value;\n  };\n\n\n  injectedEmitterOpSeededRandom = true;\n}\n\nlet injectedParticleEmitterManagerPreUpdate = false;\nexport function injectParticleEmitterManagerPreUpdate(manager) {\n  if (injectedParticleEmitterManagerPreUpdate || !manager) {\n    return injectedParticleEmitterManagerPreUpdate;\n  }\n\n  // eslint-disable-next-line no-proto\n  const proto = manager.__proto__;\n\n  proto.preUpdate = function(time, origDelta) {\n    const {scene} = this;\n    const isPaused = scene._paused.particles;\n\n    // Scale the delta\n    const delta = origDelta / this.timeScale;\n\n    const emitters = this.emitters.list;\n\n    for (let i = 0; i < emitters.length; i += 1) {\n      const emitter = emitters[i];\n      if ((!isPaused || this.ignoresScenePause || emitter.ignoresScenePause || emitter.updatesOnceOnPause) && emitter.active) {\n        emitter.preUpdate(time, delta);\n        if (isPaused) {\n          emitter.updatesOnceOnPause = false;\n        }\n      }\n    }\n  };\n\n  injectedParticleEmitterManagerPreUpdate = true;\n\n  return injectedParticleEmitterManagerPreUpdate;\n}\n\nconst defaultParticleProps = {\n  image: null,\n\n  /*\n   * to investigate:\n   * bounds: null (rectangle)\n   * bounce: 0\n   * collideBottom: true\n   * collideLeft: true\n   * collideRight: true\n   * collideTop: true\n   * defaultFrame: 0?\n   * deathZone: null\n   * emitZone: null\n   * frameQuantity: 1 int\n   * mask\n  visible: [true],\n  timeScale: [1, 0, 100],\n\n  randomFrame: [true],\n  moveToX: [0, 0, 1000],\n  moveToY: [0, 0, 1000],\n   * scrollFactorX: 1 number\n   * scrollFactorY: 1 number\n   *\n   * followOffset: vec2\n   * trackVisible: false\n   *\n   * maxVelocityX: 10000\n   * maxVelocityY: 10000\n   *\n   * I suppose we don't need both gravity and acceleration?\n  gravityX: [0, -1000, 1000],\n  gravityY: [0, -1000, 1000],\n   */\n\n  /*\n   * angle: {min: 0, max: 360}\n  */\n  frequency: [0, 0, 20000],\n  lifespan: [1000, 0, 20000],\n\n  accelerationX: [0, -1000, 1000],\n  accelerationY: [0, -1000, 1000],\n  alpha: [1, 0, 1],\n  blendMode: ['NORMAL', ['NORMAL', 'ADD', 'MULTIPLY', 'SCREEN', 'ERASE']],\n  delay: [0, 0, 20000],\n  maxParticles: [0, 0, 1000],\n  particleBringToTop: [true],\n  quantity: [1, 0, 200, 1],\n  radial: [true],\n  rotate: [0, -1080, 1080, 1],\n  scaleX: [1, 0, 100],\n  scaleY: [1, 0, 100],\n  speed: [0, 0, 1000],\n  speedX: [0, -1000, 1000],\n  speedY: [0, -1000, 1000],\n  tint: [0xFFFFFF],\n  tint_enabled: [false],\n  x: [0, -1000, 1000],\n  y: [0, -1000, 1000],\n  ignoresScenePause: [false],\n  updatesOnceOnPause: [false],\n  visible: [true],\n\n  preemit: [false],\n  preemitOnReload: [false],\n};\n\nexport function expandParticleProps(props, particleImages = ['set props/particleImages!']) {\n  Object.entries(props).forEach(([name, spec]) => {\n    if (name === 'scene.particles') {\n      return;\n    }\n\n    if (name.endsWith('.particle')) {\n      throw new Error(`Found ${name}; did you mean ${name}s?`);\n    }\n\n    if (!name.endsWith('.particles')) {\n      return;\n    }\n\n    const prefix = name.substr(0, name.length - '.particles'.length);\n\n    if (!Array.isArray(spec) || spec.length !== 1 || typeof spec[0] !== 'object') {\n      throw new Error(`Expected ${name} prop to have the shape [{}]; did you mean to end it in .particles?`);\n    }\n\n    delete props[name];\n\n    ParticleProps.push(prefix);\n\n    const [config] = spec;\n\n    const seen = {...config};\n\n    Object.entries(defaultParticleProps).forEach(([key, value]) => {\n      const propKey = key.replace(/^tint/, 'tintColor');\n      const options = key === 'image' ? [particleImages[0], particleImages] : value;\n\n      if (key in config) {\n        props[`${prefix}.${propKey}`] = [config[key], ...options.slice(1)];\n        delete seen[key];\n      } else if (key === 'preemitOnReload' && config.preemit) {\n        props[`${prefix}.${propKey}`] = [true, ...options.slice(1)];\n      } else if (key.endsWith('_enabled')) {\n        const targetKey = key.substr(0, key.length - '_enabled'.length);\n        props[`${prefix}.${propKey}`] = [targetKey in config];\n      } else {\n        props[`${prefix}.${propKey}`] = options;\n      }\n    });\n\n    if (Object.keys(seen).length) {\n      throw new Error(`Got unexpected particle config settings: ${Object.keys(seen).join(', ')}`);\n    }\n  });\n}\n\nexport default function massageParticleProps({...props}) {\n  const {massageProps} = props;\n\n  delete props.onAdd;\n  delete props.massageProps;\n  delete props.image;\n\n  if (props.tintColor_enabled) {\n    props.tint = props.tintColor;\n    delete props.tintColor_enabled;\n  }\n\n  // these accidentally take precedence over one another\n  if (props.speedX === 0 && props.speedY === 0) {\n    delete props.speedX;\n    delete props.speedY;\n  } else if (props.speed === 0) {\n    delete props.speed;\n  }\n\n  // convert degrees to radians\n  if (props.rotate) {\n    if (typeof props.rotate === 'number') {\n      props.rotate *= Math.PI / 180;\n    }\n    // TODO handle other input formats\n  }\n\n  if (massageProps) {\n    massageProps(props);\n  }\n\n  return props;\n}\n","import React from 'react';\n\nexport default class Spinner extends React.Component {\n  render() {\n    return (\n      <div id=\"lds-spinner\">\n        <div className=\"lds-spinner\">\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './Controls.css';\n\nexport default class Controls extends React.Component {\n  render() {\n    const {\n      onMouseMove, volume, onVolumeChange, disableFullscreen, isFullscreen, enterFullscreen, exitFullscreen,\n    } = this.props;\n    return (\n      <div className=\"Controls\" onMouseMove={onMouseMove}>\n        <div className=\"volume\">\n          <span style={{fontSize: 20, transform: `scale(${0.5 + volume / 2})`}}></span>\n          &nbsp;&nbsp;\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"100\"\n            value={volume * 100}\n            onChange={(e) => onVolumeChange(e.target.value / 100)}\n            onMouseUp={(e) => e.target.blur()}\n          />\n        </div>\n        {disableFullscreen || (\n          <div className=\"fullscreen\">\n            {isFullscreen ? (\n              <div className=\"button\" onClick={exitFullscreen}>\n                <div className=\"label exit\"></div>\n              </div>\n            ) : (\n              <div className=\"button\" onClick={enterFullscreen}>\n                <div className=\"label enter\"></div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n","import SuperScene from './SuperScene.js';\n\nexport default class BootScene extends SuperScene {\n  static key() {\n    return 'BootScene';\n  }\n\n  constructor() {\n    super({key: BootScene.key()});\n  }\n\n  preload() {\n    super.preload();\n\n    this.game.preloadScenes.forEach((sceneClass) => {\n      if (sceneClass.name === this.name) {\n        return;\n      }\n\n      const scene = new sceneClass();\n      scene.preload.call(this);\n    });\n  }\n\n  create() {\n    super.create();\n\n    this.game.initializeShaders();\n\n    setTimeout(() => {\n      this.game.preloadComplete();\n    });\n  }\n\n  saveStateFieldName() {\n    return null;\n  }\n}\n","import _ from 'lodash';\nimport {commandKeys, gamepadKeys} from './lib/props';\nimport prop from '../props';\n\nconst GamepadButtons = {\n  LEFT: '_LCLeft',\n  RIGHT: '_LCRight',\n  UP: '_LCTop',\n  DOWN: '_LCBottom',\n  A: '_RCBottom',\n  Y: '_RCTop',\n  X: '_RCLeft',\n  B: '_RCRight',\n  L1: '_FBLeftTop',\n  L2: '_FBLeftBottom',\n  R1: '_FBRightTop',\n  R2: '_FBRightBottom',\n};\n\nconst ButtonName = {};\n\nexport default class CommandManager {\n  constructor(spec) {\n    this._spec = spec;\n    this._scenes = new Map();\n\n    this.keyboard = {};\n    this.gamepad = {};\n    this.pointerEvents = [];\n    this.executedProps = [];\n    this._ignoreAlls = {};\n\n    Object.keys(spec).forEach((name) => {\n      if (this[name]) {\n        throw new Error(`Conflicting command name ${name}`);\n      }\n\n      this[name] = {\n        held: false,\n        heldFrames: 0,\n        started: false,\n        continued: false,\n        heldDuration: 0,\n        releasedFrames: 0,\n        released: false,\n        releasedDuration: 0,\n\n        cooldown: 0,\n        coolingDown: false,\n        coolingDownTime: null,\n      };\n    });\n  }\n\n  freezeCommandState() {\n    const state = {\n      inputs: {},\n      ignoreAlls: {...this._ignoreAlls},\n    };\n\n    Object.keys(this._spec).forEach((name) => {\n      state.inputs[name] = {...this[name]};\n    });\n\n    return state;\n  }\n\n  thawCommandState(state) {\n    Object.keys(this._spec).forEach((name) => {\n      this[name] = {...state.inputs[name]};\n    });\n    this._ignoreAlls = {...state.ignoreAlls};\n  }\n\n  getManager(scene) {\n    return this._scenes.get(scene);\n  }\n\n  managerList() {\n    return [...this._scenes.values()];\n  }\n\n  attachScene(scene, suppressRepeatFrames) {\n    this._scenes.set(scene, {\n      scene,\n      commands: scene.game.debug ? [] : null,\n      tickCount: 0,\n      suppressRepeatFrames,\n    });\n  }\n\n  detachScene(scene) {\n    this._scenes.delete(scene);\n  }\n\n  attachKey(scene, code) {\n    const {keyboard} = scene.input;\n\n    keyboard.on(`keydown-${code}`, (e) => {\n      const tag = document.activeElement && document.activeElement.tagName.toLowerCase();\n      if (tag === 'input' || tag === 'select' || tag === 'textarea') {\n        return;\n      }\n\n      if (e.altKey || e.ctrlKey || e.metaKey || e.shiftKey) {\n        return;\n      }\n\n      e.preventDefault();\n      this.keyboard[code] = true;\n    });\n\n    keyboard.on(`keyup-${code}`, (e) => {\n      const tag = document.activeElement && document.activeElement.tagName.toLowerCase();\n      if (tag === 'input' || tag === 'select' || tag === 'textarea') {\n        return;\n      }\n\n      e.preventDefault();\n      this.keyboard[code] = false;\n    });\n\n    if (!(code in this.keyboard)) {\n      this.keyboard[code] = false;\n    }\n  }\n\n  detachKey(scene, code) {\n    delete this.keyboard[code];\n  }\n\n  attachInputs(scene) {\n    commandKeys(this._spec).forEach((code) => {\n      this.attachKey(scene, code);\n    });\n\n    if (scene.input.gamepad) {\n      scene.input.gamepad.on('down', (gamepad, button) => {\n        let buttonName = ButtonName[button.index];\n        if (!buttonName) {\n          Object.entries(GamepadButtons).forEach(([name, method]) => {\n            if (button === gamepad[method]) {\n              buttonName = ButtonName[button.index] = name;\n            }\n          });\n        }\n\n        this.gamepad[buttonName] = true;\n      });\n\n      scene.input.gamepad.on('up', (gamepad, button) => {\n        let buttonName = ButtonName[button.index];\n        if (!buttonName) {\n          Object.entries(GamepadButtons).forEach(([name, method]) => {\n            if (button === gamepad[method]) {\n              buttonName = ButtonName[button.index] = name;\n            }\n          });\n        }\n\n        this.gamepad[buttonName] = false;\n      });\n    }\n\n    const canvas = document.querySelector('#engine canvas');\n\n    ['pointerdown', 'pointerup'].forEach((name) => {\n      scene.input.on(name, (pointer) => {\n        // fix issue with dat.gui not releasing focus\n        if (!document.activeElement || !document.activeElement.contains || document.activeElement.contains(canvas)) {\n          this.pointerEvents.push({\n            name,\n            x: pointer.x,\n            y: pointer.y,\n          });\n        } else {\n          // timeout to avoid 2x input events\n          setTimeout(() => {\n            document.activeElement.blur();\n          });\n        }\n      });\n    });\n  }\n\n  readRawGamepad(scenes) {\n    const {gamepad} = this;\n    let seenGamepad = false;\n\n    scenes.forEach((scene) => {\n      const rawGamepad = scene.input.gamepad;\n      if (!rawGamepad.total) {\n        return;\n      }\n\n      if (!seenGamepad) {\n        seenGamepad = true;\n\n        gamepad.total = 0;\n        gamepad.LSTICKX = 0;\n        gamepad.LSTICKY = 0;\n        gamepad.RSTICKX = 0;\n        gamepad.RSTICKY = 0;\n      }\n\n      if (gamepad.total < rawGamepad.total) {\n        gamepad.total = rawGamepad.total;\n      }\n\n      rawGamepad.gamepads.filter((pad) => pad).forEach((rawPad) => {\n        const {leftStick, rightStick} = rawPad;\n        if (Math.abs(leftStick.x) > Math.abs(gamepad.LSTICKX)) {\n          gamepad.LSTICKX = leftStick.x;\n        }\n\n        if (Math.abs(leftStick.y) > Math.abs(gamepad.LSTICKY)) {\n          gamepad.LSTICKY = leftStick.y;\n        }\n\n        if (Math.abs(rightStick.x) > Math.abs(gamepad.RSTICKX)) {\n          gamepad.RSTICKX = rightStick.x;\n        }\n\n        if (Math.abs(rightStick.y) > Math.abs(gamepad.RSTICKY)) {\n          gamepad.RSTICKY = rightStick.y;\n        }\n      });\n    });\n  }\n\n  heldCommands(onlyUnignorable) {\n    const {gamepad} = this;\n    const spec = this._spec;\n    const frame = {_repeat: 0};\n\n    Object.entries(spec).forEach(([name, config]) => {\n      if (onlyUnignorable && !config.unignorable) {\n        return;\n      }\n\n      let held = false;\n      if (config.input) {\n        config.input.forEach((path) => {\n          let keyHeld;\n\n          if (gamepad.total) {\n            if (path === 'gamepad.LSTICK.RAW' && (Math.abs(gamepad.LSTICKX) > 0.1 || Math.abs(gamepad.LSTICKY) > 0.1)) {\n              held = [gamepad.LSTICKX, gamepad.LSTICKY];\n            } else if (path === 'gamepad.RSTICK.RAW' && (Math.abs(gamepad.RSTICKX) > 0.1 || Math.abs(gamepad.RSTICKY) > 0.1)) {\n              held = [gamepad.RSTICKX, gamepad.RSTICKY];\n            } else if (path === 'gamepad.LSTICK.UP') {\n              keyHeld = gamepad.LSTICKY < -0.2;\n            } else if (path === 'gamepad.LSTICK.DOWN') {\n              keyHeld = gamepad.LSTICKY > 0.2;\n            } else if (path === 'gamepad.LSTICK.LEFT') {\n              keyHeld = gamepad.LSTICKX < -0.2;\n            } else if (path === 'gamepad.LSTICK.RIGHT') {\n              keyHeld = gamepad.LSTICKX > 0.2;\n            } else if (path === 'gamepad.RSTICK.UP') {\n              keyHeld = gamepad.RSTICKY < -0.2;\n            } else if (path === 'gamepad.RSTICK.DOWN') {\n              keyHeld = gamepad.RSTICKY > 0.2;\n            } else if (path === 'gamepad.RSTICK.LEFT') {\n              keyHeld = gamepad.RSTICKX < -0.2;\n            } else if (path === 'gamepad.RSTICK.RIGHT') {\n              keyHeld = gamepad.RSTICKX > 0.2;\n            } else {\n              keyHeld = _.get(this, path);\n            }\n          } else {\n            keyHeld = _.get(this, path);\n          }\n\n          if (keyHeld) {\n            held = true;\n          }\n        });\n\n        this[name].held = held;\n\n        if (held) {\n          frame[name] = held;\n        }\n      }\n    });\n\n    if (this.pointerEvents.length) {\n      if (!onlyUnignorable) {\n        frame._pointer = [...this.pointerEvents];\n      }\n      this.pointerEvents.length = 0;\n    }\n\n    if (this.executedProps.length) {\n      if (!onlyUnignorable) {\n        frame._executedProps = [...this.executedProps];\n      }\n      this.executedProps.length = 0;\n    }\n\n    return frame;\n  }\n\n  replayFrame(frame) {\n    const spec = this._spec;\n\n    Object.entries(spec).forEach(([name, config]) => {\n      if (frame[name] && config.unreplayable) {\n        this[name].held = false;\n      } else {\n        this[name].held = frame[name];\n      }\n    });\n  }\n\n  mergeUnignorable(frame) {\n    const spec = this._spec;\n\n    Object.entries(spec).forEach(([name, config]) => {\n      if (frame[name] && config.unignorable && !config.unreplayable) {\n        this[name].held = true;\n      }\n    });\n  }\n\n  addFrameToList(suppressRepeatFrames, list, frame) {\n    if (!suppressRepeatFrames && list.length) {\n      const prevFrame = list[list.length - 1];\n      let isSame = true;\n      if (frame._pointer || prevFrame._pointer) {\n        isSame = false;\n      } else if (frame._executedProps || prevFrame._executedProps) {\n        isSame = false;\n      } else {\n        Object.keys(this._spec).forEach((key) => {\n          if (prevFrame[key] !== frame[key]) {\n            isSame = false;\n          }\n        });\n      }\n\n      if (isSame) {\n        list.pop();\n        list.push({...prevFrame, _repeat: prevFrame._repeat + 1});\n        return;\n      }\n    }\n\n    list.push(frame);\n  }\n\n  ignoreAll(type, newValue) {\n    const {_ignoreAlls} = this;\n\n    if (type === undefined) {\n      let ignoreAny = false;\n      Object.values(_ignoreAlls).forEach((ignore) => {\n        if (ignore) {\n          ignoreAny = true;\n        }\n      });\n      return ignoreAny;\n    }\n\n    if (newValue === undefined) {\n      return _ignoreAlls[type];\n    }\n\n    _ignoreAlls[type] = !!newValue;\n    return _ignoreAlls[type];\n  }\n\n  clearIgnoreAlls() {\n    const {_ignoreAlls} = this;\n    Object.keys(_ignoreAlls).forEach((key) => {\n      _ignoreAlls[key] = false;\n    });\n  }\n\n  processCommands(manager, frame, dt) {\n    const spec = this._spec;\n    const {scene} = manager;\n\n    const ignoreAll = this.ignoreAll();\n\n    Object.entries(spec).forEach(([name, config]) => {\n      const command = this[name];\n\n      if (!prop(`command.${name}.enabled`) || (ignoreAll && !config.unignorable)) {\n        command.held = false;\n      }\n\n      if (config.cooldown) {\n        command.coolingDownTime = Math.max(0, command.coolingDownTime - dt);\n        command.coolingDown = command.coolingDownTime > 0;\n        if (command.coolingDown) {\n          command.held = false;\n        }\n        if (command.held) {\n          command.coolingDownTime = prop(`command.${name}.cooldown`);\n        }\n      }\n\n      if (command.held) {\n        command.heldFrames += 1;\n        command.heldDuration += dt;\n        command.started = command.heldFrames === 1;\n        command.continued = command.heldFrames > 1;\n        command.released = false;\n        command.releasedFrames = 0;\n        command.releasedDuration = 0;\n      } else {\n        command.held = false;\n        command.heldFrames = 0;\n        command.heldDuration = 0;\n        command.started = false;\n        command.continued = false;\n        command.released = command.releasedFrames === 1;\n        command.releasedFrames += 1;\n        command.releasedDuration += dt;\n      }\n\n      if (command.started && config.execute) {\n        if (typeof config.execute === 'function') {\n          config.execute(scene, scene.game);\n        } else {\n          const scenePath = _.get(scene, config.execute);\n          if (scenePath) {\n            scenePath.call(scene);\n          } else {\n            const gamePath = _.get(scene.game, config.execute);\n            if (gamePath) {\n              gamePath.call(scene.game);\n            } else {\n              throw new Error(`Invalid execute for command '${name}'; expected a function or a scene/game method name, got ${config.execute}`);\n            }\n          }\n        }\n      }\n    });\n\n    if (!ignoreAll && frame._pointer) {\n      frame._pointer.forEach((event) => {\n        scene.handlePointerEvent(event);\n      });\n    }\n\n    if (this.replay && frame._executedProps) {\n      frame._executedProps.forEach((propName) => {\n        const fn = prop(propName);\n        if (typeof fn === 'function') {\n          fn();\n        } else {\n          // eslint-disable-next-line no-console\n          console.error(`Recorded prop ${propName} is no longer a function? It's ${fn}`);\n        }\n      });\n    }\n  }\n\n  injectReplayFrame() {\n    if (!this.replay) {\n      return null;\n    }\n\n    if (this.replayFrameIndex >= this.replay.commands.length || this.replayTicks >= this.replay.postflightCutoff) {\n      this.endedReplay();\n      return null;\n    }\n\n    const frame = this.replay.commands[this.replayFrameIndex];\n\n    if (frame._repeat) {\n      this.replayRepeatRun += 1;\n\n      if (this.replayRepeatRun > frame._repeat) {\n        this.replayRepeatRun = 0;\n        this.replayFrameIndex += 1;\n      }\n    } else {\n      this.replayFrameIndex += 1;\n    }\n\n    this.replayTicks += 1;\n\n    this.replayFrame(frame);\n    this.heldCommands(true);\n    this.mergeUnignorable(frame);\n\n    return {...frame, _repeat: 0};\n  }\n\n  processInput(scene, time, dt, onlyUnignorable) {\n    const manager = this.getManager(scene);\n\n    if (manager.scene.timeSightFrozen) {\n      const frame = this.heldCommands(onlyUnignorable);\n      this.processCommands(manager, frame, dt);\n      return;\n    }\n\n    const frame = this.injectReplayFrame()\n      || this.heldCommands(onlyUnignorable);\n\n    if (manager.commands) {\n      this.addFrameToList(manager.suppressRepeatFrames, manager.commands, frame);\n    }\n    if (this.recording) {\n      this.addFrameToList(manager.suppressRepeatFrames, this.recording.commands, frame);\n    }\n\n    manager.tickCount += 1;\n\n    if (this.recording) {\n      this.recording.tickCount += 1;\n    }\n\n    this.processCommands(manager, frame, dt);\n  }\n\n  recordPropExecution(propName) {\n    this.executedProps.push(propName);\n  }\n\n  beginRecording(scene, recording) {\n    const manager = this.getManager(scene);\n    this.recording = recording;\n    recording.commands = [...manager.commands];\n    recording.originalPreflightCutoff = recording.preflightCutoff = recording.tickCount = manager.tickCount;\n  }\n\n  stopRecording() {\n    const {recording} = this;\n    delete this.recording;\n    recording.postflightCutoff = recording.tickCount;\n    return recording;\n  }\n\n  beginReplay(replay, replayOptions) {\n    this.replay = replay;\n    this.replayFrameIndex = 0;\n    this.replayRepeatRun = 0;\n    this.replayTicks = 0;\n    this.replayOptions = replayOptions;\n\n    const startTick = replayOptions.startTick || replay.startTick || 0;\n    if (startTick) {\n      for (let i = 0; i < startTick; i += 1) {\n        this.injectReplayFrame();\n      }\n    }\n  }\n\n  endedReplay() {\n    if (!this.replay) {\n      return;\n    }\n\n    const {onEnd} = this.replayOptions;\n\n    delete this.replay;\n    delete this.replayOptions;\n    delete this.replayFrameIndex;\n    delete this.replayRepeatRun;\n    delete this.replayTicks;\n\n    if (onEnd) {\n      onEnd();\n    }\n  }\n\n  stopReplay() {\n    if (!this.replay) {\n      return;\n    }\n\n    const {onStop} = this.replayOptions;\n\n    delete this.replay;\n    delete this.replayOptions;\n    delete this.replayFrameIndex;\n    delete this.replayRepeatRun;\n    delete this.replayTicks;\n\n    if (onStop) {\n      onStop();\n    }\n  }\n\n  hasPreflight() {\n    if (!this.replay) {\n      return false;\n    }\n\n    if (this.replayTicks >= this.replay.postflightCutoff) {\n      return false;\n    }\n\n    return this.replayTicks < (this.replayOptions.preflightCutoff || this.replay.preflightCutoff);\n  }\n\n  updateCommandsFromReload(next) {\n    const prev = this._spec;\n\n    this.updateSpecFromReload(prev, next);\n    this.updateInputsFromReload(prev, next, true);\n    this.updateInputsFromReload(prev, next, false);\n  }\n\n  updateSpecFromReload(prev, next) {\n    this._spec = next;\n    const addCommands = [];\n    const removeCommands = [];\n    const updateCommands = [];\n\n    const seen = {};\n\n    Object.entries(next).forEach(([name, config]) => {\n      if (!prev[name]) {\n        addCommands.push(name);\n      } else {\n        seen[name] = true;\n\n        const prevJson = {};\n        Object.entries(prev[name]).forEach(([key, value]) => {\n          if (typeof value === 'function') {\n            prevJson[key] = String(value);\n          } else {\n            prevJson[key] = value;\n          }\n        });\n\n        const nextJson = {};\n        Object.entries(next[name]).forEach(([key, value]) => {\n          if (typeof value === 'function') {\n            nextJson[key] = String(value);\n          } else {\n            nextJson[key] = value;\n          }\n        });\n\n        if (JSON.stringify(prevJson) !== JSON.stringify(nextJson)) {\n          updateCommands.push(name);\n        }\n      }\n    });\n\n    Object.keys(prev).forEach((name) => {\n      if (!seen[name]) {\n        removeCommands.push(name);\n      }\n    });\n\n    if (addCommands.length === 0 && removeCommands.length === 0 && updateCommands.length === 0) {\n      return;\n    }\n\n    const changes = [];\n    if (addCommands.length) {\n      changes.push(`+[${addCommands.join(', ')}]`);\n    }\n    if (removeCommands.length) {\n      changes.push(`-[${removeCommands.join(', ')}]`);\n    }\n    if (updateCommands.length) {\n      changes.push(`[${updateCommands.join(', ')}]`);\n    }\n\n    // eslint-disable-next-line no-console\n    console.info(`Hot-loading command changes (${changes.join(', ')})`);\n  }\n\n  updateInputsFromReload(prev, next, isKeyboard) {\n    const nextKeys = {};\n    const prevKeys = {};\n\n    const keyLister = isKeyboard ? commandKeys : gamepadKeys;\n\n    keyLister(next).forEach((code) => {\n      nextKeys[code] = true;\n    });\n\n    keyLister(prev, true).forEach((code) => {\n      prevKeys[code] = true;\n    });\n\n    const addKeys = [];\n    Object.keys(nextKeys).forEach((code) => {\n      if (prevKeys[code]) {\n        delete prevKeys[code];\n      } else {\n        addKeys.push(code);\n      }\n    });\n    const removeKeys = Object.keys(prevKeys);\n\n    if (addKeys.length === 0 && removeKeys.length === 0) {\n      return;\n    }\n\n    if (isKeyboard) {\n      this.managerList().forEach((manager) => {\n        addKeys.forEach((code) => {\n          this.attachKey(manager.scene, code);\n        });\n        removeKeys.forEach((code) => {\n          this.detachKey(manager.scene, code);\n        });\n      });\n    }\n\n    const changes = [];\n    if (addKeys.length) {\n      changes.push(`+[${addKeys.join(', ')}]`);\n    }\n    if (removeKeys.length) {\n      changes.push(`-[${removeKeys.join(', ')}]`);\n    }\n\n    // eslint-disable-next-line no-console\n    console.info(`Hot-loading ${isKeyboard ? 'keyboard' : 'gamepad'} input changes (${changes.join(', ')})`);\n  }\n}\n","import Phaser from 'phaser';\nimport BootScene from './boot-scene';\nimport prop, {\n  commands, shaderCoordFragments, shaderColorFragments, shaderPipelines,\n} from '../props';\nimport {updatePropsFromStep} from './lib/manage-gui';\nimport {shaderTypeMeta} from './lib/shaders';\nimport {name as project} from '../../package.json';\nimport CommandManager from './CommandManager';\n\nconst baseConfig = {\n  type: Phaser.AUTO,\n  parent: 'engine',\n  width: 800,\n  height: 600,\n  tileWidth: 24,\n  tileHeight: 24,\n};\n\nexport default class SuperGame extends Phaser.Game {\n  constructor(subConfig, preloadScenes) {\n    const config = {\n      ...baseConfig,\n      ...subConfig,\n    };\n\n    super(config);\n\n    Object.entries(config).forEach(([key, value]) => {\n      if (!(key in this.config)) {\n        this.config[key] = value;\n      }\n    });\n\n    this.debug = config.debug;\n\n    this.scene.add('BootScene', BootScene, true, {seed: Date.now(), sceneId: String(Math.random())});\n\n    this.preloadScenes = preloadScenes;\n\n    // hack to stop phaser from rejecting our fullscreen\n    // eslint-disable-next-line no-proto\n    this.scale.__proto__.onFullScreenChange = function() {};\n\n    this.prop = prop;\n\n    this._replayPreflight = 0;\n\n    this._onDisableDebugUI = [];\n\n    this._sceneInitCallbacks = {};\n\n    this.assets = {};\n\n    this.command = new CommandManager(commands);\n\n    this._initializeShaderStructures(shaderCoordFragments, shaderColorFragments, shaderPipelines);\n\n    this.focused = true;\n\n    this._sceneConstructors = {};\n    [\n      BootScene,\n      ...preloadScenes,\n    ].forEach((sceneClass) => {\n      this._sceneConstructors[sceneClass.name] = sceneClass;\n    });\n\n    if (config.debug) {\n      const game = this;\n      window.scene = new Proxy({}, {\n        get(target, key) {\n          return game.topScene()[key];\n        },\n      });\n      window.prop = prop;\n    }\n\n    this.events.on('step', () => {\n      const topScene = this.topScene();\n\n      this.readRawInput();\n\n      if (config.debug) {\n        if (this._replayPreflight > 0) {\n          return;\n        }\n\n        if (!this.disableDebug && (!topScene._replay || !topScene._replay.timeSight)) {\n          updatePropsFromStep(false);\n        }\n\n        if (prop('engine.throttle')) {\n          const begin = new Date().getTime();\n          // eslint-disable-next-line no-empty\n          while ((new Date()).getTime() - begin < 50) {\n          }\n        }\n      }\n    });\n  }\n\n  shaderFragments(pipelineName) {\n    const bothFragmentTypes = this._shaderPipelines[pipelineName];\n    if (!bothFragmentTypes) {\n      return null;\n    }\n\n    return [...bothFragmentTypes[0], ...bothFragmentTypes[1]];\n  }\n\n  _initializeShaderStructures(coordFragments, colorFragments, pipelines) {\n    if (!this._shaderSource) {\n      this._shaderSource = {};\n    }\n\n    const allFragments = [\n      ...(coordFragments || []),\n      ...(colorFragments || []),\n    ];\n\n    const out = {};\n    const setupPipeline = (pipelineName, fragmentNames) => {\n      const coords = [];\n      const colors = [];\n\n      fragmentNames.forEach((fragmentName) => {\n        const coordFragment = coordFragments.find(([n]) => n === fragmentName);\n        if (coordFragment) {\n          coords.push(coordFragment);\n          return;\n        }\n\n        const colorFragment = colorFragments.find(([n]) => n === fragmentName);\n        if (colorFragment) {\n          colors.push(colorFragment);\n          return;\n        }\n\n        throw new Error(`Unable to find shader '(${fragmentName}' in shader pipeline '${pipelineName}'`);\n      });\n\n      out[pipelineName] = [coords, colors];\n    };\n\n    Object.entries(pipelines).forEach(([pipelineName, fragmentNames]) => {\n      setupPipeline(pipelineName, fragmentNames);\n    });\n\n    allFragments.forEach(([name]) => {\n      if (!out[name]) {\n        setupPipeline(name, [name]);\n      }\n    });\n\n    if (!out.main) {\n      setupPipeline('main', allFragments.map(([name]) => name));\n    }\n\n    this._shaderPipelines = out;\n  }\n\n  changeVolume(newVolume) {\n    this.volume = newVolume;\n\n    if (this.currentMusicPlayer) {\n      this.currentMusicPlayer.setVolume(newVolume * prop('scene.musicVolume'));\n    }\n\n    this.scene.scenes.forEach((scene) => {\n      scene.changeVolume(newVolume);\n    });\n  }\n\n  setFocused(isFocused) {\n    if (this.focused === isFocused) {\n      return;\n    }\n\n    this.focused = isFocused;\n  }\n\n  topScene() {\n    const {scenes} = this.scene;\n    return scenes[scenes.length - 1];\n  }\n\n  preloadComplete() {\n    const spinner = document.getElementById('lds-spinner');\n    if (spinner && spinner.parentNode) {\n      spinner.parentNode.removeChild(spinner);\n    }\n\n    this._preloadedAssets = true;\n    this.tryLaunch();\n  }\n\n  activateGame(callback) {\n    if (!this._activatedGame) {\n      this._activatedGame = [];\n    }\n\n    if (callback) {\n      this._activatedGame.push(callback);\n    }\n\n    this.tryLaunch();\n  }\n\n  tryLaunch() {\n    if (!this._preloadedAssets || !this._activatedGame) {\n      return;\n    }\n\n    if (this._launchedGame) {\n      if (this._activatedGame) {\n        this._activatedGame.forEach((callback) => {\n          callback();\n        });\n        delete this._activatedGame;\n      }\n      return;\n    }\n\n    if (this._launchingGame) {\n      return;\n    }\n\n    this._launchingGame = true;\n\n    // eslint-disable-next-line no-console\n    console.warn(`Welcome to ${project}!`);\n\n    // if clicking comes first, removing the scene immediately after\n    // preloading finishes causes a crash\n    setTimeout(() => {\n      if (this.renderer.type === Phaser.CANVAS) {\n        // eslint-disable-next-line no-alert\n        alert('It looks like this browser will offer a degraded experience. For best results, please use Chrome!');\n      }\n\n      const cover = document.getElementById('cover');\n      if (cover && cover.parentNode) {\n        cover.parentNode.removeChild(cover);\n      }\n\n      this.scene.remove(BootScene.key());\n      this.launch();\n\n      const scene = this.topScene();\n      if (scene) {\n        scene.willTransitionFrom();\n        scene.timer(() => scene.didTransitionFrom()).ignoresScenePause = true;\n      }\n\n      this._activatedGame.forEach((callback) => {\n        callback();\n      });\n      delete this._activatedGame;\n      this._launchedGame = true;\n    });\n  }\n\n  onDisableDebugUI(callback) {\n    if (this.disableDebug) {\n      callback();\n    } else {\n      this._onDisableDebugUI.push(callback);\n    }\n  }\n\n  disableDebugUI() {\n    if (this.disableDebug) {\n      return;\n    }\n\n    this.disableDebug = true;\n\n    this._onDisableDebugUI.forEach((callback) => callback());\n\n    const manage = document.querySelector('.development .Manage');\n    if (manage) {\n      manage.remove();\n    }\n\n    const replay = document.querySelector('.development .Replay');\n    if (replay) {\n      replay.remove();\n    }\n\n    const log = document.querySelector('.development .Logging');\n    if (log) {\n      log.remove();\n    }\n  }\n\n  forceQuit() {\n    this.stopRecording();\n    this.stopReplay();\n\n    this.destroy(true, true);\n\n    const engine = document.querySelector('#engine-container');\n    if (engine) {\n      engine.remove();\n    }\n\n    this.disableDebugUI();\n\n    const isInFullScreen = document.fullscreenElement\n      || document.webkitFullscreenElement\n      || document.mozFullScreenElement\n      || document.msFullscreenElement;\n\n    if (isInFullScreen) {\n      if (document.exitFullscreen) {\n        document.exitFullscreen();\n      } else if (document.webkitExitFullscreen) {\n        document.webkitExitFullscreen();\n      } else if (document.mozCancelFullScreen) {\n        document.mozCancelFullScreen();\n      } else if (document.msExitFullscreen) {\n        document.msExitFullscreen();\n      }\n    }\n  }\n\n  zeroPrefix(number, zeros) {\n    let n = number;\n    let o = '';\n    for (let i = 1; i < zeros; i += 1) {\n      if (n < 10) {\n        o += '0';\n      } else {\n        n /= 10;\n      }\n    }\n\n    return `${o}${number}`;\n  }\n\n  renderDateTime(date) {\n    const zero = (n) => this.zeroPrefix(n, 2);\n    return [\n      [date.getFullYear(), zero(date.getMonth() + 1), zero(date.getDate())].join('-'),\n      [date.getHours(), zero(date.getMinutes()), zero(date.getSeconds())].join(':'),\n    ].join(' ');\n  }\n\n  renderMillisecondDuration(duration) {\n    const m = Math.floor(duration / 1000 / 60);\n    if (m > 99) return '99:99.99+';\n    const s = duration / 1000 - m * 60;\n    return `${m}:${this.zeroPrefix(s.toFixed(3), 2)}`;\n  }\n\n  beginRecording(options = {}) {\n    const scene = this.topScene();\n\n    const now = new Date();\n\n    this._recording = {\n      timestamp: now.getTime(),\n      initData: scene.scene.settings.data,\n      sceneName: scene.constructor.name,\n      name: this.renderDateTime(now),\n      commandState: this.command.freezeCommandState(),\n      ...options,\n    };\n\n    scene.beginRecording(this._recording);\n\n    if (this._recording.snapshot) {\n      this.stopRecording();\n    } else if (this.onRecordBegin) {\n      this.onRecordBegin(this._recording);\n    }\n  }\n\n  stopRecording() {\n    const recording = this._recording;\n    if (!recording) {\n      return;\n    }\n\n    this.topScene().stopRecording();\n    delete this._recording;\n\n    if (this.onRecordStop) {\n      this.onRecordStop(recording);\n    }\n\n    return recording;\n  }\n\n  beginReplay(replay, options = {}) {\n    this._replay = replay;\n\n    let {startFromTransition} = options;\n    const {sceneTransitions} = replay;\n    if (!startFromTransition && sceneTransitions) {\n      for (let i = 0; i < sceneTransitions.length; i += 1) {\n        if (sceneTransitions[i].tickCount <= replay.preflightCutoff) {\n          startFromTransition = sceneTransitions[i];\n        }\n      }\n    }\n\n    const preflightCutoff = Math.max(\n      replay.preflightCutoff,\n      startFromTransition ? (startFromTransition.tickCount || 0) : 0,\n    );\n\n    this.transitionToSceneToBeginReplay(replay, startFromTransition).then((newScene) => {\n      newScene.beginReplay(replay, {\n        ...options,\n        startFromTransition,\n        preflightCutoff,\n        onEnd: () => {\n          this.endedReplay();\n        },\n        onStop: () => {\n          this.stopReplay(true);\n        },\n      });\n\n      if (this.onReplayBegin) {\n        this.onReplayBegin(replay);\n      }\n    });\n  }\n\n  transitionToSceneToBeginReplay(replay, startFromTransition) {\n    const oldScene = this.topScene();\n    const sceneKey = `scene-${Math.random() * Date.now()}`;\n\n    const {\n      sceneSaveState, sceneName, initData, commandState,\n    } = startFromTransition || replay;\n    const save = JSON.parse(JSON.stringify(sceneSaveState));\n    const {seed} = (startFromTransition || replay).initData;\n\n    const returnPromise = new Promise((resolve, reject) => {\n      this.onSceneInit(sceneKey, (newScene) => {\n        this.command.thawCommandState(commandState);\n        newScene.willTransitionFrom(null, null);\n        oldScene._sceneTransition(oldScene, newScene, null);\n        resolve(newScene, null);\n      });\n    });\n\n    oldScene.scene.add(\n      sceneKey,\n      this._sceneConstructors[sceneName],\n      true,\n      {\n        ...initData,\n        save,\n        seed,\n        transition: null,\n      },\n    );\n\n    return returnPromise;\n  }\n\n  endedReplay() {\n    if (!this._replay) {\n      return;\n    }\n\n    const replay = this._replay;\n    delete this._replay;\n\n    if (this.onReplayEnd) {\n      this.onReplayEnd(replay);\n    }\n  }\n\n  stopReplay(skipDownward) {\n    if (!this._replay) {\n      return;\n    }\n\n    const replay = this._replay;\n    delete this._replay;\n\n    if (!skipDownward) {\n      this.topScene().stopReplay();\n    }\n\n    if (this.onReplayStop) {\n      this.onReplayStop(replay);\n    }\n  }\n\n  playMusic(name, forceRestart) {\n    if (forceRestart || this.currentMusicName !== name) {\n      if (this.currentMusicPlayer && this.currentMusicPlayer.key) {\n        this.currentMusicPlayer.destroy();\n      }\n\n      if (name) {\n        try {\n          const music = this.sound.add(name);\n          if (!music || !music.key) {\n            // eslint-disable-next-line no-console\n            console.warn(`Could not load music ${name}`);\n            return;\n          }\n\n          music.play('', {loop: true});\n          music.setVolume(this.volume * prop('scene.musicVolume'));\n          this.currentMusicPlayer = music;\n          this.currentMusicName = name;\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.log(`Could not play music ${name}: ${e}`);\n        }\n      } else {\n        this.currentMusicName = name;\n      }\n    }\n  }\n\n  readRawInput() {\n    const scenes = this.scene.scenes.filter((scene) => scene.input.gamepad);\n    if (scenes) {\n      this.command.readRawGamepad(scenes);\n    }\n  }\n\n  cutoffTimeSightEnter() {\n    const scene = this.topScene();\n    if (scene) {\n      scene.cutoffTimeSightEnter();\n    }\n  }\n\n  cutoffTimeSightChanged(start, end) {\n    const scene = this.topScene();\n    if (scene) {\n      scene.cutoffTimeSightChanged(start, end);\n    }\n  }\n\n  cutoffTimeSightLeave() {\n    const scene = this.topScene();\n    if (scene) {\n      scene.cutoffTimeSightLeave();\n    }\n  }\n\n  shaderInstance(shaderName) {\n    if (this.renderer.type !== Phaser.WEBGL) {\n      return null;\n    }\n\n    return this.renderer.getPipeline(shaderName);\n  }\n\n  initializeShader(shaderName, replace) {\n    if (this.renderer.type !== Phaser.WEBGL) {\n      return;\n    }\n\n    if (!replace && this.renderer.hasPipeline(shaderName)) {\n      return;\n    }\n\n    const source = this.generateShaderSource(shaderName);\n\n    if (source) {\n      const shaderClass = this.shaderInstantiation(source);\n      const shader = new shaderClass(this);\n\n      // undefined `active` indicates the shader didn't completely load,\n      // probably due to a compile error\n      if (!shader || shader.active === undefined) {\n        return;\n      }\n\n      if (replace) {\n        this.renderer.removePipeline(shaderName);\n      }\n\n      this.renderer.addPipeline(shaderName, shader);\n\n      shader.setFloat2('resolution', this.config.width, this.config.height);\n    } else {\n      this.renderer.removePipeline(shaderName);\n    }\n\n    this._shaderSource[shaderName] = source;\n  }\n\n  initializeShaders() {\n    Object.keys(this._shaderPipelines).forEach((name) => {\n      this.initializeShader(name);\n    });\n  }\n\n  updateShaderFragments(nextCoord, nextColor, nextPipelines) {\n    this._initializeShaderStructures(nextCoord, nextColor, nextPipelines);\n    this.recompileShaders();\n  }\n\n  generateShaderSourceInternal(shaderName) {\n    const bothFragmentTypes = this._shaderPipelines[shaderName];\n    if (!bothFragmentTypes) {\n      throw new Error(`No definition found for shader pipeline ${shaderName}; do you need to add it to shaderPipelines in props.js?`);\n    }\n\n    const [shaderCoordSource, shaderColorSource] = bothFragmentTypes.map((fragments) => {\n      if (!fragments) {\n        return '';\n      }\n\n      return fragments.filter(([name]) => prop(`shader.${name}.enabled`)).map(([, , source]) => source).join('\\n');\n    });\n\n    if (!shaderCoordSource && !shaderColorSource) {\n      return;\n    }\n\n    return `\n      void main( void ) {\n        vec2 uv = outTexCoord;\n\n        ${shaderCoordSource}\n\n        vec4 c = texture2D(uMainSampler, uv);\n\n        ${shaderColorSource}\n\n        gl_FragColor = vec4(c.rgb * c.a, c.a);\n      }\n    `;\n  }\n\n  generateShaderSource(shaderName) {\n    const bothFragmentTypes = this._shaderPipelines[shaderName];\n    if (!bothFragmentTypes) {\n      throw new Error(`No definition found for shader pipeline ${shaderName}; do you need to add it to shaderPipelines in props.js?`);\n    }\n\n    const builtinDeclarations = `\n      precision mediump float;\n    `;\n\n    const builtinUniforms = `\n      uniform sampler2D uMainSampler;\n      varying vec2      outTexCoord;\n\n      uniform vec2 resolution;\n      uniform vec2 camera_scroll;\n      uniform float scene_time;\n    `;\n\n    const uniformNames = [];\n    const uniformDeclarations = [];\n\n    [...bothFragmentTypes[0], ...bothFragmentTypes[1]].forEach(([fragmentName, uniforms]) => {\n      if (!prop(`shader.${fragmentName}.enabled`)) {\n        return;\n      }\n\n      Object.entries(uniforms).forEach(([uniformName, [type]]) => {\n        const name = `${fragmentName}_${uniformName}`;\n        uniformNames.push(name);\n        const [, uniformType] = shaderTypeMeta[type];\n        uniformDeclarations.push(`uniform ${uniformType} ${name};\\n`);\n      });\n    });\n\n    const userShaderBody = this.generateShaderSourceInternal(shaderName);\n    if (!userShaderBody) {\n      return userShaderBody;\n    }\n\n    uniformNames.forEach((name) => {\n      const regex = new RegExp(`\\\\b${name.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\b`);\n\n      if (!userShaderBody.match(regex)) {\n        // eslint-disable-next-line no-console, max-len\n        console.error(`Shader program ${shaderName} doesn't appear use uniform '${name}'. (If this is a false positive, try adding this to your program: // ${name}`);\n      }\n    });\n\n    return `\n      ${builtinDeclarations}\n      ${builtinUniforms}\n      ${uniformDeclarations.join('')}\n      ${userShaderBody}\n    `;\n  }\n\n  recompileShader(shaderName) {\n    if (this.renderer.type !== Phaser.WEBGL) {\n      return;\n    }\n\n    const oldSource = this._shaderSource[shaderName];\n    const newSource = this.generateShaderSource(shaderName);\n\n    if (oldSource === newSource) {\n      return;\n    }\n\n    // eslint-disable-next-line no-console\n    console.info(`Hot-loading shader ${shaderName}`);\n\n    this._shaderSource[shaderName] = newSource;\n\n    if (newSource) {\n      this.initializeShader(shaderName, true);\n    } else {\n      this.renderer.removePipeline(shaderName);\n    }\n\n    const shader = this.shaderInstance(shaderName);\n\n    this.scene.scenes.forEach((scene) => {\n      if (scene.shaderName !== shaderName) {\n        return;\n      }\n\n      scene.shader = shader;\n      if (newSource) {\n        scene._shaderInitialize();\n        scene._shaderUpdate();\n        scene.camera.setPipeline(shader);\n      } else {\n        scene.camera.clearRenderToTexture();\n      }\n    });\n  }\n\n  recompileShaders() {\n    Object.keys(this._shaderPipelines).forEach((name) => {\n      this.recompileShader(name);\n    });\n  }\n\n  disableShader(shaderName) {\n    if (this.renderer.type !== Phaser.WEBGL) {\n      return;\n    }\n\n    this._shaderSource[shaderName] = null;\n\n    this.renderer.removePipeline(shaderName);\n\n    const shader = this.shaderInstance(shaderName);\n\n    this.scene.scenes.forEach((scene) => {\n      if (scene.shaderName !== shaderName) {\n        return;\n      }\n\n      scene.shader = shader;\n      scene.camera.clearRenderToTexture();\n    });\n  }\n\n  disableShaders() {\n    Object.keys(this._shaderPipelines).forEach((name) => {\n      this.disableShader(name);\n    });\n  }\n\n  shaderInstantiation(fragShader) {\n    try {\n      return new Phaser.Class({\n        Extends: Phaser.Renderer.WebGL.Pipelines.TextureTintPipeline,\n        initialize: function Shader(game) {\n          try {\n            Phaser.Renderer.WebGL.Pipelines.TextureTintPipeline.call(this, {\n              game,\n              renderer: game.renderer,\n              fragShader,\n            });\n          } catch (e) {\n            // eslint-disable-next-line no-console\n            console.error(e);\n          }\n        },\n      });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n    }\n  }\n\n  onSceneInit(key, cb) {\n    if (!this._sceneInitCallbacks[key]) {\n      this._sceneInitCallbacks[key] = [];\n    }\n\n    this._sceneInitCallbacks[key].push(cb);\n  }\n\n  sceneDidInit(scene) {\n    const {key} = scene.scene;\n    if (!this._sceneInitCallbacks[key]) {\n      return;\n    }\n\n    this._sceneInitCallbacks[key].forEach((cb) => {\n      cb(scene);\n    });\n\n    delete this._sceneInitCallbacks[key];\n  }\n}\n","export const Distance = (dx, dy) => {\n  return Math.sqrt(dx ** 2 + dy ** 2);\n};\n\nexport const NormalizeVector = (dx, dy) => {\n  const d = Distance(dx, dy);\n  return [dx / d, dy / d];\n};\n\nexport const NormalizeVectorWithDistance = (dx, dy) => {\n  const d = Distance(dx, dy);\n  return [dx / d, dy / d, d];\n};\n\nexport const SumVectors = (vs) => {\n  let tx = 0;\n  let ty = 0;\n\n  vs.foreach((vx, vy) => {\n    tx += vx;\n    ty += vy;\n  });\n\n  return [tx, ty];\n};\n\nexport const CentroidPoints = (ps) => {\n  let tx = 0;\n  let ty = 0;\n\n  ps.foreach((px, py) => {\n    tx += px;\n    ty += py;\n  });\n\n  return [tx / ps.length, ty / ps.length];\n};\n","import _ from \"lodash\";\nimport SuperScene from \"./scaffolding/SuperScene\";\nimport prop from \"./props\";\nimport { NormalizeVector } from \"./scaffolding/lib/vector\";\nimport Phaser from \"phaser\";\n\nconst Illuminated = window.illuminated;\nconst {\n  Lamp,\n  PolygonObject,\n  //DiscObject,\n  DarkMask,\n  Vec2,\n  Lighting,\n} = Illuminated;\n\n// DELAY THE INEVITABLE\n\nconst Downsamples = [24, 12, 4, 1];\nlet AmbientSamples = Downsamples.shift();\nlet OldAmbient = AmbientSamples;\n\nconst Downsample = (t) => {\n  if (AmbientSamples > 1 && Downsamples.length) {\n    console.log(\"downsampling to \", Downsamples[0]);\n    AmbientSamples = OldAmbient = Downsamples.shift();\n    t();\n  }\n};\n\nexport default class PlayScene extends SuperScene {\n  constructor() {\n    super({\n      input: {\n        gamepad: true,\n      },\n      physics: {\n        arcade: {\n          fps: 60,\n        },\n      },\n    });\n\n    this.downsamples = Downsamples;\n    this.performanceProps = [\n      ...Downsamples.map(() => () => Downsample(() => this.resampleSuns())),\n    ];\n\n    this.mapsAreRectangular = true;\n    this.suns = [];\n  }\n\n  initialSaveState() {\n    return {\n      createdAt: Date.now(),\n      deaths: 0,\n      level: 0,\n    };\n  }\n\n  saveStateVersion() {\n    return 1;\n  }\n\n  migrateSaveStateVersion1(save) {}\n\n  init(config) {\n    super.init(config);\n  }\n\n  preload() {\n    super.preload();\n  }\n\n  rotatedVecs(rect) {\n    const { lightX, lightY } = this;\n    const vecs = [];\n    const {\n      originX,\n      originY,\n      rotation,\n      width,\n      height,\n      x: offsetX,\n      y: offsetY,\n      scaleX,\n      scaleY,\n      overrideScaleX,\n      overrideScaleY,\n    } = rect;\n\n    const w = width * (overrideScaleX || scaleX);\n    const h = height * (overrideScaleY || scaleY);\n\n    [[0, 0], [0, h], [w, h], [w, 0]].forEach(([x, y]) => {\n      const { x: newX, y: newY } = Phaser.Math.RotateAround(\n        { x: x - w * originX, y: y - h * originY },\n        originX,\n        originY,\n        rotation\n      );\n      vecs.push(new Vec2(newX + offsetX - lightX, newY + offsetY - lightY));\n    });\n    return vecs;\n  }\n\n  createLightCanvas() {\n    const key = (this.lightKey = \"light-\" + Date.now());\n    const lightWidth = (this.lightWidth = 1000);\n    const lightHeight = (this.lightHeight = 800);\n    // const lightWidth = (this.lightWidth = 800);\n    // const lightHeight = (this.lightHeight = 600);\n    const lightX = (this.lightX = (800 - this.lightWidth) / 2);\n    const lightY = (this.lightY = (600 - this.lightHeight) / 2);\n    this.lightTexture = this.textures.createCanvas(\n      key,\n      lightWidth,\n      lightHeight\n    );\n    this.add\n      .image(lightX, lightY, key)\n      .setOrigin(0, 0)\n      .setDepth(-100);\n  }\n\n  createSun(x, y, objects, backwards) {\n    let coronaPrimary = 255;\n    let coronaSecondary = 0;\n    let ambientPrimary = 255;\n    let ambientSecondary = 200;\n\n    const bead = this.add.image(x, y, \"bead\");\n\n    const corona = new Lamp({\n      position: new Vec2(x - this.lightX, y - this.lightY),\n      color: `rgba(${\n        backwards ? coronaSecondary : coronaPrimary\n      }, ${coronaSecondary}, ${\n        backwards ? coronaPrimary : coronaSecondary\n      }, 0.8)`,\n      distance: 100,\n      radius: 10,\n      samples: 0,\n    });\n    const ambient = new Lamp({\n      position: new Vec2(x - this.lightX, y - this.lightY),\n      color: `rgba(${\n        backwards ? ambientSecondary : ambientPrimary\n      }, ${ambientSecondary}, ${\n        backwards ? ambientPrimary : ambientSecondary\n      }, 1)`,\n      distance: 1400,\n      radius: 10,\n      samples: AmbientSamples,\n    });\n\n    const lighting1 = new Lighting({\n      light: ambient,\n      objects,\n    });\n    const lighting2 = new Lighting({\n      light: corona,\n      objects: [],\n    });\n\n    const lamps = [corona, ambient];\n    const lightings = [lighting1, lighting2];\n\n    const set = { bead, corona, ambient, lamps, lightings, backwards };\n\n    this.suns.push(set);\n\n    this.dark = new DarkMask({\n      lights: _.flatMap(this.suns, ({ lamps }) => lamps),\n    });\n\n    return set;\n  }\n\n  resampleSuns() {\n    (this.suns || []).forEach(({ corona, ambient }) => {\n      ambient.samples = AmbientSamples;\n    });\n  }\n\n  createHealthBar(owner) {\n    const border = this.add.sprite(owner.x, owner.y, \"hpbar\");\n    const fill = this.add.sprite(owner.x, owner.y, \"hpbar\");\n    const healthBar = {\n      fill,\n      border,\n    };\n\n    fill.setCrop(1, 1, fill.width - 2, fill.height - 2);\n    fill.tint = 0xff0000;\n\n    border.tint = 0;\n    border.visible = fill.visible = false;\n    owner.healthBar = healthBar;\n  }\n\n  updateHealthBarFor(owner, percent) {\n    const { healthBar } = owner;\n    const { fill, border } = healthBar;\n\n    if (percent <= 0) {\n      border.visible = fill.visible = false;\n      return;\n    }\n\n    border.visible = fill.visible = true;\n    border.x = owner.x;\n    border.y = owner.y - owner.height;\n    fill.x = owner.x;\n    fill.y = owner.y - owner.height;\n\n    fill.setCrop(1, 1, fill.width * percent - 2, fill.height - 2);\n  }\n\n  createSmoker(player) {\n    const lightAsh = {};\n    this.particleSystem(\"effects.lightAsh\", {\n      follow: player,\n      x: { min: -player.width / 2, max: player.width / 2 },\n      y: { min: -player.height / 2, max: player.height / 2 },\n      alpha: { start: 1, end: 0 },\n      scale: { start: 0.75, end: 1.125 },\n      speedY: {\n        min: 0.5 * prop(\"effects.lightAsh.speedY\"),\n        max: prop(\"effects.lightAsh.speedY\"),\n      },\n      speedX: {\n        min: -prop(\"effects.lightAsh.speedX\"),\n        max: prop(\"effects.lightAsh.speedX\"),\n      },\n      tint: [0xf6c456, 0xec5b55, 0xaaaaaa],\n      onAdd: (particles, emitter) => {\n        lightAsh.particles = particles;\n        lightAsh.emitter = emitter;\n        emitter.on = false;\n      },\n    });\n\n    player.smoker = {\n      lightAsh,\n    };\n  }\n\n  createStars(level) {\n    this.particleSystem(\"effects.stars\", {\n      x: { min: -100, max: 900 },\n      y: { min: -100, max: 700 },\n      lifespan: {\n        min: prop(\"effects.stars.lifespan\") * 0.5,\n        max: prop(\"effects.stars.lifespan\") * 2,\n      },\n      scale: {\n        start: 0,\n        end: 1,\n        ease: (t) => (t < 0.2 ? 5 * t : 1 - (t - 0.2)),\n      },\n      alpha: {\n        start: 0,\n        end: 0.75,\n        ease: (t) => (t < 0.2 ? 5 * t : 1 - (t - 0.2)),\n      },\n      tint: [0xf6c456, 0xec5b55, 0xaaaaaa],\n      onAdd: (particles, emitter) => {\n        particles.setDepth(-50);\n        level.stars = { particles, emitter };\n      },\n    });\n  }\n\n  scheduleComet(level, t = this.randBetween(\"comet\", 10000, 100000)) {\n    this.timer(() => {\n      this.comet(level);\n    }, t);\n  }\n\n  comet(level = this.level) {\n    let speedX = this.randBetween(\"comet\", 200, 400);\n    if (this.randFloat(\"comet\") < 0.5) {\n      speedX *= -1;\n    }\n    let speedY = this.randBetween(\"comet\", 3, 10);\n    if (this.randFloat(\"comet\") < 0.5) {\n      speedY *= -1;\n    }\n    const x = this.randBetween(\"comet\", 100, 700);\n    const y = this.randBetween(\"comet\", 100, 500);\n\n    const comet = this.add.image(x, y, \"dot\");\n    comet.setScale(1.5, 1.5);\n    comet.setDepth(-48);\n    this.tweenPercent(1000, (p) => {\n      const t = 0.03 + p;\n      let nx = x + speedX * t;\n      let ny = y + speedY * t;\n      comet.x = nx;\n      comet.y = ny;\n      comet.setScale(1 + (1 - p) * 0.5, 1 + (1 - p) * 0.5);\n    });\n\n    this.timer(() => {\n      comet.destroy();\n    }, prop(\"effects.comet.lifespan\"));\n    this.particleSystem(\"effects.comet\", {\n      scale: 0.5,\n      alpha: 0.5,\n      speedX,\n      speedY,\n      onAdd: (particles, emitter) => {\n        particles.x = x;\n        particles.y = y;\n        particles.setDepth(-49);\n        level.comet = { particles, emitter };\n        this.timer(() => {\n          emitter.stop();\n        }, 1000);\n        this.timer(() => {\n          particles.destroy();\n        }, 2000);\n      },\n    });\n  }\n\n  createLevel(id) {\n    const levelId = this.levelIds()[id];\n    const level = super.createLevel(levelId);\n\n    level.index = id;\n    level.player = level.groups.player.objects[0];\n    level.player.setGravityY(prop(\"player.gravityBase\"));\n    level.player.anims.play(\"idle\");\n    level.player.overrideScaleX = 0.5;\n    //level.player.anims.play(\"idle\");\n\n    this.cameraFollow(level.player);\n\n    this.createHealthBar(level.player);\n    this.createSmoker(level.player);\n    this.createStars(level);\n    this.scheduleComet(level);\n\n    level.blockingObjects = [];\n    Object.entries(level.groups).forEach(([name, group]) => {\n      const { objects, shadow } = group;\n      if (shadow) {\n        level.blockingObjects.push(...objects);\n      }\n      switch (name) {\n        case \"spinner\":\n        case \"reverseSpinner\":\n          objects.forEach((obj) => {\n            obj.setImmovable();\n            if (name === \"reverseSpinner\") {\n              obj.body.setAngularVelocity(-30);\n              // This 180 is misleading, it's radians\n              obj.rotation = 180;\n            } else {\n              obj.body.setAngularVelocity(30);\n            }\n          });\n          break;\n        case \"drawbridge\":\n          objects.forEach((obj) => {\n            obj.setImmovable();\n            obj.body.pushable = false;\n            obj.setOrigin(0.95, 0.25);\n            obj.angle = prop(\"effects.drawbridge.rotation\");\n            obj.body.enable = false;\n\n            const fudge = 12;\n            const alternate = group.group.create(\n              obj.x + fudge,\n              obj.y,\n              \"drawbridgeAlt\"\n            );\n            alternate.setOrigin(1 - 0.25, 1 - 0.95);\n            alternate.setImmovable();\n            alternate.body.pushable = false;\n\n            alternate.visible = false;\n\n            obj.alternate = alternate;\n          });\n          break;\n        case \"button\":\n          objects.forEach((obj) => {\n            obj.setDepth(-5);\n          });\n          break;\n        default:\n          break;\n      }\n    });\n\n    level.shadowObjects = [level.player, ...level.blockingObjects];\n\n    return level;\n  }\n\n  create(config) {\n    super.create(config);\n\n    // lol doh!\n    let levelIndex;\n    if (config.levelIndex !== undefined) {\n      levelIndex = config.levelIndex;\n    } else if (this.save.level !== undefined) {\n      levelIndex = this.save.level;\n    } else {\n      levelIndex = 0;\n    }\n\n    levelIndex = levelIndex % this.levelIds().length;\n\n    this.save.level = levelIndex;\n    this.saveState();\n\n    this.respawn = config.respawn;\n\n    const level = this.createLevel(levelIndex);\n\n    this.createLightCanvas();\n\n    level.illObjects = level.shadowObjects.map((sprite) => {\n      const occ = new PolygonObject({ points: this.rotatedVecs(sprite) });\n      sprite.occ = occ;\n      return occ;\n    });\n\n    this.createSun(0, 0, level.illObjects);\n    if (level.dualSun) {\n      this.createSun(0, 0, level.illObjects, true);\n    }\n\n    this.hud = this.createHud();\n    this.setupPhysics();\n\n    this.command.ignoreAll(\"winning\", false);\n    this.command.ignoreAll(\"dying\", false);\n\n    this.spawn();\n  }\n\n  spawn() {\n    const { level, save } = this;\n\n    // make absolutely sure :D\n    this.timer(() => {\n      this.command.ignoreAll(\"winning\", false);\n      this.command.ignoreAll(\"dying\", false);\n    }, 300);\n\n    if (level.lastLevel) {\n      const wait = 500;\n      this.speak(400, 300, level.hi, {\n        duration: wait,\n        noOut: true,\n        onAdd: (label) => {\n          this.timer(() => {\n            this.tween(\"effects.attract\", label);\n          }, wait);\n        },\n      });\n\n      let label;\n      const { deaths } = save;\n      switch (deaths) {\n        case 0:\n          label = \"You won without dying!!! You are inevitable!\";\n          break;\n        case 1:\n          label = \"You perished only once!!\";\n          break;\n        default:\n          label = `You delayed the inevitable, but perished ${deaths} times.`;\n          break;\n      }\n\n      this.timer(() => {\n        this.speak(400, 400, label, {\n          duration: wait,\n          noOut: true,\n          onAdd: (label) => {\n            this.timer(() => {\n              this.tween(\"effects.attract\", label);\n            }, wait);\n          },\n        });\n      }, wait);\n    } else {\n      if (!this.respawn) {\n        this.speak(\"@\", level.hi, { dy: -50, fontSize: \"18px\" });\n      }\n    }\n  }\n\n  createHud() {\n    const hud = {};\n    /*\n    const score = hud.score = this.text(x, y, text, {color: 'rgb(255, 255, 255)'});\n    scoreSteady.setScrollFactor(0);\n    scoreSteady.setDepth(1000);\n    */\n    return hud;\n  }\n\n  setupPhysics() {\n    const { level, physics } = this;\n    const { player, groups } = level;\n    const { wall, ground, crumble, button, drawbridge } = groups;\n\n    physics.add.collider(player, wall.group);\n    physics.add.collider(player, ground.group);\n    physics.add.collider(player, drawbridge.group);\n    physics.add.collider(player, crumble.group, (...args) =>\n      this.crumble(...args)\n    );\n    physics.add.collider(player, button.group, (...args) =>\n      this.button(...args)\n    );\n  }\n\n  crumble(player, block) {\n    if (block.crumbling) {\n      return;\n    }\n\n    if (player.y + player.height * 0.6 >= block.y) {\n      return;\n    }\n\n    block.crumbling = true;\n    block.anims.play(\"crumbling\");\n    this.playSound(\"breaking\");\n    this.tween(\"effects.firstCrumble\", block, {\n      onComplete: () => {\n        this.tween(\"effects.crumble\", block, {\n          onComplete: () => {\n            block.disableBody(true, false);\n          },\n        });\n      },\n    });\n  }\n\n  button(player, button) {\n    if (player.y + player.height * 0.6 >= button.y) {\n      return;\n    }\n\n    if (player.pressingButton) {\n      return;\n    }\n    player.pressingButton = true;\n\n    if (button.toggling) {\n      return;\n    }\n    button.toggling = true;\n\n    const [drawbridge] = this.level.groups.drawbridge.objects;\n    const alternate = drawbridge.alternate;\n    this.playSound(\"drawbridge\");\n\n    this.tween(\"effects.buttonPress\", button, {\n      onComplete: () => {\n        button.toggling = false;\n      },\n    });\n\n    if (button.pressed) {\n      button.pressed = false;\n      alternate.body.enable = true;\n      drawbridge.body.enable = false;\n      this.tween(\"effects.drawbridge\", drawbridge, {});\n    } else {\n      alternate.body.enable = false;\n      drawbridge.body.enable = true;\n      button.pressed = true;\n      this.tween(\"effects.drawbridge\", drawbridge, {\n        rotation: 0,\n      });\n    }\n  }\n\n  setupAnimations() {\n    this.anims.create({\n      key: \"idle\",\n      frames: [\n        {\n          key: \"player\",\n          frame: 0,\n        },\n      ],\n    });\n    this.anims.create({\n      key: \"run\",\n      frames: [\n        {\n          key: \"player\",\n          frame: 2,\n        },\n        {\n          key: \"player\",\n          frame: 1,\n        },\n        {\n          key: \"player\",\n          frame: 2,\n        },\n        {\n          key: \"player\",\n          frame: 3,\n        },\n      ],\n      repeat: -1,\n      frameRate: 8,\n    });\n    this.anims.create({\n      key: \"fall\",\n      frames: [\n        {\n          key: \"player\",\n          frame: 5,\n        },\n      ],\n    });\n    this.anims.create({\n      key: \"jump\",\n      frames: [\n        {\n          key: \"player\",\n          frame: 4,\n        },\n      ],\n    });\n    this.anims.create({\n      key: \"crumbling\",\n      frames: [\n        {\n          key: \"crumble\",\n          frame: 1,\n        },\n      ],\n    });\n  }\n\n  processInput(time, dt) {\n    const { command, level } = this;\n    const { player } = level;\n\n    let dx = 0;\n    let dy = 0;\n    let stickInput = false;\n\n    const touchingDown = player.body.touching.down;\n    if (touchingDown) {\n      player.lastTouchDown = time;\n    }\n\n    const canJump = player.lastTouchDown > time - 75 && !player.isJumping;\n    if (command.jump.started) {\n      if (canJump) {\n        player.isJumping = true;\n        player.hasLiftedOff = false;\n        player.hasReleasedJump = false;\n        player.jumpStart = time;\n        player.setVelocityY(\n          player.body.velocity.y - prop(\"player.baseJumpVelocity\")\n        );\n        this.playSound(\"jump\", 3);\n      }\n    }\n\n    if (command.down.held) {\n      dy = 1;\n    }\n\n    if (command.right.held) {\n      dx = 1;\n    } else if (command.left.held) {\n      dx = -1;\n    }\n\n    if (command.lstick.held) {\n      [dx, dy] = command.lstick.held;\n      stickInput = true;\n    } else if (command.rstick.held) {\n      [dx, dy] = command.rstick.held;\n      stickInput = true;\n    }\n\n    if (stickInput) {\n      if (Math.abs(dx) > 0.9) {\n        dx = dx < 0 ? -1 : 1;\n        dy = 0;\n      } else if (Math.abs(dy) > 0.9) {\n        dy = dy < 0 ? -1 : 1;\n        dx = 0;\n      }\n    }\n\n    if (dx || dy) {\n      [dx, dy] = NormalizeVector(dx, dy);\n    } else {\n      dx = dy = 0;\n    }\n\n    let vx = player.body.velocity.x + dx * prop(\"player.speed\");\n    vx *= 1 - prop(\"player.drag\");\n    player.setVelocityX(vx);\n    if (Math.abs(vx) > 0) {\n      player.setFlipX(vx < 0);\n    }\n\n    const vy = player.body.velocity.y;\n    if (player.body.touching.down || this.pressingButton) {\n      if (Math.abs(dx) > 0) {\n        player.anims.play(\"run\", true);\n      } else {\n        player.anims.play(\"idle\", true);\n      }\n    } else if (vy > 0) {\n      player.anims.play(\"fall\", true);\n    } else if (vy < 0) {\n      player.anims.play(\"jump\", true);\n    }\n\n    // squash and stretch\n    {\n      let targetX = 1;\n      let targetY = 1;\n\n      const { x, y } = player.body.velocity;\n      let dx = Math.abs(x) / (32 * 32);\n      let dy = Math.abs(y) / (32 * 32);\n\n      if (dx + dy > 0.1) {\n        [dx, dy] = [(dx - dy) / (dx + dy), (dy - dx) / (dx + dy)];\n\n        // intentionally flipped\n        const max = 0.1;\n        targetX = dy * max + 1;\n        targetY = dx * max + 1;\n      }\n\n      const lerp = 0.1;\n      const sx = player.scaleX + (targetX - player.scaleX) * lerp;\n      const sy = player.scaleY + (targetY - player.scaleY) * lerp;\n      player.setScale(sx, sy);\n    }\n  }\n\n  processJumping(time, dt) {\n    const { command, level } = this;\n    const { player } = level;\n\n    if (!command.jump.held) {\n      player.hasReleasedJump = true;\n    }\n\n    const touchingDown = player.body.touching.down;\n    if (touchingDown) {\n      player.lastTouchDown = time;\n    }\n\n    if (!touchingDown) {\n      player.pressingButton = false;\n    }\n\n    if (player.isJumping && !player.hasLiftedOff && !touchingDown) {\n      player.hasLiftedOff = true;\n    }\n\n    if (player.isJumping && player.hasLiftedOff && touchingDown) {\n      player.hasLiftedOff = false;\n      player.isJumping = false;\n      this.playSound(\n        \"land\",\n        false,\n        Math.min(\n          0.8,\n          (1.5 * player.previousVelocityY) / prop(\"player.jumpTraumaDivisor\")\n        )\n      );\n      this.trauma(\n        Math.min(\n          prop(\"player.maxJumpTrauma\"),\n          player.previousVelocityY / prop(\"player.jumpTraumaDivisor\")\n        )\n      );\n    }\n\n    let vy = player.body.velocity.y;\n    if (player.isJumping && !player.hasReleasedJump) {\n      if (time - player.jumpStart > prop(\"player.maxJumpTime\")) {\n        player.hasReleasedJump = true;\n      } else {\n        vy -= prop(\"player.baseJumpVelocity\");\n        vy *= 1 - prop(\"player.drag\");\n        player.setVelocityY(vy);\n      }\n    }\n\n    player.previousVelocityY = player.body.velocity.y;\n  }\n\n  sunPosition(percent = this.percent, backwards) {\n    const firstKey = backwards ? \"bwFirstPoint\" : \"firstPoint\";\n    const lastKey = backwards ? \"bwLastPoint\" : \"lastPoint\";\n    const splineKey = backwards ? \"bwSpline\" : \"spline\";\n\n    if (!this[splineKey]) {\n      const points = [];\n      if (backwards) {\n        points.push(new Phaser.Math.Vector2(0, 750));\n      } else {\n        points.push(new Phaser.Math.Vector2(10, 600));\n      }\n\n      points.push(new Phaser.Math.Vector2(100, 200));\n      points.push(new Phaser.Math.Vector2(400, 10));\n      points.push(new Phaser.Math.Vector2(700, 200));\n      points.push(new Phaser.Math.Vector2(800, 750));\n      this[firstKey] = points[0];\n      this[lastKey] = points[points.length - 1];\n      this[splineKey] = new Phaser.Curves.Spline(points);\n    }\n\n    let p;\n    if (percent < 0) {\n      p = this[firstKey];\n    } else if (this.winning || percent > 1) {\n      p = this[lastKey];\n    } else {\n      p = this[splineKey].getPoint(percent);\n    }\n\n    return [p.x, p.y];\n  }\n\n  spinnered() {\n    const { level, lightX, lightY } = this;\n    const { player, groups } = level;\n    const { spinner, reverseSpinner } = groups;\n\n    const bounds = player.getBounds();\n\n    return [...spinner.objects, ...reverseSpinner.objects].some(({ occ }) => {\n      const { points } = occ;\n      return [[0, 1], [1, 2], [2, 3], [3, 0]].some(([i1, i2]) => {\n        const p1 = points[i1];\n        const p2 = points[i2];\n        const edge = new Phaser.Geom.Line(\n          p1.x + lightX,\n          p1.y + lightY,\n          p2.x + lightX,\n          p2.y + lightY\n        );\n        return Phaser.Geom.Intersects.LineToRectangle(edge, bounds);\n      });\n    });\n  }\n\n  crispingSun() {\n    const { suns, percent, lightX, lightY, level } = this;\n    const { player, blockingObjects } = level;\n\n    const { x: playerX, y: playerY } = player;\n\n    const sunrays = suns.map((sun) => {\n      const { backwards } = sun;\n      const [sunX, sunY] = this.sunPosition(\n        backwards ? 1 - percent : percent,\n        backwards\n      );\n      const ray = new Phaser.Geom.Line(sunX, sunY, playerX, playerY);\n      return [sun, ray, Phaser.Geom.Line.Length(ray)];\n    });\n\n    const touchingSunrays = sunrays.filter(([_sun, sunray]) => {\n      return !blockingObjects.some((obj) => {\n        const { occ } = obj;\n        const { points } = occ;\n        return [[0, 1], [1, 2], [2, 3], [3, 0]].some(([i1, i2]) => {\n          const p1 = points[i1];\n          const p2 = points[i2];\n          const edge = new Phaser.Geom.Line(\n            p1.x + lightX,\n            p1.y + lightY,\n            p2.x + lightX,\n            p2.y + lightY\n          );\n          return Phaser.Geom.Intersects.LineToLine(sunray, edge);\n        });\n      });\n    });\n\n    if (!touchingSunrays.length) {\n      return;\n    }\n\n    return touchingSunrays;\n  }\n\n  moveShadowObjects() {\n    const { level } = this;\n\n    level.shadowObjects.forEach((s) => {\n      const { occ } = s;\n      occ.points = this.rotatedVecs(s);\n    });\n  }\n\n  fixedUpdate(time, dt) {\n    const { level } = this;\n    const { player } = level;\n\n    const rawTime = (this.t = (this.t || 0) + dt);\n    const speed = this.level.sunSpeed;\n    const t = (rawTime * speed) / 1000;\n    this.percent = t / 800;\n\n    const invincible = prop(\"player.invincible\");\n\n    this.processInput(time, dt);\n    this.processJumping(time, dt);\n    this.moveShadowObjects();\n\n    const maxCrisp = 2000;\n    level.stars.emitter.on = true;\n    level.stars.particles.visible = true;\n\n    if (this.playerDying) {\n      player.smoker.lightAsh.emitter.on = false;\n    } else {\n      if (this.spinnered()) {\n        this.playerDie(true);\n      }\n\n      this.crispingSuns =\n        !this.winning && this.percent < 0.9 && this.crispingSun();\n      if (this.level.dualSun && this.percent < 0.1) {\n        this.crispingSuns = undefined;\n      }\n\n      if (this.crispingSuns) {\n        this.crispTime = Math.min(maxCrisp, (this.crispTime || 0) + dt);\n        player.smoker.lightAsh.emitter.on = true;\n      } else {\n        this.crispTime = Math.max(0, (this.crispTime || 0) - dt);\n        player.smoker.lightAsh.emitter.on = false;\n      }\n\n      this.crispPercent = this.crispTime / maxCrisp;\n      player.smoker.lightAsh.emitter.frequency = 100 * (1 - this.crispPercent);\n\n      if (this.crispingSuns) {\n        if (time > (this.lastCrisp || 0) + 100) {\n          this.playSound(\"crisp\", false, Math.min(0.8, this.crispPercent));\n          this.lastCrisp = time;\n        }\n      }\n    }\n\n    let desiredTimeScale = 1;\n    let desiredZoom = 1;\n    if (this.crispPercent >= 0.6) {\n      level.stars.emitter.on = false;\n      level.stars.particles.visible = false;\n    }\n\n    this.minTrauma = 0;\n    if (this.crispPercent >= 1) {\n      if (!invincible) {\n        this.playerDie(true);\n      }\n    } else if (!this.playerDying && this.crispPercent >= 0.3) {\n      if (this.crispPercent >= 0.6) {\n        if (this.crispingSuns) {\n          desiredTimeScale = 1.5;\n          desiredZoom = 1.02;\n        }\n        this.minTrauma = 0.2;\n      } else {\n        this.minTrauma = 0.1;\n      }\n\n      if (invincible) {\n        this.minTrauma = 0;\n        desiredTimeScale = 1;\n        desiredZoom = 1;\n      }\n      this.trauma(0);\n    }\n\n    const factor = this.crispingSuns && !this.playerDying ? 0.01 : 0.4;\n    this.timeScale =\n      this.timeScale + (desiredTimeScale - this.timeScale) * factor;\n    this.camera.zoom =\n      this.camera.zoom + (desiredZoom - this.camera.zoom) * (factor * 1.5);\n\n    const grace = 200;\n    if (\n      player.x < -grace ||\n      player.x > grace + level.width ||\n      player.y < -grace ||\n      player.y > grace + level.height\n    ) {\n      this.playerDie(false);\n    }\n  }\n\n  unlightObject(obj) {\n    const { suns } = this;\n    const { occ } = obj;\n    suns.forEach(({ lightings }) => {\n      lightings.forEach((lighting) => {\n        lighting.objects = lighting.objects.filter((o) => o !== occ);\n      });\n    });\n  }\n\n  playerDie(explode) {\n    const { level, save } = this;\n    const { player } = level;\n    if (this.playerDying || this.winning) {\n      return;\n    }\n\n    save.deaths = (save.deaths || 0) + 1;\n    this.saveState();\n\n    this.playSound(\"explode\");\n\n    this.playerDying = true;\n    this.unlightObject(player);\n    this.shockwave(player.x, player.y);\n    this.command.ignoreAll(\"dying\", true);\n    this.trauma(1);\n    player.disableBody(true, false);\n\n    if (explode) {\n      this.particleSystem(\"effects.playerAsh\", {\n        x: {\n          min: player.x - player.width * 0.4,\n          max: player.x + player.width * 0.4,\n        },\n        y: {\n          min: player.y - player.height * 0.4,\n          max: player.y + player.height * 0.4,\n        },\n        alpha: { start: 1, end: 0 },\n        scale: { start: 0.75, end: 1 },\n        speedY: {\n          min: 0.5 * prop(\"effects.playerAsh.speedY\"),\n          max: prop(\"effects.playerAsh.speedY\"),\n        },\n        speedX: {\n          min: -prop(\"effects.playerAsh.speedX\"),\n          max: prop(\"effects.playerAsh.speedX\"),\n        },\n        tint: [0xf6c456, 0xec5b55, 0xaaaaaa],\n        onAdd: (particles, emitter) => {\n          this.timer(() => {\n            emitter.stop();\n          }, prop(\"effects.playerDie.duration\") * 2 /* + prop(\"level.replaceDelay\") - prop(\"effects.playerAsh.lifespan\") */);\n        },\n      });\n      this.particleSystem(\"effects.playerSmoke\", {\n        x: {\n          min: player.x - player.width * 0.4,\n          max: player.x + player.width * 0.4,\n        },\n        y: {\n          min: player.y - player.height * 0.4,\n          max: player.y + player.height * 0.4,\n        },\n        alpha: { start: 1, end: 0 },\n        //scale: { start: 0.25, end: 0.5 },\n        scale: { start: 0.5, end: 1 },\n        rotate: { start: 0, end: 360 },\n        speedY: {\n          min: 0.5 * prop(\"effects.playerSmoke.speedY\"),\n          max: prop(\"effects.playerSmoke.speedY\"),\n        },\n        speedX: {\n          min: -prop(\"effects.playerSmoke.speedX\"),\n          max: prop(\"effects.playerSmoke.speedX\"),\n        },\n        tint: [0x333333, 0x777777, 0xaaaaaa, 0xff9999],\n        onAdd: (particles, emitter) => {\n          this.timer(() => {\n            emitter.stop();\n          }, prop(\"effects.playerDie.duration\") * 2 /* + prop(\"level.replaceDelay\") - prop(\"effects.playerAsh.lifespan\") */);\n        },\n      });\n      this.tween(\"effects.playerDieHealthBar\", player.healthBar.fill);\n      this.tween(\"effects.playerDieHealthBar\", player.healthBar.border);\n    }\n\n    this.tween(\"effects.playerDie\", player, {\n      onComplete: () => {\n        this.timer(() => {\n          this.replaceWithSelf(\n            true,\n            { respawn: true },\n            {\n              animation: \"crossFade\",\n              duration: 200,\n              delayNewSceneShader: true,\n              removeOldSceneShader: true,\n            }\n          );\n        }, prop(\"level.replaceDelay\"));\n      },\n    });\n  }\n\n  renderUpdate(time, dt) {\n    const { level } = this;\n    const { player } = level;\n    this.renderLights(time, dt);\n    this.updateHealthBarFor(player, this.crispPercent);\n  }\n\n  skipLevel() {\n    const { level } = this;\n    if (level.index === this.levelIds().length - 1) {\n      this.goToLevel(0);\n    } else {\n      this.goToLevel(level.index + 1);\n    }\n  }\n\n  prevLevel() {\n    const { level } = this;\n    if (level.index === 0) {\n      return;\n    }\n\n    this.goToLevel(level.index - 1);\n  }\n\n  goToLevel(id) {\n    this.replaceWithSelf(\n      true,\n      { respawn: false, levelIndex: id },\n      {\n        animation: \"crossFade\",\n        duration: 200,\n        delayNewSceneShader: true,\n        removeOldSceneShader: true,\n      }\n    );\n  }\n\n  wonLevel() {\n    const { level } = this;\n    const { player, groups } = level;\n    const {\n      wall,\n      ground,\n      spinner,\n      reverseSpinner,\n      crumble,\n      drawbridge,\n      button,\n    } = groups;\n\n    if (this.playerDying) {\n      return;\n    }\n\n    if (this.winning) {\n      return;\n    }\n\n    this.winning = true;\n    this.command.ignoreAll(\"winning\", true);\n    this.playSound(\"night\");\n\n    const dynamic = [player];\n    const images = [];\n\n    [spinner, reverseSpinner, crumble, drawbridge, button].forEach(\n      ({ objects }) => {\n        dynamic.push(...objects);\n      }\n    );\n\n    [wall, ground].forEach(({ objects }) => {\n      objects.forEach(({ tiles }) => {\n        images.push(...tiles.map(({ image }) => image));\n      });\n    });\n\n    dynamic.forEach((object) => {\n      object.disableBody(true, false);\n    });\n\n    [...dynamic, ...images].forEach((obj) => {\n      this.timer(\n        () => {\n          this.tween(\"effects.goodNight\", obj, {\n            dy:\n              this.randBetween(\"goodnight\", 0.5, 1) *\n              prop(\"effects.goodNight.dy\"),\n          });\n        },\n        obj === player\n          ? this.level.bye\n            ? 3000\n            : 2000\n          : this.randBetween(\"goodnight\", 0, 1000)\n      );\n    });\n\n    this.save.level = level.index + 1;\n    this.saveState();\n\n    this.timer(() => {\n      const ciao = () => {\n        this.replaceWithSelf(\n          true,\n          { respawn: false, levelIndex: level.index + 1 },\n          {\n            animation: \"crossFade\",\n            duration: 200,\n            delayNewSceneShader: true,\n            removeOldSceneShader: true,\n          }\n        );\n      };\n\n      if (level.bye) {\n        this.speak(400, 300, level.bye, {\n          scrollFactor: 0,\n          onExit: ciao,\n        });\n      } else {\n        this.timer(ciao, 1000);\n      }\n    }, 2000);\n  }\n\n  renderLights(time, dt) {\n    const {\n      lightTexture,\n      lightWidth,\n      lightHeight,\n      lightX,\n      lightY,\n      suns,\n      dark,\n      crispPercent,\n      percent,\n    } = this;\n    if (!lightTexture) {\n      return;\n    }\n    const ctx = lightTexture.context;\n\n    lightTexture.refresh();\n    ctx.clearRect(0, 0, lightWidth, lightHeight);\n\n    suns.forEach((sun) => {\n      const { bead, lamps, ambient, corona, backwards } = sun;\n      const [x, y] = this.sunPosition(\n        backwards ? 1 - percent : percent,\n        backwards\n      );\n\n      const pos = new Vec2(x - lightX, y - lightY);\n      lamps.forEach((lamp) => {\n        lamp.position = pos;\n      });\n      bead.x = x;\n      bead.y = y;\n\n      const crispingColor = {\n        r: 255,\n        g: 100,\n        b: 100,\n      };\n\n      const safeColor = {\n        r: 150,\n        g: 255,\n        b: 150,\n      };\n      let alpha = (0.3 + this.crispPercent * 0.5) / suns.length;\n      if (this.winning || this.percent > 1) {\n        const extra = this.winning ? 100 : this.percent - 1;\n        alpha = alpha - extra * prop(\"level.fadeOutFactor\");\n\n        if (alpha <= 0) {\n          alpha = 0;\n          this.wonLevel();\n        }\n      }\n\n      const tint = Phaser.Display.Color.Interpolate.ColorWithColor(\n        safeColor,\n        crispingColor,\n        100,\n        100 * crispPercent\n      );\n      const { r, g, b } = tint;\n\n      const coronaPulse = 0.5 + Math.sin(time / 500) / 2;\n      let coronaAlpha = 0.7 + 0.3 * coronaPulse;\n      if (this.winning) {\n        coronaAlpha = alpha;\n      }\n\n      ambient.color = `rgba(${r}, ${g}, ${b}, ${alpha})`;\n      if (backwards) {\n        corona.color = `rgba(0, 0, 255, ${coronaAlpha})`;\n      } else {\n        corona.color = `rgba(255, 0, 0, ${coronaAlpha})`;\n      }\n    });\n\n    suns.forEach(({ lightings }) => {\n      lightings.forEach((lighting) => {\n        lighting.compute(lightWidth, lightHeight);\n      });\n    });\n    dark.compute(lightWidth, lightHeight);\n\n    ctx.fillStyle = \"black\";\n    ctx.fillRect(0, 0, lightWidth, lightHeight);\n\n    ctx.globalCompositeOperation = \"lighter\";\n    suns.forEach(({ lightings }) => {\n      lightings.forEach((lighting) => {\n        lighting.render(ctx);\n      });\n    });\n\n    ctx.globalCompositeOperation = \"source-over\";\n    dark.render(ctx);\n  }\n\n  textSize(options) {\n    return \"24px\";\n  }\n\n  textColor(options) {\n    if (this.level.lastLevel) {\n      return \"#f6c456\";\n      //return \"rgb(255, 0, 255)\";\n    } else {\n      return \"rgb(255, 0, 0)\";\n    }\n  }\n\n  strokeColor(options) {\n    return \"rgb(0, 0, 0)\";\n  }\n\n  strokeWidth(options) {\n    return 6;\n  }\n\n  cameraColor() {\n    return 0x000000;\n  }\n\n  musicName() {\n    return this.level && this.level.music;\n  }\n\n  launchTimeSight() {\n    const { level } = this;\n    const { player } = level;\n    super.launchTimeSight();\n    player.visible = false;\n  }\n\n  renderTimeSightFrameInto(scene, phantomDt, time, dt, isLast) {\n    const { level } = this;\n    const { player } = level;\n    const objects = [];\n\n    if (!this.timeSightX) {\n      this.timeSightX = this.timeSightY = 0;\n    }\n\n    const prevX = this.timeSightX;\n    const prevY = this.timeSightY;\n\n    if (\n      isLast ||\n      Math.sqrt(\n        (player.x - prevX) * (player.x - prevX) +\n          (player.y - prevY) * (player.y - prevY)\n      ) >= 28\n    ) {\n      const phantom = scene.physics.add.sprite(player.x, player.y, \"player\");\n      // phantom.anims.play(animation);\n      // phantom.setFlipX(player.flipX);\n      // phantom.setScale(player.scaleX, player.scaleY);\n      phantom.alpha = 0.4;\n\n      objects.push(phantom);\n      this.timeSightX = player.x;\n      this.timeSightY = player.y;\n    }\n\n    if (objects.length === 0) {\n      return null;\n    }\n\n    objects.forEach((object) => {\n      object.anims.stop();\n    });\n\n    return objects;\n  }\n\n  debugHandlePointerdown(event) {\n    let { x, y } = event;\n\n    x += this.camera.scrollX;\n    y += this.camera.scrollY;\n    this.level.player.x = x;\n    this.level.player.y = y;\n  }\n\n  _hotReloadCurrentLevel() {\n    super\n      ._hotReloadCurrentLevel(\n        {},\n        {\n          animation: \"crossFade\",\n          duration: 200,\n          delayNewSceneShader: true,\n          removeOldSceneShader: true,\n        }\n      )\n      .then((scene) => {});\n  }\n\n  cleanShadows() {\n    if (AmbientSamples > 1) {\n      OldAmbient = AmbientSamples;\n      AmbientSamples = 1;\n    } else {\n      AmbientSamples = OldAmbient;\n    }\n\n    this.resampleSuns();\n  }\n\n  _hot() {}\n}\n","import SuperGame from \"./scaffolding/SuperGame\";\nimport proxyClass from \"./scaffolding/lib/proxy\";\n\nimport PlayScene from \"./play-scene\";\n\nconst baseConfig = {\n  transparent: true,\n  \"render.transparent\": true,\n};\n\nexport default class Game extends SuperGame {\n  constructor(options) {\n    const config = {\n      ...baseConfig,\n      ...options,\n    };\n    super(config, [PlayScene]);\n  }\n\n  launch() {\n    this.scene.add(`scene-${Date.now()}`, PlayScene, true, {\n      seed: Date.now(),\n      sceneId: String(Math.random()),\n    });\n  }\n}\n\nif (module.hot) {\n  {\n    const proxy = proxyClass(PlayScene);\n    module.hot.accept(\"./play-scene\", () => {\n      const Next = require(\"./play-scene\").default;\n      window.game.scene.scenes.forEach((scene) => {\n        if (scene.constructor.name === Next.name) {\n          proxyClass(Next, scene, proxy);\n        }\n      });\n    });\n  }\n}\n","import React from \"react\";\nimport \"./Engine.css\";\nimport Spinner from \"./Spinner\";\nimport Controls from \"./Controls\";\nimport Game from \"../game\";\nimport cover from \"../assets/cover.png\";\nimport { saveField, loadField } from \"./lib/store\";\n\nexport default class Engine extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      activating: false,\n      activated: false,\n      focused: true,\n      volume: loadField(\"volume\", 0.66),\n      scale: null,\n    };\n    this.controls = React.createRef();\n  }\n\n  componentDidMount() {\n    const { loadedGame, debug } = this.props;\n    const { volume } = this.state;\n\n    window.addEventListener(\"visibilitychange\", this.didVisibilityChange);\n    window.addEventListener(\"blur\", this.didBlur);\n    document.addEventListener(\"blur\", this.didBlur);\n    window.addEventListener(\"focus\", this.didFocus);\n    document.addEventListener(\"focus\", this.didFocus);\n\n    const body = document.querySelector(\"body\");\n    body.classList.add(\"natural\");\n\n    this.game = new Game({ debug });\n    this.game.changeVolume(volume);\n\n    if (loadedGame) {\n      loadedGame(this.game, (callback) => this.activateGame(callback));\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"visibilitychange\", this.didVisibilityChange);\n    window.removeEventListener(\"blur\", this.didBlur);\n    document.removeEventListener(\"blur\", this.didBlur);\n    window.removeEventListener(\"focus\", this.didFocus);\n    document.removeEventListener(\"focus\", this.didFocus);\n  }\n\n  onMouseMove() {\n    if (this.moveTimeout) {\n      clearTimeout(this.moveTimeout);\n    } else {\n      document.querySelector(\"body\").classList.add(\"mouseMoved\");\n    }\n\n    this.moveTimeout = setTimeout(() => {\n      this.clearMove(false);\n    }, 3000);\n  }\n\n  setVolume(volume) {\n    this.setState({ volume });\n\n    this.game.changeVolume(volume);\n\n    saveField(\"volume\", volume);\n  }\n\n  didVisibilityChange = () => {\n    const hidden = document.visibilityState === \"hidden\";\n    this.setState({ focused: !hidden });\n    this.game.setFocused(!hidden);\n  };\n\n  didBlur = () => {\n    this.setState({ focused: false });\n    this.game.setFocused(false);\n  };\n\n  didFocus = () => {\n    this.setState({ focused: true });\n    this.game.setFocused(true);\n  };\n\n  activateGame(callback) {\n    const { activated } = this.state;\n\n    if (activated) {\n      if (callback) {\n        callback();\n      }\n      return;\n    }\n\n    this.setState({ activating: true });\n\n    this.game.activateGame(() => {\n      // might happen multiple times\n      this.setState({ activated: true });\n      this.clearMove(true);\n      if (callback) {\n        callback();\n      }\n    });\n  }\n\n  clearMove(instant) {\n    if (!this.moveTimeout) {\n      return;\n    }\n\n    clearTimeout(this.moveTimeout);\n    this.moveTimeout = null;\n\n    if (instant && this.controls.current && this.controls.current.style) {\n      this.controls.current.style.transition = \"none\";\n      setTimeout(() => {\n        this.controls.current.style.transition = \"\";\n      });\n    }\n\n    document.querySelector(\"body\").classList.remove(\"mouseMoved\");\n  }\n\n  enterFullscreen() {\n    const body = document.querySelector(\"body\");\n    const engine = document.querySelector(\"#engine\");\n\n    if (body && engine) {\n      body.classList.add(\"scaled\");\n      body.classList.remove(\"natural\");\n\n      engine.style.overflow = \"\";\n\n      this.resizeHandler = () => {\n        const { width, height } = this.game.config;\n        const scale =\n          0.95 *\n          Math.min(window.innerWidth / width, window.innerHeight / height);\n        this.setState({ scale });\n      };\n      this.resizeHandler();\n\n      window.addEventListener(\"resize\", this.resizeHandler);\n\n      if (!this.fullscreenHandler) {\n        this.fullscreenHandler = () => {\n          const isInFullScreen =\n            document.fullscreenElement ||\n            document.webkitFullscreenElement ||\n            document.mozFullScreenElement ||\n            document.msFullscreenElement;\n\n          if (!isInFullScreen) {\n            this.exitFullscreen(true);\n          }\n        };\n\n        document.addEventListener(\n          \"webkitfullscreenchange\",\n          this.fullscreenHandler,\n          false\n        );\n        document.addEventListener(\n          \"mozfullscreenchange\",\n          this.fullscreenHandler,\n          false\n        );\n        document.addEventListener(\n          \"fullscreenchange\",\n          this.fullscreenHandler,\n          false\n        );\n        document.addEventListener(\n          \"MSFullscreenChange\",\n          this.fullscreenHandler,\n          false\n        );\n      }\n\n      if (body.requestFullscreen) {\n        body.requestFullscreen();\n      } else if (body.mozRequestFullScreen) {\n        body.mozRequestFullScreen();\n      } else if (body.webkitRequestFullScreen) {\n        body.webkitRequestFullScreen();\n      } else if (body.msRequestFullscreen) {\n        body.msRequestFullscreen();\n      }\n    }\n  }\n\n  exitFullscreen(skipBrowserFullscreen) {\n    const body = document.querySelector(\"body\");\n    const engine = document.querySelector(\"#engine\");\n    if (body && engine) {\n      body.classList.add(\"natural\");\n      body.classList.remove(\"scaled\");\n\n      engine.style.overflow = \"hidden\";\n\n      this.setState({ scale: null });\n\n      if (this.moveTimeout) {\n        clearTimeout(this.moveTimeout);\n        this.moveTimeout = null;\n      }\n\n      window.removeEventListener(\"resize\", this.resizeHandler);\n      window.removeEventListener(\"mousemove\", this.moveHandler);\n    }\n\n    if (!skipBrowserFullscreen) {\n      if (document.exitFullscreen) {\n        document.exitFullscreen();\n      } else if (document.webkitExitFullscreen) {\n        document.webkitExitFullscreen();\n      } else if (document.mozCancelFullScreen) {\n        document.mozCancelFullScreen();\n      } else if (document.msExitFullscreen) {\n        document.msExitFullscreen();\n      }\n    }\n  }\n\n  render() {\n    const { activating, scale, volume, focused } = this.state;\n    const { disableFullscreen } = this.props;\n\n    const classes = [];\n    classes.push(activating ? \"activated\" : \"activate\");\n    classes.push(focused ? \"focused\" : \"blurred\");\n\n    return (\n      <div className={classes.join(\" \")} id=\"engine-container\">\n        <div\n          id=\"engine\"\n          onMouseMove={() => this.onMouseMove()}\n          onClick={() => this.activateGame()}\n          style={scale ? { transform: `scale(${scale})` } : {}}\n          ref={(container) => {\n            if (this.gameContainerRef) {\n              return;\n            }\n\n            this.gameContainerRef = container;\n          }}\n        >\n          <div style={{ backgroundImage: `url(${cover})` }} id=\"cover\" />\n          <Spinner />\n        </div>\n        <Controls\n          ref={this.controls}\n          onMouseMove={() => this.onMouseMove()}\n          volume={volume}\n          onVolumeChange={(v) => this.setVolume(v)}\n          disableFullscreen={disableFullscreen}\n          isFullscreen={scale}\n          enterFullscreen={() => this.enterFullscreen()}\n          exitFullscreen={() => this.exitFullscreen()}\n        />\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './Manage.css';\nimport {saveField, loadField} from './lib/store';\nimport {\n  initializeManage,\n  updateSearch,\n  serializeChangedProps,\n  resetChangedProps,\n} from './lib/manage-gui';\n\nexport default class Manage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      search: loadField('search', ''),\n    };\n\n    this.ref = React.createRef();\n  }\n\n  componentDidMount() {\n    const {search} = this.state;\n\n    const gui = initializeManage();\n    this.ref.current.append(gui.domElement);\n\n    if (search !== '') {\n      updateSearch(search, true);\n    }\n  }\n\n  copyChangedProps() {\n    const tempNode = document.createElement('textarea');\n    tempNode.value = serializeChangedProps();\n    document.body.appendChild(tempNode);\n    tempNode.select();\n    document.execCommand('copy');\n    document.body.removeChild(tempNode);\n  }\n\n  render() {\n    const {search} = this.state;\n    return (\n      <div className=\"Manage\">\n        <input\n          type=\"search\"\n          className=\"search\"\n          placeholder=\"Filter props\"\n          value={search}\n          onChange={(e) => {\n            // eslint-disable-next-line react/destructuring-assignment\n            const isStarted = this.state.search === '';\n            this.setState({search: e.target.value});\n            updateSearch(e.target.value, isStarted);\n            saveField('search', e.target.value);\n          }}\n        />\n        <input\n          type=\"button\"\n          className=\"copy\"\n          value=\"Copy changes\"\n          onClick={() => this.copyChangedProps()}\n        />\n        <input\n          type=\"button\"\n          className=\"reset\"\n          value=\"Reset to saved\"\n          onClick={() => resetChangedProps()}\n        />\n        <div className={search === '' ? '' : 'searching'} ref={this.ref} />\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './DoubleEnder.css';\n\nconst semiFloor = (n) => {\n  return Math.floor(2 * n) / 2;\n};\n\nconst semiCeil = (n) => {\n  return Math.ceil(2 * n) / 2;\n};\n\nexport default class DoubleEnder extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      dragging: null,\n      lastDrag: null,\n    };\n\n    this.trackRef = React.createRef();\n    this.cursorRef = React.createRef();\n  }\n\n  componentDidMount() {\n    // force track ref to have getBoundingClientRect\n    // eslint-disable-next-line react/no-unused-state\n    this.setState({refreshDimensions: true});\n\n    window.addEventListener('resize', this.didResize);\n\n    window.game.updateReplayCursor = (frame, replay) => {\n      this.updateCursor(frame, replay);\n    };\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.didResize);\n    delete window.game.updateReplayCursor;\n  }\n\n  didResize = () => {\n    this.forceUpdate();\n  };\n\n  updateCursor(frame, replay) {\n    const {replayTimestamp} = this.props;\n    if (!this.cursorRef.current || !this.trackRef.current) {\n      return;\n    }\n\n    if (frame && replay && replay.timestamp === replayTimestamp) {\n      const {min, max} = this.props;\n      const trackWidth = this.trackRef.current.getBoundingClientRect().width;\n      const cursorPercent = Math.max(0, Math.min(1, (frame - min) / (max - min)));\n      this.cursorRef.current.style.left = `${semiFloor(cursorPercent * trackWidth)}px`;\n      this.cursorRef.current.style.display = 'block';\n    } else {\n      this.cursorRef.current.style.display = 'none';\n    }\n  }\n\n  render() {\n    const {\n      min, max, value1, value2, onChange1, onChange2,\n      onMouseUp, onMouseEnter, onMouseMove, onMouseLeave,\n      onBeginChange, onEndChange, notches, highlight1, highlight2,\n      cursor,\n    } = this.props;\n    const {dragging, lastDrag} = this.state;\n    const sliderWidth = 16;\n\n    const trackDimensions = this.trackRef.current && this.trackRef.current.getBoundingClientRect();\n    const trackLeft = trackDimensions ? trackDimensions.left : 0;\n    const trackWidth = trackDimensions ? trackDimensions.width : 100;\n    const percent1 = Math.max(0, Math.min(1, (value1 - min) / (max - min)));\n    const percent2 = Math.max(0, Math.min(1, (value2 - min) / (max - min)));\n    const highlightPercent1 = Math.max(0, Math.min(1, (highlight1 - min) / (max - min)));\n    const highlightPercent2 = Math.max(0, Math.min(1, (highlight2 - min) / (max - min)));\n    const cursorPercent = Math.max(0, Math.min(1, (cursor - min) / (max - min)));\n\n    return (\n      <div className=\"DoubleEnder\" onMouseUp={onMouseUp} onMouseEnter={onMouseEnter} onMouseMove={onMouseMove} onMouseLeave={onMouseLeave}>\n        <div className=\"track\" ref={this.trackRef} />\n        <div\n          style={{\n            left: `${semiFloor(percent1 * trackWidth)}px`,\n            right: `${semiCeil(trackWidth - percent2 * trackWidth)}px`,\n          }}\n          className=\"track selected\"\n        />\n        <div\n          style={{\n            left: `${semiFloor(highlightPercent1 * trackWidth)}px`,\n            right: `${semiCeil(trackWidth - highlightPercent2 * trackWidth)}px`,\n          }}\n          className=\"track highlighted\"\n        />\n        <div\n          style={{\n            left: `${semiFloor(cursorPercent * trackWidth)}px`,\n            display: cursor === null ? 'none' : 'block',\n          }}\n          className=\"cursor highlighted\"\n          ref={this.cursorRef}\n        />\n        {notches.map(({value, title}) => {\n          const isSelected = (value >= value1 && value <= value2) || (value >= value2 && value <= value1);\n          const isHighlighted = (value >= highlight1 && value <= highlight2) || (value >= highlight2 && value <= highlight1);\n          const percent = Math.max(0, Math.min(1, (value - min) / (max - min)));\n          const classes = ['notch'];\n          if (isHighlighted) {\n            classes.push('highlighted');\n          } else if (isSelected) {\n            classes.push('selected');\n          }\n\n          return (\n            <div\n              key={value}\n              title={title}\n              className={classes.join(' ')}\n              style={{\n                left: `${semiFloor(percent * trackWidth)}px`,\n              }}\n            >\n              {' '}\n            </div>\n          );\n        })}\n        {[1, 2].map((index) => {\n          let i = index;\n          const value = i === 1 ? value1 : value2;\n          let opposite = i === 1 ? 2 : 1;\n          const oppositeValue = opposite === 1 ? value1 : value2;\n          const percent = Math.max(0, Math.min(1, (value - min) / (max - min)));\n\n          return (\n            <div\n              key={i}\n              style={{\n                left: `${semiFloor(percent * (trackWidth - sliderWidth))}px`,\n                zIndex: i === lastDrag ? 5 : 4,\n              }}\n              className={`slider slider${i} ${dragging === i ? 'dragging' : ''}`}\n              onMouseDown={(e) => {\n                const originalX = e.clientX - e.target.getBoundingClientRect().left;\n\n                if (onBeginChange) {\n                  onBeginChange();\n                }\n                let onChange = i === 1 ? onChange1 : onChange2;\n\n                this._dragListener = ({clientX}) => {\n                  const newPercent = (clientX - trackLeft - originalX) / (trackWidth - sliderWidth);\n                  const rawValue = min + newPercent * (max - min);\n                  const newValue = Math.min(max, Math.max(min, rawValue));\n\n                  if ((i === 1 && newValue > oppositeValue) || (i === 2 && newValue < oppositeValue)) {\n                    if (onChange) {\n                      onChange(oppositeValue);\n                    }\n\n                    i = opposite;\n                    opposite = i === 1 ? 2 : 1;\n                    onChange = i === 1 ? onChange1 : onChange2;\n                    this.setState({dragging: i, lastDrag: i});\n                  } else if (onChange) {\n                    onChange(newValue);\n                  }\n                };\n\n                // eslint-disable-next-line no-shadow\n                this._upListener = (e) => {\n                  this._dragListener(e);\n\n                  window.removeEventListener('mousemove', this._dragListener);\n                  delete this._dragListener;\n\n                  window.removeEventListener('mouseup', this._upListener);\n                  delete this._upListener;\n\n                  this.setState({dragging: null});\n\n                  if (onEndChange) {\n                    onEndChange();\n                  }\n                };\n\n                window.addEventListener('mousemove', this._dragListener);\n                window.addEventListener('mouseup', this._upListener);\n\n                this.setState({dragging: i, lastDrag: i});\n              }}\n            />\n          );\n        })}\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport \"./Replay.css\";\nimport { saveField, loadField } from \"./lib/store\";\nimport DoubleEnder from \"./DoubleEnder\";\n\n/* eslint-disable jsx-a11y/accessible-emoji */\n\nconst ReplayEditFields = [\n  \"metadata\", // must be first\n  \"commands\",\n  \"sceneSaveState\",\n  \"sceneTransitions\",\n];\n\nexport default class Replay extends React.Component {\n  constructor(props) {\n    super(props);\n\n    const replays = loadField(\"replays\", []);\n\n    // migrate old replays\n    replays.forEach((replay) => {\n      if (replay.preflight) {\n        replay.commands = [...replay.preflight, ...(replay.commands || [])];\n        replay.preflightCutoff = replay.preflight.reduce(\n          (cutoff, frame) => cutoff + (frame._repeat || 1),\n          0\n        );\n        delete replay.preflight;\n      }\n\n      if (!(\"tickCount\" in replay)) {\n        replay.tickCount = replay.commands.reduce(\n          (cutoff, frame) => cutoff + (frame._repeat || 1),\n          0\n        );\n      }\n\n      if (!(\"originalPreflightCutoff\" in replay)) {\n        replay.originalPreflightCutoff = replay.preflightCutoff;\n      }\n\n      if (!(\"postflightCutoff\" in replay)) {\n        replay.postflightCutoff = replay.tickCount;\n      }\n    });\n\n    this.state = {\n      replays,\n      activeRecording: null,\n      activeReplay: loadField(\"activeReplay\", null),\n      tweaking: loadField(\"tweaking\", null),\n      editing: loadField(\"editing\", null),\n      repeat: loadField(\"repeat\", true),\n    };\n  }\n\n  componentDidMount() {\n    this.beginAutoReplay();\n    this.installGameCallbacks();\n  }\n\n  componentDidUpdate(prevProps) {\n    const { activateGame } = this.props;\n    if (activateGame !== prevProps.activateGame) {\n      this.installGameCallbacks();\n      this.beginAutoReplay();\n    }\n  }\n\n  setEditing(editing) {\n    this.setState({ editing });\n    saveField(\"editing\", editing);\n  }\n\n  setActiveReplay(activeReplay) {\n    this.setState({ activeReplay });\n    saveField(\"activeReplay\", activeReplay);\n  }\n\n  beginReplay(replay, clearOtherEditing) {\n    const { activateGame } = this.props;\n    const { editing } = this.state;\n    activateGame(() => {\n      const { activeReplay } = this.state;\n      let transition;\n\n      if (activeReplay) {\n        if (\n          activeReplay.timestamp === replay.timestamp &&\n          !activeReplay.timeSight &&\n          replay.timeSight\n        ) {\n          transition = window.game.topScene()._replayLatestTransition;\n        }\n\n        window.game.stopReplay();\n      }\n\n      if (clearOtherEditing && editing !== replay.timestamp) {\n        this.setEditing(null);\n      }\n\n      window.game.beginReplay(replay, {\n        startFromTransition: transition,\n      });\n    });\n  }\n\n  stopReplay() {\n    const { activateGame } = this.props;\n    activateGame(() => {\n      window.game.stopReplay();\n    });\n  }\n\n  beginRecording(options) {\n    const { activateGame } = this.props;\n    this.setEditing(null);\n\n    activateGame(() => {\n      window.game.beginRecording(options);\n    });\n  }\n\n  stopRecording() {\n    const { activateGame } = this.props;\n    activateGame(() => {\n      window.game.stopRecording();\n    });\n  }\n\n  trashRecording() {\n    this._trashNextRecording = true;\n    this.stopRecording();\n  }\n\n  toggleTimeSight() {\n    const { activeReplay } = this.state;\n    this.beginReplay(\n      { ...activeReplay, timeSight: !activeReplay.timeSight },\n      true\n    );\n  }\n\n  toggleRepeat() {\n    this.setState(({ repeat }) => {\n      setTimeout(() => {\n        saveField(\"repeat\", !repeat);\n      });\n\n      return {\n        repeat: !repeat,\n      };\n    });\n  }\n\n  saveReplays() {\n    setTimeout(() => {\n      const { replays, activeReplay, editing } = this.state;\n      saveField(\"replays\", replays);\n      saveField(\"editing\", editing);\n      saveField(\"activeReplay\", activeReplay);\n    });\n  }\n\n  finishEdit(replay, skipFocus) {\n    this.setEditing(null);\n    this.saveReplays();\n  }\n\n  beginAutoReplay() {\n    const { activateGame } = this.props;\n    const { activeReplay } = this.state;\n\n    if (!activateGame) {\n      return;\n    }\n\n    if (!activeReplay) {\n      return;\n    }\n\n    this.beginReplay(activeReplay);\n  }\n\n  installGameCallbacks() {\n    const { game } = window;\n    if (!game || game.onRecordBegin) {\n      return;\n    }\n\n    game.onRecordBegin = (activeRecording) => {\n      this.setState({ activeRecording });\n    };\n\n    game.onRecordStop = (replay) => {\n      this.setState({ activeRecording: null });\n\n      if (this._trashNextRecording) {\n        delete this._trashNextRecording;\n        return;\n      }\n\n      this.setState(({ replays }) => {\n        const newReplays = [replay, ...replays];\n\n        setTimeout(() => {\n          saveField(\"replays\", newReplays);\n\n          if (!replay.snapshot) {\n            this.beginReplay(replay);\n          }\n        });\n\n        return {\n          replays: newReplays,\n        };\n      });\n    };\n\n    game.onReplayBegin = (replay) => {\n      if (!replay.snapshot) {\n        this.setActiveReplay(replay);\n      }\n    };\n\n    game.onReplayEnd = (replay) => {\n      const { repeat } = this.state;\n\n      if (repeat && !replay.snapshot) {\n        setTimeout(() => {\n          // eslint-disable-next-line react/destructuring-assignment\n          this.beginReplay(this.state.activeReplay);\n        });\n      } else {\n        this.setActiveReplay(null);\n      }\n    };\n\n    game.onReplayStop = (replay) => {\n      this.setActiveReplay(null);\n    };\n  }\n\n  updateReplay({ timestamp }, changes, beginReplay) {\n    this.setState(({ activeReplay, replays }) => {\n      let newReplay;\n      const newState = {\n        replays: replays.map((replay) => {\n          if (replay.timestamp === timestamp) {\n            newReplay = {\n              ...replay,\n              ...changes,\n            };\n            return newReplay;\n          }\n          return replay;\n        }),\n      };\n\n      if (activeReplay && activeReplay.timestamp === timestamp) {\n        newState.activeReplay = {\n          ...activeReplay,\n          ...changes,\n        };\n      }\n\n      if (newReplay && beginReplay) {\n        setTimeout(() => {\n          this.beginReplay({\n            ...newReplay,\n            timeSight: activeReplay && activeReplay.timeSight,\n          });\n        });\n      }\n\n      return newState;\n    });\n  }\n\n  editName(replay, name, beginReplay) {\n    this.updateReplay(replay, { name }, beginReplay);\n  }\n\n  editPreflightCutoff(replay, preflightCutoff, beginReplay) {\n    const snapshot = preflightCutoff > replay.postflightCutoff * 0.99;\n    this.updateReplay(replay, { preflightCutoff, snapshot }, beginReplay);\n  }\n\n  editPostflightCutoff(replay, postflightCutoff, beginReplay) {\n    const snapshot = replay.preflightCutoff > postflightCutoff * 0.99;\n    this.updateReplay(replay, { postflightCutoff, snapshot }, beginReplay);\n  }\n\n  editCutoffs(replay, preflightCutoff, postflightCutoff, beginReplay) {\n    const snapshot = preflightCutoff > postflightCutoff * 0.99;\n    this.updateReplay(\n      replay,\n      { preflightCutoff, postflightCutoff, snapshot },\n      beginReplay\n    );\n  }\n\n  deleteReplay({ timestamp }) {\n    this.setState(({ activeReplay, replays }) => {\n      const newReplays = replays.filter(\n        (replay) => replay.timestamp !== timestamp\n      );\n\n      setTimeout(() => {\n        saveField(\"replays\", newReplays);\n      });\n\n      if (activeReplay && activeReplay.timestamp === timestamp) {\n        setTimeout(() => this.stopReplay());\n      }\n\n      return { replays: newReplays };\n    });\n  }\n\n  copyReplay(replay) {\n    const newReplay = {\n      ...replay,\n      timestamp: Date.now(),\n      name: `Copy of ${replay.name}`,\n    };\n\n    this.setState(({ replays }) => {\n      const newReplays = [newReplay, ...replays];\n\n      setTimeout(() => {\n        saveField(\"replays\", newReplays);\n      });\n\n      return { replays: newReplays };\n    });\n  }\n\n  cutoffTimeSightEnter() {\n    window.game.cutoffTimeSightEnter();\n  }\n\n  cutoffTimeSightChanged(start, end) {\n    window.game.cutoffTimeSightChanged(start, end);\n  }\n\n  cutoffTimeSightLeave() {\n    window.game.cutoffTimeSightLeave();\n  }\n\n  tweakReplay(replay) {\n    const metadata = { ...replay };\n    const tweaking = { replay };\n    ReplayEditFields.forEach((field) => {\n      if (field !== \"metadata\") {\n        tweaking[field] = JSON.stringify(metadata[field], null, 2);\n        delete metadata[field];\n      }\n    });\n    tweaking.metadata = JSON.stringify(metadata, null, 2);\n\n    ReplayEditFields.forEach((field) => {\n      tweaking[`${field}_original`] = tweaking[field];\n    });\n\n    this.setState({ tweaking });\n    saveField(\"tweaking\", tweaking);\n  }\n\n  updateTweak(field, value) {\n    this.setState(({ tweaking }) => {\n      const t = {\n        ...tweaking,\n        [field]: value,\n        [`${field}_error`]: null,\n        [`${field}_changed`]: value !== tweaking[`${field}_original`],\n      };\n\n      setTimeout(() => saveField(\"tweaking\", t));\n\n      return { tweaking: t };\n    });\n  }\n\n  revertTweak(field) {\n    // eslint-disable-next-line react/destructuring-assignment\n    this.updateTweak(field, this.state.tweaking[`${field}_original`]);\n  }\n\n  discardTweaks() {\n    setTimeout(() => {\n      saveField(\"tweaking\", null);\n    });\n    this.setState({\n      tweaking: null,\n    });\n  }\n\n  saveTweaks() {\n    this.setState(({ tweaking }) => {\n      let replay;\n      let sawError = false;\n      const newState = { ...tweaking };\n\n      ReplayEditFields.forEach((field) => {\n        try {\n          const value = JSON.parse(tweaking[field]);\n          if (field === \"metadata\") {\n            replay = value;\n          } else if (replay) {\n            replay[field] = value;\n          }\n\n          newState[`${field}_error`] = null;\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.error(e);\n          sawError = true;\n          newState[`${field}_error`] = e.toString();\n        }\n      });\n\n      if (sawError) {\n        setTimeout(() => {\n          saveField(\"tweaking\", newState);\n        });\n        return { tweaking: newState };\n      } else {\n        setTimeout(() => {\n          this.updateReplay(tweaking.replay, replay, false);\n          setTimeout(() => {\n            saveField(\"tweaking\", null);\n          });\n        });\n\n        return { tweaking: null };\n      }\n    });\n  }\n\n  renderEditReplay(replay) {\n    const { activeReplay } = this.state;\n    let highlight1 = null;\n    let highlight2 = null;\n\n    const { game } = window;\n    const scene = game && game.topScene();\n    let cursor = scene && scene.command ? scene.command.replayTicks : null;\n\n    if (activeReplay && activeReplay.timestamp !== replay.timestamp) {\n      cursor = null;\n    }\n\n    if (\n      activeReplay &&\n      activeReplay.timestamp === replay.timestamp &&\n      activeReplay.timeSight\n    ) {\n      cursor = null;\n\n      const { sceneTransitions } = replay;\n      if (!sceneTransitions || sceneTransitions.length === 0) {\n        highlight1 = replay.preflightCutoff;\n        highlight2 = replay.postflightCutoff;\n      } else {\n        const latestTransition = scene && scene._replayLatestTransition;\n        if (!scene) {\n          // if we haven't rendered yet, the default is preflightCutoff until the next scene transition\n          highlight1 = replay.preflightCutoff;\n          for (let i = 0; i < sceneTransitions.length; i += 1) {\n            if (sceneTransitions[i].tickCount > highlight1) {\n              highlight2 = Math.min(\n                replay.postflightCutoff,\n                sceneTransitions[i].tickCount\n              );\n              break;\n            }\n          }\n        } else if (!latestTransition) {\n          // no transition yet, so take the first segment\n          highlight1 = replay.preflightCutoff;\n          highlight2 = Math.min(\n            replay.postflightCutoff,\n            sceneTransitions[0].tickCount\n          );\n        } else {\n          // take the intersection of the scene's ticks and pre/post flight\n          const firstTick = latestTransition\n            ? latestTransition.tickCount || 0\n            : 0;\n          let lastTick = replay.postflightCutoff;\n\n          highlight1 = Math.max(firstTick, replay.preflightCutoff);\n\n          for (let i = 0; i < sceneTransitions.length; i += 1) {\n            if (sceneTransitions[i].tickCount >= firstTick) {\n              if (i + 1 < sceneTransitions.length) {\n                lastTick = sceneTransitions[i + 1].tickCount;\n              }\n              break;\n            }\n          }\n\n          highlight2 = Math.min(lastTick, replay.postflightCutoff);\n        }\n      }\n\n      if (highlight1 > highlight2) {\n        highlight1 = highlight2 = null;\n      }\n    }\n\n    return (\n      <form\n        onSubmit={(e) => {\n          e.preventDefault();\n          this.finishEdit(replay);\n        }}\n      >\n        <input\n          type=\"text\"\n          autoFocus\n          value={replay.name}\n          onChange={(e) => this.editName(replay, e.target.value)}\n        />\n        <span\n          className=\"play button\"\n          title=\"Load snapshot (load state)\"\n          onClick={() =>\n            this.beginReplay({ ...replay, snapshot: true, commands: [] })\n          }\n        >\n          \n        </span>\n        <span\n          className=\"tweak button\"\n          title=\"Tweak replay\"\n          onClick={() => this.tweakReplay(replay)}\n        >\n          \n        </span>\n        <span\n          className=\"copy button\"\n          title=\"Copy replay\"\n          onClick={() => this.copyReplay(replay)}\n        >\n          \n        </span>\n        <span\n          className=\"delete button\"\n          title=\"Delete replay\"\n          onClick={() => this.deleteReplay(replay)}\n        >\n          \n        </span>\n        <span className=\"detail\">\n          {replay.preflightCutoff}-{replay.postflightCutoff}\n          {replay.postflightCutoff !== replay.tickCount &&\n            ` / ${replay.tickCount}`}\n        </span>\n        <br />\n        <DoubleEnder\n          min={0}\n          max={replay.tickCount}\n          value1={replay.preflightCutoff}\n          value2={replay.postflightCutoff}\n          highlight1={highlight1}\n          highlight2={highlight2}\n          cursor={cursor}\n          notches={(replay.sceneTransitions || []).map((t) => ({\n            value: t.tickCount,\n            title: \"Scene transition\",\n          }))}\n          replayTimestamp={replay.timestamp}\n          onMouseEnter={(e) => {\n            this._inCutoffs = true;\n            if (\n              activeReplay &&\n              activeReplay.timeSight &&\n              activeReplay.timestamp === replay.timestamp\n            ) {\n              this.cutoffTimeSightEnter();\n            }\n          }}\n          onMouseLeave={(e) => {\n            this._inCutoffs = false;\n            if (\n              activeReplay &&\n              activeReplay.timeSight &&\n              activeReplay.timestamp === replay.timestamp\n            ) {\n              if (!this._changingCutoffs) {\n                this.cutoffTimeSightLeave();\n              }\n              this.saveReplays();\n            }\n          }}\n          onBeginChange={(e) => {\n            this._changingCutoffs = true;\n          }}\n          onEndChange={(e) => {\n            this._changingCutoffs = false;\n\n            if (\n              activeReplay &&\n              activeReplay.timeSight &&\n              activeReplay.timestamp === replay.timestamp\n            ) {\n              if (!this._inCutoffs) {\n                this.cutoffTimeSightLeave();\n              }\n              this.saveReplays();\n            } else {\n              setTimeout(() => {\n                const { replays } = this.state;\n                const newReplay = replays.find(\n                  (r) => r.timestamp === replay.timestamp\n                );\n                this.beginReplay(newReplay);\n                this.saveReplays();\n              });\n            }\n          }}\n          onChange1={(preflight) => {\n            this.editPreflightCutoff(replay, Math.floor(preflight));\n            if (\n              activeReplay &&\n              activeReplay.timeSight &&\n              activeReplay.timestamp === replay.timestamp\n            ) {\n              setTimeout(() => {\n                // eslint-disable-next-line react/destructuring-assignment\n                this.cutoffTimeSightChanged(\n                  Math.floor(preflight),\n                  this.state.activeReplay.postflightCutoff\n                );\n              });\n            }\n          }}\n          onChange2={(postflight) => {\n            this.editPostflightCutoff(replay, Math.floor(postflight));\n            if (\n              activeReplay &&\n              activeReplay.timeSight &&\n              activeReplay.timestamp === replay.timestamp\n            ) {\n              setTimeout(() => {\n                // eslint-disable-next-line react/destructuring-assignment\n                this.cutoffTimeSightChanged(\n                  this.state.activeReplay.preflightCutoff,\n                  Math.floor(postflight)\n                );\n              });\n            }\n          }}\n        />\n        {(replay.preflightCutoff !== replay.originalPreflightCutoff ||\n          replay.postflightCutoff !== replay.tickCount) && (\n          <input\n            type=\"button\"\n            onClick={(e) => {\n              e.preventDefault();\n              this.editCutoffs(\n                replay,\n                replay.originalPreflightCutoff,\n                replay.tickCount,\n                true\n              );\n            }}\n            value=\"\"\n          />\n        )}\n      </form>\n    );\n  }\n\n  renderTweaking() {\n    const { tweaking } = this.state;\n\n    return (\n      <div className=\"Replay tweaking\">\n        <div className=\"controls tweaking\">\n          <span\n            className=\"button\"\n            title=\"Cancel tweaks\"\n            onClick={() => this.discardTweaks()}\n          >\n            \n          </span>\n          <span\n            className=\"button\"\n            title=\"Save tweaks\"\n            onClick={() => this.saveTweaks()}\n          >\n            \n          </span>\n        </div>\n        <div className=\"fields\">\n          {ReplayEditFields.map((field) => (\n            <div\n              key={field}\n              className={`field ${tweaking[`${field}_error`] ? \"error\" : \"\"} ${\n                tweaking[`${field}_changed`] ? \"changed\" : \"\"\n              }`}\n            >\n              <label>\n                {field}{\" \"}\n                <span\n                  style={{\n                    visibility: tweaking[`${field}_changed`]\n                      ? \"visible\"\n                      : \"hidden\",\n                  }}\n                  className=\"button\"\n                  title=\"Discard these tweaks\"\n                  onClick={() => this.revertTweak(field)}\n                >\n                  \n                </span>\n              </label>\n              {tweaking[`${field}_error`] && (\n                <span className=\"info\">{tweaking[`${field}_error`]}</span>\n              )}\n              <textarea\n                value={tweaking[field]}\n                onChange={(e) => this.updateTweak(field, e.target.value)}\n              />\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    const {\n      replays,\n      activeRecording,\n      activeReplay,\n      editing,\n      repeat,\n      tweaking,\n    } = this.state;\n\n    if (tweaking) {\n      return this.renderTweaking();\n    }\n\n    return (\n      <div className=\"Replay\">\n        <div\n          className={`controls ${activeReplay ? \"active-replay\" : \"\"} ${\n            activeReplay && activeReplay.timeSight ? \"timeSight\" : \"\"\n          }`}\n        >\n          {activeReplay && (\n            <React.Fragment>\n              <span\n                className={`button repeat ${\n                  repeat ? \"repeat-on\" : \"repeat-off\"\n                }`}\n                title={\n                  repeat\n                    ? \"Disable automatic repeat\"\n                    : \"Enable automatic repeat\"\n                }\n                onClick={() => this.toggleRepeat()}\n              >\n                \n              </span>\n              <span\n                className=\"button\"\n                title=\"Stop replay\"\n                onClick={() => this.stopReplay()}\n              >\n                \n              </span>\n              {activeReplay.timeSight && (\n                <span\n                  className=\"button\"\n                  title=\"Disable timeSight\"\n                  onClick={() => this.toggleTimeSight()}\n                >\n                  \n                </span>\n              )}\n              {!activeReplay.timeSight && (\n                <span\n                  className=\"button\"\n                  title=\"Enable timeSight\"\n                  onClick={() => this.toggleTimeSight()}\n                >\n                  \n                </span>\n              )}\n            </React.Fragment>\n          )}\n          {!activeReplay &&\n            (activeRecording ? (\n              <React.Fragment>\n                <span\n                  className=\"recording button\"\n                  title=\"Stop recording\"\n                  onClick={() => this.stopRecording()}\n                >\n                  \n                </span>\n                <span\n                  className=\"button\"\n                  title=\"Discard recording\"\n                  onClick={() => this.trashRecording()}\n                >\n                  \n                </span>\n              </React.Fragment>\n            ) : (\n              <React.Fragment>\n                <span\n                  className=\"record button\"\n                  title=\"Start recording replay\"\n                  onClick={() => this.beginRecording()}\n                >\n                  \n                </span>\n                <span\n                  className=\"snapshot button\"\n                  title=\"Take snapshot (save state)\"\n                  onClick={() => this.beginRecording({ snapshot: true })}\n                >\n                  \n                </span>\n              </React.Fragment>\n            ))}\n        </div>\n        <ul className=\"replays\">\n          {replays.map((replay) => (\n            <li\n              className={`\n                replay\n                ${\n                  activeReplay && activeReplay.timestamp === replay.timestamp\n                    ? \"active\"\n                    : \"\"\n                }\n                ${editing === replay.timestamp ? \"editing\" : \"\"}\n              `}\n              key={replay.timestamp}\n            >\n              <span className=\"drag\"></span>\n              {activeReplay &&\n                activeReplay.timeSight &&\n                activeReplay.timestamp === replay.timestamp && (\n                  <span\n                    className=\"play button\"\n                    title=\"Restart timeSight\"\n                    onClick={() =>\n                      this.beginReplay({ ...replay, timeSight: true }, true)\n                    }\n                  >\n                    \n                  </span>\n                )}\n              {activeReplay &&\n                !activeReplay.timeSight &&\n                activeReplay.timestamp === replay.timestamp && (\n                  <span\n                    className=\"play button\"\n                    title=\"Restart replay\"\n                    onClick={() => this.beginReplay(replay, true)}\n                  >\n                    \n                  </span>\n                )}\n              {(!activeReplay || activeReplay.timestamp !== replay.timestamp) &&\n                !replay.snapshot && (\n                  <span\n                    className=\"play button\"\n                    title=\"Start replay\"\n                    onClick={() => this.beginReplay(replay, true)}\n                  >\n                    \n                  </span>\n                )}\n              {(!activeReplay || activeReplay.timestamp !== replay.timestamp) &&\n                replay.snapshot && (\n                  <span\n                    className=\"play button\"\n                    title=\"Load snapshot (load state)\"\n                    onClick={() => this.beginReplay(replay, true)}\n                  >\n                    \n                  </span>\n                )}\n              {editing === replay.timestamp && this.renderEditReplay(replay)}\n              <span\n                className=\"name\"\n                onClick={() => this.beginReplay(replay, true)}\n              >\n                {replay.name}\n              </span>\n              <span\n                className=\"edit button\"\n                title=\"Edit replay\"\n                onClick={() => this.setEditing(replay.timestamp)}\n              >\n                \n              </span>\n            </li>\n          ))}\n        </ul>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './Logging.css';\nimport {saveField, loadField} from './lib/store';\n\nexport default class Logging extends React.Component {\n  constructor(props) {\n    super(props);\n    const log = loadField('log', []).map((line) => ({...line, recent: false, old: true}));\n    this.state = {\n      log,\n    };\n    this.logId = 1 + Number(log.map(({id}) => id).reduce((a, b) => (a > b ? a : b), 0));\n    this.timers = [];\n    this.ref = React.createRef();\n  }\n\n  componentDidMount() {\n    this.original = {};\n    const component = this;\n    ['trace', 'debug', 'log', 'info', 'warn', 'error'].forEach((level) => {\n      // eslint-disable-next-line no-console\n      const original = this.original[level] = console[level];\n      // eslint-disable-next-line no-console\n      console[level] = function(...args) {\n        const context = component.extractContext(...args);\n        component.prependLog(args.join(' '), level, context);\n        return original(...args);\n      };\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    const {game} = this.props;\n    if (!prevProps.game && game) {\n      game.onDisableDebugUI(() => {\n        this.removeLogging();\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    this.removeLogging();\n  }\n\n  removeLogging() {\n    this.timers.forEach((timer) => {\n      clearTimeout(timer);\n    });\n\n    Object.entries(this.original).forEach(([level, original]) => {\n      // eslint-disable-next-line no-console\n      console[level] = original;\n    });\n  }\n\n  extractContext(msg) {\n    if (msg instanceof Error) {\n      const {stack} = msg;\n      const match = stack.match(/ at (\\w+) \\(http/);\n      if (match) {\n        return match[1];\n      }\n    }\n    return null;\n  }\n\n  prependLog(originalMsg, level, context) {\n    const msg = originalMsg.replace(/^Error: /, '');\n\n    if (msg.match(/https:\\/\\/phaser\\.io/)) {\n      return;\n    }\n\n    const id = (this.logId += 1);\n\n    {\n      const timer = setTimeout(() => {\n        this.setState(({log}) => ({\n          log: log.map((line) => (line.id === id ? {...line, recent: true} : line)),\n        }));\n      }, 500);\n\n      this.timers.push(timer);\n    }\n\n    {\n      const timer = setTimeout(() => {\n        this.setState(({log}) => ({\n          log: log.map((line) => (line.id === id ? {...line, recent: false, old: true} : line)),\n        }));\n      }, 5000);\n\n      this.timers.push(timer);\n    }\n\n    this.ref.current.scrollTop = 0;\n\n    this.setState(({log}) => {\n      const newLog = [\n        {\n          msg, level, id, context,\n        },\n        ...log.filter((_, n) => n < 19),\n      ];\n\n      setTimeout(() => {\n        saveField('log', newLog);\n      });\n\n      return {\n        log: newLog,\n      };\n    });\n  }\n\n  render() {\n    const {log} = this.state;\n    return (\n      <div className=\"Logging\" ref={this.ref}>\n        <ol>\n          {log.map(({\n            msg, level, id, recent, old, context,\n          }) => (\n            <li key={id} className={`${level} ${recent ? 'recent' : ''} ${old ? 'old' : ''}`}>\n              <span className=\"level\">{level}</span>\n              <span className=\"msg\">{msg}</span>\n              {context && (\n                <span className=\"context\">\n                  {context}\n                </span>\n              )}\n            </li>\n          ))}\n        </ol>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport \"./Development.css\";\nimport Engine from \"./Engine\";\nimport Manage from \"./Manage\";\nimport Replay from \"./Replay\";\nimport Logging from \"./Logging\";\nimport { developmentDisplay } from \"../../package.json\";\n\nexport default class Development extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      game: null,\n      activateGame: null,\n    };\n  }\n\n  loadedGame = (game, activateGame) => {\n    window.game = game;\n    this.setState({ game, activateGame });\n  };\n\n  render() {\n    const { game, activateGame } = this.state;\n\n    return (\n      <div className=\"development\">\n        <Engine debug loadedGame={this.loadedGame} />\n\n        <Logging game={game} />\n\n        <div className=\"sidebar\">\n          <ul className=\"links\">\n            {developmentDisplay.links.map(([href, label]) => (\n              <li key={href}>\n                <a target=\"_blank\" rel=\"noopener noreferrer\" href={href}>\n                  {label}\n                </a>\n              </li>\n            ))}\n          </ul>\n\n          <Manage />\n          <Replay activateGame={activateGame} />\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './Production.css';\nimport Engine from './Engine';\nimport twitchLogo from './twitchLogo.png';\nimport twitterLogo from './twitterLogo.png';\nimport {productionDisplay} from '../../package.json';\n\nexport default class Production extends React.Component {\n  render() {\n    return (\n      <div className=\"production\">\n        <Engine />\n\n        <div className=\"game-metadata\">\n          <h1>{productionDisplay.displayName}</h1>\n          {productionDisplay.authorName && (\n            <h3>\n              by\n              <br />\n              {productionDisplay.authorURL ? (\n                <a target=\"_blank\" rel=\"noopener noreferrer\" href={productionDisplay.authorURL}>{productionDisplay.authorName}</a>\n              ) : (\n                productionDisplay.authorName\n              )}\n              <br />\n              {productionDisplay.authorTwitter && (\n                <a target=\"_blank\" rel=\"noopener noreferrer\" href={`https://twitter.com/${productionDisplay.authorTwitter}`}>\n                  <img src={twitterLogo} alt={`@${productionDisplay.authorTwitter} on Twitter`} />\n                </a>\n              )}\n              {productionDisplay.authorTwitch && (\n                <a target=\"_blank\" rel=\"noopener noreferrer\" href={`https://twitch.tv/${productionDisplay.authorTwitch}`}>\n                  <img src={twitchLogo} alt={`${productionDisplay.authorTwitch} on Twitch`} />\n                </a>\n              )}\n            </h3>\n          )}\n          <p>\n            {productionDisplay.eventDescription && (\n              <React.Fragment>\n                {productionDisplay.eventDescription}\n                <br />\n              </React.Fragment>\n            )}\n            {productionDisplay.eventNamePre}\n            {' '}\n            <strong>{productionDisplay.eventNameBold}</strong>\n            {' '}\n            {productionDisplay.eventNamePost}\n          </p>\n          {productionDisplay.eventURL && (\n            <p>\n              <a target=\"_blank\" rel=\"noopener noreferrer\" href={productionDisplay.eventURL}>\n                {productionDisplay.eventURL}\n              </a>\n            </p>\n          )}\n          <p>\n            {productionDisplay.themeDescription && (\n              <React.Fragment>\n                {productionDisplay.themeDescription}\n                <br />\n              </React.Fragment>\n            )}\n            {productionDisplay.themePre}\n            {' '}\n            <em>{productionDisplay.themeItalic}</em>\n            {' '}\n            {productionDisplay.themePost}\n          </p>\n          {productionDisplay.repoURL && (\n            <p>\n              code at\n              <br />\n              <a className=\"url\" target=\"_blank\" rel=\"noopener noreferrer\" href={productionDisplay.repoURL}>\n                {productionDisplay.repoURL}\n              </a>\n            </p>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './Production.css';\nimport Engine from './Engine';\n\nexport default class Embed extends React.Component {\n  render() {\n    return (\n      <div className=\"production embed\">\n        <Engine disableFullscreen />\n      </div>\n    );\n  }\n}\n","import {hot} from 'react-hot-loader/root';\nimport React from 'react';\nimport Development from './Development';\nimport Production from './Production';\nimport Embed from './Embed';\nimport {productionDisplay} from '../../package.json';\n\nclass App extends React.Component {\n  render() {\n    const {debug} = this.props;\n\n    if (productionDisplay.embed) {\n      return <Embed />;\n    } else if (debug) {\n      return <Development />;\n    } else {\n      return <Production />;\n    }\n  }\n}\n\nexport default hot(App);\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './base.css';\nimport App from './App';\n\nconst debug = !process.env.NODE_ENV || process.env.NODE_ENV === 'development';\n\nReactDOM.render(<App debug={debug} />, document.getElementById('root'));\n","import Phaser from \"phaser\";\nimport deepEqual from \"deep-equal\";\nimport prop, {\n  propsWithPrefix,\n  manageableProps,\n  tileDefinitions,\n  propSpecs,\n} from \"../props\";\nimport {\n  updatePropsFromStep,\n  overrideProps,\n  refreshUI,\n} from \"./lib/manage-gui\";\nimport massageParticleProps, {\n  injectEmitterOpSeededRandom,\n  injectParticleEmitterManagerPreUpdate,\n  particlePropFromProp,\n} from \"./lib/particles\";\nimport massageTransitionProps, {\n  baseTransitionProps,\n  applyPause,\n} from \"./lib/transitions\";\nimport { injectAddSpriteTimeScale } from \"./lib/sprites\";\nimport { injectAnimationUpdate } from \"./lib/anims\";\nimport { injectCameraShake } from \"./lib/camera\";\nimport massageTweenProps, { injectTweenManagerAdd } from \"./lib/tweens\";\nimport { shaderTypeMeta, propNamesForUniform } from \"./lib/shaders\";\nimport { saveField, loadField } from \"./lib/store\";\n\nimport { parseMaps, parseLevelLines } from \"./lib/level-parser\";\nimport mapsFile from \"../assets/maps.txt\";\nimport * as assets from \"../assets/index\";\nimport { preloadAssets, reloadAssets } from \"./lib/assets\";\n\nconst baseConfig = {};\n\nexport default class SuperScene extends Phaser.Scene {\n  constructor(subconfig) {\n    const config = {\n      ...baseConfig,\n      ...subconfig,\n    };\n    super(config);\n\n    this.rnd = {};\n    this.timeScale = 1;\n    this.sounds = [];\n    this.timers = [];\n    this.performanceFrames = 0;\n    this.performanceAcceptable = true;\n    this.scene_time = 0;\n    this.shockwave_time = 0;\n    this._trauma = 0;\n    this._traumaShake = 0;\n    this._paused = {\n      physics: false,\n      particles: false,\n      timers: false,\n      tweens: false,\n      anims: false,\n    };\n\n    this._renderDelta = 0;\n  }\n\n  init(config) {\n    const { tileWidth, tileHeight, width, height } = this.game.config;\n    this.tileWidth = tileWidth;\n    this.tileHeight = tileHeight;\n    this.halfWidth = tileWidth / 2;\n    this.halfHeight = tileWidth / 2;\n\n    if (!config.seed) {\n      throw new Error(\n        `You must provide a \"seed\" (e.g. Date.now()) to ${\n          this.constructor.name\n        }`\n      );\n    }\n\n    if (!config.sceneId) {\n      throw new Error(\n        `You must provide a \"sceneId\" (e.g. Date.now()) to ${\n          this.constructor.name\n        }`\n      );\n    }\n\n    this.sceneId = config.sceneId;\n\n    this.command = this.game.command;\n    this.command.attachScene(this, config._timeSightTarget);\n\n    this.camera = this.cameras.main;\n    const color = this.cameraColor();\n    if (color !== null) {\n      this.camera.setBackgroundColor(color);\n    }\n    injectCameraShake(this.camera);\n\n    if (config.save) {\n      this.save = config.save;\n    } else if (!this.save && this.saveStateFieldName()) {\n      this.save = loadField(this.saveStateFieldName(), () => {\n        const save = this.initialSaveState();\n        save.version = this.saveStateVersion();\n        return save;\n      });\n    }\n\n    if (this.save) {\n      this.save = this.migrateSaveState(this.save);\n    }\n\n    if (!this.save) {\n      this.save = {};\n    }\n\n    this._initialSave = JSON.parse(JSON.stringify(this.save));\n\n    if (this.physics && this.physics.world) {\n      injectAddSpriteTimeScale(this);\n      injectTweenManagerAdd(this.tweens);\n\n      if (prop(\"scene.debugDraw\")) {\n        this.physics.world.createDebugGraphic();\n      }\n\n      // there's no event for physics step, so interject one {\n      if (this.fixedUpdate) {\n        // make tweens use a fixed update\n        const { tweens } = this.scene.systems;\n        const eventEmitter = tweens.systems.events;\n        eventEmitter.off(\"update\", tweens.update, tweens);\n\n        const { physics } = this;\n        const { world } = physics;\n        const originalStep = world.step;\n        let time = 0;\n        physics.time = physics.dt = 0;\n        world.step = (originalDelta) => {\n          const delta = originalDelta / world.timeScale;\n\n          while (!this._didRenderDelta || this._renderDelta > 0) {\n            const dt = delta * 1000;\n            time += dt;\n            physics.dt = dt;\n            physics.time = time;\n            this.scene_time = time;\n\n            if (this._didRenderDelta) {\n              this._renderDelta -= originalDelta * 1000;\n            } else {\n              this._renderDelta = 0;\n              this._didRenderDelta = true;\n            }\n\n            if (this.game._stepExceptions > 100) {\n              return;\n            }\n\n            try {\n              const isTopScene = this.isTopScene();\n\n              if (this.timeSightFrozen) {\n                if (isTopScene) {\n                  this.command.processInput(this, time, dt, true);\n                }\n                this.updateTweens(time, dt);\n                this.timeSightMouseDrag();\n                return;\n              }\n\n              if (!this._paused.physics) {\n                originalStep.call(world, delta);\n              }\n\n              if (isTopScene) {\n                this.command.processInput(this, time, dt);\n              }\n\n              if (this.game.updateReplayCursor) {\n                this.game.updateReplayCursor(\n                  this.command.replayTicks,\n                  this._replay\n                );\n              }\n\n              if (!this._paused.physics) {\n                this.fixedUpdate(time, dt);\n              }\n\n              this.updateTimers(time, dt);\n\n              if (this.performanceProps && this.performanceProps.length) {\n                this.recoverPerformance();\n              }\n\n              this.updateTweens(time, dt);\n\n              this.game._stepExceptions = 0;\n            } catch (e) {\n              // eslint-disable-next-line no-console\n              console.error(e);\n\n              this.game._stepExceptions = (this.game._stepExceptions || 0) + 1;\n              if (this.game._stepExceptions > 100) {\n                // eslint-disable-next-line no-console\n                console.error(\n                  \"Too many errors; pausing update cycle until hot reload\"\n                );\n              }\n            }\n          }\n        };\n      }\n      // }\n    }\n\n    this.sound.pauseOnBlur = false;\n\n    this.particleSystems = [];\n\n    this.sys.events.on(\"destroy\", this.destroy, this);\n\n    [\"_recording\", \"_replay\", \"_replayOptions\"].forEach((key) => {\n      this[key] = config[key];\n      delete config[key];\n    });\n\n    if (this._recording) {\n      this._recording.sceneTransitions.push({\n        tickCount: this._recording.tickCount,\n        timestamp: Date.now(),\n        seed: config.seed,\n        sceneName: this.constructor.name,\n        initData: this.scene.settings.data,\n        sceneSaveState: JSON.parse(JSON.stringify(this._initialSave)),\n        parentSceneId: config.parentSceneId,\n        sceneId: this.sceneId,\n        commandState: this.command.freezeCommandState(),\n      });\n    }\n\n    if (this._replay) {\n      const { sceneTransitions } = this._replay;\n      const { replayTicks } = this.command;\n      for (let i = 0; i < sceneTransitions.length; i += 1) {\n        if (sceneTransitions[i].tickCount <= replayTicks) {\n          this._replayLatestTransition = sceneTransitions[i];\n        } else {\n          break;\n        }\n      }\n    }\n\n    const mapWidth = Math.floor(width / (tileWidth + 2));\n    const mapHeight = Math.floor(height / (tileHeight + 3));\n\n    this.xBorder = (width - mapWidth * tileWidth) / 2;\n    this.yBorder = (height - mapHeight * tileHeight) / 2;\n\n    this.game.sceneDidInit(this);\n  }\n\n  saveStateFieldName() {\n    return `game_${this.constructor.name}`;\n  }\n\n  saveStateVersion() {\n    return 0;\n  }\n\n  migrateSaveState(originalSave) {\n    const target = this.saveStateVersion();\n    if (originalSave.version === target) {\n      return originalSave;\n    }\n\n    const save = JSON.parse(JSON.stringify(originalSave));\n    if (!save.version) {\n      save.version = 0;\n    }\n\n    while (save.version < target) {\n      const method = `migrateSaveStateVersion${save.version}`;\n      // eslint-disable-next-line no-console\n      console.debug(method);\n      if (!this[method]) {\n        throw new Error(`Missing migration method ${method}`);\n      }\n      this[method](save);\n      save.version += 1;\n    }\n\n    return save;\n  }\n\n  initialSaveState() {\n    return {};\n  }\n\n  saveState() {\n    saveField(this.saveStateFieldName(), this.save);\n  }\n\n  isTopScene() {\n    return this.game.topScene() === this;\n  }\n\n  vendRNG(name) {\n    if (!name) {\n      throw new Error(\"You must provide a name for each RNG sequence\");\n    }\n\n    if (!this.rnd[name]) {\n      const { seed } = this.scene.settings.data;\n      this.rnd[name] = new Phaser.Math.RandomDataGenerator([seed, name]);\n    }\n\n    return this.rnd[name];\n  }\n\n  randFloat(name) {\n    return this.vendRNG(name).frac();\n  }\n\n  randBetween(name, min, max) {\n    return this.randFloat(name) * (max - min) + min;\n  }\n\n  randElement(name, list) {\n    return list[Math.floor(this.randBetween(name, 0, list.length))];\n  }\n\n  create() {\n    this.command.attachInputs(this);\n\n    this.startedAt = new Date();\n\n    if (this.setupAnimations) {\n      this.setupAnimations();\n    }\n\n    const { transition } = this.scene.settings.data;\n    if (!transition || !transition.delayNewSceneShader) {\n      this._setupShader();\n    }\n  }\n\n  setShader(shaderName) {\n    this.shaderName = shaderName;\n    this._setupShader();\n  }\n\n  _setupShader() {\n    if (!(\"shaderName\" in this)) {\n      this.shaderName = \"main\";\n    }\n\n    if (this.shaderName) {\n      this.game.initializeShader(this.shaderName);\n      this.shader = this.game.shaderInstance(this.shaderName);\n      if (this.shader) {\n        this._shaderInitialize(true);\n        this._shaderUpdate();\n        this.camera.setRenderToTexture(this.shader);\n      }\n    }\n  }\n\n  preload() {\n    this.load.text(\"_mapsFile\", mapsFile);\n\n    preloadAssets(this, assets);\n  }\n\n  levelIds() {\n    if (!this.game._ldMapFiles) {\n      this.game._ldMapFiles = parseMaps(this.cache.text.get(\"_mapsFile\"));\n    }\n\n    return this.game._ldMapFiles.map(([, config]) => config.id);\n  }\n\n  loadLevel(id) {\n    if (!this.game._ldMapFiles) {\n      this.game._ldMapFiles = parseMaps(this.cache.text.get(\"_mapsFile\"));\n    }\n    const mapFiles = this.game._ldMapFiles;\n\n    let index;\n    let spec = mapFiles[id];\n    if (spec) {\n      index = id;\n    } else {\n      index = mapFiles.findIndex((m) => m[1].id === id);\n      spec = mapFiles[index];\n    }\n\n    if (!spec) {\n      throw new Error(`Cannot find level with id ${id}`);\n    }\n\n    const [lines, config] = spec;\n    const { map, mapText, lookups } = parseLevelLines(\n      lines,\n      this.mapsAreRectangular\n    );\n\n    const { tileWidth, tileHeight } = this;\n    const heightInTiles = map.length;\n    const height = tileHeight * heightInTiles;\n    const widthInTiles = Math.max(...map.map((a) => a.length));\n    const width = tileWidth * widthInTiles;\n\n    const level = {\n      ...config,\n      heightInTiles,\n      widthInTiles,\n      height,\n      width,\n      map,\n      mapText,\n      mapLookups: lookups,\n      index,\n    };\n\n    if (level.background) {\n      level.background = this.add.sprite(0, 0, level.background);\n      level.background.setPosition(\n        level.background.width * 0.5,\n        level.background.height * 0.5\n      );\n    }\n\n    if (level.underground) {\n      this.createUnderground(level.underground);\n    }\n\n    return level;\n  }\n\n  createUnderground(name) {\n    if (this.game.debug) {\n      const template = this.add.image(0, 0, name);\n      const { width, height } = template;\n      template.destroy();\n\n      // eslint-disable-next-line no-bitwise\n      const isPowerOfTwo = (x) => x && !(x & (x - 1));\n      if (!isPowerOfTwo(width) || !isPowerOfTwo(height)) {\n        // eslint-disable-next-line no-console\n        console.error(\n          `Underground ${name} is ${width}x${height}; please use an image having powers-of-two dimensions for best rendering`\n        );\n      }\n    }\n\n    const { width, height, tileWidth, tileHeight } = this.game.config;\n\n    // Add some fudge because even with late updates to underground position\n    // we still see the background peek through\n    const w = width + 10 * tileWidth;\n    const h = height + 10 * tileHeight;\n    const underground = this.add.tileSprite(w / 2, h / 2, w, h, name);\n    underground.tilePositionX = 0;\n    underground.tilePositionY = 0;\n    this.underground = underground;\n  }\n\n  executeScript(script) {\n    const { execute, delay } = script;\n\n    if (delay) {\n      this.timer(() => {\n        this.executeScript({ ...script, delay: 0 });\n      }, delay);\n      return;\n    }\n\n    if (execute) {\n      if (typeof execute === \"object\") {\n        const [method, ...args] = execute;\n        this[method](...args);\n      } else {\n        this[execute]();\n      }\n    }\n  }\n\n  textSize() {\n    return \"24px\";\n  }\n\n  textColor() {\n    return \"rgb(255, 0, 0)\";\n  }\n\n  strokeColor() {\n    return \"rgb(0, 0, 0)\";\n  }\n\n  strokeWidth() {\n    return 6;\n  }\n\n  cameraColor() {\n    return 0x000000;\n  }\n\n  text(x, y, text, options = {}) {\n    const label = this.add.text(x, y, text, {\n      fontFamily:\n        '\"Avenir Next\", \"Avenir\", \"Helvetica Neue\", \"Helvetica\", \"Arial\"',\n      fontWeight: \"bold\",\n      fontSize: this.textSize(options),\n      color: this.textColor(options),\n      ...options,\n    });\n\n    if (options.stroke !== null) {\n      if (options.stroke === undefined) {\n        label.setStroke(this.strokeColor(options), this.strokeWidth(options));\n      } else {\n        label.setStroke(...options.stroke);\n      }\n    }\n\n    return label;\n  }\n\n  speak(...args) {\n    let delay = 0;\n\n    let xc = args.shift();\n    let yc;\n\n    if (xc && !Number.isInteger(xc)) {\n      const lookups = this.level.mapLookups[xc];\n      xc = yc = lookups.map((t) => t.object).find((o) => o);\n      if (xc === undefined) {\n        xc = lookups[0].xCoord;\n        yc = lookups[0].yCoord;\n      }\n    } else {\n      yc = args.shift();\n    }\n\n    if (xc === null || xc === undefined) {\n      xc = this.game.config.width / 2;\n    }\n    if (yc === null || yc === undefined) {\n      yc = this.game.config.height / 2;\n    }\n\n    let lines = args.shift();\n    if (!Array.isArray(lines)) {\n      lines = [lines];\n    }\n\n    const options = args.shift() || {};\n\n    lines.forEach((line, i) => {\n      const {\n        duration,\n        inTime,\n        outTime,\n        text,\n        extraDelay,\n        dx,\n        dy,\n        ox,\n        oy,\n        noOut,\n        follow,\n        scrollFactor,\n        onAdd,\n        onExit,\n      } = {\n        inTime: 200,\n        outTime: 200,\n        duration: null,\n        extraDelay: 200,\n        dy: null,\n        dx: null,\n        ox: 0,\n        oy: 0,\n        noOut: false,\n        follow: true,\n        scrollFactor: null,\n        onAdd: null,\n        onExit: null,\n        ...options,\n        ...(typeof line === \"object\" ? line : { text: line }),\n      };\n\n      const d = duration === null ? text.length * 100 : duration;\n      const dx1 = dx === null ? 0 : dx;\n      const dy1 = dy === null ? -this.game.config.tileHeight : dy;\n\n      this.timer(() => {\n        let xl = xc;\n        let yl = yc;\n\n        let xo = typeof xl === \"object\" ? xl : null;\n        let yo = typeof yl === \"object\" ? yl : null;\n\n        if (xo) {\n          xl = xo.x;\n          if (!follow) {\n            xo = null;\n          }\n        }\n        if (yo) {\n          yl = yo.y;\n          if (!follow) {\n            yo = null;\n          }\n        }\n\n        xl += ox;\n        yl += oy;\n\n        const label = this.text(xl, yl, text, options);\n        const halfWidth = label.width / 2;\n        const halfHeight = label.height / 2;\n        label.x -= halfWidth;\n        label.y -= halfHeight;\n\n        let lx = label.x;\n        let ly = label.y;\n        label.alpha = 0;\n\n        if (scrollFactor !== null) {\n          label.setScrollFactor(scrollFactor);\n        }\n\n        if (onAdd) {\n          onAdd(label);\n        }\n\n        this.tweenPercent(\n          inTime,\n          (factor) => {\n            label.alpha = factor;\n\n            if (xo) {\n              label.x =\n                (xo.xCoord === undefined ? xo.x : xo.xCoord) - halfWidth + dx1;\n              lx = label.x;\n            }\n\n            if (yo) {\n              label.y =\n                (yo.yCoord === undefined ? yo.y : yo.yCoord) - halfHeight + dy1;\n              ly = label.y;\n            }\n\n            label.x = lx - dx1 * (1.0 - factor) + ox;\n            label.y = ly - dy1 * (1.0 - factor) + oy;\n          },\n          null,\n          0,\n          \"Cubic.easeOut\"\n        );\n\n        this.timer(() => {\n          this.tweenPercent(\n            d,\n            (factor) => {\n              if (xo) {\n                label.x =\n                  (xo.xCoord === undefined ? xo.x : xo.xCoord) -\n                  halfWidth +\n                  dx1;\n                lx = label.x;\n              }\n              if (yo) {\n                label.y =\n                  (yo.yCoord === undefined ? yo.y : yo.yCoord) -\n                  halfHeight +\n                  dy1;\n                ly = label.y;\n              }\n\n              label.x = lx + ox;\n              label.y = ly + oy;\n            },\n            null,\n            0,\n            \"Cubic.easeOut\"\n          );\n        }, inTime);\n\n        if (noOut) {\n          return;\n        }\n\n        this.timer(() => {\n          this.tweenPercent(\n            outTime,\n            (factor) => {\n              label.alpha = 1.0 - factor;\n\n              if (xo) {\n                label.x =\n                  (xo.xCoord === undefined ? xo.x : xo.xCoord) -\n                  halfWidth +\n                  dx1;\n                lx = label.x;\n              }\n\n              if (yo) {\n                label.y =\n                  (yo.yCoord === undefined ? yo.y : yo.yCoord) -\n                  halfHeight +\n                  dy1;\n                ly = label.y;\n              }\n\n              label.x = lx - dx1 * factor + ox;\n              label.y = ly - dy1 * factor + oy;\n            },\n            () => {\n              if (onExit) {\n                onExit();\n              }\n              label.destroy();\n            },\n            0,\n            \"Cubic.easeOut\"\n          );\n        }, inTime + d);\n      }, extraDelay + delay);\n\n      delay += extraDelay + d + inTime + outTime;\n    });\n  }\n\n  createLevel(id) {\n    const level = (this.level = this.loadLevel(id));\n    this.addMap();\n    return level;\n  }\n\n  createTileForGroup(groupName, x, y) {\n    const { level, tileWidth, tileHeight, halfWidth, halfHeight } = this;\n    const group = level.groups[groupName];\n\n    let object;\n\n    if (group.image) {\n      object = group.group.create(x, y, group.image);\n    } else {\n      object = this.add.rectangle(x, y, tileWidth, tileHeight);\n      group.group.add(object);\n    }\n    group.objects.push(object);\n\n    if (group.isCircle) {\n      const radius = (halfHeight + halfWidth) / 2;\n      object.setCircle(radius);\n    }\n\n    return object;\n  }\n\n  addMap() {\n    const { level, tileWidth, tileHeight, halfWidth, halfHeight } = this;\n\n    const groups = (level.groups = {});\n    Object.values(tileDefinitions).forEach((spec) => {\n      if (!spec) {\n        return;\n      }\n\n      if (spec.group) {\n        let group;\n        if (spec.isStatic) {\n          group = this.physics.add.staticGroup();\n        } else {\n          group = this.physics.add.group();\n        }\n\n        groups[spec.group] = {\n          tiles: [],\n          objects: [],\n          ...spec,\n          group,\n        };\n      }\n    });\n\n    const combine = {};\n\n    level.map.forEach((row, y) => {\n      row.forEach((tile, x) => {\n        const { glyph, group } = tile;\n        const [xCoord, yCoord] = this.positionToScreenCoordinate(\n          tile.x,\n          tile.y\n        );\n        tile.xCoord = xCoord;\n        tile.yCoord = yCoord;\n\n        if (group) {\n          if (tile.combine) {\n            const combiner = tile.combine === true ? glyph : tile.combine;\n\n            if (!combine[combiner]) {\n              combine[combiner] = [];\n            }\n\n            combine[combiner].push(tile);\n            return;\n          }\n\n          const object = this.createTileForGroup(\n            group,\n            xCoord + halfWidth,\n            yCoord + halfHeight\n          );\n          object.tiles = [tile];\n          tile.object = object;\n        } else if (tile.image) {\n          const image = this.add.image(\n            xCoord + halfWidth,\n            yCoord + halfHeight,\n            tile.image\n          );\n          image.tile = tile;\n          tile.image = image;\n        }\n\n        if (tile.combine) {\n          // eslint-disable-next-line no-console\n          console.warn(\n            `Cannot combine tile of type ${tile.glyph}; needs a group`\n          );\n        }\n      });\n    });\n\n    Object.values(combine).forEach((tiles) => {\n      const { preferCombineVertical } = tiles[0];\n      const dxPrimary = preferCombineVertical ? 0 : 1;\n      const dyPrimary = preferCombineVertical ? 1 : 0;\n      const dxSecondary = preferCombineVertical ? 1 : 0;\n      const dySecondary = preferCombineVertical ? 0 : 1;\n\n      const group = level.groups[tiles[0].group];\n\n      if (preferCombineVertical) {\n        tiles.sort((a, b) => a.x - b.x || a.y - b.y);\n      } else {\n        tiles.sort((a, b) => a.y - b.y || a.x - b.x);\n      }\n\n      const m = this.level.map[0].map((row) => []);\n      // fake autovivify for last row\n      m.push([]);\n\n      tiles.forEach((tile) => {\n        const { x, y } = tile;\n        m[x][y] = tile;\n      });\n\n      const chains = {};\n\n      // This starts at the top left and greedily scans down/right for\n      // chaining; this could be improved by looking for the \"best\"\n      // at each scanline, e.g. when preferring horizontal this should\n      // create one one-tile chain and one three-tile chain\n      //   *\n      //   ***\n      // but instead it creates two two-tile chains\n\n      tiles.forEach((tile) => {\n        const { x, y, combineWith } = tile;\n\n        const id = `${x}/${y}`;\n\n        // Start a new chain\n        if (!combineWith) {\n          const primary = m[x + dxPrimary][y + dyPrimary];\n          if (primary && !primary.combineWith) {\n            primary.combineWith = id;\n            primary.dxNext = dxPrimary;\n            primary.dyNext = dyPrimary;\n            chains[id] = [tile, primary];\n          } else {\n            const secondary = m[x + dxSecondary][y + dySecondary];\n            if (secondary && !secondary.combineWith) {\n              secondary.combineWith = id;\n              secondary.dxNext = dxSecondary;\n              secondary.dyNext = dySecondary;\n              chains[id] = [tile, secondary];\n            } else {\n              chains[id] = [tile];\n            }\n          }\n        } else {\n          const { dxNext, dyNext } = tile;\n          // Continue existing chain\n          const next = m[x + dxNext][y + dyNext];\n          if (next && !next.combineWith) {\n            next.combineWith = combineWith;\n            next.dxNext = dxNext;\n            next.dyNext = dyNext;\n            chains[combineWith].push(next);\n          }\n        }\n      });\n\n      Object.entries(chains).forEach(([id, chainTiles]) => {\n        const first = chainTiles[0];\n        const last = chainTiles[chainTiles.length - 1];\n        const [x0, y0] = this.positionToScreenCoordinate(first.x, first.y);\n        const [x1, y1] = this.positionToScreenCoordinate(last.x, last.y);\n        const w = x1 - x0 + tileWidth;\n        const h = y1 - y0 + tileHeight;\n        const object = this.add.rectangle(x0 + w * 0.5, y0 + h * 0.5, w, h);\n\n        group.group.add(object);\n        group.objects.push(object);\n        object.tiles = chainTiles;\n\n        chainTiles.forEach((tile) => {\n          const image = this.add.image(\n            tile.xCoord + halfWidth,\n            tile.yCoord + halfHeight,\n            tile.image\n          );\n          image.tile = tile;\n          tile.image = image;\n          tile.object = object;\n        });\n      });\n    });\n\n    return level;\n  }\n\n  setCameraBounds() {\n    const { level } = this;\n\n    if (!prop(\"scene.camera.hasBounds\")) {\n      this.camera.removeBounds();\n      return;\n    }\n\n    if (level && level.width && level.height) {\n      const boundsX = 0;\n      const boundsY = 0;\n      let boundsWidth = level.width;\n      let boundsHeight = level.height;\n\n      if (this.xBorder) {\n        boundsWidth += this.xBorder * 2;\n      }\n\n      if (this.yBorder) {\n        boundsHeight += this.yBorder * 2;\n      }\n\n      this.camera.setBounds(boundsX, boundsY, boundsWidth, boundsHeight);\n    }\n  }\n\n  setCameraDeadzone() {\n    this.camera.setDeadzone(\n      prop(\"scene.camera.deadzoneX\"),\n      prop(\"scene.camera.deadzoneY\")\n    );\n  }\n\n  setCameraLerp() {\n    this.camera.setLerp(prop(\"scene.camera.lerp\"));\n  }\n\n  firstUpdate(time, dt) {\n    this.setCameraBounds();\n    this.setCameraDeadzone();\n    this.setCameraLerp();\n\n    if (this.level && this.level.scripts) {\n      let delay = 0;\n      this.level.scripts.forEach((script) => {\n        if (script.delay) {\n          delay += script.delay;\n        }\n        this.executeScript({ ...script, delay });\n      });\n    }\n  }\n\n  update(time, dt) {\n    if (!this._firstUpdated) {\n      this.firstUpdate(time, dt);\n      this._firstUpdated = true;\n      this._renderDelta = 0;\n    }\n    this._renderDelta += dt;\n\n    if (\n      this.physics &&\n      this.physics.world.isPaused &&\n      !this.timeSightFrozen &&\n      this.isTopScene()\n    ) {\n      this.command.processInput(this, time, dt, true);\n    }\n\n    if (this.renderUpdate) {\n      this.renderUpdate(time, dt);\n    }\n    if (this.shader) {\n      this._shaderUpdate();\n    }\n\n    this.positionBackground();\n    this.positionUnderground();\n  }\n\n  positionBackground() {\n    const { level, game, xBorder, yBorder, camera } = this;\n    if (!level) {\n      return;\n    }\n\n    const { background, width: levelWidth, height: levelHeight } = level;\n    if (!background) {\n      return;\n    }\n\n    const { width: gameWidth, height: gameHeight } = game.config;\n    const { width: backgroundWidth, height: backgroundHeight } = background;\n    const { scrollX, scrollY } = camera;\n\n    const xDivisor = levelWidth - gameWidth + xBorder * 2;\n    if (xDivisor === 0) {\n      background.x = backgroundWidth * 0.5;\n    } else {\n      const xFactor = scrollX / xDivisor;\n      background.x =\n        xBorder +\n        backgroundWidth * 0.5 +\n        xFactor * (levelWidth - backgroundWidth);\n    }\n\n    const yDivisor = levelHeight - gameHeight + yBorder * 2;\n    if (yDivisor === 0) {\n      background.y = backgroundHeight * 0.5;\n    } else {\n      const yFactor = scrollY / yDivisor;\n      background.y =\n        yBorder +\n        backgroundHeight * 0.5 +\n        yFactor * (levelHeight - backgroundHeight);\n    }\n  }\n\n  positionUnderground() {\n    const { underground, camera, tileWidth, tileHeight } = this;\n    if (underground) {\n      underground.x = camera.scrollX + underground.width / 2 - tileWidth * 5;\n      underground.y = camera.scrollY + underground.height / 2 - tileHeight * 5;\n      underground.tilePositionX = camera.scrollX % tileWidth;\n      underground.tilePositionY = camera.scrollY % tileHeight;\n    }\n  }\n\n  _shaderInitialize(initializeListeners) {\n    const { shaderInitialize } = this;\n    this.game\n      .shaderFragments(this.shaderName)\n      .forEach(([fragmentName, uniforms]) => {\n        Object.entries(uniforms).forEach(([uniformName, spec]) => {\n          const name = `${fragmentName}_${uniformName}`;\n          const [type, listenerInitial, listenerIfNull] = spec;\n          if (listenerIfNull === null) {\n            if (\n              !(shaderInitialize && shaderInitialize[name] && name in this) &&\n              (initializeListeners || !(name in this))\n            ) {\n              this[name] = listenerInitial;\n            }\n          } else {\n            const [, , setter] = shaderTypeMeta[type];\n\n            const propNames = propNamesForUniform(\n              fragmentName,\n              uniformName,\n              spec\n            );\n            let initialValue;\n\n            if (propNames.length === 1) {\n              initialValue = prop(propNames[0]);\n            } else {\n              initialValue = [];\n              propNames.forEach((n) => {\n                const v = prop(n);\n                if (Array.isArray(v)) {\n                  initialValue.push(...v);\n                } else {\n                  initialValue.push(v);\n                }\n              });\n            }\n\n            if (type === \"rgb\" || type === \"rgba\") {\n              initialValue = initialValue.map((c, i) =>\n                i < 3 ? c / 255.0 : c\n              );\n            }\n\n            this.shader[setter](name, initialValue);\n          }\n        });\n      });\n\n    // generate this._shaderUpdate based on what's being used\n\n    // eslint-disable-next-line no-unused-vars\n    const { shader, camera } = this;\n\n    if (!shader) {\n      this._shaderUpdate = function() {};\n    }\n\n    const shaderUpdate = [\n      \"(function () {\",\n      `  shader.setFloat2('camera_scroll', camera.scrollX / ${\n        this.game.config.width\n      }, camera.scrollY / ${this.game.config.height});`,\n      \"  shader.setFloat1('scene_time', this.scene_time);\",\n    ];\n\n    this.game\n      .shaderFragments(this.shaderName)\n      .forEach(([fragmentName, uniforms]) => {\n        if (!prop(`shader.${fragmentName}.enabled`)) {\n          return;\n        }\n\n        Object.entries(uniforms).forEach(\n          ([uniformName, [type, , listenerIfNull]]) => {\n            const name = `${fragmentName}_${uniformName}`;\n            if (listenerIfNull !== null) {\n              return;\n            }\n\n            const [, , setter] = shaderTypeMeta[type];\n\n            if (type === \"bool\") {\n              shaderUpdate.push(\n                `  shader.${setter}('${name}', this['${name}'] ? 1.0 : 0.0);`\n              );\n            } else {\n              shaderUpdate.push(\n                `  shader.${setter}('${name}', this['${name}']);`\n              );\n            }\n          }\n        );\n      });\n\n    shaderUpdate.push(\"})\");\n\n    // eslint-disable-next-line no-eval\n    this._shaderUpdate = eval(shaderUpdate.join(\"\\n\"));\n  }\n\n  replaceWithSceneNamed(name, reseed, config = {}, originalTransition = null) {\n    const { game } = this;\n\n    if (!this.scene.settings) {\n      // this can happen when HMR happens during timeSight; SuperScene's\n      // builtinHot causes the top scene to get replaced out of the scene\n      // graph, but proxy.js still calls _hot on it\n      return;\n    }\n\n    if (this.scene.settings.data._timeSightTarget) {\n      this.endedReplay();\n      return;\n    }\n\n    let { seed } = this.scene.settings.data;\n    if (reseed === true) {\n      seed = this.randFloat(\"replaceWithSceneNamed\");\n    } else if (reseed) {\n      seed = reseed;\n    }\n\n    let sceneId;\n\n    if (this._replay) {\n      (this._replay.sceneTransitions || []).forEach((t) => {\n        if (t.parentSceneId === this.sceneId) {\n          // eslint-disable-next-line prefer-destructuring\n          sceneId = t.sceneId;\n        }\n      });\n    }\n\n    if (!sceneId) {\n      sceneId = String(this.randFloat(\"sceneId\"));\n    }\n\n    const target = `scene-${this.randFloat(\"sceneId\") * Date.now()}`;\n\n    if (this._isTransitioning) {\n      // eslint-disable-next-line no-console\n      console.error(\n        \"replaceWithSceneName called again even though this scene is already transitioning. Ignoring.\"\n      );\n      return;\n    }\n\n    this._isTransitioning = true;\n\n    const oldScene = this;\n    const { _replay, _replayOptions, _recording } = this;\n\n    const transition = this._transitionProps(originalTransition);\n\n    const returnPromise = new Promise((resolve, reject) => {\n      this.game.onSceneInit(target, (newScene) => {\n        this.willTransitionTo(newScene, transition);\n        newScene.willTransitionFrom(oldScene, transition);\n        this._sceneTransition(oldScene, newScene, transition);\n        resolve(newScene, transition);\n      });\n    });\n\n    this.scene.add(target, game._sceneConstructors[name], true, {\n      ...this.scene.settings.data,\n      ...{\n        _replay,\n        _replayOptions,\n        _recording,\n        sceneId,\n        parentSceneId: this.sceneId,\n      },\n      ...config,\n      transition,\n      seed,\n    });\n\n    return returnPromise;\n  }\n\n  replaceWithSelf(reseed, config = {}, transition = null) {\n    return this.replaceWithSceneNamed(\n      this.constructor.name,\n      reseed,\n      config,\n      transition\n    );\n  }\n\n  _sceneTransition(oldScene, newScene, transition) {\n    const {\n      animation,\n      ease,\n      duration,\n      onUpdate,\n      oldPauseTime,\n      newUnpauseTime,\n    } = transition || {};\n\n    let newUnpauseFn = () => {\n      // eslint-disable-next-line no-console\n      console.error(\"Transition did not instantiate newUnpauseFn\");\n    };\n\n    let swapScenes = true;\n\n    let _hasCutover = false;\n    const cutoverPrimary = (overrideSwapScenes) => {\n      if (_hasCutover) {\n        return;\n      }\n      _hasCutover = true;\n\n      if (overrideSwapScenes !== undefined) {\n        swapScenes = overrideSwapScenes;\n      }\n\n      if (transition && transition.onCutover) {\n        transition.onCutover(oldScene, newScene, transition);\n      }\n\n      if (oldPauseTime === \"cutover\") {\n        applyPause(oldScene, transition, transition.oldPause);\n      }\n\n      if (newUnpauseTime === \"cutover\") {\n        newUnpauseFn();\n      }\n\n      newScene.playMusicIfSet();\n\n      if (swapScenes) {\n        newScene.game.scene.bringToTop(newScene.scene.key);\n      }\n    };\n\n    let _hasCompleted = false;\n    const completeTransition = () => {\n      if (_hasCompleted) {\n        return;\n      }\n\n      if (!_hasCutover) {\n        // eslint-disable-next-line no-console\n        console.error(\n          \"completeTransition called, but cutoverPrimary hasn't been yet\"\n        );\n        cutoverPrimary();\n      }\n\n      if (transition && transition.onComplete) {\n        transition.onComplete(oldScene, newScene, transition);\n      }\n\n      if (oldPauseTime === \"complete\") {\n        applyPause(oldScene, transition, transition.oldPause);\n      }\n\n      if (newUnpauseTime === \"complete\") {\n        newUnpauseFn();\n      }\n\n      _hasCompleted = true;\n\n      newScene.timer(() => {\n        oldScene.didTransitionTo(newScene, transition);\n        newScene.didTransitionFrom(oldScene, transition);\n        oldScene.scene.remove();\n      }).ignoresScenePause = true;\n\n      if (transition) {\n        const waitTimer = newScene.timer(() => {\n          if (transition && transition.onWaitEnd) {\n            transition.onWaitEnd(oldScene, newScene, transition);\n          }\n\n          if (newUnpauseTime === \"waitEnd\") {\n            newUnpauseFn();\n          }\n        }, transition.wait);\n        waitTimer.ignoresScenePause = true;\n      }\n    };\n\n    if (transition) {\n      if (transition.removeOldSceneShader) {\n        oldScene.shader = null;\n        oldScene.camera.clearRenderToTexture();\n      }\n\n      let animate;\n\n      if (typeof animation === \"function\") {\n        animate = () =>\n          animation(\n            oldScene,\n            newScene,\n            cutoverPrimary,\n            completeTransition,\n            transition\n          );\n      } else if (animation === \"fadeInOut\") {\n        swapScenes = true;\n\n        newScene.camera.setBackgroundColor(0);\n        oldScene.camera.setBackgroundColor(0);\n        newScene.camera.alpha = 0;\n        oldScene.camera.alpha = 1;\n\n        animate = () => {\n          const tween = this.tweenInOut(\n            duration / 2,\n            duration / 2,\n            (factor, firstHalf) => {\n              if (firstHalf) {\n                oldScene.camera.alpha = 1 - factor;\n              } else {\n                newScene.camera.alpha = 1 - factor;\n              }\n\n              if (onUpdate) {\n                const percent = firstHalf ? factor / 2 : 1 - factor / 2;\n                onUpdate(percent, oldScene, newScene, transition);\n              }\n            },\n            (followupTween) => {\n              followupTween.ignoresScenePause = true;\n              cutoverPrimary();\n            },\n            () => {\n              newScene.camera.alpha = 1;\n              oldScene.camera.alpha = 0;\n              completeTransition();\n            },\n            0,\n            ease\n          );\n          tween.ignoresScenePause = true;\n        };\n      } else if (animation === \"crossFade\") {\n        // crossfade doesn't really care about scene order, so help the\n        // shader out if we can\n        if (!oldScene.shader && newScene.shader) {\n          oldScene.game.scene.bringToTop(oldScene.scene.key);\n          swapScenes = false;\n        } else if (oldScene.shader && !newScene.shader) {\n          newScene.game.scene.bringToTop(newScene.scene.key);\n          swapScenes = false;\n        } else {\n          swapScenes = true;\n        }\n\n        newScene.camera.alpha = 0;\n        oldScene.camera.alpha = 1;\n\n        animate = () => {\n          const tween = this.tweenPercent(\n            duration,\n            (factor) => {\n              newScene.camera.alpha = factor;\n              oldScene.camera.alpha = 1 - factor;\n              if (factor >= 0.5) {\n                cutoverPrimary();\n              }\n\n              if (onUpdate) {\n                onUpdate(factor, oldScene, newScene, transition);\n              }\n            },\n            () => {\n              newScene.camera.alpha = 1;\n              oldScene.camera.alpha = 0;\n\n              if (\n                !transition.suppressShaderCheck &&\n                !transition.delayNewSceneShader &&\n                oldScene.shader &&\n                newScene.shader\n              ) {\n                // eslint-disable-next-line no-console, max-len\n                console.error(\n                  \"crossFade transitions do not render correctly if the both scenes have a shader; provide delayNewSceneShader, removeOldSceneShader, or suppressShaderCheck to the transition, or use fadeInOut animation\"\n                );\n              }\n\n              completeTransition();\n            },\n            0,\n            ease\n          );\n          tween.ignoresScenePause = true;\n        };\n      } else if (\n        animation === \"pushRight\" ||\n        animation === \"pushLeft\" ||\n        animation === \"pushUp\" ||\n        animation === \"pushDown\"\n      ) {\n        const { height, width } = this.game.config;\n\n        swapScenes = true;\n\n        oldScene.camera.x = 0;\n        oldScene.camera.y = 0;\n\n        let dx = 0;\n        let dy = 0;\n\n        if (animation === \"pushRight\") {\n          newScene.camera.x = -width;\n          dx = 1;\n        } else if (animation === \"pushLeft\") {\n          newScene.camera.x = width;\n          dx = -1;\n        } else if (animation === \"pushUp\") {\n          newScene.camera.y = -height;\n          dy = -1;\n        } else if (animation === \"pushDown\") {\n          newScene.camera.y = height;\n          dy = 1;\n        }\n\n        animate = () => {\n          const tween = this.tweenPercent(\n            duration,\n            (factor) => {\n              newScene.camera.x = dx * (factor - 1) * width;\n              oldScene.camera.x = dx * factor * width;\n              newScene.camera.y = dy * (factor - 1) * height;\n              oldScene.camera.y = dy * factor * height;\n\n              if (factor >= 0.5) {\n                cutoverPrimary();\n              }\n\n              if (onUpdate) {\n                onUpdate(factor, oldScene, newScene, transition);\n              }\n            },\n            () => {\n              newScene.camera.x = 0;\n              newScene.camera.y = 0;\n              completeTransition();\n            },\n            0,\n            ease\n          );\n          tween.ignoresScenePause = true;\n        };\n      } else if (\n        animation === \"wipeRight\" ||\n        animation === \"wipeLeft\" ||\n        animation === \"wipeUp\" ||\n        animation === \"wipeDown\"\n      ) {\n        const { height, width } = this.game.config;\n\n        swapScenes = false;\n\n        let newCamera;\n        let oldCamera;\n\n        // we cannot wipe with the builtin camera\n        if (animation === \"wipeRight\" || animation === \"wipeDown\") {\n          newScene.camera.alpha = 0;\n\n          newCamera = newScene.cameras.add(0, 0, width, height);\n          const color = newScene.cameraColor();\n          if (color !== null) {\n            newCamera.setBackgroundColor(color);\n          }\n          newCamera.scrollX = newScene.camera.scrollX;\n          newCamera.scrollY = newScene.camera.scrollY;\n\n          if (animation === \"wipeRight\") {\n            newCamera.width = 1;\n          } else {\n            newCamera.height = 1;\n          }\n        } else {\n          oldScene.game.scene.bringToTop(oldScene.scene.key);\n          oldScene.camera.alpha = 0;\n\n          oldCamera = oldScene.cameras.add(0, 0, width, height);\n          const color = oldScene.cameraColor();\n          if (color !== null) {\n            oldCamera.setBackgroundColor(color);\n          }\n          oldCamera.scrollX = oldScene.camera.scrollX;\n          oldCamera.scrollY = oldScene.camera.scrollY;\n\n          if (oldScene.shader) {\n            oldCamera.setRenderToTexture(oldScene.shader);\n          }\n        }\n\n        let firstCall = true;\n\n        animate = () => {\n          const tween = this.tweenPercent(\n            duration,\n            (factor) => {\n              if (newCamera && firstCall) {\n                if (newScene.shader) {\n                  newCamera.setRenderToTexture(newScene.shader);\n                }\n                firstCall = false;\n              }\n\n              if (animation === \"wipeRight\") {\n                newCamera.setSize(Math.max(1, factor * width), height);\n              } else if (animation === \"wipeLeft\") {\n                oldCamera.setSize(Math.max(1, (1 - factor) * width), height);\n              } else if (animation === \"wipeUp\") {\n                oldCamera.setSize(width, Math.max(1, (1 - factor) * height));\n              } else if (animation === \"wipeDown\") {\n                newCamera.setSize(width, Math.max(1, factor * height));\n              }\n\n              if (factor >= 0.5) {\n                cutoverPrimary();\n              }\n\n              if (onUpdate) {\n                onUpdate(factor, oldScene, newScene, transition);\n              }\n            },\n            () => {\n              if (newCamera) {\n                newScene.cameras.main.alpha = 1;\n                newScene.camera.scrollX = newCamera.scrollX;\n                newScene.camera.scrollY = newCamera.scrollY;\n                newScene.cameras.remove(newCamera);\n              }\n\n              if (!transition.suppressShaderCheck) {\n                if (\n                  !transition.delayNewSceneShader &&\n                  newScene.shader &&\n                  newCamera\n                ) {\n                  // eslint-disable-next-line no-console, max-len\n                  console.error(\n                    `${animation} transitions do not render correctly if the new scene has a shader; provide delayNewSceneShader or suppressShaderCheck to the transition, or use a different animation`\n                  );\n                }\n                if (oldScene.shader && oldCamera) {\n                  // eslint-disable-next-line no-console, max-len\n                  console.error(\n                    `${animation} transitions do not render correctly if the old scene has a shader; provide removeOldSceneShader or suppressShaderCheck to the transition, or use a different animation`\n                  );\n                }\n              }\n\n              completeTransition();\n            },\n            0,\n            ease\n          );\n          tween.ignoresScenePause = true;\n        };\n      } else {\n        // eslint-disable-next-line no-console\n        console.error(`Invalid transition animation '${animation}'`);\n        cutoverPrimary();\n        completeTransition();\n        return;\n      }\n\n      if (swapScenes) {\n        oldScene.game.scene.bringToTop(oldScene.scene.key);\n      }\n\n      if (oldPauseTime === \"begin\") {\n        applyPause(oldScene, transition, transition.oldPause);\n      }\n\n      if (newUnpauseTime !== \"begin\") {\n        newUnpauseFn = applyPause(newScene, transition, transition.newPause);\n      }\n\n      const oldAnimate = animate;\n      animate = () => {\n        if (transition && transition.onDelayEnd) {\n          transition.onDelayEnd(oldScene, newScene, transition);\n        }\n\n        if (oldPauseTime === \"delayEnd\") {\n          applyPause(oldScene, transition, transition.oldPause);\n        }\n\n        if (newUnpauseTime === \"delayEnd\") {\n          newUnpauseFn();\n        }\n\n        oldAnimate();\n      };\n\n      if (transition.delay) {\n        const delayTimer = this.timer(animate, transition.delay);\n        delayTimer.ignoresScenePause = true;\n      } else {\n        animate();\n      }\n    } else {\n      cutoverPrimary();\n      completeTransition();\n    }\n  }\n\n  preemitEmitter(emitter) {\n    const maxLifespan = emitter.lifespan.staticValueEmit();\n    const quantity = emitter.quantity.staticValueEmit();\n    const { frequency } = emitter;\n    for (let i = maxLifespan; i > 0; i -= frequency) {\n      for (let j = 0; j < quantity; j += 1) {\n        const particle = emitter.emitParticle(1);\n        particle.update(i, i / 1000, []);\n      }\n    }\n  }\n\n  sleep(duration, ignoreTimeScale = false) {\n    this.pauseEverythingForSleep(duration);\n\n    const timer = this.timer(() => {\n      this.unpauseEverythingForSleep(duration);\n    }, duration);\n\n    timer.ignoresScenePause = true;\n    if (ignoreTimeScale) {\n      timer.ignoresTimeScale = true;\n    }\n  }\n\n  beginReplay(replay, replayOptions) {\n    const { command, game } = this;\n    const { loop } = game;\n\n    this._replay = replay;\n    this._replayOptions = replayOptions;\n    this._replayLatestTransition = replayOptions.startFromTransition;\n    const startTick =\n      replayOptions.startTick ||\n      (this._replayLatestTransition\n        ? this._replayLatestTransition.tickCount || 0\n        : 0);\n\n    command.beginReplay(replay, {\n      ...replayOptions,\n      startTick,\n      onEnd: () => {\n        this.game.topScene().endedReplay();\n      },\n      onStop: () => {\n        this.game.topScene().stopReplay(true);\n      },\n    });\n\n    let time = window.performance.now();\n    const dt = 1000 / this.physics.world.fps;\n\n    game._replayPreflight += 1;\n\n    const manager = this.command.getManager(this);\n\n    loop.sleep();\n    this.scene.setVisible(false);\n    while (command.hasPreflight()) {\n      if (replay.timeSightFrameCallback) {\n        replay.timeSightFrameCallback(\n          this,\n          time,\n          dt,\n          manager,\n          true,\n          false,\n          false\n        );\n      }\n\n      time += dt;\n      loop.step(time);\n\n      if (game._stepExceptions > 100) {\n        // eslint-disable-next-line no-console\n        console.error(\"Too many errors in preflight; bailing out\");\n        return;\n      }\n    }\n    loop.resetDelta();\n\n    game._replayPreflight -= 1;\n\n    // now that preflight is done, beware that if it had a scene transition,\n    // then `this` may have been removed from the scene graph and instead\n    // should use topScene\n    const topScene = game.topScene();\n\n    if (replay.timeSight) {\n      topScene.calculateTimeSight();\n    } else if (replay.timeSightFrameCallback) {\n      game._replayPreflight += 1;\n      topScene._timeSightTargetEnded = () => {\n        replay.timeSightFrameCallback(\n          topScene,\n          time,\n          dt,\n          manager,\n          false,\n          true,\n          true\n        );\n      };\n\n      let postflightCutoff;\n      if (\"postflightCutoff\" in replay) {\n        ({ postflightCutoff } = replay.postflightCutoff);\n        delete replay.postflightCutoff;\n      }\n\n      while (!topScene._timeSightTargetDone) {\n        const isPostflight =\n          postflightCutoff !== undefined &&\n          this.command.replayTicks >= postflightCutoff;\n        replay.timeSightFrameCallback(\n          topScene,\n          time,\n          dt,\n          manager,\n          false,\n          isPostflight,\n          false\n        );\n        time += dt;\n        loop.step(time);\n\n        if (game._stepExceptions > 100) {\n          // eslint-disable-next-line no-console\n          console.error(\"Too many errors in timeSight; bailing out\");\n          return;\n        }\n      }\n      topScene.scene.remove();\n      game._replayPreflight -= 1;\n    } else {\n      topScene.scene.setVisible(true);\n      loop.wake();\n    }\n  }\n\n  calculateTimeSight() {\n    // eslint-disable-next-line no-console\n    console.info(\"Calculating timeSight\");\n\n    this._timeSightFrames = [];\n\n    this.scene.setActive(false);\n    this.scene.setVisible(false);\n\n    this.launchTimeSight();\n\n    const target = `scene-${Math.random() * Date.now()}`;\n    const targetScene = this.game.scene.add(target, this.constructor, true, {\n      ...this.scene.settings.data,\n      _timeSightTarget: true,\n    });\n    this.game.scene.bringToTop(target);\n\n    let objectDt = 0;\n\n    targetScene.beginReplay(\n      {\n        ...this._replay,\n        timeSight: false,\n        startTick:\n          (this._replayLatestTransition\n            ? this._replayLatestTransition.tickCount\n            : 0) || 0,\n        timeSightFrameCallback: (\n          scene,\n          frameTime,\n          frameDt,\n          manager,\n          isPreflight,\n          isPostflight,\n          isLast\n        ) => {\n          objectDt += frameDt;\n\n          const frame = this.timeSightTargetStep(\n            scene,\n            objectDt,\n            frameTime,\n            frameDt,\n            manager,\n            isPreflight,\n            isPostflight,\n            isLast\n          );\n          if (frame) {\n            objectDt = 0;\n          }\n        },\n      },\n      {\n        onEnd: () => {\n          targetScene._timeSightTargetDone = true;\n\n          this.scene.setVisible(true);\n          this.scene.setActive(true);\n\n          this.game.loop.wake();\n\n          this.beginTimeSightAlphaAnimation();\n        },\n      }\n    );\n  }\n\n  timeSightTargetStep(\n    scene,\n    objectDt,\n    frameTime,\n    frameDt,\n    manager,\n    isPreflight,\n    isPostflight,\n    isLast\n  ) {\n    const objects = scene.renderTimeSightFrameInto(\n      this,\n      objectDt,\n      frameTime,\n      frameDt,\n      isLast\n    );\n    if (!objects || !objects.length) {\n      return;\n    }\n\n    updatePropsFromStep(true);\n\n    const frame = {\n      objects,\n      props: { ...manageableProps },\n      commands: [...manager.commands],\n      tickCount: manager.tickCount,\n      isPreflight,\n      isPostflight,\n    };\n\n    objects.forEach((object) => {\n      if (object.scene !== this) {\n        // eslint-disable-next-line no-console\n        console.error(\n          `renderTimeSightFrameInto rendered this object into the wrong scene: ${JSON.stringify(\n            object\n          )}`\n        );\n      }\n\n      object._timeSightAlpha = object.alpha;\n      object._timeSightFrame = frame;\n\n      if (isPreflight || isPostflight) {\n        object.alpha = 0;\n      }\n    });\n\n    this._timeSightFrames.push(frame);\n    return frame;\n  }\n\n  beginTimeSightAlphaAnimation() {\n    const frames = this._timeSightFrames;\n    const activeFrames = frames.filter(\n      (frame) => !frame.isPreflight && !frame.isPostflight\n    );\n\n    if (!activeFrames.length) {\n      return;\n    }\n\n    overrideProps(activeFrames[0].props);\n\n    if (this.game.updateReplayCursor) {\n      this.game.updateReplayCursor();\n    }\n\n    let loopAlpha;\n    // eslint-disable-next-line prefer-const\n    loopAlpha = (frame, n) => {\n      const { objects, props } = frame;\n\n      overrideProps(props);\n\n      objects.forEach((object, i) => {\n        object._timeSightAlphaTween = this.tweens.add({\n          targets: object,\n          alpha: 0.7,\n          duration: 200,\n          onComplete: () => {\n            object._timeSightAlphaTween = this.tweens.add({\n              targets: object,\n              alpha: object._timeSightAlpha,\n              duration: 200,\n              onComplete: () => {\n                if (i === 0) {\n                  frame.timer = this.time.addEvent({\n                    delay: 100 * activeFrames.length + 1000,\n                    callback: () => loopAlpha(frame, n),\n                  });\n                }\n              },\n            });\n          },\n        });\n      });\n    };\n\n    activeFrames.forEach((frame, n) => {\n      frame.timer = this.time.addEvent({\n        delay: 100 * n + 1000,\n        callback: () => {\n          loopAlpha(frame, n);\n        },\n      });\n    });\n\n    if (this._timeSightMouseInput) {\n      activeFrames.forEach((frame) => {\n        frame.objects.forEach((object) => {\n          object.alpha = object._timeSightAlpha;\n        });\n      });\n\n      return;\n    }\n\n    this._timeSightMouseInput = true;\n\n    this.input.topOnly = true;\n\n    activeFrames.forEach((frame) => {\n      frame.objects.forEach((object) => {\n        object.setInteractive();\n      });\n    });\n\n    this.input.on(\"gameobjectover\", (pointer, activeObject) => {\n      if (this._timeSightRemoveFocusTimer) {\n        this._timeSightRemoveFocusTimer.destroy();\n      }\n\n      this.game.canvas.style.cursor = \"pointer\";\n\n      let matchedFrame;\n      activeFrames.forEach((frame) => {\n        if (frame.timer) {\n          frame.timer.destroy();\n        }\n\n        frame.objects.forEach((object) => {\n          if (object._timeSightAlphaTween) {\n            object._timeSightAlphaTween.stop();\n          }\n\n          object.alpha = object._timeSightAlpha;\n\n          if (object === activeObject) {\n            matchedFrame = frame;\n            object.alpha = 1;\n          }\n        });\n      });\n\n      if (matchedFrame) {\n        overrideProps(matchedFrame.props);\n\n        if (this.game.updateReplayCursor) {\n          this.game.updateReplayCursor(matchedFrame.tickCount, this._replay);\n        }\n      }\n    });\n\n    this.input.on(\"gameobjectout\", (pointer, activeObject) => {\n      if (this._timeSightRemoveFocusTimer) {\n        this._timeSightRemoveFocusTimer.destroy();\n      }\n\n      this._timeSightRemoveFocusTimer = this.time.addEvent({\n        delay: 100,\n        callback: () => {\n          this.game.canvas.style.cursor = \"\";\n          this.beginTimeSightAlphaAnimation();\n        },\n      });\n    });\n\n    this.input.on(\"gameobjectdown\", (pointer, activeObject) => {\n      if (this._timeSightRemoveFocusTimer) {\n        this._timeSightRemoveFocusTimer.destroy();\n      }\n\n      this.game.canvas.style.cursor = \"\";\n\n      const replay = this._replay;\n\n      const { commands } = activeObject._timeSightFrame;\n      const preflightCutoff = commands.reduce(\n        (cutoff, frame) => cutoff + (frame._repeat || 1),\n        0\n      );\n\n      this.game.stopReplay();\n      this.game.beginReplay(\n        {\n          ...replay,\n          ...(this._replayLatestTransition || {}),\n          timeSight: false,\n          snapshot: true,\n          commands,\n          preflightCutoff,\n        },\n        {\n          startFromTransition: this._replayLatestTransition,\n          startTick: -1, // TODO\n        }\n      );\n    });\n  }\n\n  endedReplay() {\n    if (!this._replay) {\n      return;\n    }\n\n    const { onEnd } = this._replayOptions;\n    const replay = this._replay;\n\n    delete this._replay;\n    delete this._replayOptions;\n\n    if (replay.timeSight) {\n      this.replaceWithSelf(false);\n      return;\n    }\n\n    if (this._timeSightTargetEnded) {\n      this._timeSightTargetEnded();\n    }\n\n    if (onEnd) {\n      onEnd();\n    }\n  }\n\n  stopReplay(skipDownward) {\n    if (!this._replay) {\n      return;\n    }\n\n    const { onStop } = this._replayOptions;\n    const replay = this._replay;\n\n    delete this._replay;\n    delete this._replayOptions;\n\n    if (replay.timeSight) {\n      this.replaceWithSelf(false);\n      return;\n    }\n\n    if (!skipDownward) {\n      this.command.stopReplay();\n    }\n\n    if (onStop) {\n      onStop();\n    }\n  }\n\n  launchTimeSight() {\n    this.timeSightFrozen = true;\n\n    [...this.tweens._active, ...this.tweens._add].forEach(\n      (tween) => tween._skipFreezeTimeSight || tween.stop()\n    );\n    this.add.displayList.list\n      .filter((node) => node.type === \"Sprite\")\n      .map((node) => node._skipFreezeTimeSight || node.anims.stop());\n\n    // this intentionally uses the base Phaser timer so existing particles get\n    // paused after only a frame of rendering, but any particles that\n    // renderTimeSightFrameInto creates are unaffected\n    const particles = this.add.displayList.list.filter(\n      (node) => node.type === \"ParticleEmitterManager\"\n    );\n    this.time.addEvent({\n      callback: () => {\n        particles.forEach((node) => {\n          if (!node._skipFreezeTimeSight) {\n            node.pause();\n          }\n        });\n      },\n    });\n  }\n\n  cutoffTimeSightEnter() {\n    const frames = this._timeSightFrames;\n\n    if (!frames) {\n      return;\n    }\n\n    if (this._timeSightRemoveFocusTimer) {\n      this._timeSightRemoveFocusTimer.destroy();\n    }\n\n    frames.forEach((frame) => {\n      if (frame.timer) {\n        frame.timer.destroy();\n      }\n\n      frame.objects.forEach((object) => {\n        if (object._timeSightAlphaTween) {\n          object._timeSightAlphaTween.stop();\n        }\n\n        object.alpha = object._timeSightAlpha;\n      });\n    });\n\n    this.cutoffTimeSightChanged(\n      this._replay.preflightCutoff,\n      this._replay.postflightCutoff\n    );\n  }\n\n  cutoffTimeSightChanged(start, end) {\n    const frames = this._timeSightFrames;\n    if (!frames) {\n      return;\n    }\n\n    // ordinarily to be avoided, but we don't want to start a new replay\n    // to take the update from Replay.jsx\n    this._replay.preflightCutoff = start;\n    this._replay.postflightCutoff = end;\n\n    frames.forEach((frame, f) => {\n      const tick =\n        frame.tickCount +\n        ((this._replayLatestTransition\n          ? this._replayLatestTransition.tickCount\n          : 0) || 0);\n      frame.isPreflight = tick < start;\n      frame.isPostflight = tick > end;\n\n      frame.objects.forEach((object) => {\n        object.alpha =\n          frame.isPreflight || frame.isPostflight ? object._timeSightAlpha : 1;\n      });\n    });\n  }\n\n  cutoffTimeSightLeave() {\n    const frames = this._timeSightFrames;\n    if (!frames) {\n      return;\n    }\n\n    frames.forEach((frame) => {\n      frame.objects.forEach((object) => {\n        object.alpha =\n          frame.isPreflight || frame.isPostflight ? 0 : object._timeSightAlpha;\n      });\n    });\n\n    this.beginTimeSightAlphaAnimation();\n  }\n\n  propDidChange(key, value) {\n    this.replayParticleSystems(key);\n  }\n\n  propDidFinishChange(key, value) {\n    if (this._replay && this._replay.timeSight) {\n      const replay = this._replay;\n      this.game.stopReplay();\n      this.game.beginReplay(replay, {\n        startFromTransition: this._replayLatestTransition,\n      });\n    }\n  }\n\n  beginRecording(recording) {\n    this._recording = recording;\n    recording.sceneSaveState = JSON.parse(JSON.stringify(this._initialSave));\n    recording.sceneTransitions = [];\n    recording.sceneId = this.sceneId;\n\n    this.command.beginRecording(this, recording);\n  }\n\n  stopRecording() {\n    const recording = this._recording;\n    delete this._recording;\n    this.command.stopRecording();\n    return recording;\n  }\n\n  replayParticleSystems(changedKey) {\n    const { particleSystems } = this;\n    this.particleSystems = [];\n\n    particleSystems.forEach((config) => {\n      const { particles, emitter, name, options } = config;\n\n      if (!particles.active || particles.moribund) {\n        return;\n      }\n\n      // keep other systems as-is\n      if (changedKey && !changedKey.startsWith(name)) {\n        this.particleSystems.push(config);\n        return;\n      }\n\n      const { seed } = emitter;\n      emitter.killAll();\n      emitter.stop();\n      particles.destroy();\n\n      this.particleSystem(name, options, seed);\n    });\n  }\n\n  _builtinHot() {\n    // eslint-disable-next-line no-console\n    console.info(`Hot-loading ${this.constructor.name}`);\n\n    if (this.game._stepExceptions > 100) {\n      // eslint-disable-next-line no-console\n      console.info(\"Resetting after recovering from errors\");\n      this.game._stepExceptions = 0;\n      return;\n    }\n\n    if (this._replay && this._replay.timeSight) {\n      const replay = this._replay;\n      this.game.stopReplay();\n      this.game.beginReplay(replay, {\n        startFromTransition: this._replayLatestTransition,\n      });\n    } else {\n      this.replayParticleSystems();\n    }\n\n    if (this.setupAnimations) {\n      this.reloadAnimations();\n    } else {\n      this.removeAnimations();\n    }\n\n    this.game.recompileShaders();\n\n    this.playMusic();\n  }\n\n  _hotReloadCurrentLevel(...args) {\n    return this.replaceWithSelf(false, ...args);\n  }\n\n  removeAnimations() {\n    if (\n      this.physics &&\n      this.physics.world &&\n      this.physics.world.bodies &&\n      this.physics.world.bodies.entries\n    ) {\n      this.physics.world.bodies.entries.forEach((body) => {\n        if (body.gameObject && body.gameObject.anims) {\n          body.gameObject.anims.pause();\n          body.gameObject.anims.stop();\n          body.gameObject.anims.remove();\n        }\n      });\n    }\n\n    Object.keys(this.anims.anims.entries).forEach((key) => {\n      this.anims.remove(key);\n    });\n  }\n\n  reloadAnimations() {\n    Object.keys(this.anims.anims.entries).forEach((key) => {\n      this.anims.remove(key);\n    });\n\n    this.setupAnimations();\n\n    if (\n      this.physics &&\n      this.physics.world &&\n      this.physics.world.bodies &&\n      this.physics.world.bodies.entries\n    ) {\n      this.physics.world.bodies.entries.forEach((body) => {\n        if (\n          body.gameObject &&\n          body.gameObject.anims &&\n          body.gameObject.anims.currentAnim\n        ) {\n          const { key } = body.gameObject.anims.currentAnim;\n          body.gameObject.anims.stop();\n          body.gameObject.anims.currentAnim = null;\n          this.timer(() =>\n            body.gameObject.anims.play(key)\n          ).ignoresScenePause = true;\n        }\n      });\n    }\n  }\n\n  particleSystem(name, options = {}, reloadSeed) {\n    // throws error if invalid\n    prop(`${name}.image`);\n\n    const props = {\n      ...propsWithPrefix(`${name}.`),\n      ...options,\n    };\n\n    const { onAdd, image } = props;\n\n    const particles = this.add.particles(image);\n\n    const emitterProps = massageParticleProps(props);\n    const emitter = particles.createEmitter(emitterProps);\n\n    injectEmitterOpSeededRandom(\n      emitter,\n      reloadSeed || this.randFloat(\"particles\")\n    );\n\n    if (onAdd) {\n      onAdd(particles, emitter);\n    }\n\n    if (props.preemit || (reloadSeed && props.preemitOnReload)) {\n      this.preemitEmitter(emitter);\n    }\n\n    emitter.ignoresScenePause = emitterProps.ignoresScenePause;\n    emitter.updatesOnceOnPause = emitterProps.updatesOnceOnPause;\n\n    this.particleSystems.push({\n      particles,\n      emitter,\n      name,\n      options,\n    });\n  }\n\n  tween(name, target, options = {}) {\n    if (name !== null) {\n      // throws error if invalid\n      prop(`${name}.duration`);\n    }\n\n    const props =\n      name === null\n        ? { ...options }\n        : {\n            ...propsWithPrefix(`${name}.`),\n            ...options,\n          };\n\n    const params = massageTweenProps(target, props, options);\n\n    return this.tweens.add(params);\n  }\n\n  _transitionProps(input) {\n    if (!input) {\n      return input;\n    }\n\n    const prefix = typeof input === \"object\" ? input.name : input;\n    const options = typeof input === \"object\" ? input : {};\n\n    let props;\n\n    if (prefix) {\n      // throws error if invalid\n      prop(`${prefix}.animation`);\n\n      props = {\n        ...propsWithPrefix(`${prefix}.`),\n        ...options,\n      };\n    } else {\n      props = {\n        ...baseTransitionProps,\n        ...options,\n      };\n    }\n\n    return massageTransitionProps(props, options);\n  }\n\n  tweenPercent(duration, update, onComplete, startPoint = 0, ease = \"Linear\") {\n    const tween = this.tweens.addCounter({\n      from: startPoint,\n      to: 100,\n      ease,\n      duration,\n      onUpdate: () => {\n        const factor = tween.getValue() / 100.0;\n        update(factor);\n      },\n      onComplete,\n    });\n\n    return tween;\n  }\n\n  tweenPercentExclusive(\n    fieldName,\n    duration,\n    update,\n    onComplete,\n    ease = \"Linear\"\n  ) {\n    let startPoint = 0;\n    if (this[fieldName]) {\n      startPoint = this[fieldName].getValue();\n      this[fieldName].stop();\n    }\n\n    this[fieldName] = this.tweenPercent(\n      duration * (1 - startPoint / 100.0),\n      update,\n      (...args) => {\n        if (onComplete) {\n          onComplete(...args);\n        }\n        delete this[fieldName];\n      },\n      startPoint,\n      ease\n    );\n\n    return this[fieldName];\n  }\n\n  tweenInOut(\n    inDuration,\n    outDuration,\n    update,\n    onMidpoint,\n    onComplete,\n    startPoint = 0,\n    inEase = \"Linear\",\n    outEase = inEase\n  ) {\n    let tween;\n\n    tween = this.tweens.addCounter({\n      from: startPoint,\n      to: 100,\n      ease: inEase,\n      duration: inDuration,\n      onUpdate: () => {\n        const factor = tween.getValue() / 100.0;\n        update(factor, true);\n      },\n      onComplete: () => {\n        tween = this.tweens.addCounter({\n          from: 100,\n          to: 0,\n          ease: outEase,\n          duration: outDuration,\n          onUpdate: () => {\n            const factor = tween.getValue() / 100.0;\n            update(factor, false);\n          },\n          onComplete,\n        });\n\n        if (onMidpoint) {\n          onMidpoint(tween);\n        }\n      },\n    });\n\n    return tween;\n  }\n\n  tweenInOutExclusive(\n    fieldName,\n    inDuration,\n    outDuration,\n    update,\n    onMidpoint,\n    onComplete,\n    inEase = \"Linear\",\n    outEase = inEase\n  ) {\n    let startPoint = 0;\n    if (this[fieldName]) {\n      startPoint = this[fieldName].getValue();\n      this[fieldName].stop();\n    }\n\n    this[fieldName] = this.tweenInOut(\n      inDuration * (1 - startPoint / 100.0),\n      outDuration,\n      update,\n      (tween, ...args) => {\n        if (onMidpoint) {\n          onMidpoint(tween, ...args);\n        }\n\n        this[fieldName] = tween;\n      },\n      (...args) => {\n        if (onComplete) {\n          onComplete(...args);\n        }\n        delete this[fieldName];\n      },\n      startPoint,\n      inEase,\n      outEase\n    );\n\n    return this[fieldName];\n  }\n\n  tweenSustain(\n    inDuration,\n    sustainDuration,\n    outDuration,\n    update,\n    onSustain,\n    onOut,\n    onComplete,\n    startPoint = 0,\n    inEase = \"Linear\",\n    outEase = inEase\n  ) {\n    let tween;\n\n    tween = this.tweens.addCounter({\n      from: startPoint,\n      to: 100,\n      ease: inEase,\n      duration: inDuration,\n      onUpdate: () => {\n        const factor = tween.getValue() / 100.0;\n        update(factor, \"in\");\n      },\n      onComplete: () => {\n        tween = this.tweens.addCounter({\n          from: 0,\n          to: 100,\n          duration: sustainDuration,\n          onUpdate: () => {\n            const factor = tween.getValue() / 100.0;\n            update(1, \"sustain\", factor);\n          },\n          onComplete: () => {\n            tween = this.tweens.addCounter({\n              from: 100,\n              to: 0,\n              ease: outEase,\n              duration: outDuration,\n              onUpdate: () => {\n                const factor = tween.getValue() / 100.0;\n                update(factor, \"out\");\n              },\n              onComplete,\n            });\n\n            if (onOut) {\n              onOut(tween);\n            }\n          },\n        });\n\n        if (onSustain) {\n          onSustain(tween);\n        }\n      },\n    });\n\n    return tween;\n  }\n\n  tweenSustainExclusive(\n    fieldName,\n    inDuration,\n    sustainDuration,\n    outDuration,\n    update,\n    onSustain,\n    onOut,\n    onComplete,\n    inEase = \"Linear\",\n    outEase = inEase\n  ) {\n    let startPoint = 0;\n    if (this[fieldName]) {\n      startPoint = this[fieldName].getValue();\n      this[fieldName].stop();\n    }\n\n    this[fieldName] = this.tweenSustain(\n      inDuration * (1 - startPoint / 100.0),\n      sustainDuration,\n      outDuration,\n      update,\n      (tween, ...args) => {\n        if (onSustain) {\n          onSustain(tween, ...args);\n        }\n\n        this[fieldName] = tween;\n      },\n      (tween, ...args) => {\n        if (onOut) {\n          onOut(tween, ...args);\n        }\n\n        this[fieldName] = tween;\n      },\n      (...args) => {\n        if (onComplete) {\n          onComplete(...args);\n        }\n        delete this[fieldName];\n      },\n      startPoint,\n      inEase,\n      outEase\n    );\n\n    return this[fieldName];\n  }\n\n  trauma(amount) {\n    if ((this.minTrauma || amount) && !this._trauma) {\n      this._traumaStart = this.time.now;\n    }\n\n    let newTrauma = Math.min(Math.max((this._trauma || 0) + amount, 0), 1);\n    if (this.minTrauma) {\n      newTrauma = Math.max(this.minTrauma, newTrauma);\n    }\n    const shake = newTrauma ** prop(\"scene.trauma.exponent\");\n    this._trauma = newTrauma;\n    this._traumaShake = shake;\n\n    if (shake && prop(\"scene.trauma.legacy\") && prop(\"scene.trauma.enabled\")) {\n      const { width, height } = this.game.config;\n      const duration = 100;\n      const intensity = new Phaser.Math.Vector2(\n        (shake * prop(\"scene.trauma.dx\")) / width,\n        (shake * prop(\"scene.trauma.dy\")) / height\n      );\n      this.camera.shake(duration, intensity);\n    }\n  }\n\n  playSound(baseName, variants, volume = 1.0) {\n    // preflight etc\n    if (!this.scene.isVisible() || this.game._replayPreflight) {\n      return;\n    }\n\n    let name = baseName;\n    if (variants) {\n      name += 1 + Math.floor(this.randBetween(`sound/${name}`, 0, variants));\n    }\n\n    const sound = this.sound.add(name);\n\n    if (!sound || !sound.key) {\n      // eslint-disable-next-line no-console\n      console.warn(`Could not load sound ${name}`);\n      return;\n    }\n\n    this.sounds.push(sound);\n\n    sound.on(\"complete\", () => {\n      this.sounds = this.sounds.filter((s) => s !== sound);\n    });\n\n    try {\n      sound.requestedVolume = volume;\n      sound.setVolume(volume * this.game.volume * prop(\"scene.soundVolume\"));\n      sound.timeScale = 1;\n      sound.play();\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.warn(`Could not play sound ${name}: ${e}`);\n    }\n  }\n\n  changeVolume(newVolume) {\n    const { sounds } = this;\n\n    const multiplier = newVolume * prop(\"scene.soundVolume\");\n\n    sounds.forEach((sound) =>\n      sound.setVolume(sound.requestedVolume * multiplier)\n    );\n  }\n\n  playMusic(name = this.musicName(), forceRestart = false) {\n    this.game.playMusic(name, forceRestart);\n  }\n\n  playMusicIfSet(name = this.musicName(), forceRestart = false) {\n    if (name) {\n      return this.playMusic(name, forceRestart);\n    }\n  }\n\n  musicName() {\n    return null;\n  }\n\n  timer(callback, time) {\n    const timer = { callback, time };\n    this.timers.push(timer);\n    return timer;\n  }\n\n  updateTimers(time, dt) {\n    const { timers } = this;\n    const newTimers = (this.timers = []);\n    const isPaused = this._paused.timers;\n\n    if (!isPaused && this._trauma) {\n      this.trauma(prop(\"scene.trauma.decay\") * dt * -1);\n    }\n\n    timers.forEach((timer) => {\n      if (isPaused && !timer.ignoresScenePause) {\n        newTimers.push(timer);\n        return;\n      }\n\n      if (timer.time) {\n        if (timer.ignoresTimeScale) {\n          timer.time -= dt * this.timeScale;\n        } else {\n          timer.time -= dt;\n        }\n        if (timer.time > 0) {\n          newTimers.push(timer);\n          return;\n        }\n      }\n\n      timer.callback();\n    });\n  }\n\n  updateTweens(time, origDt) {\n    const { tweens } = this.scene.systems;\n    const isPaused = this._paused.tweens;\n\n    // taken from Phaser TweenManager.update\n    const dt = origDt / tweens.timeScale;\n\n    tweens._active.forEach((tween) => {\n      if (isPaused && !tween.ignoresScenePause) {\n        return;\n      }\n\n      if (tween.update(time, dt)) {\n        tweens._destroy.push(tween);\n        tweens._toProcess += 1;\n      }\n    });\n  }\n\n  recoverPerformance() {\n    this.performanceFrames += 1;\n\n    if (!this.performanceAcceptable) {\n      this.performanceAcceptable = this.game.loop.actualFps > 50;\n    }\n\n    if (this.performanceFrames < 200) {\n      return;\n    }\n\n    this.performanceFrames = 0;\n\n    if (this.performanceAcceptable) {\n      this.performanceAcceptable = false;\n      return;\n    }\n\n    if (this.performanceProps.length) {\n      let changes = this.performanceProps.shift();\n      if (!Array.isArray(changes)) {\n        changes = [changes];\n      }\n\n      const applyPropChanges = (props) => {\n        if (props.length) {\n          if (this.game.debug) {\n            refreshUI();\n          }\n\n          props.forEach((propName) => {\n            const particleProp = particlePropFromProp(propName);\n            if (particleProp) {\n              propsWithPrefix(`${particleProp}.`, true);\n\n              this.replayParticleSystems(particleProp);\n            }\n          });\n        }\n      };\n\n      let batch = true;\n      const changedProps = [];\n      const setProp = (key, value) => {\n        changedProps.push(key);\n        const spec = propSpecs[key];\n\n        if (this.game.debug) {\n          manageableProps[key] = value;\n        } else {\n          propSpecs[key][0] = value;\n        }\n\n        if (spec.length > 1 && spec[1] !== null) {\n          if (typeof spec[spec.length - 1] === \"function\") {\n            const changeCallback = spec[spec.length - 1];\n            changeCallback(value, this, this.game);\n          }\n        }\n\n        if (!batch) {\n          applyPropChanges([key]);\n        }\n      };\n\n      changes.forEach((change) => {\n        if (typeof change === \"string\") {\n          if (change === \"disableShaders\") {\n            this.game.disableShaders();\n          } else {\n            setProp(change, !prop(change));\n          }\n        } else if (typeof change === \"function\") {\n          change(setProp);\n        }\n      });\n\n      batch = false;\n\n      // eslint-disable-next-line no-console\n      console.log(`Performance seems iffy; applying ${changes.join(\", \")}`);\n\n      applyPropChanges(changedProps);\n    }\n  }\n\n  handlePointerEvent(event) {\n    const camelName = event.name.charAt(0).toUpperCase() + event.name.slice(1);\n    const method = `handle${camelName}`;\n    if (this[method]) {\n      this[method](event);\n    } else if (prop(\"config.debug\")) {\n      const debugMethod = `debugHandle${camelName}`;\n      if (this[debugMethod]) {\n        this[debugMethod](event);\n      }\n    }\n  }\n\n  cameraFollow(object, offsetX = 0, offsetY = 0) {\n    if (object) {\n      const lerp = prop(\"scene.camera.lerp\");\n      // true is roundPixels to avoid subpixel rendering\n      this.camera.startFollow(object, true, lerp, lerp, offsetX, offsetY);\n    } else {\n      this.camera.stopFollow();\n    }\n  }\n\n  get timeScale() {\n    return this._timeScale;\n  }\n\n  set timeScale(scale) {\n    this._timeScale = scale;\n\n    if (this.physics) {\n      this.physics.world.timeScale = scale;\n      this.physics.world.bodies.entries.forEach((body) => {\n        if (body.gameObject && body.gameObject.anims) {\n          body.gameObject.anims.setTimeScale(scale);\n        }\n      });\n    }\n\n    // None of these are necessary thanks to us rewiring the event loop:\n    /*\n    this.tweens.timeScale = scale;\n    this.time.timeScale = scale;\n    this.anims.globalTimeScale = scale;\n    if (this.particleSystems) {\n      this.particleSystems.forEach((p) => {\n        p.particles.timeScale = scale;\n      });\n    }\n\n    */\n  }\n\n  shockwave(x, y) {\n    this.shockwave_time = this.scene_time;\n    this.shockwave_center = [\n      x / this.game.config.width,\n      y / this.game.config.height,\n    ];\n  }\n\n  positionToScreenCoordinate(x, y) {\n    const { xBorder, yBorder, tileWidth, tileHeight } = this;\n    return [x * tileWidth + xBorder, y * tileHeight + yBorder];\n  }\n\n  positionToScreenCoordinateHalf(x, y) {\n    const {\n      xBorder,\n      yBorder,\n      tileWidth,\n      tileHeight,\n      halfWidth,\n      halfHeight,\n    } = this;\n    return [\n      x * tileWidth + xBorder + halfWidth,\n      y * tileHeight + yBorder + halfHeight,\n    ];\n  }\n\n  timeSightMouseDrag() {\n    const { activePointer } = this.game.input;\n    if (activePointer.isDown) {\n      this.cameraFollow();\n\n      if (this._timeSightMouseDragX) {\n        this.camera.scrollX +=\n          this._timeSightMouseDragX - activePointer.position.x;\n      }\n\n      if (this._timeSightMouseDragY) {\n        this.camera.scrollY +=\n          this._timeSightMouseDragY - activePointer.position.y;\n      }\n\n      this._timeSightMouseDragX = activePointer.position.x;\n      this._timeSightMouseDragY = activePointer.position.y;\n    } else {\n      delete this._timeSightMouseDragX;\n      delete this._timeSightMouseDragY;\n    }\n  }\n\n  willTransitionTo(newScene, transition) {}\n\n  willTransitionFrom(oldScene, transition) {}\n\n  didTransitionTo(newScene, transition) {}\n\n  didTransitionFrom(oldScene, transition) {\n    if (transition && transition.delayNewSceneShader) {\n      this._setupShader();\n    }\n\n    this.playMusic();\n  }\n\n  pauseInputForTransition(transition) {\n    this.command.ignoreAll(\"_transition\", true);\n  }\n\n  unpauseInputForTransition(transition) {\n    this.command.ignoreAll(\"_transition\", false);\n  }\n\n  pauseInputForSleep(duration) {\n    this.command.ignoreAll(\"_sleep\", true);\n  }\n\n  unpauseInputForSleep(duration) {\n    this.command.ignoreAll(\"_sleep\", false);\n  }\n\n  pausePhysicsForTransition(transition) {\n    this.pauseInputForTransition(transition);\n\n    this._paused.physics = true;\n\n    this.pauseAllAnimations();\n  }\n\n  pausePhysicsForSleep(duration) {\n    this.pauseInputForSleep(duration);\n\n    this._paused.physics = true;\n\n    this.pauseAllAnimations();\n  }\n\n  unpausePhysicsForTransition(transition) {\n    this.unpauseInputForTransition(transition);\n\n    this._paused.physics = false;\n\n    this.resumeAllAnimations();\n  }\n\n  unpausePhysicsForSleep(duration) {\n    this.unpauseInputForSleep(duration);\n\n    this._paused.physics = false;\n\n    this.resumeAllAnimations();\n  }\n\n  pauseEverythingForTransition(transition) {\n    this.pausePhysicsForTransition(transition);\n\n    this._paused.timers = true;\n    this.pauseAllParticleSystems();\n    this.pauseAllTweens();\n  }\n\n  unpauseEverythingForTransition(transition) {\n    this.unpausePhysicsForTransition(transition);\n\n    this._paused.timers = false;\n    this.resumeAllParticleSystems();\n    this.resumeAllTweens();\n  }\n\n  pauseEverythingForSleep(duration) {\n    this.pausePhysicsForSleep(duration);\n\n    this._paused.timers = true;\n    this.pauseAllParticleSystems();\n    this.pauseAllTweens();\n  }\n\n  unpauseEverythingForSleep(duration) {\n    this.unpausePhysicsForSleep(duration);\n\n    this._paused.timers = false;\n    this.resumeAllParticleSystems();\n    this.resumeAllTweens();\n  }\n\n  pauseAllParticleSystems() {\n    this._paused.particles = true;\n\n    if (this.particleSystems.length) {\n      injectParticleEmitterManagerPreUpdate(this.particleSystems[0].particles);\n    }\n  }\n\n  pauseAllTweens() {\n    this._paused.tweens = true;\n  }\n\n  pauseAllAnimations() {\n    this._paused.anims = true;\n\n    if (this._injectedAnimsUpdate) {\n      return;\n    }\n\n    if (\n      this.physics &&\n      this.physics.world &&\n      this.physics.world.bodies &&\n      this.physics.world.bodies.entries\n    ) {\n      this.physics.world.bodies.entries.forEach((body) => {\n        if (body.gameObject && body.gameObject.anims) {\n          if (injectAnimationUpdate(body.gameObject.anims)) {\n            this._injectedAnimsUpdate = true;\n          }\n        }\n      });\n    }\n  }\n\n  resumeAllParticleSystems() {\n    this._paused.particles = false;\n\n    this.particleSystems.forEach((p) => {\n      p.particles.resume();\n    });\n  }\n\n  resumeAllTweens() {\n    this._paused.tweens = false;\n  }\n\n  resumeAllAnimations() {\n    this._paused.anims = false;\n  }\n\n  destroy() {\n    this.command.detachScene(this);\n  }\n}\n\nif (module.hot) {\n  module.hot.accept(\"../assets/maps.txt\", () => {\n    try {\n      const next = require(\"../assets/maps.txt\");\n\n      fetch(next).then((res) => {\n        res.text().then((text) => {\n          try {\n            const { game } = window;\n\n            const previous = game._ldMapFiles;\n            const nextMaps = parseMaps(text);\n\n            if (!previous || !nextMaps) {\n              return;\n            }\n\n            game._ldMapFiles = nextMaps;\n\n            let reloadCurrent = true;\n\n            const scene = game.topScene();\n            const activeId = scene.level && scene.level.id;\n\n            const prevById = {};\n            previous.forEach((spec) => {\n              prevById[spec[1].id] = spec;\n            });\n            const nextById = {};\n            nextMaps.forEach((spec) => {\n              nextById[spec[1].id] = spec;\n            });\n\n            const changes = [];\n\n            const leftover = { ...prevById };\n\n            Object.entries(nextById).forEach(([id, nextSpec]) => {\n              if (!prevById[id]) {\n                if (id !== activeId) {\n                  changes.push(`+${id}`);\n                }\n              } else {\n                const previousSpec = prevById[id];\n                delete leftover[id];\n\n                if (!deepEqual(previousSpec, nextSpec)) {\n                  if (id !== activeId) {\n                    changes.push(`${id}`);\n                  }\n                }\n              }\n            });\n\n            changes.push(\n              ...Object.keys(leftover)\n                .filter((id) => id !== activeId)\n                .map((id) => `-${id}`)\n            );\n\n            if (\n              !deepEqual(\n                previous.map((spec) => spec[1].id),\n                nextMaps.map((spec) => spec[1].id)\n              )\n            ) {\n              changes.push(\"(order)\");\n            }\n\n            if (activeId) {\n              const p = prevById[activeId];\n              const n = nextById[activeId];\n\n              if (deepEqual(p, n)) {\n                reloadCurrent = false;\n              } else {\n                changes.unshift(`active level ${activeId}`);\n              }\n            }\n\n            // eslint-disable-next-line no-console\n            console.info(`Hot-loading levels: ${changes.join(\", \")}`);\n\n            if (!reloadCurrent) {\n              return;\n            }\n\n            if (scene._builtinHot) {\n              scene._builtinHot();\n            }\n            if (scene._hot) {\n              scene._hot();\n            }\n\n            scene._hotReloadCurrentLevel();\n          } catch (e) {\n            // eslint-disable-next-line no-console\n            console.error(e);\n          }\n        });\n      });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n    }\n  });\n\n  module.hot.accept(\"../assets/index\", () => {\n    try {\n      const next = require(\"../assets/index\");\n      const { game } = window;\n\n      reloadAssets(game.topScene(), next).then(\n        ([changedAssets, changesByType]) => {\n          const scene = game.topScene();\n          let sawChanges = false;\n\n          Object.entries(changedAssets).forEach(([type, changed]) => {\n            if (changesByType[type] && changesByType[type].length) {\n              sawChanges = true;\n              // eslint-disable-next-line no-console\n              console.info(\n                `Hot-loading ${type}: ${changesByType[type].join(\", \")}`\n              );\n            }\n\n            if (type === \"musicAssets\") {\n              const { currentMusicName } = game;\n              if (changed[currentMusicName]) {\n                game.playMusic(currentMusicName, true);\n              }\n            } else if (type === \"imageAssets\" || type === \"spriteAssets\") {\n              Object.entries(changed).forEach(([key, texture]) => {\n                scene.add.displayList.list.forEach((object) => {\n                  if (object.texture && object.texture.key === key) {\n                    if (object.setTexture) {\n                      object.setTexture(key);\n                    } else {\n                      object.texture = texture;\n                    }\n                  }\n                });\n              });\n            }\n          });\n\n          if (!sawChanges) {\n            return;\n          }\n\n          if (scene._builtinHot) {\n            scene._builtinHot();\n          }\n          if (scene._hot) {\n            scene._hot();\n          }\n        }\n      );\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n    }\n  });\n}\n","import deepEqual from 'deep-equal';\nimport {tileDefinitions} from '../../props';\n\nlet tileSpecs;\nexport function updateTileDefinitions(newDefinitions) {\n  const previousTileSpecs = tileSpecs;\n  tileSpecs = preprocessTileDefinitions(newDefinitions);\n\n  if (!previousTileSpecs) {\n    return null;\n  }\n\n  const changes = [];\n\n  const leftoverKeys = {};\n  Object.keys(previousTileSpecs).forEach((key) => {\n    leftoverKeys[key] = true;\n  });\n\n  Object.keys(tileSpecs).forEach((key) => {\n    const oldValue = previousTileSpecs[key];\n    const newValue = tileSpecs[key];\n\n    if (key in previousTileSpecs) {\n      delete leftoverKeys[key];\n    }\n\n    if (!deepEqual(oldValue, newValue)) {\n      changes.push(key);\n    }\n  });\n\n  changes.push(...Object.keys(leftoverKeys));\n  return changes;\n}\n\nupdateTileDefinitions(tileDefinitions);\n\nexport function tileSpec(glyph) {\n  return tileSpecs[glyph];\n}\n\nfunction flattenInheritance(specs) {\n  Object.entries(specs).forEach(([key, config]) => {\n    if (!config || !config._inherit) {\n      return;\n    }\n\n    const seen = {[key]: true};\n    const nodes = [{...config}];\n\n    let parent = config._inherit;\n    if (!(parent in specs)) {\n      throw new Error(`Inherited from nonexistent parent: ${key}  ${parent}`);\n    }\n\n    while (specs[parent]) {\n      if (seen[parent]) {\n        throw new Error(`Loop detected in tileDefinitions _inherit: ${[...Object.keys(seen), key].join('  ')}`);\n      }\n\n      seen[parent] = true;\n      nodes.unshift(specs[parent]);\n      parent = specs[parent]._inherit;\n    }\n\n    Object.assign(config, ...nodes);\n  });\n\n  return specs;\n}\n\nexport function preprocessTileDefinitions(specs) {\n  return flattenInheritance(specs);\n}\n\nexport function parseMaps(content) {\n  const maps = [];\n\n  const allLines = content.split('\\n');\n  if (allLines.length === 0) {\n    return maps;\n  }\n\n  // simplify end checking\n  allLines.push('');\n\n  let mapLines = [];\n  let configLines = [];\n  let prevLineIsEmpty = true;\n  let parsingConfig = false;\n\n  allLines.forEach((line, i) => {\n    if (line === '') {\n      if (prevLineIsEmpty) {\n        return;\n      }\n      prevLineIsEmpty = true;\n\n      if (mapLines.length && configLines.length) {\n        const config = JSON.parse(configLines.join('\\n'));\n        if (!config.id) {\n          // eslint-disable-next-line no-console\n          console.warn(`Config line ${i}: level is missing an 'id'`);\n        }\n        maps.push([[...mapLines], config]);\n        mapLines = [];\n        configLines = [];\n        parsingConfig = false;\n      } else if (mapLines.length) {\n        parsingConfig = true;\n      }\n    } else {\n      prevLineIsEmpty = false;\n\n      if (parsingConfig) {\n        configLines.push(line);\n      } else {\n        mapLines.push(line);\n      }\n    }\n  });\n\n  return maps;\n}\n\nexport function parseLevelLines(lines, isRectangular) {\n  const lookups = {};\n  const map = [];\n  lines.forEach((line, y) => {\n    const row = [];\n    line.split('').forEach((glyph, x) => {\n      if (!(glyph in tileSpecs)) {\n        throw new Error(`Unknown glyph at (${x}, ${y}): ${glyph}`);\n      }\n\n      const tile = {\n        x,\n        y,\n        glyph,\n        ...tileSpecs[glyph],\n      };\n\n      row.push(tile);\n\n      if (!lookups[glyph]) {\n        lookups[glyph] = [];\n      }\n      lookups[glyph].push(tile);\n    });\n\n    map.push(row);\n  });\n\n  if (isRectangular) {\n    map.forEach((row, y) => {\n      if (y === map.length - 1) {\n        return;\n      }\n\n      if (row.length !== map[y + 1].length) {\n        throw new Error(`Inconsistent row width at ${y + 1}. Expected ${row.length}, got ${map[y + 1].length}`);\n      }\n    });\n  }\n\n  const mapText = lines.join('\\n');\n\n  return {map, mapText, lookups};\n}\n\nexport default function parseLevel(content, isRectangular) {\n  const allLines = content.split('\\n');\n\n  // trailing empty lines\n  while (allLines[allLines.length - 1].length === 0) {\n    allLines.pop();\n  }\n\n  // find last empty line\n  let i;\n  for (i = allLines.length - 1; i >= 0; i -= 1) {\n    if (allLines[i].length === 0) {\n      break;\n    }\n  }\n\n  if (i < 0) {\n    throw new Error('No empty line for parseLevel');\n  }\n\n  const {lookups, map} = parseLevelLines(allLines.slice(0, i), isRectangular);\n  const config = JSON.parse(allLines.slice(i).join('\\n'));\n\n  return {map, config, lookups};\n}\n\nif (module.hot) {\n  module.hot.accept('../../props', () => {\n    try {\n      const next = require('../../props');\n\n      const changes = updateTileDefinitions(next.tileDefinitions);\n      if (changes.length === 0) {\n        return;\n      }\n\n      // eslint-disable-next-line no-console\n      console.info(`Hot-loading tile definitions: ${changes}`);\n\n      const {game} = window;\n      const scene = game.topScene();\n      if (scene._builtinHot) {\n        scene._builtinHot();\n      }\n      if (scene._hot) {\n        scene._hot();\n      }\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n    }\n  });\n}\n","import {\n  builtinPropSpecs,\n  ManageableProps,\n  PropLoader,\n  makePropsWithPrefix,\n  preprocessPropSpecs,\n} from \"./scaffolding/lib/props\";\n\nconst particleImages = [\"dot\", \"smoke\"];\n\nexport const commands = {\n  jump: {\n    input: [\n      \"keyboard.UP\",\n      \"keyboard.Z\",\n      \"keyboard.Y\",\n      \"keyboard.W\",\n      \"keyboard.COLON\",\n      \"keyboard.SEMICOLON\",\n      \"keyboard.SPACE\",\n      \"gamepad.UP\",\n      \"gamepad.A\",\n      \"gamepad.B\",\n      \"gamepad.X\",\n      \"gamepad.Y\",\n    ],\n  },\n  down: {\n    input: [\"keyboard.DOWN\", \"gamepad.DOWN\", \"keyboard.S\"],\n  },\n  left: {\n    input: [\"keyboard.LEFT\", \"gamepad.LEFT\", \"keyboard.A\"],\n  },\n  right: {\n    input: [\"keyboard.RIGHT\", \"gamepad.RIGHT\", \"keyboard.D\"],\n  },\n  lstick: {\n    input: [\"gamepad.LSTICK.RAW\"],\n    joystick: true,\n  },\n  rstick: {\n    input: [\"gamepad.RSTICK.RAW\"],\n    joystick: true,\n  },\n\n  comet: {\n    input: [\"keyboard.M\"],\n    execute: \"comet\",\n    unignorable: true,\n  },\n  shadows: {\n    input: [\"keyboard.C\"],\n    execute: \"cleanShadows\",\n    unignorable: true,\n  },\n\n  restart: {\n    input: [\"keyboard.R\"],\n    execute: (scene) => scene.replaceWithSelf(),\n    debug: true,\n    unignorable: true,\n    unreplayable: true,\n  },\n  quit: {\n    input: [\"keyboard.Q\"],\n    execute: \"forceQuit\",\n    debug: true,\n    unignorable: true,\n    unreplayable: true,\n  },\n  recordCycle: {\n    input: [\"gamepad.R1\"],\n    unreplayable: true,\n    debug: true,\n    unignorable: true,\n    execute: (scene, game) => {\n      const { _replay, _recording } = game;\n      if (_replay && _replay.timeSight) {\n        game.stopReplay();\n      } else if (_replay) {\n        setTimeout(() => {\n          game.stopReplay();\n          game.beginReplay({ ..._replay, timeSight: true });\n        });\n      } else if (_recording) {\n        game.stopRecording();\n      } else {\n        game.beginRecording();\n      }\n    },\n  },\n  skip: {\n    input: [\"keyboard.N\"],\n    execute: \"skipLevel\",\n    unignorable: true,\n    unreplayable: true,\n  },\n  prev: {\n    input: [\"keyboard.P\"],\n    execute: \"prevLevel\",\n    unignorable: true,\n    unreplayable: true,\n  },\n  win: {\n    input: [\"keyboard.T\"],\n    execute: \"wonLevel\",\n    debug: true,\n    unignorable: true,\n    unreplayable: true,\n  },\n};\n\nexport const shaderCoordFragments = [\"shockwave\"];\nexport const shaderColorFragments = null;\nexport const shaderPipelines = {};\n\nexport const propSpecs = {\n  ...builtinPropSpecs(commands, shaderCoordFragments, shaderColorFragments),\n  \"command.ignore_all.spawn\": [\n    false,\n    null,\n    (scene) => scene.command.ignoreAll(\"spawn\"),\n  ],\n  \"command.ignore_all.dying\": [\n    false,\n    null,\n    (scene) => scene.command.ignoreAll(\"dying\"),\n  ],\n  \"command.ignore_all.winning\": [\n    false,\n    null,\n    (scene) => scene.command.ignoreAll(\"winning\"),\n  ],\n\n  \"player.speed\": [150, 1, 1000],\n  \"player.drag\": [0.3, 0, 1],\n  \"player.gravityBase\": [3000, 1, 10000],\n  \"player.baseJumpVelocity\": [300, 1, 1000],\n  \"player.touchingDown\": [false, null, \"level.player.body.touching.down\"],\n  \"player.isJumping\": [false, null, \"level.player.isJumping\"],\n  \"player.hasLiftedOff\": [false, null, \"level.player.hasLiftedOff\"],\n  \"player.hasReleasedJump\": [false, null, \"level.player.hasReleasedJump\"],\n  \"player.jumpStart\": [0, null, \"level.player.jumpStart\"],\n  \"player.maxJumpTime\": [200, 0, 10000],\n  \"player.maxJumpTrauma\": [0.5, 0, 1],\n  \"player.jumpTraumaDivisor\": [3000, 0, 10000],\n  \"player.invincible\": [false],\n\n  \"sun.downsamplesLeft\": [\n    0,\n    null,\n    (scene) => scene.downsamples && scene.downsamples.length,\n  ],\n  \"level.replaceDelay\": [2000, 0, 10000],\n  \"level.fadeOutFactor\": [10, 0, 100],\n  \"effects.firstCrumble.tween\": [\n    {\n      duration: 200,\n      ease: \"Cubic.easeInOut\",\n      scaleX: 1.05,\n      dy: 3,\n      scaleY: 0.95,\n      refreshPhysics: true,\n      yoyo: true,\n    },\n  ],\n  \"effects.crumble.tween\": [\n    {\n      duration: 800,\n      ease: \"Quad.easeOut\",\n      dy: 10,\n      refreshPhysics: true,\n      scaleX: 1.1,\n      scaleY: 0.9,\n      alpha: 0,\n    },\n  ],\n  \"effects.attract.tween\": [\n    {\n      duration: 1000,\n      ease: \"Cubic.easeInOut\",\n      dy: 16,\n      loop: 999,\n      yoyo: true,\n    },\n  ],\n  \"effects.goodNight.tween\": [\n    {\n      duration: 1000,\n      ease: \"Cubic.easeIn\",\n      dy: 100,\n      alpha: 0,\n    },\n  ],\n  \"effects.playerDie.tween\": [\n    {\n      duration: 200,\n      alpha: 0,\n    },\n  ],\n  \"effects.playerDieHealthBar.tween\": [\n    {\n      duration: 200,\n      dy: 100,\n      alpha: 0,\n    },\n  ],\n  \"effects.buttonPress.tween\": [\n    {\n      duration: 500,\n      ease: \"Cubic.easeInOut\",\n      dy: 16,\n      refreshPhysics: true,\n      yoyo: true,\n    },\n  ],\n  \"effects.drawbridge.tween\": [\n    {\n      duration: 1500,\n      ease: \"Bounce.easeOut\",\n      rotation: -90,\n    },\n  ],\n  \"effects.playerAsh.particles\": [\n    {\n      image: \"dot\",\n      blendMode: \"ADD\",\n      accelerationY: 2000,\n      lifespan: 500,\n      speedX: 500,\n      speedY: -1000,\n      frequency: 1,\n      quantity: 5,\n    },\n  ],\n  \"effects.lightAsh.particles\": [\n    {\n      image: \"dot\",\n      blendMode: \"ADD\",\n      accelerationY: 2000,\n      lifespan: 250,\n      speedX: 250,\n      speedY: -500,\n      frequency: 100,\n      quantity: 1,\n    },\n  ],\n  \"effects.playerSmoke.particles\": [\n    {\n      image: \"smoke\",\n      blendMode: \"ADD\",\n      accelerationY: -100,\n      lifespan: 1000,\n      speedX: 100,\n      speedY: -100,\n      frequency: 1,\n      quantity: 1,\n    },\n  ],\n  \"effects.stars.particles\": [\n    {\n      image: \"dot\",\n      blendMode: \"ADD\",\n      lifespan: 2000,\n      frequency: 1000,\n      quantity: 25,\n      preemit: true,\n    },\n  ],\n  \"effects.comet.particles\": [\n    {\n      image: \"dot\",\n      lifespan: 250,\n      frequency: 1,\n      quantity: 10,\n    },\n  ],\n};\n\npropSpecs[\"scene.musicVolume\"][0] = 0.66;\npropSpecs[\"scene.camera.lerp\"][0] = 0.005;\npropSpecs[\"scene.camera.deadzoneX\"][0] = 200;\npropSpecs[\"scene.camera.deadzoneY\"][0] = 200;\n\nexport const tileDefinitions = {\n  \".\": null, // background\n  \"#\": {\n    image: \"solid\",\n    group: \"wall\",\n    combine: \"#\",\n    isStatic: true,\n    shadow: true,\n  },\n  \"|\": {\n    image: \"translucent\",\n    group: \"ground\",\n    combine: \"|\",\n    preferCombineVertical: true,\n    isStatic: true,\n  },\n  I: {\n    image: \"solid\",\n    group: \"wall\",\n    combine: \"I\",\n    preferCombineVertical: true,\n    isStatic: true,\n    shadow: true,\n  },\n  _: {\n    image: \"translucent\",\n    group: \"ground\",\n    combine: \"_\",\n    isStatic: true,\n  },\n  \"/\": {\n    image: \"spinner\",\n    group: \"spinner\",\n    shadow: true,\n  },\n  \"\\\\\": {\n    image: \"spinner\",\n    group: \"reverseSpinner\",\n    shadow: true,\n  },\n  \"@\": {\n    image: \"player\",\n    group: \"player\",\n  },\n  \"~\": {\n    image: \"crumble\",\n    group: \"crumble\",\n    isStatic: true,\n  },\n  n: {\n    image: \"button\",\n    group: \"button\",\n    isStatic: true,\n  },\n  \"=\": {\n    image: \"drawbridge\",\n    group: \"drawbridge\",\n    shadow: true,\n  },\n};\n\npreprocessPropSpecs(propSpecs, particleImages);\n\nexport const manageableProps = new ManageableProps(propSpecs);\nexport const propsWithPrefix = makePropsWithPrefix(propSpecs, manageableProps);\nexport default PropLoader(propSpecs, manageableProps);\n","import _ from 'lodash';\nimport * as dat from 'dat.gui';\nimport prop, {manageableProps, propSpecs} from '../../props';\nimport {saveField} from './store';\nimport {savedChangedProps} from './props';\n\nlet gui;\n\nconst folders = {};\nconst controllers = {};\nconst parentOfFolder = new Map();\nconst changedProps = {};\n\nconst originalProp = prop;\nlet proxiedManageableProps = manageableProps;\nconst manageablePropsProxy = new Proxy({}, {\n  get(target, key) {\n    return proxiedManageableProps[key];\n  },\n\n  set(target, key, value) {\n    proxiedManageableProps[key] = value;\n    return true;\n  },\n});\n\nexport function initializeManage() {\n  if (!gui) {\n    gui = new dat.GUI({autoPlace: false});\n\n    Object.keys(propSpecs).forEach((key) => addNestedFolder(key));\n    Object.keys(propSpecs).forEach((key) => addController(\n      key,\n      propSpecs[key],\n      false,\n      key in savedChangedProps || `${key}_enabled` in savedChangedProps,\n    ));\n  }\n\n  return gui;\n}\n\nfunction upcase(word) {\n  return word.charAt(0).toUpperCase() + word.slice(1);\n}\n\nfunction sentenceCase(name) {\n  const words = name.split(/[-_ ]/);\n  return words.map(upcase).join(' ');\n}\n\nfunction addNestedFolder(key) {\n  const sections = key.split('.');\n  let folderKey = '';\n  let folder = gui;\n\n  while (sections.length > 1) {\n    const section = sections.shift();\n    folderKey += `.${section}`;\n\n    if (!folders[folderKey]) {\n      folders[folderKey] = folder.addFolder(sentenceCase(section));\n      parentOfFolder.set(folders[folderKey], folder);\n\n      const title = folders[folderKey].domElement.querySelector('li.title');\n      title.addEventListener('click', () => {\n        regenerateListenPropsCache();\n      });\n    }\n\n    folder = folders[folderKey];\n  }\n\n  return folder;\n}\n\nfunction removeEmptyFolders() {\n  let deletedFolder = false;\n\n  Object.entries(folders).forEach(([name, folder]) => {\n    if (folder.__controllers.length || Object.keys(folder.__folders).length) {\n      return;\n    }\n\n    const parent = parentOfFolder.get(folder);\n    parent.removeFolder(folder);\n\n    parentOfFolder.delete(folder);\n    delete folders[name];\n\n    deletedFolder = true;\n  });\n\n  // recurse now that the parent of the deleted folder could now be empty\n  if (deletedFolder) {\n    removeEmptyFolders();\n  }\n}\n\nlet batchSaveChangedProps = 0;\nfunction saveChangedProps() {\n  if (batchSaveChangedProps) {\n    return;\n  }\n\n  saveField('changedProps', changedProps);\n}\n\nfunction setChangedProp(key) {\n  changedProps[key] = [manageableProps[key], propSpecs[key][0]];\n  document.body.classList.add('changed-props');\n}\n\nfunction setUnchangedProp(key) {\n  delete changedProps[key];\n  if (!Object.keys(changedProps).length) {\n    document.body.classList.remove('changed-props');\n  }\n}\n\nfunction addController(key, spec, open, saved) {\n  const [originalValue, ...options] = propSpecs[key];\n  const folder = addNestedFolder(key);\n\n  if (manageablePropsProxy[key] === null) {\n    throw new Error(`Prop ${key} must not be initialized to null`);\n  }\n\n  if (key.endsWith('_enabled')) {\n    const prefix = key.substr(0, key.length - '_enabled'.length);\n    if (!(prefix in propSpecs)) {\n      throw new Error(`Prop ${key} does not have corresponding ${prefix}`);\n    }\n    return;\n  }\n\n  const enabledKey = `${key}_enabled`;\n\n  let controller;\n  if (options.length >= 1 && options[0] === null) {\n    if (key.match(/color$/i)) {\n      controller = folder.addColor(manageablePropsProxy, key).listen();\n    } else {\n      controller = folder.add(manageablePropsProxy, key).listen();\n    }\n    controller.domElement.closest('.cr').classList.add('listen');\n    controller.domElement.querySelectorAll('input, select').forEach((node) => {\n      node.tabIndex = -1;\n      node.onclick = (e) => {\n        e.preventDefault();\n      };\n    });\n\n    if (options.length > 1 && typeof options[options.length - 1] === 'function') {\n      controller.__ldListenCallback = options[options.length - 1];\n    }\n  } else {\n    let callback;\n    if (options.length >= 1 && typeof options[options.length - 1] === 'function') {\n      callback = options.pop();\n    }\n\n    if (key.match(/color$/i)) {\n      controller = folder.addColor(manageablePropsProxy, key, ...options);\n    } else {\n      controller = folder.add(manageablePropsProxy, key, ...options);\n    }\n\n    if (callback) {\n      controller.__ldChangeCallback = callback;\n    }\n\n    if (typeof originalValue === 'function') {\n      controller.__ldActionCallback = originalValue;\n    }\n\n    const crNode = controller.domElement.closest('.cr');\n\n    let enabledCheckbox;\n    let enabledValue;\n    const originalEnabled = enabledKey in propSpecs ? propSpecs[enabledKey][0] : null;\n\n    if (enabledKey in manageableProps) {\n      enabledValue = manageableProps[enabledKey];\n\n      const container = document.createElement('div');\n      container.classList.add('toggle');\n\n      enabledCheckbox = document.createElement('input');\n      enabledCheckbox.setAttribute('type', 'checkbox');\n      if (enabledValue) {\n        enabledCheckbox.setAttribute('checked', 'checked');\n        enabledCheckbox.checked = true;\n      }\n\n      container.appendChild(enabledCheckbox);\n\n      crNode.classList.add('disableable');\n\n      const {parentNode} = controller.domElement;\n      parentNode.appendChild(container);\n\n      controller.__ldEnabledSpec = propSpecs[enabledKey];\n\n      enabledCheckbox.onchange = (e) => {\n        e.preventDefault();\n        const {checked} = e.target;\n        manageableProps[enabledKey] = checked;\n\n        enabledCheckbox.__suppressChange = true;\n        try {\n          controller.__onChange(manageableProps[key]);\n          controller.__onFinishChange(manageableProps[key]);\n        } catch (err) {\n          enabledCheckbox.__suppressChange = false;\n          throw err;\n        }\n\n        enabledCheckbox.__suppressChange = false;\n      };\n    }\n\n    if (typeof originalValue !== 'function') {\n      const container = document.createElement('div');\n      container.classList.add('reset');\n\n      const resetButton = document.createElement('input');\n      resetButton.setAttribute('type', 'button');\n      resetButton.value = '';\n\n      container.appendChild(resetButton);\n\n      const {parentNode} = controller.domElement;\n      parentNode.appendChild(container);\n\n      resetButton.onclick = (e) => {\n        if (e) {\n          e.preventDefault();\n          e.stopPropagation();\n        }\n\n        manageableProps[key] = originalValue;\n\n        if (enabledCheckbox) {\n          enabledCheckbox.__suppressChange = true;\n          manageableProps[enabledKey] = originalEnabled;\n          if (originalEnabled) {\n            enabledCheckbox.setAttribute('checked', 'checked');\n            enabledCheckbox.checked = true;\n          } else {\n            enabledCheckbox.removeAttribute('checked');\n            enabledCheckbox.checked = false;\n          }\n        }\n\n        controller.updateDisplay();\n\n        try {\n          controller.__onChange(manageableProps[key]);\n          controller.__onFinishChange(manageableProps[key]);\n        } catch (err) {\n          if (enabledCheckbox) {\n            enabledCheckbox.__suppressChange = false;\n          }\n\n          throw err;\n        }\n\n        if (enabledCheckbox) {\n          enabledCheckbox.__suppressChange = false;\n        }\n      };\n    }\n\n    if (typeof originalValue !== 'function') {\n      controller.onFinishChange((value) => {\n        let ret;\n        try {\n          const {game} = window;\n          const scene = game.topScene();\n          scene.propDidFinishChange(key, value);\n          saveChangedProps();\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.error(e);\n        }\n\n        return ret;\n      });\n\n      controller.onChange((value) => {\n        let ret;\n        try {\n          if (enabledCheckbox && !enabledCheckbox.__suppressChange) {\n            manageableProps[enabledKey] = true;\n            enabledCheckbox.setAttribute('checked', 'checked');\n            enabledCheckbox.checked = true;\n          }\n\n          const {game} = window;\n          const scene = game.topScene();\n          scene.propDidChange(key, value);\n\n          let isChanged = false;\n          if (enabledCheckbox) {\n            if (manageableProps[enabledKey] !== originalEnabled) {\n              isChanged = true;\n              setChangedProp(enabledKey);\n            } else {\n              setUnchangedProp(enabledKey);\n            }\n          }\n\n          if (value !== originalValue) {\n            isChanged = true;\n            setChangedProp(key);\n          } else {\n            setUnchangedProp(key);\n          }\n\n          saveChangedProps();\n\n          if (isChanged) {\n            crNode.classList.add('changed');\n          } else {\n            crNode.classList.remove('changed');\n          }\n\n          if (controller.__ldChangeCallback) {\n            ret = controller.__ldChangeCallback(value, scene, game);\n          }\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.error(e);\n        }\n\n        return ret;\n      });\n\n      if (saved) {\n        setChangedProp(key);\n        crNode.classList.add('changed');\n      }\n    }\n  }\n\n  const container = controller.domElement.closest('.cr');\n  container.title = key;\n  container.dataset.prop = key;\n\n  controllers[key] = controller;\n  controller.__ldSpec = spec;\n\n  if (open) {\n    let f = folder;\n    while (f) {\n      f.open();\n      f = parentOfFolder.get(f);\n    }\n  }\n\n  return controller;\n}\n\nfunction removeProp(key) {\n  const controller = controllers[key];\n  const folder = addNestedFolder(key);\n  folder.remove(controller);\n  delete controllers[key];\n}\n\nexport function refreshUI() {\n  gui.updateDisplay();\n  Object.values(folders).forEach((folder) => folder.updateDisplay());\n}\n\nconst listenPropsCache = [];\nfunction regenerateListenPropsCache() {\n  listenPropsCache.length = 0;\n  document.querySelectorAll('.Manage ul:not(.closed) > li.listen:not(.filtered)').forEach((node) => {\n    const key = node.dataset.prop;\n    const spec = propSpecs[key];\n    listenPropsCache.push([key, spec]);\n  });\n}\n\nexport function updatePropsFromStep(skipCache) {\n  const {game} = window;\n  const scene = game.topScene();\n\n  const updateProp = ([key, spec]) => {\n    if (spec[1] === null) {\n      if (!spec[2]) {\n        manageableProps[key] = _.get(game, key) || _.get(scene, key);\n      } else if (typeof spec[2] === 'string') {\n        manageableProps[key] = _.get(game, spec[2]) || _.get(scene, spec[2]);\n      } else if (typeof spec[2] === 'function') {\n        try {\n          manageableProps[key] = spec[2](game.topScene(), game);\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.error(e);\n        }\n      }\n    }\n  };\n\n  if (skipCache) {\n    Object.entries(propSpecs).forEach(updateProp);\n  } else {\n    listenPropsCache.forEach(updateProp);\n  }\n}\n\nexport function overrideProps(newProps) {\n  Object.entries(propSpecs).forEach(([key, spec]) => {\n    if (spec[1] === null) {\n      manageableProps[key] = newProps[key];\n    }\n  });\n}\n\nfunction specDiffers(old, next) {\n  let differsInFunction;\n\n  if ((!next && old) || (!old && next)) {\n    return true;\n  }\n\n  if (old.length !== next.length) {\n    return true;\n  }\n\n  for (let i = next.length - 1; i >= 0; i -= 1) {\n    if (i === next.length - 1 && typeof next[i] === 'function' && typeof old[i] === 'function') {\n      differsInFunction = true;\n    } else if ((i === 0 || i === 1) && Array.isArray(next[i]) && Array.isArray(old[i])) {\n      // compare enum values\n      const nextArray = next[i];\n      const oldArray = old[i];\n\n      if (nextArray.length !== oldArray.length) {\n        return true;\n      }\n\n      for (let j = nextArray.length - 1; j >= 0; j -= 1) {\n        if (nextArray[j] !== oldArray[j]) {\n          return true;\n        }\n      }\n    } else if (next[i] !== old[i]) {\n      return true;\n    }\n  }\n\n  if (differsInFunction) {\n    return 'function';\n  }\n\n  return false;\n}\n\nfunction requiresControllerRecreation(key, next) {\n  const spec = next[key];\n  const controller = controllers[key];\n  const oldSpec = controller.__ldSpec;\n\n  // listeners don't need to regenerate unless the type changes\n  if (oldSpec[1] === null && spec[1] === null) {\n    if (typeof oldSpec[0] !== typeof spec[0]) {\n      return true;\n    }\n\n    return false;\n  }\n\n  const nextEnabledSpec = next[`${key}_enabled`];\n  if ('__ldEnabledSpec' in controller) {\n    if (specDiffers(controller.__ldEnabledSpec, nextEnabledSpec)) {\n      return true;\n    }\n  } else if (nextEnabledSpec) {\n    return true;\n  }\n\n  return specDiffers(oldSpec, spec);\n}\n\nfunction updatePropsFromReload(oldValues, nextSpecs) {\n  const changes = [];\n\n  const leftoverKeys = {};\n  Object.keys(controllers).forEach((key) => {\n    leftoverKeys[key] = true;\n  });\n\n  Object.keys(nextSpecs).forEach((key) => addNestedFolder(key, true));\n\n  Object.entries(nextSpecs).forEach(([key, spec]) => {\n    if (!(key in controllers)) {\n      addController(key, spec, true);\n\n      if (!key.endsWith('_enabled')) {\n        changes.push(key);\n      }\n    } else {\n      delete leftoverKeys[key];\n      const controller = controllers[key];\n\n      const requiresRecreation = requiresControllerRecreation(key, nextSpecs);\n      if (!requiresRecreation || requiresRecreation === 'function') {\n        if (!requiresRecreation && spec.length > 1 && spec[1] === null && typeof spec[spec.length - 1] === 'function') {\n          if (String(spec[spec.length - 1]) !== String(controller.__ldListenCallback)) {\n            changes.push(key);\n          }\n          controller.__ldListenCallback = spec[spec.length - 1];\n        } else if (requiresRecreation === 'function') {\n          if (controller.__ldChangeCallback) {\n            if (String(spec[spec.length - 1]) !== String(controller.__ldChangeCallback)) {\n              changes.push(key);\n            }\n            controller.__ldChangeCallback = spec[spec.length - 1];\n          } else {\n            if (String(spec[spec.length - 1]) !== String(controller.__ldActionCallback)) {\n              changes.push(key);\n            }\n            controller.__ldActionCallback = spec[spec.length - 1];\n          }\n        } else if (spec[1] !== null && manageableProps[key] !== oldValues[key]) {\n          manageableProps[key] = oldValues[key];\n          setChangedProp(key);\n          changes.push(key);\n        }\n\n        return;\n      }\n\n      changes.push(key);\n\n      setUnchangedProp(`${key}_enabled`);\n      setUnchangedProp(key);\n\n      // regenerate this controller with the new config\n      const container = controller.domElement.closest('.cr');\n      const parent = container.parentNode;\n      const {children} = parent;\n      const index = Array.prototype.indexOf.call(children, container);\n      const nextContainer = index > -1 ? children[index + 1] : null;\n\n      controller.remove();\n\n      const newController = addController(key, spec, true);\n\n      if (nextContainer) {\n        const newContainer = newController.domElement.closest('.cr');\n        parent.removeChild(newContainer);\n        parent.insertBefore(newContainer, nextContainer);\n      }\n    }\n  });\n\n  changes.forEach((key) => {\n    let f = addNestedFolder(key);\n    while (f) {\n      f.open();\n      f = parentOfFolder.get(f);\n    }\n  });\n\n  if (leftoverKeys.length) {\n    changes.push(...leftoverKeys);\n  }\n\n  Object.keys(leftoverKeys).forEach(removeProp);\n  removeEmptyFolders();\n\n  // refresh UI with new values\n  refreshUI();\n\n  return changes;\n}\n\nfunction queryize(query) {\n  const characters = query.split('');\n  let hasUppercase = false;\n\n  const escapedCharacters = characters.map((character) => {\n    if (character !== character.toLowerCase()) {\n      hasUppercase = true;\n    }\n\n    if ('.*+?^${}()|[]\\\\'.includes(character)) {\n      return `\\\\${character}`;\n    } else {\n      return character;\n    }\n  });\n\n  const subsequence = escapedCharacters.join('.*');\n\n  if (query.startsWith('/')) {\n    try {\n      return new RegExp(query.substring(1), hasUppercase ? '' : 'i');\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n    }\n    return new RegExp('(?!)');\n  }\n\n  return new RegExp(subsequence, hasUppercase ? '' : 'i');\n}\n\nlet previousQuery = '';\nexport function updateSearch(query, isStarted) {\n  previousQuery = query;\n\n  const queryRegex = queryize(query);\n\n  const container = document.querySelector('.Manage .dg.main');\n  if (query === '') {\n    Object.values(folders).forEach((folder) => folder.close());\n    container.querySelectorAll('.filtered').forEach((node) => {\n      node.classList.remove('filtered');\n    });\n  } else {\n    Object.values(folders).forEach((folder) => {\n      if (isStarted) {\n        folder.open();\n      }\n\n      folder.domElement.classList.add('filtered');\n    });\n\n    container.querySelectorAll('li[data-prop]').forEach((node) => {\n      let isFiltered = true;\n\n      if (query.toLowerCase() === 'change') {\n        if (node.classList.contains('changed')) {\n          isFiltered = false;\n        }\n      } else if (node.dataset.prop.match(queryRegex)) {\n        isFiltered = false;\n      }\n\n      if (isFiltered) {\n        node.classList.add('filtered');\n      } else {\n        let folder = node;\n        while (folder) {\n          folder.classList.remove('filtered');\n          folder = folder.parentNode.closest('.filtered');\n        }\n      }\n    });\n  }\n  regenerateListenPropsCache();\n}\n\nexport function serializeChangedProps() {\n  return Object.entries(changedProps).map(([key, [current]]) => (\n    `propSpecs['${key}'][0] = ${JSON.stringify(current)};`\n  )).join('\\n');\n}\n\nexport function resetChangedProps() {\n  batchSaveChangedProps += 1;\n  document.querySelectorAll('.Manage .cr.changed .reset input').forEach((button) => {\n    button.onclick();\n  });\n  batchSaveChangedProps -= 1;\n  saveChangedProps();\n}\n\nif (module.hot) {\n  module.hot.accept('../../props', () => {\n    try {\n      const next = require('../../props');\n\n      const oldProps = proxiedManageableProps;\n      proxiedManageableProps = next.manageableProps;\n      const changes = updatePropsFromReload(oldProps, next.propSpecs);\n\n      originalProp(null, next.manageableProps);\n\n      if (changes.length) {\n        // eslint-disable-next-line no-console\n        console.info(`Hot-loading props: ${changes.join(', ')}`);\n      }\n\n      const {game} = window;\n      game.command.updateCommandsFromReload(next.commands);\n\n      game.updateShaderFragments(next.shaderCoordFragments, next.shaderColorFragments, next.shaderPipelines);\n\n      regenerateListenPropsCache();\n\n      updateSearch(previousQuery, true);\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n    }\n  });\n}\n","import Phaser from \"phaser\";\nimport { expandParticleProps } from \"./particles\";\nimport { expandTweenProps } from \"./tweens\";\nimport { expandTransitionProps } from \"./transitions\";\nimport { freezeStorage, removeAllFields, loadField } from \"./store\";\nimport { shaderProps } from \"./shaders.js\";\n\nconst savedChangedProps = loadField(\"changedProps\", {});\nexport { savedChangedProps };\n\nconst rendererName = {\n  [Phaser.AUTO]: \"auto\",\n  [Phaser.CANVAS]: \"canvas\",\n  [Phaser.WEBGL]: \"webgl\",\n};\n\nconst debug = !process.env.NODE_ENV || process.env.NODE_ENV === \"development\";\n\nexport function builtinPropSpecs(\n  commands,\n  shaderCoordFragments,\n  shaderColorFragments\n) {\n  if (!debug) {\n    Object.keys(commands).forEach((key) => {\n      if (commands[key].debug) {\n        delete commands[key];\n      }\n    });\n  }\n\n  return {\n    \"engine.time\": [0.01, null, \"loop.time\"],\n    \"engine.frameTime\": [0.01, null, \"loop.delta\"],\n    \"engine.actualFps\": [0.01, null, \"loop.actualFps\"],\n    \"engine.targetFps\": [0.01, null, \"loop.targetFps\"],\n    \"engine.renderer\": [\n      rendererName[Phaser.AUTO],\n      null,\n      (scene, game) => rendererName[game.renderer.type],\n    ],\n    \"engine.focused\": [false, null, \"scene.game.focused\"],\n    \"engine.throttle\": [false],\n    \"engine.stepping\": [\n      false,\n      (value, scene, game) => (value ? game.loop.sleep() : game.loop.wake()),\n    ],\n    \"engine.step\": [\n      (scene, game) => game.prop(\"engine.stepping\") && game.loop.tick(),\n    ],\n    \"engine.clearLocalStorage\": [\n      () => {\n        removeAllFields();\n        freezeStorage();\n        // eslint-disable-next-line no-self-assign\n        window.location = window.location;\n      },\n    ],\n    \"engine.clearGameState\": [\n      () => {\n        removeAllFields(\"game_\");\n        freezeStorage();\n        // eslint-disable-next-line no-self-assign\n        window.location = window.location;\n      },\n    ],\n    \"engine.disableDebugUI\": [(scene, game) => game.disableDebugUI()],\n\n    \"config.debug\": [debug, null, () => debug],\n    \"config.width\": [0, null, (scene, game) => game.config.width],\n    \"config.height\": [0, null, (scene, game) => game.config.height],\n    \"config.tileWidth\": [0, null, (scene, game) => game.config.tileWidth],\n    \"config.tileHeight\": [0, null, (scene, game) => game.config.tileHeight],\n    \"config.xBorder\": [0, null, (scene, game) => scene.xBorder],\n    \"config.yBorder\": [0, null, (scene, game) => scene.xBorder],\n\n    \"scene.count\": [\"\", null, \"scene.scenes.length\"],\n    \"scene.commandScenes\": [\"\", null, (scene) => scene.command._scenes.size],\n    \"scene.class\": [\"\", null, (scene) => scene.constructor.name],\n    \"scene.sceneId\": [\"\", null, \"sceneId\"],\n    \"scene.parentSceneId\": [\"\", null, \"scene.settings.data.parentSceneId\"],\n    \"scene.key\": [\"\", null, \"scene.key\"],\n    \"scene.seed\": [\"\", null, \"scene.settings.data.seed\"],\n    \"scene.scene_time\": [0.01, null, \"scene_time\"],\n    \"scene.music\": [\"\", null, \"currentMusicName\"],\n    \"scene.timeScale\": [0.01, null, \"timeScale\"],\n    \"scene.shaderName\": [\"\", null, \"shaderName\"],\n    \"scene.physicsFps\": [0.01, null, \"physics.world.fps\"],\n    \"scene.images\": [\n      0,\n      null,\n      (scene) =>\n        scene.add.displayList.list.filter((node) => node.type === \"Image\")\n          .length,\n    ],\n    \"scene.sprites\": [\n      0,\n      null,\n      (scene) =>\n        scene.add.displayList.list.filter((node) => node.type === \"Sprite\")\n          .length,\n    ],\n    \"scene.particles\": [\n      0,\n      null,\n      (scene) =>\n        scene.add.displayList.list.filter(\n          (node) => node.type === \"ParticleEmitterManager\"\n        ).length,\n    ],\n    \"scene.text\": [\n      0,\n      null,\n      (scene) =>\n        scene.add.displayList.list.filter((node) => node.type === \"Text\")\n          .length,\n    ],\n    \"scene.sounds\": [0, null, \"sounds.length\"],\n    \"scene.timers\": [0, null, \"timers.length\"],\n    \"scene.physicsColliders\": [\n      0,\n      null,\n      \"physics.world.colliders._active.length\",\n    ],\n    \"scene.musicVolume\": [\n      1,\n      0,\n      1,\n      (value, scene, game) => {\n        game.changeVolume(game.volume);\n      },\n    ],\n    \"scene.soundVolume\": [\n      1,\n      0,\n      1,\n      (value, scene, game) => {\n        game.changeVolume(game.volume);\n      },\n    ],\n    \"scene.debugDraw\": [\n      false,\n      (value, scene) => {\n        if (value) {\n          scene.physics.world.createDebugGraphic();\n        } else {\n          scene.physics.world.debugGraphic.destroy();\n        }\n      },\n    ],\n    \"scene.replaceWithSelf\": [(scene) => scene.replaceWithSelf(false)],\n\n    \"scene.camera.width\": [0, null, \"camera.width\"],\n    \"scene.camera.height\": [0, null, \"camera.height\"],\n    \"scene.camera.alpha\": [0.1, null, \"camera.alpha\"],\n    \"scene.camera.zoom\": [0.1, null, \"camera.zoom\"],\n    \"scene.camera.rotation\": [0.1, null, \"camera.rotation\"],\n    \"scene.camera.x\": [0, null, \"camera.x\"],\n    \"scene.camera.y\": [0, null, \"camera.y\"],\n    \"scene.camera.scrollX\": [0, null, \"camera.scrollX\"],\n    \"scene.camera.scrollY\": [0, null, \"camera.scrollY\"],\n    \"scene.camera.centerX\": [0, null, \"camera.centerX\"],\n    \"scene.camera.centerY\": [0, null, \"camera.centerY\"],\n    \"scene.camera.boundsX\": [0, null, \"camera._bounds.x\"],\n    \"scene.camera.boundsY\": [0, null, \"camera._bounds.y\"],\n    \"scene.camera.boundsWidth\": [0, null, \"camera._bounds.width\"],\n    \"scene.camera.boundsHeight\": [0, null, \"camera._bounds.height\"],\n    \"scene.camera.useBounds\": [true, null, \"camera.useBounds\"],\n\n    \"scene.camera.follow\": [\n      \"\",\n      null,\n      objectIdentifier((scene) => scene.level, (scene) => scene.camera._follow),\n    ],\n    \"scene.camera.followOffsetX\": [0, null, \"camera.followOffset.x\"],\n    \"scene.camera.followOffsetY\": [0, null, \"camera.followOffset.y\"],\n\n    \"scene.camera.lerp\": [\n      1,\n      0,\n      1,\n      (value, scene) => {\n        scene.setCameraLerp();\n      },\n    ],\n    \"scene.camera.deadzoneX\": [\n      0,\n      0,\n      1000,\n      (value, scene) => {\n        scene.setCameraDeadzone();\n      },\n    ],\n    \"scene.camera.deadzoneY\": [\n      0,\n      0,\n      1000,\n      (value, scene) => {\n        scene.setCameraDeadzone();\n      },\n    ],\n    \"scene.camera.hasBounds\": [\n      true,\n      (value, scene) => {\n        scene.setCameraBounds();\n      },\n    ],\n\n    \"scene.trauma.amount\": [0.01, null, \"_trauma\"],\n    \"scene.trauma.shakeAmount\": [0.01, null, \"_traumaShake\"],\n    \"scene.trauma.decay\": [0.001, 0, 1],\n    \"scene.trauma.exponent\": [2.0, 0, 4],\n    \"scene.trauma.dx\": [30.0, 0, 100],\n    \"scene.trauma.dy\": [30.0, 0, 100],\n    \"scene.trauma.dt\": [0.17, 0, 1],\n    \"scene.trauma.speed\": [0.2, 0, 1],\n    \"scene.trauma.easeIn\": [100, 0, 1000],\n    \"scene.trauma.legacy\": [false],\n    \"scene.trauma.mild\": [(scene) => scene.trauma(0.2)],\n    \"scene.trauma.minor\": [(scene) => scene.trauma(0.5)],\n    \"scene.trauma.major\": [(scene) => scene.trauma(0.8)],\n    \"scene.trauma.max\": [(scene) => scene.trauma(100)],\n    \"scene.trauma.enabled\": [true],\n\n    ...commandKeyProps(commands),\n\n    \"command.gamepad.total\": [0, null],\n    \"command.gamepad.A\": [false, null],\n    \"command.gamepad.B\": [false, null],\n    \"command.gamepad.X\": [false, null],\n    \"command.gamepad.Y\": [false, null],\n    \"command.gamepad.L1\": [false, null],\n    \"command.gamepad.L2\": [false, null],\n    \"command.gamepad.R1\": [false, null],\n    \"command.gamepad.R2\": [false, null],\n    \"command.gamepad.UP\": [false, null],\n    \"command.gamepad.DOWN\": [false, null],\n    \"command.gamepad.LEFT\": [false, null],\n    \"command.gamepad.RIGHT\": [false, null],\n    \"command.gamepad.LSTICKX\": [0.01, null],\n    \"command.gamepad.LSTICKY\": [0.01, null],\n    \"command.gamepad.RSTICKX\": [0.01, null],\n    \"command.gamepad.RSTICKY\": [0.01, null],\n\n    \"command.ignore_all.any\": [\n      false,\n      null,\n      (scene) => scene.command.ignoreAll(),\n    ],\n    \"command.ignore_all._transition\": [\n      false,\n      null,\n      (scene) => scene.command.ignoreAll(\"_transition\"),\n    ],\n    \"command.ignore_all._sleep\": [\n      false,\n      null,\n      (scene) => scene.command.ignoreAll(\"_sleep\"),\n    ],\n\n    ...commandProps(commands),\n    ...shaderProps(shaderCoordFragments, shaderColorFragments),\n  };\n}\n\nfunction commandProps(commands) {\n  const props = {};\n\n  Object.entries(commands).forEach(([name, config]) => {\n    props[`command.${name}.held`] = [false, null];\n    props[`command.${name}.started`] = [false, null];\n    props[`command.${name}.continued`] = [false, null];\n    props[`command.${name}.released`] = [false, null];\n\n    props[`command.${name}.heldFrames`] = [0, null];\n    props[`command.${name}.releasedFrames`] = [0, null];\n    props[`command.${name}.heldDuration`] = [0, null];\n    props[`command.${name}.releasedDuration`] = [0, null];\n\n    if (config.cooldown) {\n      props[`command.${name}.cooldown`] = [config.cooldown, 0, 100000];\n      props[`command.${name}.coolingDown`] = [\n        false,\n        null,\n        (scene) => scene.command[name].coolingDown,\n      ];\n      props[`command.${name}.coolingDownTime`] = [\n        0.01,\n        null,\n        (scene) => scene.command[name].coolingDownTime,\n      ];\n    }\n\n    if (config.joystick) {\n      props[`command.${name}.x`] = [\n        0.01,\n        null,\n        (scene) => scene.command[name].held[0],\n      ];\n      props[`command.${name}.y`] = [\n        0.01,\n        null,\n        (scene) => scene.command[name].held[1],\n      ];\n    }\n\n    props[`command.${name}.enabled`] = [true];\n\n    if (config.execute) {\n      const execute =\n        typeof config.execute === \"function\"\n          ? (scene, game) => config.execute(scene, game)\n          : (scene, game) => scene[config.execute](scene, game);\n      props[`command.${name}.execute`] = [execute];\n    }\n  });\n\n  return props;\n}\n\nconst knownInputs = [\n  \"gamepad.A\",\n  \"gamepad.B\",\n  \"gamepad.X\",\n  \"gamepad.Y\",\n  \"gamepad.L1\",\n  \"gamepad.L2\",\n  \"gamepad.R1\",\n  \"gamepad.R2\",\n  \"gamepad.UP\",\n  \"gamepad.DOWN\",\n  \"gamepad.LEFT\",\n  \"gamepad.RIGHT\",\n  \"gamepad.LSTICK.UP\",\n  \"gamepad.LSTICK.DOWN\",\n  \"gamepad.LSTICK.LEFT\",\n  \"gamepad.LSTICK.RIGHT\",\n  \"gamepad.RSTICK.UP\",\n  \"gamepad.RSTICK.DOWN\",\n  \"gamepad.RSTICK.LEFT\",\n  \"gamepad.RSTICK.RIGHT\",\n  \"gamepad.LSTICK.RAW\",\n  \"gamepad.RSTICK.RAW\",\n\n  ...Object.keys(Phaser.Input.Keyboard.KeyCodes).map((x) => `keyboard.${x}`),\n].reduce((a, b) => {\n  a[b] = true;\n  return a;\n}, {});\n\nexport function keysWithPrefix(commands, prefix, skipWarning) {\n  const keys = [];\n\n  Object.entries(commands).forEach(([command, config]) => {\n    if (!config.input) {\n      return;\n    }\n\n    config.input.forEach((inputPath) => {\n      if (!knownInputs[inputPath]) {\n        if (!skipWarning) {\n          // eslint-disable-next-line no-console\n          console.error(\n            `Unknown input path ${inputPath} for command ${command}`\n          );\n        }\n        return;\n      }\n\n      if (inputPath.startsWith(prefix)) {\n        keys.push(inputPath.substr(prefix.length));\n      }\n    });\n  });\n\n  return keys;\n}\n\nexport function commandKeys(commands, skipWarning) {\n  return keysWithPrefix(commands, \"keyboard.\", skipWarning);\n}\n\nexport function gamepadKeys(commands, skipWarning) {\n  return keysWithPrefix(commands, \"gamepad.\", skipWarning);\n}\n\nexport function commandKeyProps(commands) {\n  const props = {};\n\n  commandKeys(commands)\n    .sort()\n    .forEach((key) => {\n      props[`command.keyboard.${key}`] = [false, null];\n    });\n\n  return props;\n}\n\nexport function preprocessPropSpecs(propSpecs, particleImages) {\n  expandParticleProps(propSpecs, particleImages);\n  expandTweenProps(propSpecs, particleImages);\n  expandTransitionProps(propSpecs, particleImages);\n}\n\nexport function ManageableProps(propSpecs) {\n  Object.entries(propSpecs).forEach(([key, spec]) => {\n    if (!Array.isArray(spec)) {\n      throw new Error(\n        `Invalid spec for prop ${key}; expected array, got ${spec}`\n      );\n    }\n\n    let [value] = spec;\n    // interject the scene and game, and wrap in a try\n    if (typeof value === \"function\") {\n      const original = value;\n      value = () => {\n        try {\n          const { game } = window;\n          const scene = game.topScene();\n          scene.command.recordPropExecution(key);\n          original(scene, game);\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.error(e);\n        }\n      };\n    }\n\n    if (key in savedChangedProps) {\n      const [current, original] = savedChangedProps[key];\n      if (JSON.stringify(value) === JSON.stringify(original)) {\n        value = current;\n      } else {\n        delete savedChangedProps[key];\n      }\n    }\n\n    this[key] = value;\n  });\n}\n\nexport function makePropsWithPrefix(propSpecs, manageableProps) {\n  if (debug) {\n    return (prefix) => {\n      const props = {};\n      Object.entries(manageableProps).forEach(([key, value]) => {\n        if (key.startsWith(prefix)) {\n          const name = key.substr(prefix.length);\n          props[name] = value;\n        }\n      });\n      return props;\n    };\n  }\n\n  const cache = {};\n  return (prefix, clearCache) => {\n    if (clearCache) {\n      if (prefix) {\n        delete cache[prefix];\n      } else {\n        Object.keys(cache).forEach((key) => delete cache[key]);\n      }\n    }\n\n    if (!cache[prefix]) {\n      const props = {};\n      Object.entries(propSpecs).forEach(([key, spec]) => {\n        if (key.startsWith(prefix)) {\n          const [value] = spec;\n          const name = key.substr(prefix.length);\n          props[name] = value;\n        }\n      });\n      cache[prefix] = props;\n    }\n    return cache[prefix];\n  };\n}\n\nexport function PropLoader(propSpecs, manageableProps) {\n  if (debug) {\n    let p = manageableProps;\n    return (name, update) => {\n      if (update) {\n        p = update;\n        return;\n      }\n\n      if (!(name in p)) {\n        throw new Error(`Invalid prop named ${name}`);\n      }\n\n      return p[name];\n    };\n  }\n\n  return (name) => propSpecs[name][0];\n}\n\nexport function objectIdentifier(getContainer, getObject) {\n  let cacheInput;\n  let cacheOutput;\n  return (...args) => {\n    const object = getObject(...args);\n    if (object === cacheInput) {\n      return cacheOutput;\n    }\n\n    cacheInput = object;\n\n    if (!object) {\n      cacheOutput = object;\n      return cacheOutput;\n    }\n\n    if (typeof object === \"object\" && object.name) {\n      cacheOutput = object.name;\n      return cacheOutput;\n    }\n\n    const container = getContainer(...args);\n    if (container && typeof container === \"object\") {\n      // eslint-disable-next-line guard-for-in, no-restricted-syntax\n      for (const key in container) {\n        const value = container[key];\n\n        if (value === object) {\n          cacheOutput = key;\n          return cacheOutput;\n        }\n      }\n    }\n\n    if (typeof object === \"object\" && object.texture && object.texture.key) {\n      cacheOutput = object.texture.key;\n      return cacheOutput;\n    }\n\n    cacheOutput = undefined;\n    return cacheOutput;\n  };\n}\n","let injected = false;\nexport function injectAddSpriteTimeScale(scene) {\n  if (injected) {\n    return;\n  }\n\n  // eslint-disable-next-line no-proto\n  const proto = scene.physics.add.__proto__;\n\n  const origAdd = proto.sprite;\n\n  proto.sprite = function(...args) {\n    const sprite = origAdd.call(this, ...args);\n    if (sprite && sprite.anims) {\n      sprite.anims.setTimeScale(sprite.scene.timeScale);\n      sprite.anims.ignoresScenePause = false;\n    }\n    return sprite;\n  };\n\n  injected = true;\n}\n","let injected = false;\nexport function injectAnimationUpdate(animation) {\n  if (injected || !animation) {\n    return injected;\n  }\n\n  // eslint-disable-next-line no-proto\n  const proto = animation.__proto__;\n\n  const origUpdate = proto.update;\n\n  proto.update = function(...args) {\n    if (this.parent.scene._paused.anims && !this.ignoresScenePause && (!this.currentAnim || !this.currentAnim.ignoresScenePause)) {\n      return;\n    }\n\n    return origUpdate.call(this, ...args);\n  };\n\n  injected = true;\n\n  return injected;\n}\n","import SimplexNoise from 'simplex-noise';\nimport prop from '../../props';\n\nconst noiseX = new SimplexNoise('X');\nconst noiseY = new SimplexNoise('Y');\nconst noiseT = new SimplexNoise('T');\n\nlet injected = false;\nexport function injectCameraShake(camera) {\n  if (injected || !camera) {\n    return injected;\n  }\n\n  // eslint-disable-next-line no-proto\n  const proto = camera.__proto__;\n\n  const origPreRender = proto.preRender;\n\n  proto.preRender = function(...args) {\n    origPreRender.call(this, ...args);\n\n    if (prop('scene.trauma.legacy') || !prop('scene.trauma.enabled')) {\n      return;\n    }\n\n    const {width, height, scene} = this;\n    const {\n      _traumaShake, time, timeScale, _traumaStart,\n    } = scene;\n    const {now} = time;\n\n    if (!_traumaShake) {\n      return;\n    }\n\n    const delta = now - _traumaStart;\n    const t = delta * prop('scene.trauma.speed') / timeScale ** 2;\n    const easeIn = Math.min(1, delta / (prop('scene.trauma.easeIn') * timeScale));\n\n    const dx = easeIn * _traumaShake * prop('scene.trauma.dx') * noiseX.noise2D(_traumaStart, t);\n    const dy = easeIn * _traumaShake * prop('scene.trauma.dy') * noiseY.noise2D(_traumaStart, t);\n    const dt = easeIn * _traumaShake * prop('scene.trauma.dt') * noiseT.noise2D(_traumaStart, t);\n\n    const halfWidth = width / 2;\n    const halfHeight = height / 2;\n\n    // rotate about the center\n    this.matrix.translate(halfWidth, halfHeight);\n    this.matrix.rotate(dt);\n    this.matrix.translate(-halfWidth, -halfHeight);\n\n    this.matrix.translate(dx, dy);\n  };\n\n  injected = true;\n\n  return injected;\n}\n","module.exports = __webpack_public_path__ + \"static/media/maps.8b4011d1.txt\";","// This file is automatically generated by asset scripts in scripts/\n\nimport dot from \"./dot.png\";\nimport hpbar from \"./hpbar.png\";\nimport player from \"./player.png\";\nimport translucent from \"./translucent.png\";\nimport solid from \"./solid.png\";\nimport crumble from \"./crumble.png\";\nimport button from \"./button.png\";\nimport drawbridge from \"./drawbridge.png\";\nimport drawbridgeAlt from \"./drawbridgeAlt.png\";\nimport smoke from \"./smoke.png\";\nimport bead from \"./bead.png\";\nimport spinner from \"./spinner.png\";\nimport a from \"./a.mp3\";\nimport b from \"./b.mp3\";\nimport c from \"./c.mp3\";\nimport d from \"./d.mp3\";\nimport explode from \"./explode.wav\";\nimport jump1 from \"./jump1.wav\";\nimport jump2 from \"./jump2.wav\";\nimport jump3 from \"./jump3.wav\";\nimport land from \"./land.wav\";\nimport crisp from \"./crisp.wav\";\nimport night from \"./night.wav\";\nimport drawbridgeSound from \"./drawbridge.wav\";\nimport breaking from \"./break.wav\";\n\nexport const imageAssets = {\n  dot,\n  bead,\n  smoke,\n  hpbar,\n  button,\n  drawbridge,\n  drawbridgeAlt,\n  spinner,\n  translucent,\n  solid,\n};\n\nexport const spriteAssets = {\n  player: {\n    file: player,\n    frameWidth: 32,\n    frameHeight: 32,\n  },\n  crumble: {\n    file: crumble,\n    frameWidth: 2 + 24 * 3,\n    frameHeight: 24,\n  },\n};\n\nexport const musicAssets = {\n  a,\n  b,\n  c,\n  d,\n};\n\nexport const soundAssets = {\n  explode,\n  jump1,\n  jump2,\n  jump3,\n  land,\n  crisp,\n  night,\n  breaking,\n  drawbridge: drawbridgeSound,\n};\n","module.exports = __webpack_public_path__ + \"static/media/dot.4b22b40e.png\";","module.exports = __webpack_public_path__ + \"static/media/hpbar.043a32f4.png\";","module.exports = __webpack_public_path__ + \"static/media/player.4dbc163f.png\";","module.exports = __webpack_public_path__ + \"static/media/translucent.6e5072b6.png\";","module.exports = __webpack_public_path__ + \"static/media/solid.0160712b.png\";","module.exports = __webpack_public_path__ + \"static/media/crumble.667252ac.png\";","module.exports = __webpack_public_path__ + \"static/media/button.ce98be2b.png\";","module.exports = __webpack_public_path__ + \"static/media/drawbridge.47b5b6a3.png\";","module.exports = __webpack_public_path__ + \"static/media/drawbridgeAlt.46940f8e.png\";","module.exports = __webpack_public_path__ + \"static/media/smoke.ed2b177b.png\";","module.exports = __webpack_public_path__ + \"static/media/bead.c1362c20.png\";","module.exports = __webpack_public_path__ + \"static/media/spinner.4f869c95.png\";","module.exports = __webpack_public_path__ + \"static/media/a.b1ad1e13.mp3\";","module.exports = __webpack_public_path__ + \"static/media/b.7ebbb69e.mp3\";","module.exports = __webpack_public_path__ + \"static/media/c.09259550.mp3\";","module.exports = __webpack_public_path__ + \"static/media/d.85b63039.mp3\";","module.exports = __webpack_public_path__ + \"static/media/explode.0b012912.wav\";","module.exports = __webpack_public_path__ + \"static/media/jump1.e14ce3ec.wav\";","module.exports = __webpack_public_path__ + \"static/media/jump2.c834a042.wav\";","module.exports = __webpack_public_path__ + \"static/media/jump3.437195c5.wav\";","module.exports = __webpack_public_path__ + \"static/media/land.83a53280.wav\";","module.exports = __webpack_public_path__ + \"static/media/crisp.e9aff6f1.wav\";","import {tweenEases} from './tweens';\n\nexport const transitionAnimations = [\n  'fadeInOut',\n  'crossFade',\n\n  'pushLeft',\n  'pushRight',\n  'pushUp',\n  'pushDown',\n\n  'wipeLeft',\n  'wipeRight',\n  'wipeUp',\n  'wipeDown',\n];\n\nexport const transitionPauses = [\n  'nothing',\n  'input',\n  'physics',\n  'everything',\n];\n\nexport const transitionPauseTimes = [\n  'begin',\n  'delayEnd',\n  'cutover',\n  'complete',\n  'waitEnd',\n];\n\nexport const defaultTransitionProps = {\n  animation: ['fadeInOut', transitionAnimations],\n\n  delay_enabled: [true],\n  delay: [0, 0, 10000],\n  duration: [1000, 0, 10000],\n  ease: ['Linear', tweenEases],\n  wait_enabled: [true],\n  wait: [0, 0, 10000],\n\n  oldPause: ['input', transitionPauses],\n  oldPauseTime: ['begin', transitionPauseTimes.filter((t) => t !== 'waitEnd')],\n  newPause: ['input', transitionPauses],\n  newUnpauseTime: ['waitEnd', transitionPauseTimes],\n\n  delayNewSceneShader: [false],\n  removeOldSceneShader: [false],\n  suppressShaderCheck: [false],\n\n  animated: [true],\n};\n\nexport const baseTransitionProps = {};\nObject.entries(defaultTransitionProps).forEach(([key, [value]]) => {\n  baseTransitionProps[key] = value;\n});\n\nexport function expandTransitionProps(props) {\n  Object.entries(props).forEach(([name, spec]) => {\n    if (!name.endsWith('.transition')) {\n      return;\n    }\n\n    const prefix = name.substr(0, name.length - '.transition'.length);\n\n    if (!Array.isArray(spec) || spec.length !== 1 || typeof spec[0] !== 'object') {\n      throw new Error(`Expected ${name} prop to have the shape [{}]; did you mean to end it in .transition?`);\n    }\n\n    delete props[name];\n\n    const [config] = spec;\n\n    const seen = {...config};\n\n    Object.entries(defaultTransitionProps).forEach(([key, value]) => {\n      if (key in config) {\n        props[`${prefix}.${key}`] = [config[key], ...value.slice(1)];\n        delete seen[key];\n      } else if (key.endsWith('_enabled')) {\n        const targetKey = key.substr(0, key.length - '_enabled'.length);\n        props[`${prefix}.${key}`] = [targetKey in config];\n      } else {\n        props[`${prefix}.${key}`] = value;\n      }\n    });\n\n    props[`${prefix}.execute`] = [(scene, game) => {\n      scene.replaceWithSelf(false, null, prefix);\n    }];\n\n    if (Object.keys(seen).length) {\n      throw new Error(`Got unexpected transition config settings: ${Object.keys(seen).join(', ')}`);\n    }\n  });\n}\n\nexport default function massageTransitionProps(props, options) {\n  const {massageProps} = props;\n\n  delete props.massageProps;\n\n  Object.entries(props).forEach(([key, config]) => {\n    if (key.endsWith('_enabled')) {\n      const main = key.substr(0, key.length - '_enabled'.length);\n      if (!config && !options[main]) {\n        delete props[main];\n      }\n      delete props[key];\n    }\n  });\n\n  if (massageProps) {\n    massageProps(props);\n  }\n\n  if ('animated' in props && !props.animated) {\n    props.duration = 0;\n  }\n  delete props.animated;\n\n  return props;\n}\n\nexport function applyPause(scene, transition, type) {\n  if (type === 'nothing') {\n    return () => {};\n  } else if (type === 'input') {\n    scene.pauseInputForTransition(transition);\n    return () => {\n      scene.unpauseInputForTransition(transition);\n    };\n  } else if (type === 'physics') {\n    scene.pausePhysicsForTransition(transition);\n    return () => {\n      scene.unpausePhysicsForTransition(transition);\n    };\n  } else if (type === 'everything') {\n    scene.pauseEverythingForTransition(transition);\n    return () => {\n      scene.unpauseEverythingForTransition(transition);\n    };\n  } else {\n    // eslint-disable-next-line no-console\n    console.error(`Invalid transition pause '${type}'`);\n    return () => {};\n  }\n}\n","module.exports = __webpack_public_path__ + \"static/media/night.91eec8db.wav\";","module.exports = __webpack_public_path__ + \"static/media/drawbridge.66a092f2.wav\";","module.exports = __webpack_public_path__ + \"static/media/break.c2acd27f.wav\";","const loaderMethod = {\n  imageAssets: 'image',\n  spriteAssets: 'spritesheet',\n  musicAssets: 'audio',\n  soundAssets: 'audio',\n};\n\nconst unloadFunction = {\n  imageAssets: (scene, key) => {\n    scene.load.textureManager.remove(key);\n  },\n  musicAssets: (scene, key) => {\n    scene.cache.audio.remove(key);\n  },\n};\n\nunloadFunction.spriteAssets = unloadFunction.imageAssets;\nunloadFunction.soundAssets = unloadFunction.musicAssets;\n\nfunction massageInput(type, game, input) {\n  if (type === 'spriteAssets') {\n    if (typeof input === 'string') {\n      const {spriteWidth, spriteHeight} = game.config;\n      if (spriteWidth && spriteHeight) {\n        return [input, {frameWidth: spriteWidth, frameHeight: spriteHeight}];\n      }\n\n      const {tileWidth, tileHeight} = game.config;\n      return [input, {frameWidth: tileWidth, frameHeight: tileHeight}];\n    } else {\n      const {file} = input;\n      return [file, input];\n    }\n  }\n\n  return [input];\n}\n\nexport function loadAsset(scene, type, key, input) {\n  const {game} = scene;\n  const method = loaderMethod[type];\n\n  const params = massageInput(type, game, input);\n\n  scene.load[method](key, ...params);\n\n  game.assets[type][key] = input;\n}\n\nexport function preloadAssets(scene, assets) {\n  const {game} = scene;\n\n  Object.entries(assets).forEach(([type, entries]) => {\n    if (!loaderMethod[type]) {\n      // eslint-disable-next-line no-console\n      console.error(`No loader for assets of type ${type}`);\n      return;\n    }\n\n    if (!game.assets[type]) {\n      game.assets[type] = {};\n    }\n\n    Object.entries(entries).forEach(([key, input]) => {\n      loadAsset(scene, type, key, input);\n    });\n  });\n}\n\nlet isLoading = false;\nexport function assetReloader(scene) {\n  const {game} = scene;\n\n  if (isLoading) {\n    throw new Error('assetReloader does not yet support concurrency');\n  }\n  isLoading = true;\n\n  const assets = {\n  };\n\n  const typeForKey = {\n  };\n\n  // eslint-disable-next-line no-proto\n  const proto = scene.load.__proto__;\n\n  const origKeyExists = proto.keyExists;\n  proto.keyExists = () => false;\n\n  const origFileProcessComplete = proto.fileProcessComplete;\n  proto.fileProcessComplete = (file) => {\n    const type = typeForKey[file.key];\n    unloadFunction[type](scene, file.key);\n    return origFileProcessComplete.call(scene.load, file);\n  };\n\n  const reload = (type, key, value, isNew) => {\n    if (!assets[type]) {\n      assets[type] = {};\n    }\n\n    typeForKey[key] = type;\n    assets[type][key] = undefined;\n    loadAsset(scene, type, key, value);\n  };\n\n  const remove = (type, key) => {\n    if (!assets[type]) {\n      assets[type] = {};\n    }\n\n    typeForKey[key] = type;\n    assets[type][key] = null;\n    unloadFunction[type](scene, key);\n    delete game.assets[type][key];\n  };\n\n  const done = (...args) => {\n    scene.load.on('filecomplete', (key, _, object) => {\n      const type = typeForKey[key];\n\n      if (!assets[type]) {\n        assets[type] = {};\n      }\n\n      assets[type][key] = object;\n    });\n\n    let completeResolve;\n    scene.load.on('complete', () => {\n      if (completeResolve) {\n        completeResolve();\n      }\n    });\n\n    const promise = new Promise((resolve, reject) => {\n      completeResolve = () => {\n        completeResolve = null;\n\n        proto.keyExists = origKeyExists;\n        proto.fileProcessComplete = origFileProcessComplete;\n\n        isLoading = false;\n\n        resolve([assets, ...args]);\n      };\n    });\n\n    scene.load.start();\n\n    // we didn't load anything\n    if (scene.load.isReady()) {\n      if (completeResolve) {\n        completeResolve();\n      }\n    }\n\n    return promise;\n  };\n\n  return [reload, remove, done];\n}\n\nexport function reloadAssets(scene, assets) {\n  const {game} = scene;\n  const [reloadAsset, removeAsset, startReload] = assetReloader(scene);\n  const changesByType = {};\n\n  ['imageAssets', 'spriteAssets', 'musicAssets', 'soundAssets'].forEach((type) => {\n    const gameAssets = game.assets[type];\n    const leftover = {...gameAssets};\n    const changes = changesByType[type] = [];\n\n    Object.entries(assets[type]).forEach(([key, value]) => {\n      if (!gameAssets[key]) {\n        changes.push(`+${key}`);\n        reloadAsset(type, key, value, true);\n      } else {\n        delete leftover[key];\n\n        if (JSON.stringify(gameAssets[key]) === JSON.stringify(value)) {\n          return;\n        }\n\n        changes.push(`${key}`);\n        reloadAsset(type, key, value, false);\n      }\n    });\n\n    Object.entries(leftover).forEach(([key, value]) => {\n      changes.push(`-${key}`);\n      removeAsset(type, key);\n    });\n  });\n\n  return startReload(changesByType);\n}\n","module.exports = __webpack_public_path__ + \"static/media/cover.eac6fbb9.png\";","module.exports = __webpack_public_path__ + \"static/media/twitchLogo.754c9f3b.png\";","module.exports = __webpack_public_path__ + \"static/media/twitterLogo.5ee804a1.png\";","export const builtinCoordFragments = [\n  ['shockwave', {\n    time: ['float', 0, null],\n    center: ['vec2', [0.5, 0.5], null],\n    scale: ['float', 10.0, 0, 500],\n    range: ['float', 0.8, 0, 10],\n    thickness: ['float', 0.1, 0, 10],\n    speed: ['float', 3.0, 0, 50],\n    inner: ['float', 0.09, 0, 1],\n    dropoff: ['float', 40.0, 0, 500],\n  }, `\n      float shockwave_dt = (scene_time - shockwave_time) / 3333.0;\n      if (shockwave_time > 0.0 && shockwave_dt < 10.0) {\n        float dist = distance(uv, shockwave_center - camera_scroll);\n        float t = shockwave_dt * shockwave_speed;\n        if (dist <= t + shockwave_thickness && dist >= t - shockwave_thickness && dist >= shockwave_inner) {\n          float diff = dist - t;\n          float scaleDiff = 1.0 - pow(abs(diff * shockwave_scale), shockwave_range);\n          float diffTime = diff * scaleDiff;\n          vec2 diffTexCoord = normalize(uv - (shockwave_center - camera_scroll));\n          uv += (diffTexCoord * diffTime) / (t * dist * shockwave_dropoff);\n        }\n      }\n  `],\n];\n\nexport const builtinColorFragments = [\n  ['blur', {\n    amount: ['float', 0, null],\n  }, `\n      if (blur_amount > 0.0) {\n        float b = blur_amount / resolution.x;\n        c *= 0.2270270270;\n        c += texture2D(uMainSampler, vec2(uv.x - 4.0*b, uv.y - 4.0*b)) * 0.0162162162;\n        c += texture2D(uMainSampler, vec2(uv.x - 3.0*b, uv.y - 3.0*b)) * 0.0540540541;\n        c += texture2D(uMainSampler, vec2(uv.x - 2.0*b, uv.y - 2.0*b)) * 0.1216216216;\n        c += texture2D(uMainSampler, vec2(uv.x - 1.0*b, uv.y - 1.0*b)) * 0.1945945946;\n        c += texture2D(uMainSampler, vec2(uv.x + 1.0*b, uv.y + 1.0*b)) * 0.1945945946;\n        c += texture2D(uMainSampler, vec2(uv.x + 2.0*b, uv.y + 2.0*b)) * 0.1216216216;\n        c += texture2D(uMainSampler, vec2(uv.x + 3.0*b, uv.y + 3.0*b)) * 0.0540540541;\n        c += texture2D(uMainSampler, vec2(uv.x + 4.0*b, uv.y + 4.0*b)) * 0.0162162162;\n      }\n  `],\n\n  ['aberration', {\n    red: ['vec2', [0, 0], null],\n    green: ['vec2', [0, 0], null],\n    blue: ['vec2', [0, 0], null],\n  }, `\n    c.r += texture2D(uMainSampler, vec2(uv.x - aberration_red.x, uv.y - aberration_red.y)).r;\n    c.r -= texture2D(uMainSampler, vec2(uv.x + aberration_red.x, uv.y + aberration_red.y)).r;\n\n    c.g += texture2D(uMainSampler, vec2(uv.x - aberration_green.x, uv.y - aberration_green.y)).g;\n    c.g -= texture2D(uMainSampler, vec2(uv.x + aberration_green.x, uv.y + aberration_green.y)).g;\n\n    c.b += texture2D(uMainSampler, vec2(uv.x - aberration_blue.x, uv.y - aberration_blue.y)).b;\n    c.b -= texture2D(uMainSampler, vec2(uv.x + aberration_blue.x, uv.y + aberration_blue.y)).b;\n  `],\n\n  ['tint', {\n    color: ['rgba', [1, 1, 1, 1]],\n  }, `\n      c.r *= tint_color.r * tint_color.a;\n      c.g *= tint_color.g * tint_color.a;\n      c.b *= tint_color.b * tint_color.a;\n  `],\n];\n\nexport const shaderTypeMeta = {\n  float: [1, 'float', 'setFloat1'],\n  bool: [1, 'float', 'setFloat1'],\n  vec2: [2, 'vec2', 'setFloat2v', 'x', 'y'],\n  vec3: [3, 'vec3', 'setFloat3v', 'x', 'y', 'z'],\n  vec4: [4, 'vec4', 'setFloat4v', 'x', 'y', 'z', 'w'],\n  rgb: [3, 'vec3', 'setFloat3v', 'r', 'g', 'b'],\n  rgba: [4, 'vec4', 'setFloat4v', 'r', 'g', 'b', 'a'],\n};\n\nexport function propNamesForUniform(fragmentName, uniformName, spec) {\n  let [type] = spec;\n\n  if (!type) {\n    type = 'float';\n  }\n\n  const [count, , , ...subvariables] = shaderTypeMeta[type];\n\n  if (type === 'rgb') {\n    let sub = '';\n    if (!uniformName.match(/color$/i)) {\n      sub = '_color';\n    }\n\n    return [`shader.${fragmentName}.${uniformName}${sub}`];\n  } else if (type === 'rgba') {\n    return [\n      `shader.${fragmentName}.${uniformName}_color`,\n      `shader.${fragmentName}.${uniformName}_alpha`,\n    ];\n  } else if (count === 1) {\n    return [`shader.${fragmentName}.${uniformName}`];\n  } else {\n    return subvariables.map((sub, i) => {\n      return `shader.${fragmentName}.${uniformName}_${sub}`;\n    });\n  }\n}\n\nfunction injectBuiltinFragment(fragments, isCoord) {\n  let primary = builtinColorFragments;\n  let secondary = builtinCoordFragments;\n  let primaryName = 'shaderColorFragments';\n  let secondaryName = 'shaderCoordFragments';\n\n  if (!fragments) {\n    return [];\n  }\n\n  if (isCoord) {\n    [primary, secondary] = [secondary, primary];\n    [primaryName, secondaryName] = [secondaryName, primaryName];\n  }\n\n  if (fragments.length === 0) {\n    fragments.push(...primary);\n    return;\n  }\n\n  for (let i = 0; i < fragments.length; i += 1) {\n    if (typeof fragments[i] === 'string') {\n      const name = fragments[i];\n      const replacement = primary.find(([p]) => name === p);\n      if (replacement) {\n        fragments[i] = replacement;\n      } else {\n        // eslint-disable-next-line no-console\n        console.error(`Unable to find builtin ${primaryName} '${name}'; available are: ${primary.map(([p]) => p).join(', ')}`);\n\n        const suggestion = secondary.find(([p]) => name === p);\n        if (suggestion) {\n          // eslint-disable-next-line no-console\n          console.error(`Perhaps you meant the builtin ${secondaryName} '${name}'?`);\n        }\n\n        fragments.splice(i, 1);\n        i -= 1;\n      }\n    }\n  }\n}\n\nexport function shaderProps(coordFragments, colorFragments) {\n  const props = {};\n\n  injectBuiltinFragment(coordFragments, true);\n  injectBuiltinFragment(colorFragments, false);\n\n  [...(coordFragments || []), ...(colorFragments || [])].forEach(([fragmentName, uniforms]) => {\n    props[`shader.${fragmentName}.enabled`] = [true, (value, scene, game) => game.recompileShaders()];\n\n    Object.entries(uniforms).forEach(([uniformName, spec]) => {\n      // eslint-disable-next-line prefer-const\n      let [type, ...config] = spec;\n\n      const name = `${fragmentName}_${uniformName}`;\n\n      if (!type) {\n        type = 'float';\n      }\n\n      if (!shaderTypeMeta[type]) {\n        throw new Error(`Unknown type ${type} for shader ${name}`);\n      }\n\n      const [count, , setter, ...subvariables] = shaderTypeMeta[type];\n\n      if (uniformName.match(/color$/i) && type !== 'rgb' && type !== 'rgba') {\n        throw new Error(`Shader uniform ${name} ends with /color$/i but it isn't using type rgb or rgba`);\n      }\n\n      if (type === 'rgb') {\n        if (config.length > 2\n            || config.length === 0\n            || !Array.isArray(config[0])\n            || config[0].length !== 3\n            || (config.length === 2 && config[1] !== null)) {\n          throw new Error(`Expected rgb shader uniform ${name} to have shape ['rgb', [0.95, 0.25, 0.5]] or ['rgb', [0.95, 0.25, 0.5], null]`);\n        }\n\n        let sub = '';\n        if (!uniformName.match(/color$/i)) {\n          sub = '_color';\n        }\n\n        if (config[1] === null) {\n          config.push((scene) => (scene[name] ? scene[name].map((c) => c * 255.0) : undefined));\n        } else {\n          config.push((_, scene, game) => {\n            if (!scene.shader) {\n              return;\n            }\n            const value = game.prop(`shader.${fragmentName}.${uniformName}${sub}`).map((c) => c / 255.0);\n            scene.shader[setter](name, value);\n          });\n        }\n\n        config[0] = config[0].map((c) => c * 255.0);\n        props[`shader.${fragmentName}.${uniformName}${sub}`] = config;\n      } else if (type === 'rgba') {\n        if (config.length > 2\n            || config.length === 0\n            || !Array.isArray(config[0])\n            || config[0].length !== 4\n            || (config.length === 2 && config[1] !== null)) {\n          throw new Error(`Expected rgbs shader uniform ${name} to have shape ['rgba', [0.95, 0.25, 0.5, 1]] or ['rgb', [0.95, 0.25, 0.5, 1], null]`);\n        }\n\n        const colorConfig = [config[0].filter((_, i) => i < 3)];\n        const alphaConfig = [config[0][3]];\n\n        if (config[1] === null) {\n          colorConfig.push(null);\n          alphaConfig.push(null);\n\n          colorConfig.push((scene) => (scene[name] ? scene[name].filter((_, i) => i < 3).map((c) => c * 255.0) : undefined));\n          alphaConfig.push((scene) => (scene[name] ? scene[name][3] : undefined));\n        } else {\n          alphaConfig.push(0, 1); // min and max\n\n          const cb = (value, scene, game) => {\n            if (!scene.shader) {\n              return;\n            }\n\n            scene.shader[setter](name, [\n              ...game.prop(`shader.${fragmentName}.${uniformName}_color`).map((c) => c / 255.0),\n              game.prop(`shader.${fragmentName}.${uniformName}_alpha`),\n            ]);\n          };\n          colorConfig.push(cb);\n          alphaConfig.push(cb);\n        }\n\n        colorConfig[0] = colorConfig[0].map((c) => c * 255.0);\n        props[`shader.${fragmentName}.${uniformName}_color`] = colorConfig;\n        props[`shader.${fragmentName}.${uniformName}_alpha`] = alphaConfig;\n      } else if (type === 'bool') {\n        if (config[1] === null) {\n          config.push((scene) => scene[name]);\n        } else if (typeof config[config.length - 1] !== 'function') {\n          config.push((value, scene) => scene.shader && scene.shader[setter](name, value ? 1.0 : 0.0));\n        }\n\n        props[`shader.${fragmentName}.${uniformName}`] = config;\n      } else if (count === 1) {\n        if (config[1] === null) {\n          config.push((scene) => scene[name]);\n        } else if (typeof config[config.length - 1] !== 'function') {\n          config.push((value, scene) => scene.shader && scene.shader[setter](name, value));\n        }\n\n        if (config[0] === 0 && config[1] === null) {\n          config[0] = 0.1;\n        }\n\n        props[`shader.${fragmentName}.${uniformName}`] = config;\n      } else {\n        subvariables.forEach((sub, i) => {\n          const c = [...config];\n          c[0] = c[0][i];\n\n          if (c[1] === null) {\n            c.push((scene) => (scene[name] ? scene[name][i] : undefined));\n          } else if (typeof c[c.length - 1] !== 'function') {\n            c.push((_, scene, game) => {\n              if (!scene.shader) {\n                return;\n              }\n\n              const value = subvariables.map((s) => game.prop(`shader.${fragmentName}.${uniformName}_${s}`));\n              scene.shader[setter](name, value);\n            });\n          }\n\n          if (c[0] === 0 && c[1] === null) {\n            c[0] = 0.1;\n          }\n\n          props[`shader.${fragmentName}.${uniformName}_${sub}`] = c;\n        });\n      }\n    });\n  });\n\n  return props;\n}\n"],"sourceRoot":""}