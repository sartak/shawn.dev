{"version":3,"sources":["scaffolding/lib/store.js","scaffolding/lib/particles.js","scaffolding/Spinner.jsx","scaffolding/Controls.jsx","scaffolding/boot-scene.js","scaffolding/lib/analytics.js","scaffolding/CommandManager.js","scaffolding/SuperGame.js","vector.js","play-scene.js","game.js","scaffolding/Engine.jsx","scaffolding/Manage.jsx","scaffolding/DoubleEnder.jsx","scaffolding/Replay.jsx","scaffolding/Logging.jsx","scaffolding/Development.jsx","scaffolding/Production.jsx","scaffolding/Embed.jsx","scaffolding/App.jsx","scaffolding/index.jsx","scaffolding/SuperScene.js","scaffolding/lib/level-parser.js","props.js","scaffolding/lib/tweens.js","scaffolding/lib/manage-gui.js","scaffolding/lib/props.js","scaffolding/lib/sprites.js","scaffolding/lib/anims.js","assets/maps.txt","assets/index.js","assets/image/background.png","assets/image/cloud.png","assets/music/peace.mp3","assets/music/war.mp3","assets/music/win.mp3","assets/sound/border.wav","assets/sound/coopbreak.wav","assets/sound/coop.wav","assets/sound/dash.wav","assets/sound/dashfollower.wav","assets/sound/dashkill.wav","assets/sound/hit.wav","assets/sound/howl.wav","assets/sound/kill.wav","assets/sound/lose.wav","assets/sound/murder.wav","assets/sound/stun.wav","assets/sound/treasure.wav","assets/sound/win.wav","assets/sprite/enemyA.png","assets/sprite/farmer.png","assets/sprite/follower.png","assets/sprite/player.png","assets/tile/coop.png","assets/tile/grass.png","assets/tile/grassrock.png","assets/tile/treasure-closed.png","assets/tile/treasure-open.png","assets/tile/wall.png","scaffolding/lib/assets.js","assets/cover.png","scaffolding/twitchLogo.png","scaffolding/twitterLogo.png","scaffolding/lib/transitions.js","scaffolding/lib/shaders.js"],"names":["__webpack_require__","d","__webpack_exports__","freezeStorage","saveField","removeAllFields","loadField","_package_json__WEBPACK_IMPORTED_MODULE_0__","prefix","concat","project","frozen","name","value","payload","JSON","stringify","localStorage","setItem","e","console","error","subprefix","arguments","length","undefined","Object","keys","forEach","key","startsWith","removeItem","defaultValue","getItem","parse","ParticleProps","particlePropFromProp","prop","find","p","injectedEmitterOpSeededRandom","injectEmitterOpSeededRandom","emitter","seed","rnd","Phaser","Math","RandomDataGenerator","proto","delay","__proto__","randomStaticValueEmit","particle","randomIndex","floor","frac","this","propertyValue","randomRangedValueEmit","realInRange","start","end","data","min","injectedParticleEmitterManagerPreUpdate","injectParticleEmitterManagerPreUpdate","manager","preUpdate","time","origDelta","isPaused","scene","_paused","particles","delta","timeScale","emitters","list","i","ignoresScenePause","updatesOnceOnPause","active","defaultParticleProps","image","frequency","lifespan","accelerationX","accelerationY","alpha","blendMode","maxParticles","particleBringToTop","quantity","radial","rotate","scaleX","scaleY","speed","speedX","speedY","tint","tint_enabled","x","y","visible","preemit","preemitOnReload","expandParticleProps","props","particleImages","entries","_ref","_ref2","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__","spec","endsWith","Error","substr","Array","isArray","push","config","seen","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__","_ref3","_ref4","propKey","replace","options","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_1__","slice","targetKey","join","massageParticleProps","_ref5","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__","massageProps","onAdd","tintColor_enabled","tintColor","PI","Spinner","react_default","a","createElement","id","className","React","Component","Controls","_this$props","onMouseMove","volume","onVolumeChange","disableFullscreen","isFullscreen","enterFullscreen","exitFullscreen","style","fontSize","transform","type","max","onChange","target","onMouseUp","blur","onClick","BootScene","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","_this","get","prototype","game","preloadScenes","sceneClass","preload","_this2","initializeMainShaders","setTimeout","preloadComplete","SuperScene","debug","process","analytics","event","event_category","window","gtag","apply","GamepadButtons","LEFT","RIGHT","UP","DOWN","A","Y","X","B","L1","L2","R1","R2","ButtonName","CommandManager","_spec","_scenes","Map","keyboard","gamepad","pointerEvents","executedProps","_ignoreAlls","held","heldFrames","started","continued","heldDuration","releasedFrames","released","releasedDuration","state","inputs","ignoreAlls","objectSpread","_this3","toConsumableArray","values","suppressRepeatFrames","set","commands","tickCount","delete","code","_this4","input","on","tag","document","activeElement","tagName","toLowerCase","altKey","ctrlKey","metaKey","shiftKey","preventDefault","_this5","commandKeys","attachKey","button","buttonName","index","slicedToArray","method","canvas","querySelector","pointer","contains","scenes","seenGamepad","rawGamepad","total","LSTICKX","LSTICKY","RSTICKX","RSTICKY","gamepads","filter","pad","rawPad","leftStick","rightStick","abs","onlyUnignorable","_this6","frame","_repeat","_ref6","unignorable","path","keyHeld","_","_pointer","_executedProps","_this7","_ref7","_ref8","unreplayable","_this8","_ref9","_ref10","prevFrame","isSame","pop","newValue","ignoreAny","ignore","dt","_this9","ignoreAll","_ref11","_ref12","command","execute","scenePath","gamePath","handlePointerEvent","replay","propName","fn","replayFrameIndex","replayTicks","postflightCutoff","endedReplay","replayRepeatRun","replayFrame","heldCommands","mergeUnignorable","getManager","timeSightFrozen","processCommands","injectReplayFrame","addFrameToList","recording","originalPreflightCutoff","preflightCutoff","replayOptions","startTick","onEnd","onStop","next","prev","updateSpecFromReload","updateInputsFromReload","addCommands","removeCommands","updateCommands","_ref13","_ref14","prevJson","_ref15","_ref16","String","nextJson","_ref17","_ref18","changes","info","isKeyboard","_this10","nextKeys","prevKeys","keyLister","gamepadKeys","addKeys","removeKeys","managerList","detachKey","baseConfig","AUTO","parent","width","height","tileWidth","tileHeight","SuperGame","subConfig","add","Date","now","sceneId","random","scale","onFullScreenChange","_replayPreflight","_onDisableDebugUI","_sceneInitCallbacks","assets","_shaderSource","_shaderCoordFragments","shaderCoordFragments","_shaderColorFragments","shaderColorFragments","shaderFragments","focused","_sceneConstructors","assertThisInitialized","Proxy","topScene","events","readRawInput","disableDebug","_replay","timeSight","updatePropsFromStep","begin","getTime","newVolume","currentMusicPlayer","setVolume","changeVolume","isFocused","spinner","getElementById","parentNode","removeChild","_preloadedAssets","tryLaunch","callback","_activatedGame","_launchedGame","_launchingGame","warn","renderer","CANVAS","alert","cover","remove","launch","willTransitionFrom","timer","didTransitionFrom","manage","log","stopRecording","stopReplay","destroy","engine","disableDebugUI","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen","number","zeros","n","o","date","zero","zeroPrefix","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","duration","m","s","toFixed","_recording","timestamp","initData","settings","sceneName","constructor","renderDateTime","commandState","freezeCommandState","beginRecording","snapshot","onRecordBegin","onRecordStop","startFromTransition","sceneTransitions","transitionToSceneToBeginReplay","then","newScene","beginReplay","onReplayBegin","oldScene","sceneKey","sceneSaveState","save","returnPromise","Promise","resolve","reject","onSceneInit","thawCommandState","_sceneTransition","transition","onReplayEnd","skipDownward","onReplayStop","forceRestart","currentMusicName","music","sound","play","loop","readRawGamepad","cutoffTimeSightEnter","cutoffTimeSightChanged","cutoffTimeSightLeave","shaderName","WEBGL","getPipeline","hasPipeline","source","generateShaderSource","shader","shaderInstantiation","removePipeline","addPipeline","setFloat2","initializeShader","nextCoord","nextColor","recompileMainShaders","_map","map","fragments","_map2","shaderCoordSource","shaderColorSource","uniformNames","uniformDeclarations","fragmentName","uniforms","uniformName","uniformType","shaderTypeMeta","userShaderMain","generateShaderSourceInternal","regex","RegExp","match","oldSource","newSource","shaderInstance","_shaderInitialize","_shaderUpdate","camera","setPipeline","clearRenderToTexture","recompileShader","disableShader","fragShader","Class","Extends","Renderer","WebGL","Pipelines","TextureTintPipeline","initialize","cb","Game","Distance","dx","dy","sqrt","pow","NormalizeVector","TowardCentroid","os","tx","ty","AvoidObjects","r","count","AvoidObject","_NormalizeVectorWithD","NormalizeVectorWithDistance","_NormalizeVectorWithD2","ClosestObject","PlayScene","physics","arcade","fps","performanceProps","mapsAreRectangular","createdAt","levelId","wonLevel","xBorder","yBorder","levelPlayer","player","loadLevel","flock_amount","saveState","defer","level","treasureGroup","staticGroup","mapLookups","$","tile","shake","playSound","_this$positionToScree","positionToScreenCoordinate","_this$positionToScree2","xCoord","yCoord","treasure","create","collected","setTexture","speak","treasureScript","blockades","createUnderground","underground","createMap","closeExits","createPlayer","followers","createFollowers","enemies","createEnemies","boundary","createBoundary","createTreasure","setupPhysics","scripts","script","glyph","night_amount","old_night_amount","old_flock_amount","tweenNightAmount","initialNight","tweenFlockAmount","groupName","object","group","groups","above","rectangle","objects","isCircle","setCircle","template","setPosition","tileDefinitions","isStatic","tiles","brickwork","left","right","up","down","row","g","_this2$positionToScre","_this2$positionToScre2","widthInTiles","heightInTiles","createTileForGroup","axis","direction","t","sort","b","gs","last","gg","first","w","h","wall","isWall","levelWidth","levelHeight","bw","border","_this$positionToScree3","_this$positionToScree4","transitionOffset","sprite","body","setMass","setBounce","setDrag","setMaxVelocity","setDamping","setFriction","setSize","dash","cooldown","ax","ay","stun","children","cameraFollow","followerGroup","mass","bounce","drag","friction","maxVelocity","_this4$positionToScre","_this4$positionToScre2","follower","targetMaxVelocity","isFollower","followerCount","enemyGroup","enemy","_this5$positionToScre","_this5$positionToScre2","isEnemy","anims","frames","frameRate","repeat","overlap","enteredTransition","collider","rock","farmer","coop","playerCollideCoop","playerCollideFollower","playerKillEnemy","collectTreasure","justCoolItDown","enemyCollideCoop","enemyKillFollower","damager","fx","fy","health","reduction","prevFactor","tweenPercent","factor","damageCoop","setAcceleration","stopDash","buttobasu","killFollower","zoomTo","zoomForLossCompleted","zoomedForLoss","unzoomForLoss","impact","entity","disableBody","_NormalizeVector","_NormalizeVector2","ex","ey","_NormalizeVector3","_NormalizeVector4","isNaN","sleep","impactUnlessLosing","tween","rotation","ease","onComplete","killer","victim","_NormalizeVector5","_NormalizeVector6","stunAlpha","stunRotate","stunRecover","fakeStun","f","lastFollower","butsu","winLevel","animated","forward","_this11","extraDelay","enable","block","_this12","enableBody","playMusic","glowEmitter","stop","openExits","replacing","replaceWithSelf","onUpdate","transitioning","_transition$tile","animation","playerConfig","oldX","oldY","newX","newY","nextLevel","progress","normalVelocity","dashEmitter","_this13","onDash","dashCallback","_NormalizeVector7","_NormalizeVector8","dashVelocity","particleSystem","tweenSustainExclusive","v","c","_this14","onStun","px","py","shockwave","distance","effect","stickInput","lstick","_command$lstick$held","rstick","_command$rstick$held","_NormalizeVector9","_NormalizeVector10","accel","lastAccel","_player$lastAccel","_this15","played","_script","radius","shift","_this16","processInput","flockFollowers","flockEnemies","zoomOnLoss","updateVelocities","moveChildren","playDialog","spawningEnemies","suppressShit","amount","_this17","_this18","lines","_this19","defaults","inTime","outTime","noOut","line","_defaults","text","goof","_execute","toArray","args","label","fontFamily","fontWeight","color","_this20","replaceLostLevel","minDistance","isSafe","_ClosestObject","_ClosestObject2","effectiveDistance","losing","unzoomStartTimer","pan","useBounds","originTimeScale","unzoomTimeScaleTween","_min","pauseEverythingForTransition","panDuration","zoomDuration","setDeadzone","unpauseEverythingForTransition","followerLerp","enemyLerp","overlapRect","gameObject","isObstacle","isCoop","subgroup","_this21","acceleration","cohereRadius","cohereFactor","spreadRadius","spreadFactor","playerFactor","playerRadius","obstacleFactor","obstacleRadius","enemyFactor","enemyRadius","killerFactor","killerRadius","killerAcceleration","killerVelocity","sg","hasFocus","targetX","targetY","fs","followersNearPoint","_TowardCentroid","_TowardCentroid2","obstaclesNearPoint","es","enemiesNearPoint","_min2","AvoidClosestObject","theta","atan2","cos","sin","_this22","avoidPlayerFactor","avoidPlayerRadius","seekPlayerFactor","seekPlayerRadius","followerFactor","followerRadius","victimFactor","victimRadius","victimAcceleration","victimVelocity","_TowardCentroid3","_TowardCentroid4","noncoopObstaclesNearPoint","_min3","_min4","SeekClosestObject","willTransition","phantomDt","isLast","scrollX","scrollY","setVelocity","delayNewSceneShader","removeOldSceneShader","Engine","didVisibilityChange","hidden","visibilityState","setState","setFocused","didBlur","didFocus","activating","activated","controls","createRef","loadedGame","addEventListener","classList","activateGame","removeEventListener","moveTimeout","clearTimeout","clearMove","instant","current","overflow","resizeHandler","_this6$game$config","innerWidth","innerHeight","fullscreenHandler","requestFullscreen","mozRequestFullScreen","webkitRequestFullScreen","msRequestFullscreen","skipBrowserFullscreen","moveHandler","_this$state","classes","ref","container","gameContainerRef","backgroundImage","Spinner_Spinner","Controls_Controls","Manage","search","gui","initializeManage","append","domElement","updateSearch","tempNode","serializeChangedProps","appendChild","select","execCommand","placeholder","isStarted","copyChangedProps","resetChangedProps","semiFloor","semiCeil","ceil","DoubleEnder","didResize","forceUpdate","dragging","lastDrag","trackRef","cursorRef","refreshDimensions","updateReplayCursor","updateCursor","replayTimestamp","trackWidth","getBoundingClientRect","cursorPercent","display","_this$props2","value1","value2","onChange1","onChange2","onMouseEnter","onMouseLeave","onBeginChange","onEndChange","notches","highlight1","highlight2","cursor","trackDimensions","trackLeft","percent1","percent2","highlightPercent1","highlightPercent2","title","isSelected","isHighlighted","percent","opposite","oppositeValue","zIndex","onMouseDown","originalX","clientX","_dragListener","rawValue","_upListener","ReplayEditFields","Replay","replays","preflight","reduce","cutoff","activeRecording","activeReplay","tweaking","editing","beginAutoReplay","installGameCallbacks","prevProps","_trashNextRecording","newReplays","setActiveReplay","clearOtherEditing","_replayLatestTransition","setEditing","_this4$state","skipFocus","saveReplays","newReplay","newState","updateReplay","latestTransition","firstTick","lastTick","onSubmit","finishEdit","autoFocus","editName","tweakReplay","copyReplay","deleteReplay","DoubleEnder_DoubleEnder","_inCutoffs","_changingCutoffs","editPreflightCutoff","postflight","editPostflightCutoff","editCutoffs","metadata","field","_objectSpread2","defineProperty","updateTweak","sawError","toString","discardTweaks","saveTweaks","visibility","revertTweak","renderTweaking","Fragment","toggleRepeat","toggleTimeSight","trashRecording","renderEditReplay","Logging","recent","old","logId","Number","timers","original","component","_len","_key","context","extractContext","prependLog","onDisableDebugUI","removeLogging","msg","stack","originalMsg","scrollTop","newLog","Development","Engine_Engine","Logging_Logging","developmentDisplay","links","href","rel","Manage_Manage","Replay_Replay","Production","productionDisplay","displayName","authorName","authorURL","authorTwitter","src","twitterLogo","alt","authorTwitch","twitchLogo","eventDescription","eventNamePre","eventNameBold","eventNamePost","eventURL","themeDescription","themePre","themeItalic","themePost","repoURL","Embed","App","embed","Embed_Embed","Development_Development","Production_Production","hot","ReactDOM","render","scaffolding_App","subconfig","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_3__","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_5__","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_6__","sounds","performanceFrames","performanceAcceptable","scene_time","shockwave_time","tweens","attachScene","_timeSightTarget","cameras","main","setBackgroundColor","cameraColor","saveStateFieldName","initialSaveState","version","saveStateVersion","migrateSaveState","_initialSave","world","injectAddSpriteTimeScale","injectTweenManagerAdd","createDebugGraphic","fixedUpdate","systems","off","update","originalStep","step","originalDelta","_stepExceptions","isTopScene","updateTweens","timeSightMouseDrag","updateTimers","recoverPerformance","pauseOnBlur","particleSystems","sys","parentSceneId","_this$game$config","mapWidth","mapHeight","sceneDidInit","originalSave","vendRNG","randFloat","randBetween","attachInputs","startedAt","setupAnimations","_setupShader","setRenderToTexture","load","mapsFile","preloadAssets","_ldMapFiles","parseMaps","cache","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_1__","mapFiles","findIndex","_spec2","_parseLevelLines","parseLevelLines","mapText","lookups","_this$game$config2","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","background","boundsWidth","boundsHeight","setBounds","removeBounds","setLerp","setCameraBounds","setCameraDeadzone","setCameraLerp","_firstUpdated","firstUpdate","renderUpdate","positionBackground","_game$config","gameWidth","gameHeight","backgroundWidth","backgroundHeight","xDivisor","xFactor","yDivisor","yFactor","initializeListeners","_spec3","listenerInitial","initialValue","setter","propNames","propNamesForUniform","_initialValue","shaderUpdate","_ref10$","listenerIfNull","eval","reseed","originalTransition","_isTransitioning","_replayOptions","_transitionProps","willTransitionTo","replaceWithSceneNamed","oldPauseTime","newUnpauseTime","newUnpauseFn","swapScenes","_hasCutover","cutoverPrimary","overrideSwapScenes","onCutover","applyPause","oldPause","playMusicIfSet","bringToTop","_hasCompleted","completeTransition","didTransitionTo","onWaitEnd","wait","animate","tweenInOut","firstHalf","followupTween","suppressShaderCheck","_this$game$config3","newCamera","oldCamera","_this$game$config4","firstCall","newPause","oldAnimate","onDelayEnd","maxLifespan","staticValueEmit","j","emitParticle","performance","setVisible","hasPreflight","timeSightFrameCallback","resetDelta","calculateTimeSight","_timeSightTargetEnded","_timeSightTargetDone","isPostflight","wake","_timeSightFrames","setActive","launchTimeSight","targetScene","objectDt","frameTime","frameDt","isPreflight","timeSightTargetStep","beginTimeSightAlphaAnimation","renderTimeSightFrameInto","manageableProps","_timeSightAlpha","_timeSightFrame","loopAlpha","activeFrames","overrideProps","_timeSightAlphaTween","targets","addEvent","_timeSightMouseInput","topOnly","setInteractive","activeObject","matchedFrame","_timeSightRemoveFocusTimer","_active","_add","_skipFreezeTimeSight","displayList","node","pause","tick","replayParticleSystems","changedKey","moribund","killAll","reloadAnimations","removeAnimations","bodies","currentAnim","reloadSeed","propsWithPrefix","emitterProps","createEmitter","preemitEmitter","params","massageTweenProps","baseTransitionProps","massageTransitionProps","startPoint","addCounter","from","to","getValue","fieldName","inDuration","outDuration","onMidpoint","inEase","outEase","_len2","_key2","sustainDuration","onSustain","onOut","tweenSustain","_len3","_key3","_len4","_key4","baseName","variants","isVisible","requestedVolume","multiplier","musicName","newTimers","origDt","_destroy","_toProcess","actualFps","applyPropChanges","refreshUI","particleProp","batch","changedProps","setProp","propSpecs","changeCallback","change","disableMainShaders","camelName","charAt","toUpperCase","debugMethod","offsetX","offsetY","lerp","startFollow","stopFollow","shockwave_center","_this$game$config5","activePointer","isDown","_timeSightMouseDragX","position","_timeSightMouseDragY","pauseInputForTransition","pauseAllAnimations","unpauseInputForTransition","resumeAllAnimations","pausePhysicsForTransition","pauseAllParticleSystems","pauseAllTweens","unpausePhysicsForTransition","resumeAllParticleSystems","resumeAllTweens","_injectedAnimsUpdate","injectAnimationUpdate","resume","detachScene","_timeScale","setTimeScale","Scene","tileSpecs","content","maps","allLines","split","mapLines","configLines","prevLineIsEmpty","parsingConfig","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_3__","isRectangular","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","newDefinitions","previousTileSpecs","specs","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","_inherit","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__","nodes","unshift","assign","flattenInheritance","leftoverKeys","oldValue","deepEqual","updateTileDefinitions","joystick","restart","quit","recordCycle","alpha_factor","tint_factor","builtinPropSpecs","command.ignore_all.blockade","level.id","level.width","level.height","player.x","player.y","player.velocity_x","player.velocity_y","player.acceleration_x","player.acceleration_y","player.acceleration","player.mass","player.drag","player.friction","player.bounce","player.maxVelocity","player.dash.active","player.dash.cooldown","player.dash.velocity","player.dash.in_duration","player.dash.sustain_duration","player.dash.out_duration","player.dash.in_ease","tweenEases","player.dash.out_ease","player.dash.cooldown_duration","player.stun.active","player.stun.cooldown","follower.mass","follower.drag","follower.friction","follower.bounce","follower.maxVelocity","follower.velocityLerp","follower.flockAcceleration","follower.cohereRadius","follower.cohereFactor","follower.spreadRadius","follower.spreadFactor","follower.playerRadius","follower.playerFactor","follower.obstacleRadius","follower.obstacleFactor","follower.enemyRadius","follower.enemyFactor","follower.killerRadius","follower.killerFactor","follower.killerAcceleration","follower.killerVelocity","enemy.mass","enemy.drag","enemy.friction","enemy.bounce","enemy.maxVelocity","enemy.velocityLerp","enemy.flockAcceleration","enemy.cohereRadius","enemy.cohereFactor","enemy.spreadRadius","enemy.spreadFactor","enemy.avoidPlayerRadius","enemy.avoidPlayerFactor","enemy.seekPlayerRadius","enemy.seekPlayerFactor","enemy.obstacleRadius","enemy.obstacleFactor","enemy.followerRadius","enemy.followerFactor","enemy.victimRadius","enemy.victimFactor","enemy.victimAcceleration","enemy.victimVelocity","effects.sceneTransition.transition","effects.zoomOnLoss.distance","effects.zoomOnLoss.pan_duration","effects.zoomOnLoss.pan_ease","effects.zoomOnLoss.zoom_duration","effects.zoomOnLoss.zoom_ease","effects.zoomOnLoss.zoom_scale","effects.zoomOnLoss.time_scale","effects.zoomOnLoss.recover_linger_duration","effects.zoomOnLoss.recover_zoom_duration","effects.zoomOnLoss.recover_zoom_ease","effects.zoomOnLoss.recover_pan_duration","effects.zoomOnLoss.recover_pan_ease","effects.zoomOnLoss.recover_time_scale_duration","effects.zoomOnLoss.recover_time_scale_ease","effects.followerDie.duration","effects.dashPuff.particles","effects.glow.particles","effects.loseTransition.transition",".","@","+","F","*","0",";","^","[","]","preprocessPropSpecs","ManageableProps","makePropsWithPrefix","PropLoader","defaultTweenProps","delay_enabled","dx_enabled","dy_enabled","alpha_enabled","rotation_enabled","scaleX_enabled","scaleY_enabled","yoyo","refreshPhysics","destroyOnComplete","expandTweenProps","originalY","refreshBody","injected","origAdd","folders","controllers","parentOfFolder","proxiedManageableProps","manageablePropsProxy","dat","autoPlace","addNestedFolder","addController","savedChangedProps","upcase","word","sections","folderKey","folder","section","addFolder","regenerateListenPropsCache","batchSaveChangedProps","saveChangedProps","setChangedProp","setUnchangedProp","open","saved","_propSpecs$key","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_toArray__WEBPACK_IMPORTED_MODULE_1__","originalValue","controller","enabledKey","addColor","listen","closest","querySelectorAll","tabIndex","onclick","__ldListenCallback","__ldChangeCallback","__ldActionCallback","enabledCheckbox","enabledValue","crNode","originalEnabled","setAttribute","checked","__ldEnabledSpec","onchange","__suppressChange","__onChange","__onFinishChange","err","resetButton","stopPropagation","removeAttribute","updateDisplay","onFinishChange","propDidFinishChange","ret","propDidChange","isChanged","dataset","__ldSpec","listenPropsCache","skipCache","updateProp","newProps","query","queryRegex","characters","hasUppercase","subsequence","character","includes","substring","queryize","close","isFiltered","rendererName","_rendererName","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_3__","engine.time","engine.frameTime","engine.actualFps","engine.targetFps","engine.renderer","engine.focused","engine.throttle","engine.stepping","engine.step","engine.clearLocalStorage","location","engine.clearGameState","engine.disableDebugUI","config.debug","config.width","config.height","config.tileWidth","config.tileHeight","config.xBorder","config.yBorder","scene.count","scene.commandScenes","size","scene.class","scene.sceneId","scene.parentSceneId","scene.key","scene.seed","scene.scene_time","scene.music","scene.timeScale","scene.physicsFps","scene.images","scene.sprites","scene.particles","scene.text","scene.sounds","scene.timers","scene.physicsColliders","scene.musicVolume","scene.soundVolume","scene.debugDraw","debugGraphic","scene.replaceWithSelf","scene.camera.width","scene.camera.height","scene.camera.alpha","scene.camera.zoom","scene.camera.rotation","scene.camera.x","scene.camera.y","scene.camera.scrollX","scene.camera.scrollY","scene.camera.centerX","scene.camera.centerY","scene.camera.boundsX","scene.camera.boundsY","scene.camera.boundsWidth","scene.camera.boundsHeight","scene.camera.useBounds","scene.camera.follow","objectIdentifier","_follow","scene.camera.followOffsetX","scene.camera.followOffsetY","scene.camera.lerp","scene.camera.deadzoneX","scene.camera.deadzoneY","scene.camera.hasBounds","commandKeyProps","command.gamepad.total","command.gamepad.A","command.gamepad.B","command.gamepad.X","command.gamepad.Y","command.gamepad.L1","command.gamepad.L2","command.gamepad.R1","command.gamepad.R2","command.gamepad.UP","command.gamepad.DOWN","command.gamepad.LEFT","command.gamepad.RIGHT","command.gamepad.LSTICKX","command.gamepad.LSTICKY","command.gamepad.RSTICKX","command.gamepad.RSTICKY","command.ignore_all.any","command.ignore_all._transition","commandProps","shaderProps","knownInputs","Input","Keyboard","KeyCodes","keysWithPrefix","skipWarning","inputPath","expandTransitionProps","recordPropExecution","_savedChangedProps$ke","clearCache","getContainer","getObject","cacheInput","cacheOutput","texture","origUpdate","module","exports","imageAssets","spriteAssets","musicAssets","soundAssets","_image_background_png__WEBPACK_IMPORTED_MODULE_0__","_image_background_png__WEBPACK_IMPORTED_MODULE_0___default","_image_cloud_png__WEBPACK_IMPORTED_MODULE_1__","_image_cloud_png__WEBPACK_IMPORTED_MODULE_1___default","_music_peace_mp3__WEBPACK_IMPORTED_MODULE_2__","_music_peace_mp3__WEBPACK_IMPORTED_MODULE_2___default","_music_war_mp3__WEBPACK_IMPORTED_MODULE_3__","_music_war_mp3__WEBPACK_IMPORTED_MODULE_3___default","_music_win_mp3__WEBPACK_IMPORTED_MODULE_4__","_music_win_mp3__WEBPACK_IMPORTED_MODULE_4___default","_sound_border_wav__WEBPACK_IMPORTED_MODULE_5__","_sound_border_wav__WEBPACK_IMPORTED_MODULE_5___default","_sound_coopbreak_wav__WEBPACK_IMPORTED_MODULE_6__","_sound_coopbreak_wav__WEBPACK_IMPORTED_MODULE_6___default","_sound_coop_wav__WEBPACK_IMPORTED_MODULE_7__","_sound_coop_wav__WEBPACK_IMPORTED_MODULE_7___default","_sound_dash_wav__WEBPACK_IMPORTED_MODULE_8__","_sound_dash_wav__WEBPACK_IMPORTED_MODULE_8___default","_sound_dashfollower_wav__WEBPACK_IMPORTED_MODULE_9__","_sound_dashfollower_wav__WEBPACK_IMPORTED_MODULE_9___default","_sound_dashkill_wav__WEBPACK_IMPORTED_MODULE_10__","_sound_dashkill_wav__WEBPACK_IMPORTED_MODULE_10___default","_sound_hit_wav__WEBPACK_IMPORTED_MODULE_11__","_sound_hit_wav__WEBPACK_IMPORTED_MODULE_11___default","_sound_howl_wav__WEBPACK_IMPORTED_MODULE_12__","_sound_howl_wav__WEBPACK_IMPORTED_MODULE_12___default","_sound_kill_wav__WEBPACK_IMPORTED_MODULE_13__","_sound_kill_wav__WEBPACK_IMPORTED_MODULE_13___default","_sound_lose_wav__WEBPACK_IMPORTED_MODULE_14__","_sound_lose_wav__WEBPACK_IMPORTED_MODULE_14___default","_sound_murder_wav__WEBPACK_IMPORTED_MODULE_15__","_sound_murder_wav__WEBPACK_IMPORTED_MODULE_15___default","_sound_stun_wav__WEBPACK_IMPORTED_MODULE_16__","_sound_stun_wav__WEBPACK_IMPORTED_MODULE_16___default","_sound_treasure_wav__WEBPACK_IMPORTED_MODULE_17__","_sound_treasure_wav__WEBPACK_IMPORTED_MODULE_17___default","_sound_win_wav__WEBPACK_IMPORTED_MODULE_18__","_sound_win_wav__WEBPACK_IMPORTED_MODULE_18___default","_sprite_enemyA_png__WEBPACK_IMPORTED_MODULE_19__","_sprite_enemyA_png__WEBPACK_IMPORTED_MODULE_19___default","_sprite_farmer_png__WEBPACK_IMPORTED_MODULE_20__","_sprite_farmer_png__WEBPACK_IMPORTED_MODULE_20___default","_sprite_follower_png__WEBPACK_IMPORTED_MODULE_21__","_sprite_follower_png__WEBPACK_IMPORTED_MODULE_21___default","_sprite_player_png__WEBPACK_IMPORTED_MODULE_22__","_sprite_player_png__WEBPACK_IMPORTED_MODULE_22___default","_tile_coop_png__WEBPACK_IMPORTED_MODULE_23__","_tile_coop_png__WEBPACK_IMPORTED_MODULE_23___default","_tile_grass_png__WEBPACK_IMPORTED_MODULE_24__","_tile_grass_png__WEBPACK_IMPORTED_MODULE_24___default","_tile_grassrock_png__WEBPACK_IMPORTED_MODULE_25__","_tile_grassrock_png__WEBPACK_IMPORTED_MODULE_25___default","_tile_treasure_closed_png__WEBPACK_IMPORTED_MODULE_26__","_tile_treasure_closed_png__WEBPACK_IMPORTED_MODULE_26___default","_tile_treasure_open_png__WEBPACK_IMPORTED_MODULE_27__","_tile_treasure_open_png__WEBPACK_IMPORTED_MODULE_27___default","_tile_wall_png__WEBPACK_IMPORTED_MODULE_28__","_tile_wall_png__WEBPACK_IMPORTED_MODULE_28___default","imageBackground","imageCloud","tileGrass","tileGrassRock","tileWall","spriteEnemyA","file","frameWidth","frameHeight","spriteFarmer","spriteFollower","spritePlayer","tileCoop","tileTreasureClosed","tileTreasureOpen","musicPeace","musicWar","musicWin","soundBorder","soundCoopBreak","soundCoopHit","soundDash","soundDashFollower","soundDashKill","soundHit","soundHowl","soundKill","soundLose","soundMurder","soundStun","soundTreasure","soundWin","loaderMethod","unloadFunction","textureManager","audio","loadAsset","_scene$load","spriteWidth","spriteHeight","_game$config2","massageInput","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_2__","transitionPauses","transitionPauseTimes","defaultTransitionProps","wait_enabled","_Users_shawn_devel_boids_of_prey_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","builtinCoordFragments","center","range","thickness","inner","dropoff","builtinColorFragments","red","green","blue","float","bool","vec2","vec3","vec4","rgb","rgba","_shaderTypeMeta$type","subvariables","sub","injectBuiltinFragment","isCoord","primary","secondary","primaryName","secondaryName","replacement","splice","coordFragments","colorFragments","_shaderTypeMeta$type2","colorConfig","alphaConfig"],"mappings":"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","file":"static/js/main.5ea99d52.chunk.js","sourcesContent":["import {name as project} from '../../../package.json';\n\nconst debug = !process.env.NODE_ENV || process.env.NODE_ENV === 'development';\nconst prefix = `${project}_${debug ? 'debug' : 'prod'}_`;\n\nlet frozen = false;\nexport function freezeStorage() {\n  frozen = true;\n}\n\nexport function saveField(name, value) {\n  if (frozen) {\n    return false;\n  }\n\n  try {\n    const payload = JSON.stringify(value);\n    localStorage.setItem(`${prefix}${name}`, payload);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(e);\n    return false;\n  }\n\n  return true;\n}\n\nexport function removeField(name) {\n  if (frozen) {\n    return false;\n  }\n\n  try {\n    localStorage.removeItem(`${prefix}${name}`);\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(e);\n    return false;\n  }\n\n  return true;\n}\n\nexport function removeAllFields(subprefix = '') {\n  if (frozen) {\n    return false;\n  }\n\n  try {\n    Object.keys(localStorage).forEach((key) => {\n      if (key.startsWith(`${prefix}${subprefix}`)) {\n        localStorage.removeItem(key);\n      }\n    });\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(e);\n    return false;\n  }\n\n  return true;\n}\n\nexport function loadField(name, defaultValue) {\n  let value = defaultValue;\n\n  try {\n    const payload = localStorage.getItem(`${prefix}${name}`);\n    if (payload !== null && payload !== undefined) {\n      value = JSON.parse(payload);\n    }\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(e);\n  }\n\n  if (typeof value === 'function') {\n    value = value();\n  }\n\n  return value;\n}\n","import Phaser from 'phaser';\n\nconst ParticleProps = [];\nexport function particlePropFromProp(prop) {\n  return ParticleProps.find((p) => prop.startsWith(p));\n}\n\nlet injectedEmitterOpSeededRandom = false;\nexport function injectEmitterOpSeededRandom(emitter, seed) {\n  emitter.seed = seed;\n  emitter.rnd = new Phaser.Math.RandomDataGenerator([seed]);\n\n  if (injectedEmitterOpSeededRandom) {\n    return;\n  }\n\n  // eslint-disable-next-line no-proto\n  const proto = emitter.delay.__proto__;\n\n  proto.randomStaticValueEmit = function(particle, key) {\n    const randomIndex = Math.floor(particle.emitter.rnd.frac() * this.propertyValue.length);\n    return this.propertyValue[randomIndex];\n  };\n\n  proto.randomRangedValueEmit = function(particle, key) {\n    const value = particle.emitter.rnd.realInRange(this.start, this.end);\n\n    if (particle && particle.data[key]) {\n      particle.data[key].min = value;\n    }\n\n    return value;\n  };\n\n\n  injectedEmitterOpSeededRandom = true;\n}\n\nlet injectedParticleEmitterManagerPreUpdate = false;\nexport function injectParticleEmitterManagerPreUpdate(manager) {\n  if (injectedParticleEmitterManagerPreUpdate || !manager) {\n    return injectedParticleEmitterManagerPreUpdate;\n  }\n\n  // eslint-disable-next-line no-proto\n  const proto = manager.__proto__;\n\n  proto.preUpdate = function(time, origDelta) {\n    const {scene} = this;\n    const isPaused = scene._paused.particles;\n\n    // Scale the delta\n    const delta = origDelta * this.timeScale;\n\n    const emitters = this.emitters.list;\n\n    for (let i = 0; i < emitters.length; i += 1) {\n      const emitter = emitters[i];\n      if ((!isPaused || this.ignoresScenePause || emitter.ignoresScenePause || emitter.updatesOnceOnPause) && emitter.active) {\n        emitter.preUpdate(time, delta);\n        if (isPaused) {\n          emitter.updatesOnceOnPause = false;\n        }\n      }\n    }\n  };\n\n  injectedParticleEmitterManagerPreUpdate = true;\n\n  return injectedParticleEmitterManagerPreUpdate;\n}\n\nconst defaultParticleProps = {\n  image: null,\n\n  /*\n   * to investigate:\n   * bounds: null (rectangle)\n   * bounce: 0\n   * collideBottom: true\n   * collideLeft: true\n   * collideRight: true\n   * collideTop: true\n   * defaultFrame: 0?\n   * deathZone: null\n   * emitZone: null\n   * frameQuantity: 1 int\n   * mask\n  visible: [true],\n  timeScale: [1, 0, 100],\n\n  randomFrame: [true],\n  moveToX: [0, 0, 1000],\n  moveToY: [0, 0, 1000],\n   * scrollFactorX: 1 number\n   * scrollFactorY: 1 number\n   *\n   * followOffset: vec2\n   * trackVisible: false\n   *\n   * maxVelocityX: 10000\n   * maxVelocityY: 10000\n   *\n   * I suppose we don't need both gravity and acceleration?\n  gravityX: [0, -1000, 1000],\n  gravityY: [0, -1000, 1000],\n   */\n\n  /*\n   * angle: {min: 0, max: 360}\n  */\n  frequency: [0, 0, 20000],\n  lifespan: [1000, 0, 20000],\n\n  accelerationX: [0, -1000, 1000],\n  accelerationY: [0, -1000, 1000],\n  alpha: [1, 0, 1],\n  blendMode: ['NORMAL', ['NORMAL', 'ADD', 'MULTIPLY', 'SCREEN', 'ERASE']],\n  delay: [0, 0, 20000],\n  maxParticles: [0, 0, 1000],\n  particleBringToTop: [true],\n  quantity: [1, 0, 200, 1],\n  radial: [true],\n  rotate: [0, -1080, 1080, 1],\n  scaleX: [1, 0, 100],\n  scaleY: [1, 0, 100],\n  speed: [0, 0, 1000],\n  speedX: [0, -1000, 1000],\n  speedY: [0, -1000, 1000],\n  tint: [0xFFFFFF],\n  tint_enabled: [false],\n  x: [0, -1000, 1000],\n  y: [0, -1000, 1000],\n  ignoresScenePause: [false],\n  updatesOnceOnPause: [false],\n  visible: [true],\n\n  preemit: [false],\n  preemitOnReload: [false],\n};\n\nexport function expandParticleProps(props, particleImages = ['set props/particleImages!']) {\n  Object.entries(props).forEach(([name, spec]) => {\n    if (name === 'scene.particles') {\n      return;\n    }\n\n    if (name.endsWith('.particle')) {\n      throw new Error(`Found ${name}; did you mean ${name}s?`);\n    }\n\n    if (!name.endsWith('.particles')) {\n      return;\n    }\n\n    const prefix = name.substr(0, name.length - '.particles'.length);\n\n    if (!Array.isArray(spec) || spec.length !== 1 || typeof spec[0] !== 'object') {\n      throw new Error(`Expected ${name} prop to have the shape [{…}]; did you mean to end it in .particles?`);\n    }\n\n    delete props[name];\n\n    ParticleProps.push(prefix);\n\n    const [config] = spec;\n\n    const seen = {...config};\n\n    Object.entries(defaultParticleProps).forEach(([key, value]) => {\n      const propKey = key.replace(/^tint/, 'tintColor');\n      const options = key === 'image' ? [particleImages[0], particleImages] : value;\n\n      if (key in config) {\n        props[`${prefix}.${propKey}`] = [config[key], ...options.slice(1)];\n        delete seen[key];\n      } else if (key === 'preemitOnReload' && config.preemit) {\n        props[`${prefix}.${propKey}`] = [true, ...options.slice(1)];\n      } else if (key.endsWith('_enabled')) {\n        const targetKey = key.substr(0, key.length - '_enabled'.length);\n        props[`${prefix}.${propKey}`] = [targetKey in config];\n      } else {\n        props[`${prefix}.${propKey}`] = options;\n      }\n    });\n\n    if (Object.keys(seen).length) {\n      throw new Error(`Got unexpected particle config settings: ${Object.keys(seen).join(', ')}`);\n    }\n  });\n}\n\nexport default function massageParticleProps({...props}) {\n  const {massageProps} = props;\n\n  delete props.onAdd;\n  delete props.massageProps;\n  delete props.image;\n\n  if (props.tintColor_enabled) {\n    props.tint = props.tintColor;\n    delete props.tintColor_enabled;\n  }\n\n  // these accidentally take precedence over one another\n  if (props.speedX === 0 && props.speedY === 0) {\n    delete props.speedX;\n    delete props.speedY;\n  } else if (props.speed === 0) {\n    delete props.speed;\n  }\n\n  // convert degrees to radians\n  if (props.rotate) {\n    if (typeof props.rotate === 'number') {\n      props.rotate *= Math.PI / 180;\n    }\n    // TODO handle other input formats\n  }\n\n  if (massageProps) {\n    massageProps(props);\n  }\n\n  return props;\n}\n","import React from 'react';\n\nexport default class Spinner extends React.Component {\n  render() {\n    return (\n      <div id=\"lds-spinner\">\n        <div className=\"lds-spinner\">\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n          <div />\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './Controls.css';\n\nexport default class Controls extends React.Component {\n  render() {\n    const {\n      onMouseMove, volume, onVolumeChange, disableFullscreen, isFullscreen, enterFullscreen, exitFullscreen,\n    } = this.props;\n    return (\n      <div className=\"Controls\" onMouseMove={onMouseMove}>\n        <div className=\"volume\">\n          <span style={{fontSize: 20, transform: `scale(${0.5 + volume / 2})`}}>♫</span>\n          &nbsp;&nbsp;\n          <input\n            type=\"range\"\n            min=\"0\"\n            max=\"100\"\n            value={volume * 100}\n            onChange={(e) => onVolumeChange(e.target.value / 100)}\n            onMouseUp={(e) => e.target.blur()}\n          />\n        </div>\n        {disableFullscreen || (\n          <div className=\"fullscreen\">\n            {isFullscreen ? (\n              <div className=\"button\" onClick={exitFullscreen}>\n                <div className=\"label exit\">╳</div>\n              </div>\n            ) : (\n              <div className=\"button\" onClick={enterFullscreen}>\n                <div className=\"label enter\">⇆</div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n","import SuperScene from './SuperScene.js';\n\nexport default class BootScene extends SuperScene {\n  static key() {\n    return 'BootScene';\n  }\n\n  constructor() {\n    super({key: BootScene.key()});\n  }\n\n  preload() {\n    super.preload();\n\n    this.game.preloadScenes.forEach((sceneClass) => {\n      if (sceneClass.name === this.name) {\n        return;\n      }\n\n      const scene = new sceneClass();\n      scene.preload.call(this);\n    });\n  }\n\n  create() {\n    super.create();\n\n    this.game.initializeMainShaders();\n\n    setTimeout(() => {\n      this.game.preloadComplete();\n    });\n  }\n\n  saveStateFieldName() {\n    return null;\n  }\n}\n","import {name as project} from '../../../package.json';\n\nconst debug = !process.env.NODE_ENV || process.env.NODE_ENV === 'development';\n\nexport function devAnalytics(event, value) {\n  const options = {event_category: project};\n\n  if (value !== undefined) {\n    options.value = value;\n  }\n\n  try {\n    window.gtag(\n      'event',\n      event,\n      options,\n    );\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.error(e);\n  }\n}\n\nexport default function analytics(...args) {\n  if (debug) {\n    return;\n  }\n\n  return devAnalytics(...args);\n}\n","import _ from 'lodash';\nimport {commandKeys, gamepadKeys} from './lib/props';\nimport prop from '../props';\n\nconst GamepadButtons = {\n  LEFT: '_LCLeft',\n  RIGHT: '_LCRight',\n  UP: '_LCTop',\n  DOWN: '_LCBottom',\n  A: '_RCBottom',\n  Y: '_RCTop',\n  X: '_RCLeft',\n  B: '_RCRight',\n  L1: '_FBLeftTop',\n  L2: '_FBLeftBottom',\n  R1: '_FBRightTop',\n  R2: '_FBRightBottom',\n};\n\nconst ButtonName = {};\n\nexport default class CommandManager {\n  constructor(spec) {\n    this._spec = spec;\n    this._scenes = new Map();\n\n    this.keyboard = {};\n    this.gamepad = {};\n    this.pointerEvents = [];\n    this.executedProps = [];\n    this._ignoreAlls = {};\n\n    Object.keys(spec).forEach((name) => {\n      if (this[name]) {\n        throw new Error(`Conflicting command name ${name}`);\n      }\n\n      this[name] = {\n        held: false,\n        heldFrames: 0,\n        started: false,\n        continued: false,\n        heldDuration: 0,\n        releasedFrames: 0,\n        released: false,\n        releasedDuration: 0,\n      };\n    });\n  }\n\n  freezeCommandState() {\n    const state = {\n      inputs: {},\n      ignoreAlls: {...this._ignoreAlls},\n    };\n\n    Object.keys(this._spec).forEach((name) => {\n      state.inputs[name] = {...this[name]};\n    });\n\n    return state;\n  }\n\n  thawCommandState(state) {\n    Object.keys(this._spec).forEach((name) => {\n      this[name] = {...state.inputs[name]};\n    });\n    this._ignoreAlls = {...state.ignoreAlls};\n  }\n\n  getManager(scene) {\n    return this._scenes.get(scene);\n  }\n\n  managerList() {\n    return [...this._scenes.values()];\n  }\n\n  attachScene(scene, suppressRepeatFrames) {\n    this._scenes.set(scene, {\n      scene,\n      commands: scene.game.debug ? [] : null,\n      tickCount: 0,\n      suppressRepeatFrames,\n    });\n  }\n\n  detachScene(scene) {\n    this._scenes.delete(scene);\n  }\n\n  attachKey(scene, code) {\n    const {keyboard} = scene.input;\n\n    keyboard.on(`keydown-${code}`, (e) => {\n      const tag = document.activeElement && document.activeElement.tagName.toLowerCase();\n      if (tag === 'input' || tag === 'select' || tag === 'textarea') {\n        return;\n      }\n\n      if (e.altKey || e.ctrlKey || e.metaKey || e.shiftKey) {\n        return;\n      }\n\n      e.preventDefault();\n      this.keyboard[code] = true;\n    });\n\n    keyboard.on(`keyup-${code}`, (e) => {\n      const tag = document.activeElement && document.activeElement.tagName.toLowerCase();\n      if (tag === 'input' || tag === 'select' || tag === 'textarea') {\n        return;\n      }\n\n      e.preventDefault();\n      this.keyboard[code] = false;\n    });\n\n    if (!(code in this.keyboard)) {\n      this.keyboard[code] = false;\n    }\n  }\n\n  detachKey(scene, code) {\n    delete this.keyboard[code];\n  }\n\n  attachInputs(scene) {\n    commandKeys(this._spec).forEach((code) => {\n      this.attachKey(scene, code);\n    });\n\n    if (scene.input.gamepad) {\n      scene.input.gamepad.on('down', (gamepad, button) => {\n        let buttonName = ButtonName[button.index];\n        if (!buttonName) {\n          Object.entries(GamepadButtons).forEach(([name, method]) => {\n            if (button === gamepad[method]) {\n              buttonName = ButtonName[button.index] = name;\n            }\n          });\n        }\n\n        this.gamepad[buttonName] = true;\n      });\n\n      scene.input.gamepad.on('up', (gamepad, button) => {\n        let buttonName = ButtonName[button.index];\n        if (!buttonName) {\n          Object.entries(GamepadButtons).forEach(([name, method]) => {\n            if (button === gamepad[method]) {\n              buttonName = ButtonName[button.index] = name;\n            }\n          });\n        }\n\n        this.gamepad[buttonName] = false;\n      });\n    }\n\n    const canvas = document.querySelector('#engine canvas');\n\n    ['pointerdown', 'pointerup'].forEach((name) => {\n      scene.input.on(name, (pointer) => {\n        // fix issue with dat.gui not releasing focus\n        if (!document.activeElement || !document.activeElement.contains || document.activeElement.contains(canvas)) {\n          this.pointerEvents.push({\n            name,\n            x: pointer.x,\n            y: pointer.y,\n          });\n        } else {\n          // timeout to avoid 2x input events\n          setTimeout(() => {\n            document.activeElement.blur();\n          });\n        }\n      });\n    });\n  }\n\n  readRawGamepad(scenes) {\n    const {gamepad} = this;\n    let seenGamepad = false;\n\n    scenes.forEach((scene) => {\n      const rawGamepad = scene.input.gamepad;\n      if (!rawGamepad.total) {\n        return;\n      }\n\n      if (!seenGamepad) {\n        seenGamepad = true;\n\n        gamepad.total = 0;\n        gamepad.LSTICKX = 0;\n        gamepad.LSTICKY = 0;\n        gamepad.RSTICKX = 0;\n        gamepad.RSTICKY = 0;\n      }\n\n      if (gamepad.total < rawGamepad.total) {\n        gamepad.total = rawGamepad.total;\n      }\n\n      rawGamepad.gamepads.filter((pad) => pad).forEach((rawPad) => {\n        const {leftStick, rightStick} = rawPad;\n        if (Math.abs(leftStick.x) > Math.abs(gamepad.LSTICKX)) {\n          gamepad.LSTICKX = leftStick.x;\n        }\n\n        if (Math.abs(leftStick.y) > Math.abs(gamepad.LSTICKY)) {\n          gamepad.LSTICKY = leftStick.y;\n        }\n\n        if (Math.abs(rightStick.x) > Math.abs(gamepad.RSTICKX)) {\n          gamepad.RSTICKX = rightStick.x;\n        }\n\n        if (Math.abs(rightStick.y) > Math.abs(gamepad.RSTICKY)) {\n          gamepad.RSTICKY = rightStick.y;\n        }\n      });\n    });\n  }\n\n  heldCommands(onlyUnignorable) {\n    const {gamepad} = this;\n    const spec = this._spec;\n    const frame = {_repeat: 0};\n\n    Object.entries(spec).forEach(([name, config]) => {\n      if (onlyUnignorable && !config.unignorable) {\n        return;\n      }\n\n      let held = false;\n      if (config.input) {\n        config.input.forEach((path) => {\n          let keyHeld;\n\n          if (gamepad.total) {\n            if (path === 'gamepad.LSTICK.RAW' && (Math.abs(gamepad.LSTICKX) > 0.1 || Math.abs(gamepad.LSTICKY) > 0.1)) {\n              held = [gamepad.LSTICKX, gamepad.LSTICKY];\n            } else if (path === 'gamepad.RSTICK.RAW' && (Math.abs(gamepad.RSTICKX) > 0.1 || Math.abs(gamepad.RSTICKY) > 0.1)) {\n              held = [gamepad.RSTICKX, gamepad.RSTICKY];\n            } else if (path === 'gamepad.LSTICK.UP') {\n              keyHeld = gamepad.LSTICKY < -0.2;\n            } else if (path === 'gamepad.LSTICK.DOWN') {\n              keyHeld = gamepad.LSTICKY > 0.2;\n            } else if (path === 'gamepad.LSTICK.LEFT') {\n              keyHeld = gamepad.LSTICKX < -0.2;\n            } else if (path === 'gamepad.LSTICK.RIGHT') {\n              keyHeld = gamepad.LSTICKX > 0.2;\n            } else if (path === 'gamepad.RSTICK.UP') {\n              keyHeld = gamepad.RSTICKY < -0.2;\n            } else if (path === 'gamepad.RSTICK.DOWN') {\n              keyHeld = gamepad.RSTICKY > 0.2;\n            } else if (path === 'gamepad.RSTICK.LEFT') {\n              keyHeld = gamepad.RSTICKX < -0.2;\n            } else if (path === 'gamepad.RSTICK.RIGHT') {\n              keyHeld = gamepad.RSTICKX > 0.2;\n            } else {\n              keyHeld = _.get(this, path);\n            }\n          } else {\n            keyHeld = _.get(this, path);\n          }\n\n          if (keyHeld) {\n            held = true;\n          }\n        });\n\n        this[name].held = held;\n\n        if (held) {\n          frame[name] = held;\n        }\n      }\n    });\n\n    if (this.pointerEvents.length) {\n      if (!onlyUnignorable) {\n        frame._pointer = [...this.pointerEvents];\n      }\n      this.pointerEvents.length = 0;\n    }\n\n    if (this.executedProps.length) {\n      if (!onlyUnignorable) {\n        frame._executedProps = [...this.executedProps];\n      }\n      this.executedProps.length = 0;\n    }\n\n    return frame;\n  }\n\n  replayFrame(frame) {\n    const spec = this._spec;\n\n    Object.entries(spec).forEach(([name, config]) => {\n      if (frame[name] && config.unreplayable) {\n        this[name].held = false;\n      } else {\n        this[name].held = frame[name];\n      }\n    });\n  }\n\n  mergeUnignorable(frame) {\n    const spec = this._spec;\n\n    Object.entries(spec).forEach(([name, config]) => {\n      if (frame[name] && config.unignorable && !config.unreplayable) {\n        this[name].held = true;\n      }\n    });\n  }\n\n  addFrameToList(suppressRepeatFrames, list, frame) {\n    if (!suppressRepeatFrames && list.length) {\n      const prevFrame = list[list.length - 1];\n      let isSame = true;\n      if (frame._pointer || prevFrame._pointer) {\n        isSame = false;\n      } else if (frame._executedProps || prevFrame._executedProps) {\n        isSame = false;\n      } else {\n        Object.keys(this._spec).forEach((key) => {\n          if (prevFrame[key] !== frame[key]) {\n            isSame = false;\n          }\n        });\n      }\n\n      if (isSame) {\n        list.pop();\n        list.push({...prevFrame, _repeat: prevFrame._repeat + 1});\n        return;\n      }\n    }\n\n    list.push(frame);\n  }\n\n  ignoreAll(type, newValue) {\n    const {_ignoreAlls} = this;\n\n    if (type === undefined) {\n      let ignoreAny = false;\n      Object.values(_ignoreAlls).forEach((ignore) => {\n        if (ignore) {\n          ignoreAny = true;\n        }\n      });\n      return ignoreAny;\n    }\n\n    if (newValue === undefined) {\n      return _ignoreAlls[type];\n    }\n\n    _ignoreAlls[type] = !!newValue;\n    return _ignoreAlls[type];\n  }\n\n  processCommands(manager, frame, dt) {\n    const spec = this._spec;\n    const {scene} = manager;\n\n    const ignoreAll = this.ignoreAll();\n\n    Object.entries(spec).forEach(([name, config]) => {\n      const command = this[name];\n\n      if (!prop(`command.${name}.enabled`) || (ignoreAll && !config.unignorable)) {\n        command.held = false;\n      }\n\n      if (command.held) {\n        command.heldFrames += 1;\n        command.heldDuration += dt;\n        command.started = command.heldFrames === 1;\n        command.continued = command.heldFrames > 1;\n        command.released = false;\n        command.releasedFrames = 0;\n        command.releasedDuration = 0;\n      } else {\n        command.held = false;\n        command.heldFrames = 0;\n        command.heldDuration = 0;\n        command.started = false;\n        command.continued = false;\n        command.released = command.releasedFrames === 1;\n        command.releasedFrames += 1;\n        command.releasedDuration += dt;\n      }\n\n      if (command.started && config.execute) {\n        if (typeof config.execute === 'function') {\n          config.execute(scene, scene.game);\n        } else {\n          const scenePath = _.get(scene, config.execute);\n          if (scenePath) {\n            scenePath.call(scene);\n          } else {\n            const gamePath = _.get(scene.game, config.execute);\n            if (gamePath) {\n              gamePath.call(scene.game);\n            } else {\n              throw new Error(`Invalid execute for command '${name}'; expected a function or a scene/game method name, got ${config.execute}`);\n            }\n          }\n        }\n      }\n    });\n\n    if (!ignoreAll && frame._pointer) {\n      frame._pointer.forEach((event) => {\n        scene.handlePointerEvent(event);\n      });\n    }\n\n    if (this.replay && frame._executedProps) {\n      frame._executedProps.forEach((propName) => {\n        const fn = prop(propName);\n        if (typeof fn === 'function') {\n          fn();\n        } else {\n          // eslint-disable-next-line no-console\n          console.error(`Recorded prop ${propName} is no longer a function? It's ${fn}`);\n        }\n      });\n    }\n  }\n\n  injectReplayFrame() {\n    if (!this.replay) {\n      return null;\n    }\n\n    if (this.replayFrameIndex >= this.replay.commands.length || this.replayTicks >= this.replay.postflightCutoff) {\n      this.endedReplay();\n      return null;\n    }\n\n    const frame = this.replay.commands[this.replayFrameIndex];\n\n    if (frame._repeat) {\n      this.replayRepeatRun += 1;\n\n      if (this.replayRepeatRun > frame._repeat) {\n        this.replayRepeatRun = 0;\n        this.replayFrameIndex += 1;\n      }\n    } else {\n      this.replayFrameIndex += 1;\n    }\n\n    this.replayTicks += 1;\n\n    this.replayFrame(frame);\n    this.heldCommands(true);\n    this.mergeUnignorable(frame);\n\n    return {...frame, _repeat: 0};\n  }\n\n  processInput(scene, time, dt, onlyUnignorable) {\n    const manager = this.getManager(scene);\n\n    if (manager.scene.timeSightFrozen) {\n      const frame = this.heldCommands(onlyUnignorable);\n      this.processCommands(manager, frame, dt);\n      return;\n    }\n\n    const frame = this.injectReplayFrame()\n      || this.heldCommands(onlyUnignorable);\n\n    if (manager.commands) {\n      this.addFrameToList(manager.suppressRepeatFrames, manager.commands, frame);\n    }\n    if (this.recording) {\n      this.addFrameToList(manager.suppressRepeatFrames, this.recording.commands, frame);\n    }\n\n    manager.tickCount += 1;\n\n    if (this.recording) {\n      this.recording.tickCount += 1;\n    }\n\n    this.processCommands(manager, frame, dt);\n  }\n\n  recordPropExecution(propName) {\n    this.executedProps.push(propName);\n  }\n\n  beginRecording(scene, recording) {\n    const manager = this.getManager(scene);\n    this.recording = recording;\n    recording.commands = [...manager.commands];\n    recording.originalPreflightCutoff = recording.preflightCutoff = recording.tickCount = manager.tickCount;\n  }\n\n  stopRecording() {\n    const {recording} = this;\n    delete this.recording;\n    recording.postflightCutoff = recording.tickCount;\n    return recording;\n  }\n\n  beginReplay(replay, replayOptions) {\n    this.replay = replay;\n    this.replayFrameIndex = 0;\n    this.replayRepeatRun = 0;\n    this.replayTicks = 0;\n    this.replayOptions = replayOptions;\n\n    const startTick = replayOptions.startTick || replay.startTick || 0;\n    if (startTick) {\n      for (let i = 0; i < startTick; i += 1) {\n        this.injectReplayFrame();\n      }\n    }\n  }\n\n  endedReplay() {\n    if (!this.replay) {\n      return;\n    }\n\n    const {onEnd} = this.replayOptions;\n\n    delete this.replay;\n    delete this.replayOptions;\n    delete this.replayFrameIndex;\n    delete this.replayRepeatRun;\n    delete this.replayTicks;\n\n    if (onEnd) {\n      onEnd();\n    }\n  }\n\n  stopReplay() {\n    if (!this.replay) {\n      return;\n    }\n\n    const {onStop} = this.replayOptions;\n\n    delete this.replay;\n    delete this.replayOptions;\n    delete this.replayFrameIndex;\n    delete this.replayRepeatRun;\n    delete this.replayTicks;\n\n    if (onStop) {\n      onStop();\n    }\n  }\n\n  hasPreflight() {\n    if (!this.replay) {\n      return false;\n    }\n\n    if (this.replayTicks >= this.replay.postflightCutoff) {\n      return false;\n    }\n\n    return this.replayTicks < (this.replayOptions.preflightCutoff || this.replay.preflightCutoff);\n  }\n\n  updateCommandsFromReload(next) {\n    const prev = this._spec;\n\n    this.updateSpecFromReload(prev, next);\n    this.updateInputsFromReload(prev, next, true);\n    this.updateInputsFromReload(prev, next, false);\n  }\n\n  updateSpecFromReload(prev, next) {\n    this._spec = next;\n    const addCommands = [];\n    const removeCommands = [];\n    const updateCommands = [];\n\n    const seen = {};\n\n    Object.entries(next).forEach(([name, config]) => {\n      if (!prev[name]) {\n        addCommands.push(name);\n      } else {\n        seen[name] = true;\n\n        const prevJson = {};\n        Object.entries(prev[name]).forEach(([key, value]) => {\n          if (typeof value === 'function') {\n            prevJson[key] = String(value);\n          } else {\n            prevJson[key] = value;\n          }\n        });\n\n        const nextJson = {};\n        Object.entries(next[name]).forEach(([key, value]) => {\n          if (typeof value === 'function') {\n            nextJson[key] = String(value);\n          } else {\n            nextJson[key] = value;\n          }\n        });\n\n        if (JSON.stringify(prevJson) !== JSON.stringify(nextJson)) {\n          updateCommands.push(name);\n        }\n      }\n    });\n\n    Object.keys(prev).forEach((name) => {\n      if (!seen[name]) {\n        removeCommands.push(name);\n      }\n    });\n\n    if (addCommands.length === 0 && removeCommands.length === 0 && updateCommands.length === 0) {\n      return;\n    }\n\n    const changes = [];\n    if (addCommands.length) {\n      changes.push(`+[${addCommands.join(', ')}]`);\n    }\n    if (removeCommands.length) {\n      changes.push(`-[${removeCommands.join(', ')}]`);\n    }\n    if (updateCommands.length) {\n      changes.push(`Δ[${updateCommands.join(', ')}]`);\n    }\n\n    // eslint-disable-next-line no-console\n    console.info(`Hot-loading command changes (${changes.join(', ')})`);\n  }\n\n  updateInputsFromReload(prev, next, isKeyboard) {\n    const nextKeys = {};\n    const prevKeys = {};\n\n    const keyLister = isKeyboard ? commandKeys : gamepadKeys;\n\n    keyLister(next).forEach((code) => {\n      nextKeys[code] = true;\n    });\n\n    keyLister(prev, true).forEach((code) => {\n      prevKeys[code] = true;\n    });\n\n    const addKeys = [];\n    Object.keys(nextKeys).forEach((code) => {\n      if (prevKeys[code]) {\n        delete prevKeys[code];\n      } else {\n        addKeys.push(code);\n      }\n    });\n    const removeKeys = Object.keys(prevKeys);\n\n    if (addKeys.length === 0 && removeKeys.length === 0) {\n      return;\n    }\n\n    if (isKeyboard) {\n      this.managerList().forEach((manager) => {\n        addKeys.forEach((code) => {\n          this.attachKey(manager.scene, code);\n        });\n        removeKeys.forEach((code) => {\n          this.detachKey(manager.scene, code);\n        });\n      });\n    }\n\n    const changes = [];\n    if (addKeys.length) {\n      changes.push(`+[${addKeys.join(', ')}]`);\n    }\n    if (removeKeys.length) {\n      changes.push(`-[${removeKeys.join(', ')}]`);\n    }\n\n    // eslint-disable-next-line no-console\n    console.info(`Hot-loading ${isKeyboard ? 'keyboard' : 'gamepad'} input changes (${changes.join(', ')})`);\n  }\n}\n","import Phaser from 'phaser';\nimport BootScene from './boot-scene';\nimport prop, {commands, shaderCoordFragments, shaderColorFragments} from '../props';\nimport {updatePropsFromStep} from './lib/manage-gui';\nimport {shaderTypeMeta} from './lib/shaders';\nimport {name as project} from '../../package.json';\nimport analytics from './lib/analytics';\nimport CommandManager from './CommandManager';\n\nconst baseConfig = {\n  type: Phaser.AUTO,\n  parent: 'engine',\n  width: 800,\n  height: 600,\n  tileWidth: 24,\n  tileHeight: 24,\n};\n\nexport default class SuperGame extends Phaser.Game {\n  constructor(subConfig, preloadScenes) {\n    const config = {\n      ...baseConfig,\n      ...subConfig,\n    };\n\n    super(config);\n\n    Object.entries(config).forEach(([key, value]) => {\n      if (!(key in this.config)) {\n        this.config[key] = value;\n      }\n    });\n\n    this.debug = config.debug;\n\n    this.scene.add('BootScene', BootScene, true, {seed: Date.now(), sceneId: String(Math.random())});\n\n    this.preloadScenes = preloadScenes;\n\n    // hack to stop phaser from rejecting our fullscreen\n    // eslint-disable-next-line no-proto\n    this.scale.__proto__.onFullScreenChange = function() {};\n\n    this.prop = prop;\n\n    this._replayPreflight = 0;\n\n    this._onDisableDebugUI = [];\n\n    this._sceneInitCallbacks = {};\n\n    this.assets = {};\n\n    this.command = new CommandManager(commands);\n\n    this._shaderSource = {};\n    this._shaderCoordFragments = shaderCoordFragments;\n    this._shaderColorFragments = shaderColorFragments;\n    this.shaderFragments = [...(shaderCoordFragments || []), ...(shaderColorFragments || [])];\n\n    this.focused = true;\n\n    this._sceneConstructors = {};\n    [\n      BootScene,\n      ...preloadScenes,\n    ].forEach((sceneClass) => {\n      this._sceneConstructors[sceneClass.name] = sceneClass;\n    });\n\n    if (config.debug) {\n      const game = this;\n      window.scene = new Proxy({}, {\n        get(target, key) {\n          return game.topScene()[key];\n        },\n      });\n      window.prop = prop;\n    }\n\n    this.events.on('step', () => {\n      const topScene = this.topScene();\n\n      this.readRawInput();\n\n      if (config.debug) {\n        if (this._replayPreflight > 0) {\n          return;\n        }\n\n        if (!this.disableDebug && (!topScene._replay || !topScene._replay.timeSight)) {\n          updatePropsFromStep(false);\n        }\n\n        if (prop('engine.throttle')) {\n          const begin = new Date().getTime();\n          // eslint-disable-next-line no-empty\n          while ((new Date()).getTime() - begin < 50) {\n          }\n        }\n      }\n    });\n  }\n\n  changeVolume(newVolume) {\n    this.volume = newVolume;\n\n    if (this.currentMusicPlayer) {\n      this.currentMusicPlayer.setVolume(newVolume * prop('scene.musicVolume'));\n    }\n\n    this.scene.scenes.forEach((scene) => {\n      scene.changeVolume(newVolume);\n    });\n  }\n\n  setFocused(isFocused) {\n    if (this.focused === isFocused) {\n      return;\n    }\n\n    this.focused = isFocused;\n  }\n\n  topScene() {\n    const {scenes} = this.scene;\n    return scenes[scenes.length - 1];\n  }\n\n  preloadComplete() {\n    const spinner = document.getElementById('lds-spinner');\n    if (spinner && spinner.parentNode) {\n      spinner.parentNode.removeChild(spinner);\n    }\n\n    this._preloadedAssets = true;\n    this.tryLaunch();\n  }\n\n  activateGame(callback) {\n    if (!this._activatedGame) {\n      this._activatedGame = [];\n    }\n\n    if (callback) {\n      this._activatedGame.push(callback);\n    }\n\n    this.tryLaunch();\n  }\n\n  tryLaunch() {\n    if (!this._preloadedAssets || !this._activatedGame) {\n      return;\n    }\n\n    if (this._launchedGame) {\n      if (this._activatedGame) {\n        this._activatedGame.forEach((callback) => {\n          callback();\n        });\n        delete this._activatedGame;\n      }\n      return;\n    }\n\n    if (this._launchingGame) {\n      return;\n    }\n\n    this._launchingGame = true;\n\n    analytics('00 started game');\n\n    // eslint-disable-next-line no-console\n    console.warn(`Welcome to ${project}!`);\n\n    // if clicking comes first, removing the scene immediately after\n    // preloading finishes causes a crash\n    setTimeout(() => {\n      if (this.renderer.type === Phaser.CANVAS) {\n        // eslint-disable-next-line no-alert\n        alert('It looks like this browser will offer a degraded experience. For best results, please use Chrome!');\n      }\n\n      const cover = document.getElementById('cover');\n      if (cover && cover.parentNode) {\n        cover.parentNode.removeChild(cover);\n      }\n\n      this.scene.remove(BootScene.key());\n      this.launch();\n\n      const scene = this.topScene();\n      if (scene) {\n        scene.willTransitionFrom();\n        scene.timer(() => scene.didTransitionFrom()).ignoresScenePause = true;\n      }\n\n      this._activatedGame.forEach((callback) => {\n        callback();\n      });\n      delete this._activatedGame;\n      this._launchedGame = true;\n    });\n  }\n\n  onDisableDebugUI(callback) {\n    if (this.disableDebug) {\n      callback();\n    } else {\n      this._onDisableDebugUI.push(callback);\n    }\n  }\n\n  disableDebugUI() {\n    if (this.disableDebug) {\n      return;\n    }\n\n    this.disableDebug = true;\n\n    this._onDisableDebugUI.forEach((callback) => callback());\n\n    const manage = document.querySelector('.development .Manage');\n    if (manage) {\n      manage.remove();\n    }\n\n    const replay = document.querySelector('.development .Replay');\n    if (replay) {\n      replay.remove();\n    }\n\n    const log = document.querySelector('.development .Logging');\n    if (log) {\n      log.remove();\n    }\n  }\n\n  forceQuit() {\n    this.stopRecording();\n    this.stopReplay();\n\n    this.destroy(true, true);\n\n    const engine = document.querySelector('#engine-container');\n    if (engine) {\n      engine.remove();\n    }\n\n    this.disableDebugUI();\n\n    const isInFullScreen = document.fullscreenElement\n      || document.webkitFullscreenElement\n      || document.mozFullScreenElement\n      || document.msFullscreenElement;\n\n    if (isInFullScreen) {\n      if (document.exitFullscreen) {\n        document.exitFullscreen();\n      } else if (document.webkitExitFullscreen) {\n        document.webkitExitFullscreen();\n      } else if (document.mozCancelFullScreen) {\n        document.mozCancelFullScreen();\n      } else if (document.msExitFullscreen) {\n        document.msExitFullscreen();\n      }\n    }\n  }\n\n  zeroPrefix(number, zeros) {\n    let n = number;\n    let o = '';\n    for (let i = 1; i < zeros; i += 1) {\n      if (n < 10) {\n        o += '0';\n      } else {\n        n /= 10;\n      }\n    }\n\n    return `${o}${number}`;\n  }\n\n  renderDateTime(date) {\n    const zero = (n) => this.zeroPrefix(n, 2);\n    return [\n      [date.getFullYear(), zero(date.getMonth() + 1), zero(date.getDate())].join('-'),\n      [date.getHours(), zero(date.getMinutes()), zero(date.getSeconds())].join(':'),\n    ].join(' ');\n  }\n\n  renderMillisecondDuration(duration) {\n    const m = Math.floor(duration / 1000 / 60);\n    if (m > 99) return '99:99.99+';\n    const s = duration / 1000 - m * 60;\n    return `${m}:${this.zeroPrefix(s.toFixed(3), 2)}`;\n  }\n\n  beginRecording(options = {}) {\n    const scene = this.topScene();\n\n    const now = new Date();\n\n    this._recording = {\n      timestamp: now.getTime(),\n      initData: scene.scene.settings.data,\n      sceneName: scene.constructor.name,\n      name: this.renderDateTime(now),\n      commandState: this.command.freezeCommandState(),\n      ...options,\n    };\n\n    scene.beginRecording(this._recording);\n\n    if (this._recording.snapshot) {\n      this.stopRecording();\n    } else if (this.onRecordBegin) {\n      this.onRecordBegin(this._recording);\n    }\n  }\n\n  stopRecording() {\n    const recording = this._recording;\n    if (!recording) {\n      return;\n    }\n\n    this.topScene().stopRecording();\n    delete this._recording;\n\n    if (this.onRecordStop) {\n      this.onRecordStop(recording);\n    }\n\n    return recording;\n  }\n\n  beginReplay(replay, options = {}) {\n    this._replay = replay;\n\n    let {startFromTransition} = options;\n    const {sceneTransitions} = replay;\n    if (!startFromTransition && sceneTransitions) {\n      for (let i = 0; i < sceneTransitions.length; i += 1) {\n        if (sceneTransitions[i].tickCount <= replay.preflightCutoff) {\n          startFromTransition = sceneTransitions[i];\n        }\n      }\n    }\n\n    const preflightCutoff = Math.max(\n      replay.preflightCutoff,\n      startFromTransition ? (startFromTransition.tickCount || 0) : 0,\n    );\n\n    this.transitionToSceneToBeginReplay(replay, startFromTransition).then((newScene) => {\n      newScene.beginReplay(replay, {\n        ...options,\n        startFromTransition,\n        preflightCutoff,\n        onEnd: () => {\n          this.endedReplay();\n        },\n        onStop: () => {\n          this.stopReplay(true);\n        },\n      });\n\n      if (this.onReplayBegin) {\n        this.onReplayBegin(replay);\n      }\n    });\n  }\n\n  transitionToSceneToBeginReplay(replay, startFromTransition) {\n    const oldScene = this.topScene();\n    const sceneKey = `scene-${Math.random() * Date.now()}`;\n\n    const {\n      sceneSaveState, sceneName, initData, commandState,\n    } = startFromTransition || replay;\n    const save = JSON.parse(JSON.stringify(sceneSaveState));\n    const {seed} = (startFromTransition || replay).initData;\n\n    const returnPromise = new Promise((resolve, reject) => {\n      this.onSceneInit(sceneKey, (newScene) => {\n        this.command.thawCommandState(commandState);\n        newScene.willTransitionFrom(null, null);\n        oldScene._sceneTransition(oldScene, newScene, null);\n        resolve(newScene, null);\n      });\n    });\n\n    oldScene.scene.add(\n      sceneKey,\n      this._sceneConstructors[sceneName],\n      true,\n      {\n        ...initData,\n        save,\n        seed,\n        transition: null,\n      },\n    );\n\n    return returnPromise;\n  }\n\n  endedReplay() {\n    if (!this._replay) {\n      return;\n    }\n\n    const replay = this._replay;\n    delete this._replay;\n\n    if (this.onReplayEnd) {\n      this.onReplayEnd(replay);\n    }\n  }\n\n  stopReplay(skipDownward) {\n    if (!this._replay) {\n      return;\n    }\n\n    const replay = this._replay;\n    delete this._replay;\n\n    if (!skipDownward) {\n      this.topScene().stopReplay();\n    }\n\n    if (this.onReplayStop) {\n      this.onReplayStop(replay);\n    }\n  }\n\n  playMusic(name, forceRestart) {\n    if (forceRestart || this.currentMusicName !== name) {\n      this.currentMusicName = name;\n      if (this.currentMusicPlayer && this.currentMusicPlayer.key) {\n        this.currentMusicPlayer.destroy();\n      }\n\n      if (name) {\n        const music = this.sound.add(name);\n        music.play('', {loop: true});\n        music.setVolume(this.volume * prop('scene.musicVolume'));\n        this.currentMusicPlayer = music;\n      }\n    }\n  }\n\n  readRawInput() {\n    const scenes = this.scene.scenes.filter((scene) => scene.input.gamepad);\n    if (scenes) {\n      this.command.readRawGamepad(scenes);\n    }\n  }\n\n  cutoffTimeSightEnter() {\n    const scene = this.topScene();\n    if (scene) {\n      scene.cutoffTimeSightEnter();\n    }\n  }\n\n  cutoffTimeSightChanged(start, end) {\n    const scene = this.topScene();\n    if (scene) {\n      scene.cutoffTimeSightChanged(start, end);\n    }\n  }\n\n  cutoffTimeSightLeave() {\n    const scene = this.topScene();\n    if (scene) {\n      scene.cutoffTimeSightLeave();\n    }\n  }\n\n  shaderInstance(shaderName) {\n    if (this.renderer.type !== Phaser.WEBGL) {\n      return null;\n    }\n\n    return this.renderer.getPipeline(shaderName);\n  }\n\n  initializeShader(shaderName, replace) {\n    if (this.renderer.type !== Phaser.WEBGL) {\n      return;\n    }\n\n    if (!replace && this.renderer.hasPipeline(shaderName)) {\n      return;\n    }\n\n    const source = this.generateShaderSource(shaderName);\n\n    if (source) {\n      const shaderClass = this.shaderInstantiation(source);\n      const shader = new shaderClass(this);\n\n      // undefined `active` indicates the shader didn't completely load,\n      // probably due to a compile error\n      if (!shader || shader.active === undefined) {\n        return;\n      }\n\n      if (replace) {\n        this.renderer.removePipeline(shaderName);\n      }\n\n      this.renderer.addPipeline(shaderName, shader);\n\n      shader.setFloat2('resolution', this.config.width, this.config.height);\n    } else {\n      this.renderer.removePipeline(shaderName);\n    }\n\n    this._shaderSource[shaderName] = source;\n  }\n\n  initializeMainShaders() {\n    this.initializeShader('main');\n  }\n\n  updateShaderFragments(nextCoord, nextColor) {\n    this._shaderCoordFragments = nextCoord;\n    this._shaderColorFragments = nextColor;\n    this.shaderFragments = [...(nextCoord || []), ...(nextColor || [])];\n\n    this.recompileMainShaders();\n  }\n\n  generateShaderSourceInternal(shaderName) {\n    if (shaderName !== 'main') {\n      throw new Error('Multi-shader support not yet available');\n    }\n\n    const [shaderCoordSource, shaderColorSource] = [this._shaderCoordFragments, this._shaderColorFragments].map((fragments) => {\n      if (!fragments) {\n        return '';\n      }\n\n      return fragments.filter(([name]) => prop(`shader.${name}.enabled`)).map(([, , source]) => source).join('\\n');\n    });\n\n    if (!shaderCoordSource && !shaderColorSource) {\n      return;\n    }\n\n    return `\n      void main( void ) {\n        vec2 uv = outTexCoord;\n\n        ${shaderCoordSource}\n\n        vec4 c = texture2D(u_texture, uv);\n\n        ${shaderColorSource}\n\n        c.r *= c.a;\n        c.g *= c.a;\n        c.b *= c.a;\n\n        gl_FragColor = vec4(c.r, c.g, c.b, 1.0);\n      }\n    `;\n  }\n\n  generateShaderSource(shaderName) {\n    if (shaderName !== 'main') {\n      throw new Error('Multi-shader support not yet available');\n    }\n\n    const builtinDeclarations = `\n      precision mediump float;\n    `;\n\n    const builtinUniforms = `\n      uniform sampler2D u_texture;\n      varying vec2      outTexCoord;\n\n      uniform vec2 resolution;\n      uniform vec2 camera_scroll;\n      uniform float scene_time;\n    `;\n\n    const uniformNames = [];\n    const uniformDeclarations = [];\n\n    this.shaderFragments.forEach(([fragmentName, uniforms]) => {\n      if (!prop(`shader.${fragmentName}.enabled`)) {\n        return;\n      }\n\n      Object.entries(uniforms).forEach(([uniformName, [type]]) => {\n        const name = `${fragmentName}_${uniformName}`;\n        uniformNames.push(name);\n        const [, uniformType] = shaderTypeMeta[type];\n        uniformDeclarations.push(`uniform ${uniformType} ${name};\\n`);\n      });\n    });\n\n    const userShaderMain = this.generateShaderSourceInternal(shaderName);\n    if (!userShaderMain) {\n      return userShaderMain;\n    }\n\n    uniformNames.forEach((name) => {\n      const regex = new RegExp(`\\\\b${name.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')}\\\\b`);\n\n      if (!userShaderMain.match(regex)) {\n        // eslint-disable-next-line no-console\n        console.error(`Shader program doesn't appear use uniform '${name}'. (If this is a false positive, try adding this to your program: // ${name}`);\n      }\n    });\n\n    return `\n      ${builtinDeclarations}\n      ${builtinUniforms}\n      ${uniformDeclarations.join('')}\n      ${userShaderMain}\n    `;\n  }\n\n  recompileShader(shaderName) {\n    if (this.renderer.type !== Phaser.WEBGL) {\n      return;\n    }\n\n    const oldSource = this._shaderSource[shaderName];\n    const newSource = this.generateShaderSource(shaderName);\n\n    if (oldSource === newSource) {\n      return;\n    }\n\n    // eslint-disable-next-line no-console\n    console.info(`Hot-loading shader ${shaderName}`);\n\n    this._shaderSource[shaderName] = newSource;\n\n    if (newSource) {\n      this.initializeShader(shaderName, true);\n    } else {\n      this.renderer.removePipeline(shaderName);\n    }\n\n    const shader = this.shaderInstance(shaderName);\n\n    this.scene.scenes.forEach((scene) => {\n      if (scene.shaderName !== shaderName) {\n        return;\n      }\n\n      scene.shader = shader;\n      if (newSource) {\n        scene._shaderInitialize();\n        scene._shaderUpdate();\n        scene.camera.setPipeline(shader);\n      } else {\n        scene.camera.clearRenderToTexture();\n      }\n    });\n  }\n\n  recompileMainShaders() {\n    this.recompileShader('main');\n  }\n\n  disableShader(shaderName) {\n    if (this.renderer.type !== Phaser.WEBGL) {\n      return;\n    }\n\n    this._shaderSource[shaderName] = null;\n\n    this.renderer.removePipeline(shaderName);\n\n    const shader = this.shaderInstance(shaderName);\n\n    this.scene.scenes.forEach((scene) => {\n      if (scene.shaderName !== shaderName) {\n        return;\n      }\n\n      scene.shader = shader;\n      scene.camera.clearRenderToTexture();\n    });\n  }\n\n  disableMainShaders() {\n    this.disableShader('main');\n  }\n\n  shaderInstantiation(fragShader) {\n    try {\n      return new Phaser.Class({\n        Extends: Phaser.Renderer.WebGL.Pipelines.TextureTintPipeline,\n        initialize: function Shader(game) {\n          try {\n            Phaser.Renderer.WebGL.Pipelines.TextureTintPipeline.call(this, {\n              game,\n              renderer: game.renderer,\n              fragShader,\n            });\n          } catch (e) {\n            // eslint-disable-next-line no-console\n            console.error(e);\n          }\n        },\n      });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n    }\n  }\n\n  onSceneInit(key, cb) {\n    if (!this._sceneInitCallbacks[key]) {\n      this._sceneInitCallbacks[key] = [];\n    }\n\n    this._sceneInitCallbacks[key].push(cb);\n  }\n\n  sceneDidInit(scene) {\n    const {key} = scene.scene;\n    if (!this._sceneInitCallbacks[key]) {\n      return;\n    }\n\n    this._sceneInitCallbacks[key].forEach((cb) => {\n      cb(scene);\n    });\n\n    delete this._sceneInitCallbacks[key];\n  }\n}\n","export const Distance = (dx, dy) => {\n  return Math.sqrt(dx ** 2 + dy ** 2);\n};\n\nexport const NormalizeVector = (dx, dy) => {\n  const d = Distance(dx, dy);\n  return [dx / d, dy / d];\n};\n\nexport const NormalizeVectorWithDistance = (dx, dy) => {\n  const d = Distance(dx, dy);\n  return [dx / d, dy / d, d];\n};\n\nexport const SumVectors = (vs) => {\n  let tx = 0;\n  let ty = 0;\n\n  vs.foreach((vx, vy) => {\n    tx += vx;\n    ty += vy;\n  });\n\n  return [tx, ty];\n};\n\nexport const CentroidPoints = (ps) => {\n  let tx = 0;\n  let ty = 0;\n\n  ps.foreach((px, py) => {\n    tx += px;\n    ty += py;\n  });\n\n  return [tx / ps.length, ty / ps.length];\n};\n\nexport const CentroidObjects = (os, x, y) => {\n  let tx = 0;\n  let ty = 0;\n\n  os.foreach((ox, oy) => {\n    tx += ox - x;\n    ty += oy - y;\n  });\n\n  return [tx / os.length, ty / os.length];\n};\n\nexport const TowardCentroid = (os, x, y) => {\n  let tx = 0;\n  let ty = 0;\n  os.forEach((o) => {\n    tx += o.x - x;\n    ty += o.y - y;\n  });\n  tx /= os.length;\n  ty /= os.length;\n  return NormalizeVector(tx, ty);\n};\n\nexport const AvoidObjects = (os, x, y, r) => {\n  let tx = 0;\n  let ty = 0;\n  let count = 0;\n\n  os.forEach((o) => {\n    const dx = x - o.x;\n    const dy = y - o.y;\n    const d = Distance(dx, dy);\n\n    if (d > r) {\n      return;\n    }\n\n    tx += dx / (d ** 2);\n    ty += dy / (d ** 2);\n    count += 1;\n  });\n\n  if (count === 0) {\n    return null;\n  }\n\n  tx /= count;\n  ty /= count;\n\n  return NormalizeVector(tx, ty);\n};\n\nexport const AvoidObject = (o, x, y, r) => {\n  const [dx, dy, d] = NormalizeVectorWithDistance(x - o.x, y - o.y);\n\n  if (d > r) {\n    return;\n  }\n\n  return [dx, dy];\n};\n\nexport const AvoidClosestObject = (os, x, y) => {\n  let min;\n\n  os.forEach((o) => {\n    const dx = x - o.x;\n    const dy = y - o.y;\n    const d = Distance(dx, dy);\n\n    if (!min || d < min[0]) {\n      min = [d, dx, dy];\n    }\n  });\n  const [d, tx, ty] = min;\n  return [tx / d, ty / d];\n};\n\nexport const ClosestObject = (os, x, y) => {\n  let min;\n\n  os.forEach((o) => {\n    const dx = o.x - x;\n    const dy = o.y - y;\n    const d = Distance(dx, dy);\n\n    if (!min || d < min[1]) {\n      min = [o, d];\n    }\n  });\n  return min;\n};\n\nexport const SeekClosestObject = (os, x, y) => {\n  let min;\n\n  os.forEach((o) => {\n    const dx = o.x - x;\n    const dy = o.y - y;\n    const d = Distance(dx, dy);\n\n    if (!min || d < min[0]) {\n      min = [d, dx, dy];\n    }\n  });\n  const [d, tx, ty] = min;\n  return [tx / d, ty / d];\n};\n","import SuperScene from './scaffolding/SuperScene';\nimport prop, {tileDefinitions} from './props';\nimport analytics from './scaffolding/lib/analytics';\nimport {\n  Distance, NormalizeVector, TowardCentroid, AvoidObjects,\n  AvoidObject, AvoidClosestObject, SeekClosestObject,\n  ClosestObject,\n} from './vector';\n\nconst FAR_EDGE = 'FAR_EDGE';\nconst tileHeight = 24;\nconst tileWidth = 24;\nconst halfWidth = tileWidth / 2;\nconst halfHeight = tileHeight / 2;\n\nexport default class PlayScene extends SuperScene {\n  constructor() {\n    super({\n      input: {\n        gamepad: true,\n      },\n      physics: {\n        arcade: {\n          fps: 60,\n        },\n      },\n    });\n\n    this.performanceProps = [];\n    this.mapsAreRectangular = true;\n  }\n\n  initialSaveState() {\n    return {\n      createdAt: Date.now(),\n      levelId: 'intro',\n      wonLevel: {\n      },\n    };\n  }\n\n  saveStateVersion() {\n    return 1;\n  }\n\n  migrateSaveStateVersion1(save) {\n  }\n\n  init(config) {\n    super.init(config);\n    this.config = config;\n    this.xBorder = this.yBorder = 0;\n\n    if (config.levelId === undefined) {\n      config.levelId = this.save.levelId;\n      if (this.save.levelPlayer) {\n        config.player = this.save.levelPlayer;\n      }\n    }\n  }\n\n  preload() {\n    super.preload();\n  }\n\n  create(config) {\n    super.create(config);\n\n    const levelId = config.levelId || 'intro';\n    this.loadLevel(levelId);\n    this.flock_amount = 0;\n\n    this.save.levelId = levelId;\n    this.save.levelPlayer = config.player;\n    this.saveState();\n\n    this.music = 'musicPeace';\n  }\n\n  getTreasure(name) {\n    this.save[name] = true;\n    this.saveState();\n  }\n\n  createTreasure(defer) {\n    const {level} = this;\n    const treasureGroup = level.treasureGroup || this.physics.add.staticGroup();\n    level.treasureGroup = treasureGroup;\n\n    if (defer) {\n      return;\n    }\n\n    const [tile] = level.mapLookups.$ || [];\n    if (!tile) {\n      return;\n    }\n\n    this.camera.shake(100, 0.01);\n    this.playSound('soundCoopHit');\n\n    const [xCoord, yCoord] = this.positionToScreenCoordinate(tile.x, tile.y);\n\n    level.treasure = treasureGroup.create(xCoord + halfWidth, yCoord + halfHeight, 'tileTreasureClosed');\n  }\n\n  collectTreasure(player, treasure) {\n    const {x, y} = treasure;\n    if (treasure.collected) {\n      return;\n    }\n\n    treasure.collected = true;\n    treasure.setTexture('tileTreasureOpen');\n    this.playSound('soundTreasure');\n    this.speak(x - tileWidth, y + tileHeight, this.level.treasureScript);\n  }\n\n  loadLevel(id) {\n    const level = this.level = super.loadLevel(id);\n    level.levelId = id;\n\n    this.level.blockades = [];\n\n    this.createUnderground(level.underground || 'imageBackground');\n\n    this.createMap();\n\n    if (!this.save.wonLevel[id]) {\n      this.closeExits(false, true);\n    }\n\n    this.level.player = this.createPlayer();\n    this.level.followers = this.createFollowers();\n    this.level.enemies = this.createEnemies(true);\n    this.level.boundary = this.createBoundary();\n    this.level.treasure = this.createTreasure(true);\n\n    this.setupPhysics();\n\n    if (level.scripts) {\n      level.scripts = JSON.parse(JSON.stringify(level.scripts));\n      level.scripts.forEach((script) => {\n        if (script[1] === null) {\n          const glyph = script[2];\n          const tile = level.mapLookups[glyph][0];\n          script[1] = tile.xCoord + tileWidth;\n          script[2] = tile.yCoord - tileHeight;\n        }\n      });\n    }\n\n    this.night_amount = this.old_night_amount || 0;\n    this.flock_amount = this.old_flock_amount || 0;\n    this.tweenNightAmount(level.initialNight || 0);\n    this.tweenFlockAmount(0);\n    if (this.oldScene) {\n      this.oldScene.tweenNightAmount(level.initialNight || 0);\n      this.oldScene.tweenFlockAmount(0);\n    }\n\n    return level;\n  }\n\n  createTileForGroup(groupName, x, y) {\n    const {level} = this;\n    const group = level.groups[groupName];\n\n    if (group.above) {\n      this.add.image(x, y, group.above);\n    }\n\n    let object;\n\n    if (group.image) {\n      object = group.group.create(x, y, group.image);\n    } else {\n      object = this.add.rectangle(x, y, tileWidth, tileHeight);\n      group.group.add(object);\n    }\n    group.objects.push(object);\n\n    if (group.isCircle) {\n      const radius = (halfHeight + halfWidth) / 2;\n      object.setCircle(radius);\n    }\n\n    return object;\n  }\n\n  cameraColor() {\n    return 0x4D8C3A;\n  }\n\n  createUnderground(name) {\n    const {level} = this;\n    const template = this.add.image(0, 0, name);\n    const {width, height} = template;\n    template.setPosition(width * -0.5, height * -0.5);\n\n    let x = -0.5;\n    let y = -0.5;\n\n    while ((x - 1) * width < level.width + tileWidth) {\n      y = -0.5;\n\n      while ((y - 1) * height < level.height + tileHeight) {\n        if (!(x === -0.5 && y === -0.5)) {\n          this.add.image(x * width, y * height, name);\n        }\n        y += 1;\n      }\n\n      x += 1;\n    }\n  }\n\n  createMap() {\n    const {level} = this;\n\n    const groups = level.groups = {};\n    Object.values(tileDefinitions).forEach((spec) => {\n      if (!spec) {\n        return;\n      }\n\n      if (spec.group) {\n        let group;\n        if (spec.isStatic) {\n          group = this.physics.add.staticGroup();\n        } else {\n          group = this.physics.add.group();\n        }\n\n        groups[spec.group] = {\n          tiles: [],\n          objects: [],\n          ...spec,\n          group,\n        };\n      }\n    });\n\n    const brickwork = {\n      left: [],\n      right: [],\n      up: [],\n      down: [],\n    };\n\n    level.map.forEach((row, y) => {\n      row.forEach((tile, x) => {\n        const [xCoord, yCoord] = this.positionToScreenCoordinate(tile.x, tile.y);\n        tile.xCoord = xCoord;\n        tile.yCoord = yCoord;\n\n        let object;\n        if (tile.group === 'wall') {\n          let g;\n          if (x === 0) {\n            g = 'left';\n          } else if (y === 0) {\n            g = 'up';\n          } else if (x === level.widthInTiles - 1) {\n            g = 'right';\n          } else if (y === level.heightInTiles - 1) {\n            g = 'down';\n          }\n\n          if (g) {\n            brickwork[g].push(tile);\n            object = this.add.image(xCoord + halfWidth, yCoord + halfHeight, tile.image);\n          } else {\n            object = this.createTileForGroup(tile.group, xCoord + halfWidth, yCoord + halfHeight);\n          }\n        } else if (tile.group) {\n          object = this.createTileForGroup(tile.group, xCoord + halfWidth, yCoord + halfHeight);\n        } else if (tile.image) {\n          object = this.add.image(xCoord + halfWidth, yCoord + halfHeight, tile.image);\n        }\n        if (object) {\n          object.tile = tile;\n          tile.object = object;\n        }\n      });\n    });\n\n    Object.entries(brickwork).forEach(([direction, tiles]) => {\n      let axis;\n      let other;\n      if (direction === 'left' || direction === 'right') {\n        axis = 'y';\n        other = 'x';\n      } else {\n        axis = 'x';\n        other = 'y';\n      }\n      const t = [...tiles];\n      t.sort((a, b) => a[axis] - b[axis]);\n\n      const gs = [];\n      let g = [];\n      t.forEach((tile) => {\n        if (!g.length) {\n          g.push(tile);\n          return;\n        }\n        const last = g[g.length - 1];\n        if (tile[axis] === last[axis] + 1) {\n          g.push(tile);\n        } else {\n          gs.push(g);\n          g = [tile];\n        }\n      });\n\n      if (g.length) {\n        gs.push(g);\n      }\n\n      gs.forEach((gg) => {\n        const first = gg[0];\n        const last = gg[gg.length - 1];\n        const x = tileWidth * first.x;\n        const y = tileHeight * first.y;\n        const w = tileWidth * (last.x + 1) - x;\n        const h = tileHeight * (last.y + 1) - y;\n        const wall = this.add.rectangle(x + w * 0.5, y + h * 0.5, w, h);\n        groups.wall.group.add(wall);\n        wall.isWall = true;\n      });\n    });\n  }\n\n  createBoundary() {\n    const {level} = this;\n    const {width: levelWidth, height: levelHeight} = level;\n\n    const boundary = this.physics.add.staticGroup();\n\n    const bw = tileWidth * 10;\n    const bh = tileHeight * 10;\n\n    const top = [-bw / 2, -bw, levelWidth + bw, bh];\n    const bottom = [-bw / 2, levelHeight, levelWidth + bw, bh];\n    const left = [-bw, -bh / 2, bw, levelHeight + bh];\n    const right = [levelWidth, -bh / 2, bw, levelHeight + bh];\n    [bottom, left, right, top].forEach(([x, y, w, h]) => {\n      const border = this.add.rectangle(x + w * 0.5, y + h * 0.5, w, h);\n      boundary.add(border);\n    });\n\n    return boundary;\n  }\n\n  createPlayer() {\n    const {level} = this;\n\n    let x;\n    let y;\n    if (this.config.player) {\n      [x, y] = [this.config.player.x, this.config.player.y];\n    } else {\n      const tile = level.mapLookups['@'][0];\n      [x, y] = this.positionToScreenCoordinate(tile.x, tile.y);\n      x += halfWidth;\n      y += halfHeight;\n    }\n\n    if (x === 'FAR_EDGE') {\n      x = level.width - tileWidth * 2;\n    }\n    if (y === 'FAR_EDGE') {\n      y = level.height - tileHeight * 2;\n    }\n\n    if (this.config.player && this.config.player.transitionOffset) {\n      x += (this.config.player.transitionOffset.x || 0) * tileWidth;\n      y += (this.config.player.transitionOffset.y || 0) * tileHeight;\n    }\n\n    const player = this.physics.add.sprite(x, y, 'spritePlayer');\n    player.body.setMass(prop('player.mass'));\n    player.setBounce(prop('player.bounce'));\n    player.setDrag(prop('player.drag'));\n    player.setMaxVelocity(prop('player.maxVelocity'));\n    player.setDamping(true);\n    player.setFriction(prop('player.friction'));\n    player.setSize(18, 18, true);\n\n    player.dash = {\n      active: false,\n      cooldown: false,\n      ax: 0,\n      ay: 0,\n    };\n\n    player.stun = {\n      active: false,\n      cooldown: false,\n    };\n\n    player.children = [];\n\n    this.cameraFollow(player);\n\n    return player;\n  }\n\n  createFollowers() {\n    const {level} = this;\n\n    const followerGroup = this.physics.add.group();\n\n    const mass = prop('follower.mass');\n    const bounce = prop('follower.bounce');\n    const drag = prop('follower.drag');\n    const friction = prop('follower.friction');\n    const maxVelocity = prop('follower.maxVelocity');\n    const radius = (halfWidth + halfHeight) / 2;\n\n    const tiles = level.mapLookups['+'] || [];\n    const followers = tiles.map((tile) => {\n      const [xCoord, yCoord] = this.positionToScreenCoordinate(tile.x, tile.y);\n\n      const follower = followerGroup.create(xCoord + halfWidth, yCoord + halfHeight, 'spriteFollower');\n\n      follower.body.setMass(mass);\n      follower.setBounce(bounce);\n      follower.setDrag(drag);\n      follower.setDamping(true);\n      follower.setFriction(friction);\n      follower.setMaxVelocity(maxVelocity);\n      follower.targetMaxVelocity = maxVelocity;\n      follower.isFollower = true;\n      follower.setSize(18, 18, true);\n\n      return follower;\n    });\n\n    level.followers = followers;\n    level.followerCount = followers.length;\n    level.followerGroup = followerGroup;\n\n    return followers;\n  }\n\n  createEnemies(defer) {\n    const {level} = this;\n    const enemyGroup = level.enemyGroup || this.physics.add.group();\n    const enemies = level.enemies || [];\n\n    if (!defer) {\n      const mass = prop('enemy.mass');\n      const bounce = prop('enemy.bounce');\n      const drag = prop('enemy.drag');\n      const friction = prop('enemy.friction');\n      const maxVelocity = prop('enemy.maxVelocity');\n      const radius = (halfWidth + halfHeight) / 2;\n\n      Object.entries(tileDefinitions).forEach(([glyph, spec]) => {\n        if (!spec || !spec.enemy) {\n          return;\n        }\n        const tiles = level.mapLookups[glyph] || [];\n        const e = tiles.map((tile) => {\n          const [xCoord, yCoord] = this.positionToScreenCoordinate(tile.x, tile.y);\n\n          const enemy = enemyGroup.create(xCoord + halfWidth, yCoord + halfHeight, spec.enemy);\n\n          enemy.body.setMass(mass);\n          enemy.setBounce(bounce);\n          enemy.setDrag(drag);\n          enemy.setDamping(true);\n          enemy.setFriction(friction);\n          enemy.setMaxVelocity(maxVelocity);\n          enemy.targetMaxVelocity = maxVelocity;\n          enemy.isEnemy = true;\n          enemy.anims.play('spriteEnemyAWalk');\n          enemy.setSize(18, 18, true);\n\n          // screws acceleration\n          /*\n          this.tween(\n            null,\n            enemy,\n            {\n              dy: 5,\n              duration: 500,\n              yoyo: true,\n              loop: -1,\n              ease: 'Quad.easeInOut',\n            },\n          );\n          */\n\n          return enemy;\n        });\n\n        enemies.push(...e);\n      });\n    }\n\n    level.enemies = enemies;\n    level.enemyGroup = enemyGroup;\n\n    return enemies;\n  }\n\n  setupAnimations() {\n    this.anims.create({\n      key: 'spriteEnemyAWalk',\n      frames: [\n        {\n          key: 'spriteEnemyA',\n          frame: 0,\n        },\n        {\n          key: 'spriteEnemyA',\n          frame: 1,\n        },\n      ],\n      frameRate: 6,\n      repeat: -1,\n    });\n  }\n\n  setupPhysics() {\n    const {level, physics} = this;\n    const {\n      player, groups, followerGroup, enemyGroup, boundary,\n      treasureGroup,\n    } = level;\n\n    physics.add.overlap(player, groups.transition.group, this.enteredTransition, null, this);\n    physics.add.collider(player, groups.rock.group);\n    physics.add.collider(player, groups.farmer.group);\n    physics.add.collider(player, groups.wall.group);\n    physics.add.collider(player, groups.coop.group, this.playerCollideCoop, null, this);\n    physics.add.collider(player, followerGroup, this.playerCollideFollower, null, this);\n    physics.add.overlap(player, enemyGroup, this.playerKillEnemy, null, this);\n    physics.add.collider(player, treasureGroup, this.collectTreasure, null, this);\n\n    physics.add.collider(followerGroup, groups.rock.group, this.justCoolItDown, null, this);\n    physics.add.collider(followerGroup, groups.farmer.group, this.justCoolItDown, null, this);\n    physics.add.collider(followerGroup, groups.wall.group, this.justCoolItDown, null, this);\n    physics.add.collider(followerGroup, groups.coop.group, this.justCoolItDown, null, this);\n    physics.add.collider(followerGroup, followerGroup, this.justCoolItDown, null, this);\n    physics.add.collider(followerGroup, boundary, this.justCoolItDown, null, this);\n    physics.add.collider(followerGroup, treasureGroup, this.justCoolItDown, null, this);\n    // not needed because world collide\n    // physics.add.collider(followerGroup, groups.transition.group);\n\n    physics.add.collider(enemyGroup, groups.rock.group, this.justCoolItDown, null, this);\n    physics.add.collider(enemyGroup, groups.wall.group, this.justCoolItDown, null, this);\n    physics.add.collider(enemyGroup, groups.coop.group, this.enemyCollideCoop, null, this);\n    physics.add.collider(enemyGroup, enemyGroup, this.justCoolItDown, null, this);\n    physics.add.collider(enemyGroup, boundary, this.justCoolItDown, null, this);\n    physics.add.collider(enemyGroup, treasureGroup, this.justCoolItDown, null, this);\n    physics.add.overlap(enemyGroup, followerGroup, this.enemyKillFollower, null, this);\n  }\n\n  damageCoop(coop, damager) {\n    const fx = coop.x - damager.x;\n    const fy = coop.y - damager.y;\n\n    let dx = 0;\n    let dy = 0;\n\n    if (Math.abs(fx) > Math.abs(fy)) {\n      dx = fx < 0 ? -2 : 2;\n    } else {\n      dy = fy < 0 ? -2 : 2;\n    }\n\n    coop.tile.health -= 1;\n    if (coop.tile.health < 0) {\n      coop.destroy();\n      this.playSound('soundCoopBreak');\n    } else {\n      this.playSound('soundCoopHit');\n    }\n\n    const reduction = 0.5 / this.level.groups.coop.health;\n    let prevFactor = 0;\n    this.tweenPercent(\n      100,\n      (factor) => {\n        coop.alpha -= (factor - prevFactor) * reduction;\n        coop.x += (factor - prevFactor) * dx;\n        coop.y += (factor - prevFactor) * dy;\n        prevFactor = factor;\n      },\n    );\n  }\n\n  enemyCollideCoop(enemy, coop) {\n    this.damageCoop(coop, enemy);\n    enemy.body.setAcceleration(0, 0);\n    enemy.cooldown = true;\n    this.timer(() => {\n      enemy.cooldown = false;\n    }, 1000);\n  }\n\n  playerCollideCoop(player, coop) {\n    if (player.dash.active) {\n      this.damageCoop(coop, player);\n    }\n  }\n\n  playerCollideFollower(player, follower) {\n    this.justCoolItDown(player, follower);\n\n    if (player.dash.active) {\n      this.stopDash();\n      this.buttobasu(player, follower, true);\n      this.killFollower(follower);\n    }\n  }\n\n  sleep(duration) {\n    // this.pauseEverythingForTransition();\n    this.timer(() => {\n      // this.unpauseEverythingForTransition();\n    }, duration).ignoresScenePause = true;\n  }\n\n  impact(duration, scale = 0.1) {\n    this.timeScale = scale;\n\n    this.camera.zoomTo(\n      1.05,\n      duration / 2,\n      'Cubic.easeIn',\n      true,\n    );\n\n    this.timer(() => {\n      this.timeScale = 1;\n      this.camera.zoomTo(\n        1,\n        duration,\n        'Cubic.easeIn',\n        true,\n      );\n    }, duration);\n  }\n\n  impactUnlessLosing(...args) {\n    if (this.level.zoomForLossCompleted || this.level.zoomedForLoss || this.level.unzoomForLoss) {\n      return;\n    }\n\n    this.impact(...args);\n  }\n\n  buttobasu(player, entity, isFollower) {\n    entity.disableBody();\n\n    const [ex, ey] = NormalizeVector(entity.x - player.x, entity.y - player.y);\n    const [ax, ay] = NormalizeVector(player.dash.ax, player.dash.ay);\n    let dx = (ax + ex) / 2;\n    let dy = (ay + ey) / 2;\n    if (isNaN(dx) || isNaN(dy)) {\n      dx = ex;\n      dy = ey;\n    }\n\n    const pause = 40;\n    this.sleep(pause * this.timeScale);\n    this.timer(() => {\n      this.impactUnlessLosing(400, 0.2);\n    }, pause).ignoresScenePause = true;\n\n    this.camera.shake(100, 0.005);\n\n    this.playSound('soundCoopHit');\n    this.timer(() => {\n      if (isFollower) {\n        this.playSound('soundDashFollower');\n      } else {\n        this.playSound('soundDashKill');\n      }\n    }, 80);\n\n    this.tween(\n      null,\n      entity,\n      {\n        alpha: 0,\n        delay: 40,\n        duration: 700,\n        dx: 600 * dx,\n        dy: 600 * dy,\n        scaleX: 3,\n        scaleY: 3,\n        rotation: dx < 0 ? -300 : 300,\n        ease: 'Quad.easeOut',\n        onComplete: () => {\n          entity.destroy();\n        },\n      },\n    );\n    // });\n  }\n\n  butsu(killer, victim) {\n    victim.disableBody();\n\n    const [ex, ey] = NormalizeVector(victim.x - killer.x, victim.y - killer.y);\n\n    this.tween(\n      null,\n      victim,\n      {\n        alpha: 0,\n        duration: 500,\n        dx: 100 * ex,\n        dy: 100 * ey,\n        ease: 'Quad.easeOut',\n        onComplete: () => {\n          victim.destroy();\n        },\n      },\n    );\n  }\n\n  fakeStun(entity) {\n    if (entity === this.level.player) {\n      return;\n    }\n\n    entity.cooldown = true;\n    entity.body.setAcceleration(0, 0);\n\n    entity.stunAlpha = this.tween(\n      null,\n      entity,\n      {\n        alpha: 0.5,\n        duration: 200,\n      },\n    );\n\n    entity.stunRotate = this.tween(\n      null,\n      entity,\n      {\n        delay: 200,\n        rotation: 360,\n        duration: 1000,\n        onComplete: () => {\n          entity.stunRecover = this.tween(\n            null, entity,\n            {\n              alpha: 1,\n              duration: 200,\n            },\n          );\n          entity.cooldown = false;\n        },\n      },\n    );\n  }\n\n  justCoolItDown(a, b) {\n    if (a.body && a.body.setAcceleration) {\n      this.fakeStun(a);\n    }\n\n    if (b.body && b.body.setAcceleration) {\n      this.fakeStun(b);\n    }\n  }\n\n  killFollower(follower) {\n    const {level} = this;\n    level.followers = level.followers.filter((f) => f !== follower);\n    if (level.followers.length === 0) {\n      level.lastFollower = follower;\n    }\n\n    const reduction = 1 / level.followerCount;\n    let prevFactor = 0;\n    this.tweenPercent(\n      prop('effects.followerDie.duration'),\n      (factor) => {\n        this.flock_amount += (factor - prevFactor) * reduction;\n        prevFactor = factor;\n      },\n    );\n  }\n\n  enemyKillFollower(enemy, follower) {\n    this.butsu(enemy, follower);\n    this.killFollower(follower);\n    this.playSound('soundMurder');\n  }\n\n  playerKillEnemy(player, enemy) {\n    const {level} = this;\n    level.enemies = level.enemies.filter((f) => f !== enemy);\n\n    if (player.dash.active) {\n      this.stopDash();\n      this.buttobasu(player, enemy);\n    } else {\n      this.butsu(player, enemy);\n      this.playSound('soundHit');\n    }\n\n    if (level.enemies.length === 0) {\n      this.timer(() => {\n        this.playSound('soundWin');\n        this.winLevel();\n      }, 1000);\n    }\n  }\n\n  closeExits(animated, forward, extraDelay = 0) {\n    const {level} = this;\n\n    const glyph = forward ? ';' : '^';\n\n    const tiles = [...level.mapLookups[glyph] || []];\n    tiles.sort((a, b) => a.x - b.x || a.y - b.y);\n\n    this.level.blockades.push(tiles);\n\n    const time = animated ? 500 : 0;\n\n    tiles.forEach((tile, i) => {\n      this.timer(() => {\n        const {xCoord, yCoord} = tile;\n        if (tile.object.disableBody) {\n          tile.object.disableBody();\n        } else {\n          tile.object.body.enable = false;\n        }\n        const object = this.createTileForGroup('wall', xCoord + halfWidth, yCoord + halfHeight);\n        tile.block = object;\n\n        if (animated) {\n          this.camera.shake(50, 0.01);\n          this.playSound('soundBorder');\n        }\n      }, time * (i + 2));\n    });\n\n    if (time) {\n      this.timer(() => {\n        this.command.ignoreAll('blockade', false);\n      }, time * (tiles.length + 2) + extraDelay);\n    }\n\n    return time * (tiles.length + 2);\n  }\n\n  openExits() {\n    const {level} = this;\n\n    level.blockades.forEach((tiles, t) => {\n      tiles.forEach((tile, i) => {\n        this.timer(() => {\n          if (tile.object.enableBody) {\n            tile.object.enableBody();\n          } else {\n            tile.object.body.enable = true;\n          }\n          tile.block.destroy();\n          if (t === 0) {\n            this.camera.shake(50, 0.01);\n            this.playSound('soundBorder');\n          }\n        }, 1000 + 500 * i);\n      });\n    });\n  }\n\n  winLevel() {\n    this.music = 'musicPeace';\n    this.playMusic();\n\n    if (this.level.glowEmitter) {\n      this.level.glowEmitter.stop();\n    }\n    this.tweenNightAmount(0);\n    this.tweenFlockAmount(0);\n    this.openExits();\n    this.save.wonLevel[this.level.levelId] = true;\n    this.saveState();\n  }\n\n  replaceLostLevel() {\n    if (this.replacing) {\n      return;\n    }\n\n    this.replacing = true;\n    this.timeScale = 1;\n    this.playSound('soundLose');\n\n    this.replaceWithSelf(true, null, {\n      name: 'effects.loseTransition',\n      onUpdate: (factor, oldScene, newScene) => {\n        if (factor <= 0.5) {\n          oldScene.flock_amount = 1 - (factor * 2);\n        }\n      },\n    });\n  }\n\n  enteredTransition(player, transition) {\n    if (this.transitioning) {\n      return;\n    }\n\n    const {x, y} = transition.tile;\n    let direction = 'right';\n    let animation = 'pushRight';\n    const playerConfig = {};\n\n    // TODO derive this scale\n    let dx = 3.25 * tileWidth;\n    let dy = 3.25 * tileHeight;\n\n    if (x <= 0) {\n      direction = 'left';\n      animation = 'pushRight';\n      playerConfig.y = player.y;\n      playerConfig.x = FAR_EDGE;\n      dy = 0;\n      dx *= -1;\n    } else if (y <= 0) {\n      direction = 'up';\n      animation = 'pushDown';\n      playerConfig.x = player.x;\n      playerConfig.y = FAR_EDGE;\n      dx = 0;\n      dy *= -1;\n    } else if (x >= this.level.widthInTiles - 1) {\n      direction = 'right';\n      animation = 'pushLeft';\n      playerConfig.y = player.y;\n      playerConfig.x = 2 * tileWidth;\n      dy = 0;\n    } else if (y >= this.level.heightInTiles - 1) {\n      direction = 'down';\n      animation = 'pushUp';\n      playerConfig.x = player.x;\n      playerConfig.y = 2 * tileHeight;\n      dx = 0;\n    }\n\n    playerConfig.transitionOffset = this.level[`${direction}Offset`];\n\n    this.transitioning = {\n      direction,\n    };\n\n    const nextLevel = this.level[direction];\n    if (!nextLevel) {\n      console.error('missing next level for direction', direction);\n    }\n\n    let oldX;\n    let oldY;\n    let newX;\n    let newY;\n\n    player.disableBody();\n    this.timeScale = 1;\n\n    this.replaceWithSelf(\n      true,\n      {\n        levelId: nextLevel,\n        player: playerConfig,\n      },\n      {\n        name: 'effects.sceneTransition',\n        animation,\n        onUpdate: (progress, oldScene, newScene) => {\n          if (oldX === undefined) {\n            oldX = oldScene.level.player.x;\n            oldY = oldScene.level.player.y;\n            newX = newScene.level.player.x;\n            newY = newScene.level.player.y;\n          }\n          oldScene.level.player.x = oldX + dx * progress;\n          oldScene.level.player.y = oldY + dy * progress;\n          newScene.level.player.x = newX + dx * (progress - 1);\n          newScene.level.player.y = newY + dy * (progress - 1);\n        },\n      },\n    );\n  }\n\n  musicName() {\n    if (this.level && this.level.levelId === 'last') {\n      return 'musicWin';\n    }\n\n    return this.music;\n  }\n\n  firstUpdate(time, dt) {\n    super.firstUpdate(time, dt);\n  }\n\n  stopDash() {\n    const {level} = this;\n    const {player} = level;\n\n    const normalVelocity = prop('player.maxVelocity');\n    player.setMaxVelocity(normalVelocity);\n    player.dash.active = false;\n    if (player.dashEmitter) {\n      player.dashEmitter.stop();\n      player.dashEmitter = false;\n    }\n\n    player.dash.cooldown = true;\n\n    this.timer(() => {\n      player.dash.cooldown = false;\n    }, prop('player.dash.cooldown_duration'));\n  }\n\n  dash(ax, ay) {\n    const {level} = this;\n    const {player} = level;\n\n    this.playSound('soundDash');\n\n    if (level.onDash) {\n      const script = level.onDash;\n      delete level.onDash;\n      this.speak(player.x, player.y, script);\n    }\n\n    player.dash.active = true;\n    player.dash.ax = ax;\n    player.dash.ay = ay;\n\n    const [dx, dy] = NormalizeVector(ax, ay);\n\n    const normalVelocity = prop('player.maxVelocity');\n    const dashVelocity = prop('player.dash.velocity');\n\n    let dashEmitter;\n    let dashCallback;\n    this.particleSystem(\n      'effects.dashPuff',\n      {\n        scale: {start: 0.5, end: 0},\n        alpha: {start: 1, end: 0},\n        speedX: -40 * ax,\n        speedY: -40 * ay,\n        onAdd: (particles, emitter) => {\n          dashEmitter = emitter;\n          emitter.x.propertyValue = player.x + tileWidth * dy;\n          emitter.y.propertyValue = player.y + tileHeight * dy;\n          dashCallback = (x, y) => {\n            emitter.x.propertyValue = x + tileWidth / 2 * -dx;\n            emitter.y.propertyValue = y + tileHeight / 2 * -dy;\n          };\n          player.children.push(dashCallback);\n        },\n      },\n    );\n\n    player.dashEmitter = dashEmitter;\n\n    this.tweenSustainExclusive(\n      'dashTimer',\n      prop('player.dash.in_duration'),\n      prop('player.dash.sustain_duration'),\n      prop('player.dash.out_duration'),\n      (factor) => {\n        const v = normalVelocity + factor * (dashVelocity - normalVelocity);\n        player.setMaxVelocity(v);\n      },\n      null,\n      () => {\n        player.dash.ax = null;\n        player.dash.ay = null;\n        dashEmitter.stop();\n        player.children = player.children.filter((c) => c !== dashCallback);\n      },\n      () => {\n        this.stopDash();\n      },\n      prop('player.dash.in_ease'),\n      prop('player.dash.out_ease'),\n    );\n  }\n\n  stun() {\n    const {level} = this;\n    const {player} = level;\n\n    this.playSound('soundStun');\n\n    if (level.onStun) {\n      const script = level.onStun;\n      delete level.onStun;\n      this.speak(player.x, player.y, script);\n    }\n\n    player.stun.active = true;\n\n    const px = player.x;\n    const py = player.y;\n    this.shockwave(px, py);\n\n    [...this.level.enemies, ...this.level.followers].forEach((entity) => {\n      const distance = Distance(entity.x - px, entity.y - py);\n      const effect = 1 - distance / 300;\n      if (effect < 0) {\n        return;\n      }\n\n      if (entity.stunAlpha) {\n        entity.stunAlpha.stop();\n      }\n      if (entity.stunRotate) {\n        entity.stunRotate.stop();\n      }\n      if (entity.stunRecover) {\n        entity.stunRecover.stop();\n      }\n\n      const delay = distance * 0.75;\n\n      this.timer(() => {\n        entity.cooldown = true;\n        entity.body.setAcceleration(0, 0);\n\n        entity.stunAlpha = this.tween(\n          null,\n          entity,\n          {\n            alpha: 0.5,\n            duration: 200,\n          },\n        );\n\n        entity.stunRotate = this.tween(\n          null,\n          entity,\n          {\n            delay: 200,\n            rotation: 360,\n            duration: 2000 * effect,\n            onComplete: () => {\n              entity.stunRecover = this.tween(\n                null, entity,\n                {\n                  alpha: 1,\n                  duration: 200,\n                },\n              );\n              entity.cooldown = false;\n            },\n          },\n        );\n      }, delay);\n    });\n\n    this.timer(() => {\n      player.stun.active = false;\n      player.stun.cooldown = true;\n      this.timer(() => {\n        player.stun.cooldown = false;\n      }, 5000);\n    }, 1000);\n  }\n\n  processInput(time, dt) {\n    const {command, level} = this;\n    const {player} = level;\n\n    let ax = 0;\n    let ay = 0;\n    let stickInput = false;\n\n    if (command.up.held) {\n      ay = -1;\n    } else if (command.down.held) {\n      ay = 1;\n    }\n\n    if (command.right.held) {\n      ax = 1;\n    } else if (command.left.held) {\n      ax = -1;\n    }\n\n    if (command.lstick.held) {\n      [ax, ay] = command.lstick.held;\n      stickInput = true;\n    } else if (command.rstick.held) {\n      [ax, ay] = command.rstick.held;\n      stickInput = true;\n    }\n\n    if (stickInput) {\n      if (Math.abs(ax) > 0.9) {\n        ax = ax < 0 ? -1 : 1;\n        ay = 0;\n      } else if (Math.abs(ay) > 0.9) {\n        ay = ay < 0 ? -1 : 1;\n        ax = 0;\n      }\n    }\n\n    if (player.dash.ax || player.dash.ay) {\n      ax = 0.1 * ax + 0.9 * player.dash.ax;\n      ay = 0.1 * ay + 0.9 * player.dash.ay;\n    }\n\n    if (ax || ay) {\n      [ax, ay] = NormalizeVector(ax, ay);\n      const accel = prop('player.acceleration');\n      player.lastAccel = [ax, ay];\n      player.body.setAcceleration(ax * accel, ay * accel);\n    } else {\n      player.body.setAcceleration(0, 0);\n    }\n\n    if (command.dash.started && this.save.dash && !player.dash.active && !player.dash.cooldown) {\n      if (!ax && !ay) {\n        if (player.lastAccel) {\n          [ax, ay] = player.lastAccel;\n        }\n      }\n\n      if (!ax && !ay) {\n        ax = 1;\n        ay = 0;\n      }\n\n      this.dash(ax, ay);\n    }\n\n    if (command.stun.started && this.save.stun && !player.stun.active && !player.stun.cooldown) {\n      this.stun();\n    }\n  }\n\n  playDialog() {\n    const {level} = this;\n    const {scripts, player} = level;\n\n    if (!scripts) {\n      return;\n    }\n\n    scripts.forEach((script) => {\n      if (script.played) {\n        return;\n      }\n\n      const [radius, x, y] = script;\n\n      if (Distance(player.x - x, player.y - y) < radius) {\n        script.played = true;\n\n        // shift off radius\n        script.shift();\n        this.speak(...script);\n      }\n    });\n  }\n\n  fixedUpdate(time, dt) {\n    this.processInput();\n    this.p = ((this.p || 0) + 1) % 3;\n    this.flockFollowers(this.p);\n    this.flockEnemies(this.p);\n    this.zoomOnLoss();\n    this.updateVelocities(time, dt);\n    this.moveChildren();\n    this.playDialog();\n\n    const {player} = this.level;\n    if (!this.transitioning && (player.x < 0 || player.y < 0 || player.x > this.level.width || player.y > this.level.height)) {\n      player.x = this.level.width * 0.5;\n      player.y = this.level.height * 0.5;\n    }\n\n    if (!this.spawningEnemies && this['night_amount'] > 0.99 && time > 1000 && !this.suppressShit) {\n      this.spawningEnemies = true;\n\n      this.particleSystem(\n        'effects.glow',\n        {\n          x: {min: 0, max: this.level.width},\n          y: {min: 0, max: this.level.height},\n          alpha: {\n            start: 0,\n            end: 1,\n\n            ease: (t) => (t > 0.5 ? 2 * (1 - t) : t * 2),\n          },\n          onAdd: (particles, emitter) => {\n            this.level.glowEmitter = emitter;\n          },\n        },\n      );\n\n      let duration = this.closeExits(true, false, 500);\n      if (this.save.wonLevel[this.level.levelId]) {\n        duration = Math.max(this.closeExits(true, true, 500));\n      }\n\n      this.timer(() => {\n        this.createEnemies();\n        this.level.enemies.forEach((enemy) => {\n          enemy.alpha = 0;\n          enemy.cooldown = true;\n          this.music = 'musicWar';\n          this.playMusic();\n          this.tween(\n            null,\n            enemy,\n            {\n              alpha: 1,\n              duration: 500,\n              onComplete: () => {\n                enemy.cooldown = false;\n              },\n            },\n          );\n        });\n      }, duration);\n    }\n  }\n\n  moveChildren() {\n    const {level} = this;\n    const {player} = level;\n\n    player.children.forEach((object) => {\n      if (typeof object === 'function') {\n        object(player.x, player.y);\n      } else {\n        object.x = player.x;\n        object.y = player.y;\n      }\n    });\n  }\n\n  tweenNightAmount(amount) {\n    const start = this.night_amount;\n    if (amount > 0.99) {\n      if (!this.suppressShit) {\n        this.music = null;\n        this.playMusic();\n        this.playSound('soundHowl');\n        this.command.ignoreAll('blockade', true);\n      }\n    }\n\n    return this.tweenPercent(\n      1000,\n      (factor) => {\n        this.night_amount = start * (1 - factor) + factor * amount;\n      },\n    );\n  }\n\n  tweenFlockAmount(amount) {\n    const start = this.flock_amount;\n    return this.tweenPercent(\n      1000,\n      (factor) => {\n        this.flock_amount = start * (1 - factor) + factor * amount;\n      },\n    );\n  }\n\n  speak(x, y, lines, defaults = {\n    inTime: 200, outTime: 200, duration: 1000, extraDelay: 0, dy: -20, noOut: false,\n  }) {\n    let delay = 0;\n\n    lines.forEach((line, i) => {\n      const {\n        duration, inTime, outTime, text, extraDelay,\n        execute, goof, dy, noOut,\n      } = {\n        ...defaults,\n        ...(typeof line === 'object' ? line : {text: line}),\n      };\n\n      this.timer(() => {\n        if (execute) {\n          const [method, ...args] = execute;\n          this[method](...args);\n        }\n\n        const label = this.add.text(\n          x,\n          y + dy,\n          text,\n          {\n            fontFamily: '\"Avenir Next\", \"Avenir\", \"Helvetica Neue\", \"Helvetica\", \"Arial\"',\n            fontSize: '24px',\n            fontWeight: 'bold',\n            color: 'rgb(0, 0, 0)',\n          },\n        );\n\n        label.alpha = 0;\n        this.tweenPercent(\n          inTime,\n          (factor) => {\n            label.alpha = factor;\n            label.y = y - dy * (1.0 - factor);\n          },\n          null,\n          0,\n          'Cubic.easeOut',\n        );\n\n        if (noOut) {\n          return;\n        }\n\n        this.timer(() => {\n          if (!goof) {\n            this.tweenPercent(\n              outTime,\n              (factor) => {\n                label.alpha = 1.0 - factor;\n                label.y = y - dy * factor;\n              },\n              () => {\n                label.destroy();\n              },\n              0,\n              'Cubic.easeOut',\n            );\n          } else {\n            this.tweenPercent(\n              Math.abs(outTime * goof / defaults.dy),\n              (factor) => {\n                label.y = y - goof * factor;\n              },\n              () => {\n                label.destroy();\n              },\n            );\n          }\n        }, duration);\n      }, extraDelay + delay);\n      delay += extraDelay + duration + inTime + outTime;\n    });\n  }\n\n  zoomOnLoss() {\n    const {level} = this;\n    const {enemies, followers, player} = level;\n\n    if (followers.length > 1) {\n      return;\n    }\n\n    // no followers were ever on the level\n    if (followers.length === 0 && !level.lastFollower) {\n      return;\n    }\n\n    if (this.level.zoomForLossCompleted && followers.length === 0) {\n      this.timer(() => {\n        this.replaceLostLevel();\n      }, 2000 * this.timeScale).ignoresScenePause = true;\n    }\n\n    const minDistance = prop('effects.zoomOnLoss.distance');\n\n    let isSafe = false;\n    let min;\n\n    if (enemies.length === 0) {\n      isSafe = true;\n    } else if (followers.length === 0) {\n      min = [0, level.lastFollower, null];\n    } else {\n      for (let f = 0; f < followers.length; f += 1) {\n        const follower = followers[f];\n        const [enemy, distance] = ClosestObject(enemies, follower.x, follower.y);\n        const effectiveDistance = Math.max(0.01, distance - tileWidth);\n        if (this.losing) {\n          if (effectiveDistance > 2 * minDistance) {\n            isSafe = true;\n            break;\n          }\n        } else if (effectiveDistance > minDistance) {\n          isSafe = true;\n          break;\n        }\n\n        if (!min || effectiveDistance < min[0]) {\n          min = [effectiveDistance, follower, enemy];\n        }\n      }\n    }\n\n    if (!min || isSafe) {\n      this.level.losing = null;\n      if (!this.level.zoomedForLoss || this.level.unzoomForLoss) {\n        return;\n      }\n\n      this.level.unzoomForLoss = true;\n      this.level.zoomedForLoss = false;\n      this.level.zoomForLossCompleted = false;\n\n      this.unzoomStartTimer = this.timer(() => {\n        if (this.level.zoomedForLoss) {\n          return;\n        }\n\n        this.camera.zoomTo(\n          1,\n          prop('effects.zoomOnLoss.recover_zoom_duration'),\n          prop('effects.zoomOnLoss.recover_zoom_ease'),\n          true,\n        );\n        this.camera.pan(\n          player.x,\n          player.y,\n          prop('effects.zoomOnLoss.recover_pan_duration'),\n          prop('effects.zoomOnLoss.recover_pan_ease'),\n          true,\n          () => {\n            this.cameraFollow(player);\n            this.camera.useBounds = true;\n            // this.setCameraDeadzone();\n          },\n        ).ignoresScenePause = true;\n\n        const originTimeScale = prop('effects.zoomOnLoss.time_scale');\n        this.unzoomTimeScaleTween = this.tweenPercent(\n          prop('effects.zoomOnLoss.recover_time_scale_duration'),\n          (factor) => {\n            this.timeScale = factor + originTimeScale * (1.0 - factor);\n          },\n          null,\n          0,\n          prop('effects.zoomOnLoss.recover_time_scale_ease'),\n        );\n        this.unzoomTimeScaleTween.timeScale = 1;\n      }, prop('effects.zoomOnLoss.recover_linger_duration'));\n    } else {\n      const [, follower] = min;\n      this.level.losing = min;\n      this.level.unzoomForLoss = false;\n      if (this.unzoomTimeScaleTween) {\n        this.unzoomTimeScaleTween.stop();\n      }\n\n      if (!this.level.zoomedForLoss) {\n        this.level.zoomForLossCompleted = false;\n        this.pauseEverythingForTransition();\n        this.level.zoomedForLoss = true;\n        const panDuration = prop('effects.zoomOnLoss.pan_duration');\n        const zoomDuration = prop('effects.zoomOnLoss.zoom_duration');\n\n        this.camera.setDeadzone(0, 0);\n        this.cameraFollow();\n        this.camera.useBounds = false;\n        this.camera.pan(\n          follower.x,\n          follower.y,\n          panDuration,\n          prop('effects.zoomOnLoss.pan_ease'),\n          true,\n        ).ignoresScenePause = true;\n\n        this.camera.zoomTo(\n          prop('effects.zoomOnLoss.zoom_scale'),\n          zoomDuration,\n          prop('effects.zoomOnLoss.zoom_ease'),\n          true,\n        ).ignoresScenePause = true;\n\n        this.timer(() => {\n          this.timeScale = prop('effects.zoomOnLoss.time_scale');\n          this.unpauseEverythingForTransition();\n          this.level.zoomForLossCompleted = true;\n        }, Math.max(panDuration, zoomDuration)).ignoresScenePause = true;\n      }\n    }\n  }\n\n  updateVelocities(time, dt) {\n    const {level} = this;\n    const {followers, enemies} = level;\n\n    const followerLerp = prop('follower.velocityLerp');\n    followers.forEach((follower) => {\n      const v = follower.body.maxVelocity.x;\n      const t = follower.targetMaxVelocity;\n\n      follower.setMaxVelocity(v + followerLerp * (t - v) * (dt / 16));\n    });\n\n    const enemyLerp = prop('follower.velocityLerp');\n    enemies.forEach((enemy) => {\n      const v = enemy.body.maxVelocity.x;\n      const t = enemy.targetMaxVelocity;\n\n      enemy.setMaxVelocity(v + enemyLerp * (t - v) * (dt / 16));\n    });\n  }\n\n  followersNearPoint(x, y, r) {\n    // overlapCirc was added in a newer version of phaser\n    return this.physics.overlapRect(x - r / 2, y - r / 2, r, r, true, false).map((body) => body.gameObject).filter((object) => object.isFollower);\n  }\n\n  enemiesNearPoint(x, y, r) {\n    return this.physics.overlapRect(x - r / 2, y - r / 2, r, r, true, false).map((body) => body.gameObject).filter((object) => object.isEnemy);\n  }\n\n  obstaclesNearPoint(x, y, r) {\n    return this.physics.overlapRect(x - r / 2, y - r / 2, r, r, false, true).map((body) => body.gameObject).filter((object) => object.isWall || (object.tile && object.tile.isObstacle));\n  }\n\n  noncoopObstaclesNearPoint(x, y, r) {\n    return this.physics.overlapRect(x - r / 2, y - r / 2, r, r, false, true).map((body) => body.gameObject).filter((object) => object.isWall || (object.tile && object.tile.isObstacle && !object.tile.isCoop));\n  }\n\n  flockFollowers(subgroup) {\n    const {level} = this;\n    const {followers, player} = level;\n\n    const px = player.x;\n    const py = player.y;\n\n    let acceleration = prop('follower.flockAcceleration');\n    let maxVelocity = prop('follower.maxVelocity');\n\n    const cohereRadius = prop('follower.cohereRadius');\n    const cohereFactor = prop('follower.cohereFactor');\n    const spreadRadius = prop('follower.spreadRadius');\n    const spreadFactor = prop('follower.spreadFactor');\n    const playerFactor = prop('follower.playerFactor');\n    const playerRadius = prop('follower.playerRadius');\n    const obstacleFactor = prop('follower.obstacleFactor');\n    const obstacleRadius = prop('follower.obstacleRadius');\n    const enemyFactor = prop('follower.enemyFactor');\n    const enemyRadius = prop('follower.enemyRadius');\n    const killerFactor = prop('follower.killerFactor');\n    const killerRadius = prop('follower.killerRadius');\n    const killerAcceleration = prop('follower.killerAcceleration');\n    const killerVelocity = prop('follower.killerVelocity');\n\n    followers.forEach((follower, sg) => {\n      if (sg % 3 != subgroup) {\n        return;\n      }\n      if (follower.cooldown) {\n        return;\n      }\n\n      const fx = follower.x;\n      const fy = follower.y;\n\n      let hasFocus = false;\n      let targetX = 0;\n      let targetY = 0;\n\n      if (playerFactor > 0) {\n        const dx = px - fx;\n        const dy = py - fy;\n        const d = Distance(dx, dy);\n        if (d < playerRadius) {\n          targetX += (dx / d) * playerFactor;\n          targetY += (dy / d) * playerFactor;\n          hasFocus = true;\n        }\n      }\n\n      if (cohereFactor > 0) {\n        const fs = this.followersNearPoint(fx, fy, cohereRadius);\n        if (fs.length > 1) {\n          const [x, y] = TowardCentroid(fs, fx, fy);\n          targetX += x * cohereFactor;\n          targetY += y * cohereFactor;\n          hasFocus = true;\n        }\n      }\n\n      if (spreadFactor > 0) {\n        const fs = this.followersNearPoint(fx, fy, spreadRadius);\n        const os = [player, ...fs.filter((f) => f !== follower)];\n        const v = AvoidObjects(os, fx, fy, spreadRadius);\n        if (v) {\n          targetX += v[0] * spreadFactor;\n          targetY += v[1] * spreadFactor;\n          hasFocus = true;\n        }\n      }\n\n      if (obstacleFactor > 0) {\n        const os = this.obstaclesNearPoint(fx, fy, obstacleRadius);\n        const v = AvoidObjects(os, fx, fy, obstacleRadius);\n        if (v) {\n          targetX += v[0] * obstacleFactor;\n          targetY += v[1] * obstacleFactor;\n          hasFocus = true;\n        }\n      }\n\n      if (enemyFactor > 0) {\n        const es = this.enemiesNearPoint(fx, fy, enemyRadius);\n        const v = AvoidObjects(es, fx, fy, enemyRadius);\n        if (v) {\n          targetX += v[0] * enemyFactor;\n          targetY += v[1] * enemyFactor;\n          hasFocus = true;\n        }\n      }\n\n      if (killerFactor > 0) {\n        const es = this.enemiesNearPoint(fx, fy, killerRadius);\n        if (es.length > 0) {\n          const v = AvoidClosestObject(es, fx, fy);\n          if (v) {\n            acceleration += killerAcceleration;\n            maxVelocity += killerVelocity;\n            targetX += v[0] * killerFactor;\n            targetY += v[1] * killerFactor;\n            hasFocus = true;\n          }\n        }\n      }\n\n      if (hasFocus) {\n        const theta = Math.atan2(targetY, targetX);\n        follower.body.setAcceleration(acceleration * Math.cos(theta), acceleration * Math.sin(theta));\n      } else {\n        follower.body.setAcceleration(0, 0);\n      }\n      follower.targetMaxVelocity = maxVelocity;\n    });\n  }\n\n  flockEnemies(subgroup) {\n    const {level} = this;\n    const {followers, enemies, player} = level;\n\n    const px = player.x;\n    const py = player.y;\n\n    let acceleration = prop('enemy.flockAcceleration');\n    let maxVelocity = prop('enemy.maxVelocity');\n\n    const cohereRadius = prop('enemy.cohereRadius');\n    const cohereFactor = prop('enemy.cohereFactor');\n    const spreadRadius = prop('enemy.spreadRadius');\n    const spreadFactor = prop('enemy.spreadFactor');\n    const avoidPlayerFactor = prop('enemy.avoidPlayerFactor');\n    const avoidPlayerRadius = prop('enemy.avoidPlayerRadius');\n    const seekPlayerFactor = prop('enemy.seekPlayerFactor');\n    const seekPlayerRadius = prop('enemy.seekPlayerRadius');\n    const obstacleFactor = prop('enemy.obstacleFactor');\n    const obstacleRadius = prop('enemy.obstacleRadius');\n    const followerFactor = prop('enemy.followerFactor');\n    const followerRadius = prop('enemy.followerRadius');\n    const victimFactor = prop('enemy.victimFactor');\n    const victimRadius = prop('enemy.victimRadius');\n    const victimAcceleration = prop('enemy.victimAcceleration');\n    const victimVelocity = prop('enemy.victimVelocity');\n\n    enemies.forEach((enemy, sg) => {\n      if (sg % 3 !== subgroup) {\n        return;\n      }\n      if (enemy.cooldown) {\n        return;\n      }\n\n      const fx = enemy.x;\n      const fy = enemy.y;\n\n      let hasFocus = false;\n      let targetX = 0;\n      let targetY = 0;\n\n      if (avoidPlayerFactor > 0) {\n        const v = AvoidObject(player, fx, fy, avoidPlayerRadius);\n        if (v) {\n          targetX += v[0] * avoidPlayerFactor;\n          targetY += v[1] * avoidPlayerFactor;\n          hasFocus = true;\n        }\n      }\n\n      if (seekPlayerFactor > 0) {\n        const dx = px - fx;\n        const dy = py - fy;\n        const d = Distance(dx, dy);\n        if (d < seekPlayerRadius) {\n          targetX += (dx / d) * seekPlayerFactor;\n          targetY += (dy / d) * seekPlayerFactor;\n          hasFocus = true;\n        }\n      }\n\n      if (cohereFactor > 0) {\n        const fs = this.enemiesNearPoint(fx, fy, cohereRadius);\n        if (fs.length > 1) {\n          const [x, y] = TowardCentroid(fs, fx, fy);\n          targetX += x * cohereFactor;\n          targetY += y * cohereFactor;\n          hasFocus = true;\n        }\n      }\n\n      if (spreadFactor > 0) {\n        const es = this.enemiesNearPoint(fx, fy, spreadRadius).filter((e) => e !== enemy);\n        if (es.length) {\n          const v = AvoidObjects(es, fx, fy, spreadRadius);\n          if (v) {\n            targetX += v[0] * spreadFactor;\n            targetY += v[1] * spreadFactor;\n            hasFocus = true;\n          }\n        }\n      }\n\n      if (obstacleFactor > 0) {\n        const os = this.noncoopObstaclesNearPoint(fx, fy, obstacleRadius);\n        const v = AvoidObjects(os, fx, fy, obstacleRadius);\n        if (v) {\n          targetX += v[0] * obstacleFactor;\n          targetY += v[1] * obstacleFactor;\n          hasFocus = true;\n        }\n      }\n\n      if (followerFactor > 0) {\n        const fs = this.followersNearPoint(fx, fy, followerRadius);\n        if (fs.length) {\n          const v = TowardCentroid(fs, fx, fy, followerRadius);\n          if (v) {\n            targetX += v[0] * followerFactor;\n            targetY += v[1] * followerFactor;\n            hasFocus = true;\n          }\n        }\n      }\n\n      if (victimFactor > 0) {\n        const fs = this.followersNearPoint(fx, fy, victimRadius);\n        if (fs.length > 0) {\n          const v = SeekClosestObject(fs, fx, fy);\n          if (v) {\n            acceleration += victimAcceleration;\n            maxVelocity += victimVelocity;\n            targetX += v[0] * victimFactor;\n            targetY += v[1] * victimFactor;\n            hasFocus = true;\n          }\n        }\n      }\n\n      if (hasFocus) {\n        const theta = Math.atan2(targetY, targetX);\n        enemy.body.setAcceleration(acceleration * Math.cos(theta), acceleration * Math.sin(theta));\n      } else {\n        enemy.body.setAcceleration(0, 0);\n      }\n      enemy.targetMaxVelocity = maxVelocity;\n    });\n  }\n\n  willTransitionTo(newScene, transition) {\n    super.willTransitionTo(newScene, transition);\n    this.suppressShit = true;\n  }\n\n  willTransitionFrom(oldScene, transition) {\n    super.willTransitionFrom(oldScene, transition);\n\n    this.oldScene = oldScene;\n    this.willTransition = transition;\n\n    if (oldScene && oldScene.transitioning) {\n      this.transitioning = true;\n    }\n\n    this.old_night_amount = oldScene ? (oldScene.night_amount || 0) : 0;\n    this.old_flock_amount = oldScene ? (oldScene.flock_amount || 0) : 0;\n  }\n\n  didTransitionTo(newScene, transition) {\n    super.didTransitionTo(newScene, transition);\n  }\n\n  didTransitionFrom(oldScene, transition) {\n    super.didTransitionFrom(oldScene, transition);\n    this.transitioning = null;\n    this.command.ignoreAll('blockade', false);\n    this.playMusic();\n  }\n\n  launchTimeSight() {\n    super.launchTimeSight();\n  }\n\n  renderTimeSightFrameInto(scene, phantomDt, time, dt, isLast) {\n    const objects = [];\n\n    return objects;\n  }\n\n  debugHandlePointerdown(event) {\n    let {x, y} = event;\n    const {level} = this;\n    const {player} = level;\n\n    x += this.camera.scrollX;\n    y += this.camera.scrollY;\n\n    player.body.setAcceleration(0, 0);\n    player.body.setVelocity(0, 0);\n    player.x = x;\n    player.y = y;\n  }\n\n  _hotReloadCurrentLevel() {\n    super._hotReloadCurrentLevel({\n    }, {\n      animation: 'crossFade',\n      duration: 200,\n      delayNewSceneShader: true,\n      removeOldSceneShader: true,\n    }).then((scene) => {\n    });\n  }\n\n  _hot() {\n    // this._hotReloadCurrentLevel();\n  }\n}\n","import SuperGame from './scaffolding/SuperGame';\nimport proxyClass from './scaffolding/lib/proxy';\n\nimport PlayScene from './play-scene';\n\nconst baseConfig = {\n  tileWidth: 24,\n  tileHeight: 24,\n};\n\nexport default class Game extends SuperGame {\n  constructor(options) {\n    const config = {\n      ...baseConfig,\n      ...options,\n    };\n    super(\n      config,\n      [PlayScene],\n    );\n  }\n\n  launch() {\n    this.scene.add(`scene-${Date.now()}`, PlayScene, true, {\n      seed: Date.now(),\n      sceneId: String(Math.random()),\n    });\n  }\n}\n\nif (module.hot) {\n  {\n    const proxy = proxyClass(PlayScene);\n    module.hot.accept('./play-scene', () => {\n      const Next = require('./play-scene').default;\n      window.game.scene.scenes.forEach((scene) => {\n        if (scene.constructor.name === Next.name) {\n          proxyClass(Next, scene, proxy);\n        }\n      });\n    });\n  }\n}\n","import React from 'react';\nimport './Engine.css';\nimport Spinner from './Spinner';\nimport Controls from './Controls';\nimport Game from '../game';\nimport cover from '../assets/cover.png';\nimport {saveField, loadField} from './lib/store';\n\nexport default class Engine extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      activating: false,\n      activated: false,\n      focused: true,\n      volume: loadField('volume', 0.66),\n      scale: null,\n    };\n    this.controls = React.createRef();\n  }\n\n  componentDidMount() {\n    const {loadedGame, debug} = this.props;\n    const {volume} = this.state;\n\n    window.addEventListener('visibilitychange', this.didVisibilityChange);\n    window.addEventListener('blur', this.didBlur);\n    document.addEventListener('blur', this.didBlur);\n    window.addEventListener('focus', this.didFocus);\n    document.addEventListener('focus', this.didFocus);\n\n    const body = document.querySelector('body');\n    body.classList.add('natural');\n\n    this.game = new Game({debug});\n    this.game.changeVolume(volume);\n\n    if (loadedGame) {\n      loadedGame(this.game, (callback) => this.activateGame(callback));\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('visibilitychange', this.didVisibilityChange);\n    window.removeEventListener('blur', this.didBlur);\n    document.removeEventListener('blur', this.didBlur);\n    window.removeEventListener('focus', this.didFocus);\n    document.removeEventListener('focus', this.didFocus);\n  }\n\n  onMouseMove() {\n    if (this.moveTimeout) {\n      clearTimeout(this.moveTimeout);\n    } else {\n      document.querySelector('body').classList.add('mouseMoved');\n    }\n\n    this.moveTimeout = setTimeout(() => {\n      this.clearMove(false);\n    }, 3000);\n  }\n\n  setVolume(volume) {\n    this.setState({volume});\n\n    this.game.changeVolume(volume);\n\n    saveField('volume', volume);\n  }\n\n  didVisibilityChange = () => {\n    const hidden = document.visibilityState === 'hidden';\n    this.setState({focused: !hidden});\n    this.game.setFocused(!hidden);\n  };\n\n  didBlur = () => {\n    this.setState({focused: false});\n    this.game.setFocused(false);\n  };\n\n  didFocus = () => {\n    this.setState({focused: true});\n    this.game.setFocused(true);\n  };\n\n  activateGame(callback) {\n    const {activated} = this.state;\n\n    if (activated) {\n      if (callback) {\n        callback();\n      }\n      return;\n    }\n\n    this.setState({activating: true});\n\n    this.game.activateGame(() => {\n      // might happen multiple times\n      this.setState({activated: true});\n      this.clearMove(true);\n      if (callback) {\n        callback();\n      }\n    });\n  }\n\n  clearMove(instant) {\n    if (!this.moveTimeout) {\n      return;\n    }\n\n    clearTimeout(this.moveTimeout);\n    this.moveTimeout = null;\n\n    if (instant) {\n      this.controls.current.style.transition = 'none';\n      setTimeout(() => {\n        this.controls.current.style.transition = '';\n      });\n    }\n\n    document.querySelector('body').classList.remove('mouseMoved');\n  }\n\n  enterFullscreen() {\n    const body = document.querySelector('body');\n    const engine = document.querySelector('#engine');\n\n    if (body && engine) {\n      body.classList.add('scaled');\n      body.classList.remove('natural');\n\n      engine.style.overflow = '';\n\n      this.resizeHandler = () => {\n        const {width, height} = this.game.config;\n        const scale = 0.95 * Math.min(window.innerWidth / width, window.innerHeight / height);\n        this.setState({scale});\n      };\n      this.resizeHandler();\n\n      window.addEventListener('resize', this.resizeHandler);\n\n      if (!this.fullscreenHandler) {\n        this.fullscreenHandler = () => {\n          const isInFullScreen = document.fullscreenElement\n            || document.webkitFullscreenElement\n            || document.mozFullScreenElement\n            || document.msFullscreenElement;\n\n          if (!isInFullScreen) {\n            this.exitFullscreen(true);\n          }\n        };\n\n        document.addEventListener('webkitfullscreenchange', this.fullscreenHandler, false);\n        document.addEventListener('mozfullscreenchange', this.fullscreenHandler, false);\n        document.addEventListener('fullscreenchange', this.fullscreenHandler, false);\n        document.addEventListener('MSFullscreenChange', this.fullscreenHandler, false);\n      }\n\n      if (body.requestFullscreen) {\n        body.requestFullscreen();\n      } else if (body.mozRequestFullScreen) {\n        body.mozRequestFullScreen();\n      } else if (body.webkitRequestFullScreen) {\n        body.webkitRequestFullScreen();\n      } else if (body.msRequestFullscreen) {\n        body.msRequestFullscreen();\n      }\n    }\n  }\n\n  exitFullscreen(skipBrowserFullscreen) {\n    const body = document.querySelector('body');\n    const engine = document.querySelector('#engine');\n    if (body && engine) {\n      body.classList.add('natural');\n      body.classList.remove('scaled');\n\n      engine.style.overflow = 'hidden';\n\n      this.setState({scale: null});\n\n      if (this.moveTimeout) {\n        clearTimeout(this.moveTimeout);\n        this.moveTimeout = null;\n      }\n\n      window.removeEventListener('resize', this.resizeHandler);\n      window.removeEventListener('mousemove', this.moveHandler);\n    }\n\n    if (!skipBrowserFullscreen) {\n      if (document.exitFullscreen) {\n        document.exitFullscreen();\n      } else if (document.webkitExitFullscreen) {\n        document.webkitExitFullscreen();\n      } else if (document.mozCancelFullScreen) {\n        document.mozCancelFullScreen();\n      } else if (document.msExitFullscreen) {\n        document.msExitFullscreen();\n      }\n    }\n  }\n\n  render() {\n    const {\n      activating, scale, volume, focused,\n    } = this.state;\n    const { disableFullscreen } = this.props;\n\n    const classes = [];\n    classes.push(activating ? 'activated' : 'activate');\n    classes.push(focused ? 'focused' : 'blurred');\n\n    return (\n      <div className={classes.join(' ')} id=\"engine-container\">\n        <div\n          id=\"engine\"\n          onMouseMove={() => this.onMouseMove()}\n          onClick={() => this.activateGame()}\n          style={scale ? {transform: `scale(${scale})`} : {}}\n          ref={(container) => {\n            if (this.gameContainerRef) {\n              return;\n            }\n\n            this.gameContainerRef = container;\n          }}\n        >\n          <div style={{backgroundImage: `url(${cover})`}} id=\"cover\" />\n          <Spinner />\n        </div>\n        <Controls\n          ref={this.controls}\n          onMouseMove={() => this.onMouseMove()}\n          volume={volume}\n          onVolumeChange={(v) => this.setVolume(v)}\n          disableFullscreen={disableFullscreen}\n          isFullscreen={scale}\n          enterFullscreen={() => this.enterFullscreen()}\n          exitFullscreen={() => this.exitFullscreen()}\n        />\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './Manage.css';\nimport {saveField, loadField} from './lib/store';\nimport {initializeManage, updateSearch, serializeChangedProps, resetChangedProps} from './lib/manage-gui';\n\nexport default class Manage extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      search: loadField('search', ''),\n    };\n\n    this.ref = React.createRef();\n  }\n\n  componentDidMount() {\n    const {search} = this.state;\n\n    const gui = initializeManage();\n    this.ref.current.append(gui.domElement);\n\n    if (search !== '') {\n      updateSearch(search, true);\n    }\n  }\n\n  copyChangedProps() {\n    const tempNode = document.createElement('textarea');\n    tempNode.value = serializeChangedProps();\n    document.body.appendChild(tempNode);\n    tempNode.select();\n    document.execCommand('copy');\n    document.body.removeChild(tempNode);\n  }\n\n  render() {\n    const {search} = this.state;\n    return (\n      <div className=\"Manage\">\n        <input\n          type=\"search\"\n          className=\"search\"\n          placeholder=\"Filter props…\"\n          value={search}\n          onChange={(e) => {\n            // eslint-disable-next-line react/destructuring-assignment\n            const isStarted = this.state.search === '';\n            this.setState({search: e.target.value});\n            updateSearch(e.target.value, isStarted);\n            saveField('search', e.target.value);\n          }}\n        />\n        <input\n          type=\"button\"\n          className=\"copy\"\n          value=\"Copy changes\"\n          onClick={() => this.copyChangedProps()}\n        />\n        <input\n          type=\"button\"\n          className=\"reset\"\n          value=\"Reset to saved\"\n          onClick={() => resetChangedProps()}\n        />\n        <div className={search === '' ? '' : 'searching'} ref={this.ref} />\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './DoubleEnder.css';\n\nconst semiFloor = (n) => {\n  return Math.floor(2 * n) / 2;\n};\n\nconst semiCeil = (n) => {\n  return Math.ceil(2 * n) / 2;\n};\n\nexport default class DoubleEnder extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      dragging: null,\n      lastDrag: null,\n    };\n\n    this.trackRef = React.createRef();\n    this.cursorRef = React.createRef();\n  }\n\n  componentDidMount() {\n    // force track ref to have getBoundingClientRect\n    // eslint-disable-next-line react/no-unused-state\n    this.setState({refreshDimensions: true});\n\n    window.addEventListener('resize', this.didResize);\n\n    window.game.updateReplayCursor = (frame, replay) => {\n      this.updateCursor(frame, replay);\n    };\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.didResize);\n    delete window.game.updateReplayCursor;\n  }\n\n  didResize = () => {\n    this.forceUpdate();\n  };\n\n  updateCursor(frame, replay) {\n    const {replayTimestamp} = this.props;\n    if (!this.cursorRef.current || !this.trackRef.current) {\n      return;\n    }\n\n    if (frame && replay && replay.timestamp === replayTimestamp) {\n      const {min, max} = this.props;\n      const trackWidth = this.trackRef.current.getBoundingClientRect().width;\n      const cursorPercent = Math.max(0, Math.min(1, (frame - min) / (max - min)));\n      this.cursorRef.current.style.left = `${semiFloor(cursorPercent * trackWidth)}px`;\n      this.cursorRef.current.style.display = 'block';\n    } else {\n      this.cursorRef.current.style.display = 'none';\n    }\n  }\n\n  render() {\n    const {\n      min, max, value1, value2, onChange1, onChange2,\n      onMouseUp, onMouseEnter, onMouseMove, onMouseLeave,\n      onBeginChange, onEndChange, notches, highlight1, highlight2,\n      cursor,\n    } = this.props;\n    const {dragging, lastDrag} = this.state;\n    const sliderWidth = 16;\n\n    const trackDimensions = this.trackRef.current && this.trackRef.current.getBoundingClientRect();\n    const trackLeft = trackDimensions ? trackDimensions.left : 0;\n    const trackWidth = trackDimensions ? trackDimensions.width : 100;\n    const percent1 = Math.max(0, Math.min(1, (value1 - min) / (max - min)));\n    const percent2 = Math.max(0, Math.min(1, (value2 - min) / (max - min)));\n    const highlightPercent1 = Math.max(0, Math.min(1, (highlight1 - min) / (max - min)));\n    const highlightPercent2 = Math.max(0, Math.min(1, (highlight2 - min) / (max - min)));\n    const cursorPercent = Math.max(0, Math.min(1, (cursor - min) / (max - min)));\n\n    return (\n      <div className=\"DoubleEnder\" onMouseUp={onMouseUp} onMouseEnter={onMouseEnter} onMouseMove={onMouseMove} onMouseLeave={onMouseLeave}>\n        <div className=\"track\" ref={this.trackRef} />\n        <div\n          style={{\n            left: `${semiFloor(percent1 * trackWidth)}px`,\n            right: `${semiCeil(trackWidth - percent2 * trackWidth)}px`,\n          }}\n          className=\"track selected\"\n        />\n        <div\n          style={{\n            left: `${semiFloor(highlightPercent1 * trackWidth)}px`,\n            right: `${semiCeil(trackWidth - highlightPercent2 * trackWidth)}px`,\n          }}\n          className=\"track highlighted\"\n        />\n        <div\n          style={{\n            left: `${semiFloor(cursorPercent * trackWidth)}px`,\n            display: cursor === null ? 'none' : 'block',\n          }}\n          className=\"cursor highlighted\"\n          ref={this.cursorRef}\n        />\n        {notches.map(({value, title}) => {\n          const isSelected = (value >= value1 && value <= value2) || (value >= value2 && value <= value1);\n          const isHighlighted = (value >= highlight1 && value <= highlight2) || (value >= highlight2 && value <= highlight1);\n          const percent = Math.max(0, Math.min(1, (value - min) / (max - min)));\n          const classes = ['notch'];\n          if (isHighlighted) {\n            classes.push('highlighted');\n          } else if (isSelected) {\n            classes.push('selected');\n          }\n\n          return (\n            <div\n              key={value}\n              title={title}\n              className={classes.join(' ')}\n              style={{\n                left: `${semiFloor(percent * trackWidth)}px`,\n              }}\n            >\n              {' '}\n            </div>\n          );\n        })}\n        {[1, 2].map((index) => {\n          let i = index;\n          const value = i === 1 ? value1 : value2;\n          let opposite = i === 1 ? 2 : 1;\n          const oppositeValue = opposite === 1 ? value1 : value2;\n          const percent = Math.max(0, Math.min(1, (value - min) / (max - min)));\n\n          return (\n            <div\n              key={i}\n              style={{\n                left: `${semiFloor(percent * (trackWidth - sliderWidth))}px`,\n                zIndex: i === lastDrag ? 5 : 4,\n              }}\n              className={`slider slider${i} ${dragging === i ? 'dragging' : ''}`}\n              onMouseDown={(e) => {\n                const originalX = e.clientX - e.target.getBoundingClientRect().left;\n\n                if (onBeginChange) {\n                  onBeginChange();\n                }\n                let onChange = i === 1 ? onChange1 : onChange2;\n\n                this._dragListener = ({clientX}) => {\n                  const newPercent = (clientX - trackLeft - originalX) / (trackWidth - sliderWidth);\n                  const rawValue = min + newPercent * (max - min);\n                  const newValue = Math.min(max, Math.max(min, rawValue));\n\n                  if ((i === 1 && newValue > oppositeValue) || (i === 2 && newValue < oppositeValue)) {\n                    if (onChange) {\n                      onChange(oppositeValue);\n                    }\n\n                    i = opposite;\n                    opposite = i === 1 ? 2 : 1;\n                    onChange = i === 1 ? onChange1 : onChange2;\n                    this.setState({dragging: i, lastDrag: i});\n                  } else if (onChange) {\n                    onChange(newValue);\n                  }\n                };\n\n                this._upListener = (e) => {\n                  this._dragListener(e);\n\n                  window.removeEventListener('mousemove', this._dragListener);\n                  delete this._dragListener;\n\n                  window.removeEventListener('mouseup', this._upListener);\n                  delete this._upListener;\n\n                  this.setState({dragging: null});\n\n                  if (onEndChange) {\n                    onEndChange();\n                  }\n                };\n\n                window.addEventListener('mousemove', this._dragListener);\n                window.addEventListener('mouseup', this._upListener);\n\n                this.setState({dragging: i, lastDrag: i});\n              }}\n            />\n          );\n        })}\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './Replay.css';\nimport {saveField, loadField} from './lib/store';\nimport DoubleEnder from './DoubleEnder';\n\nconst ReplayEditFields = [\n  'metadata', // must be first\n  'commands',\n  'sceneSaveState',\n  'sceneTransitions',\n];\n\nexport default class Replay extends React.Component {\n  constructor(props) {\n    super(props);\n\n    const replays = loadField('replays', []);\n\n    // migrate old replays\n    replays.forEach((replay) => {\n      if (replay.preflight) {\n        replay.commands = [\n          ...replay.preflight,\n          ...(replay.commands || []),\n        ];\n        replay.preflightCutoff = replay.preflight.reduce((cutoff, frame) => cutoff + (frame._repeat || 1), 0);\n        delete replay.preflight;\n      }\n\n      if (!('tickCount' in replay)) {\n        replay.tickCount = replay.commands.reduce((cutoff, frame) => cutoff + (frame._repeat || 1), 0);\n      }\n\n      if (!('originalPreflightCutoff' in replay)) {\n        replay.originalPreflightCutoff = replay.preflightCutoff;\n      }\n\n      if (!('postflightCutoff' in replay)) {\n        replay.postflightCutoff = replay.tickCount;\n      }\n    });\n\n    this.state = {\n      replays,\n      activeRecording: null,\n      activeReplay: loadField('activeReplay', null),\n      tweaking: loadField('tweaking', null),\n      editing: loadField('editing', null),\n      repeat: loadField('repeat', true),\n    };\n  }\n\n  componentDidMount() {\n    this.beginAutoReplay();\n    this.installGameCallbacks();\n  }\n\n  componentDidUpdate(prevProps) {\n    const {activateGame} = this.props;\n    if (activateGame !== prevProps.activateGame) {\n      this.installGameCallbacks();\n      this.beginAutoReplay();\n    }\n  }\n\n  installGameCallbacks() {\n    const {game} = window;\n    if (!game || game.onRecordBegin) {\n      return;\n    }\n\n    game.onRecordBegin = (activeRecording) => {\n      this.setState({activeRecording});\n    };\n\n    game.onRecordStop = (replay) => {\n      this.setState({activeRecording: null});\n\n      if (this._trashNextRecording) {\n        delete this._trashNextRecording;\n        return;\n      }\n\n      this.setState(({replays}) => {\n        const newReplays = [replay, ...replays];\n\n        setTimeout(() => {\n          saveField('replays', newReplays);\n\n          if (!replay.snapshot) {\n            this.beginReplay(replay);\n          }\n        });\n\n        return {\n          replays: newReplays,\n        };\n      });\n    };\n\n    game.onReplayBegin = (replay) => {\n      if (!replay.snapshot) {\n        this.setActiveReplay(replay);\n      }\n    };\n\n    game.onReplayEnd = (replay) => {\n      const {repeat} = this.state;\n\n      if (repeat && !replay.snapshot) {\n        setTimeout(() => {\n          this.beginReplay(this.state.activeReplay);\n        });\n      } else {\n        this.setActiveReplay(null);\n      }\n    };\n\n    game.onReplayStop = (replay) => {\n      this.setActiveReplay(null);\n    };\n  }\n\n  beginAutoReplay() {\n    const {activateGame} = this.props;\n    const {activeReplay} = this.state;\n\n    if (!activateGame) {\n      return;\n    }\n\n    if (!activeReplay) {\n      return;\n    }\n\n    this.beginReplay(activeReplay);\n  }\n\n  beginReplay(replay, clearOtherEditing) {\n    const {activateGame} = this.props;\n    const {editing} = this.state;\n    activateGame(() => {\n      const {activeReplay} = this.state;\n      let transition;\n\n      if (activeReplay) {\n        if (activeReplay.timestamp === replay.timestamp && !activeReplay.timeSight && replay.timeSight) {\n          transition = window.game.topScene()._replayLatestTransition;\n        }\n\n        window.game.stopReplay();\n      }\n\n      if (clearOtherEditing && editing !== replay.timestamp) {\n        this.setEditing(null);\n      }\n\n      window.game.beginReplay(replay, {\n        startFromTransition: transition,\n      });\n    });\n  }\n\n  stopReplay() {\n    const {activateGame} = this.props;\n    activateGame(() => {\n      window.game.stopReplay();\n    });\n  }\n\n  beginRecording(options) {\n    const {activateGame} = this.props;\n    this.setEditing(null);\n\n    activateGame(() => {\n      window.game.beginRecording(options);\n    });\n  }\n\n  stopRecording() {\n    const {activateGame} = this.props;\n    activateGame(() => {\n      window.game.stopRecording();\n    });\n  }\n\n  trashRecording() {\n    this._trashNextRecording = true;\n    this.stopRecording();\n  }\n\n  toggleTimeSight() {\n    const {activeReplay} = this.state;\n    this.beginReplay({...activeReplay, timeSight: !activeReplay.timeSight}, true);\n  }\n\n  toggleRepeat() {\n    this.setState(({repeat}) => {\n      setTimeout(() => {\n        saveField('repeat', !repeat);\n      });\n\n      return {\n        repeat: !repeat,\n      };\n    });\n  }\n\n  saveReplays() {\n    setTimeout(() => {\n      const {replays, activeReplay, editing} = this.state;\n      saveField('replays', replays);\n      saveField('editing', editing);\n      saveField('activeReplay', activeReplay);\n    });\n  }\n\n  finishEdit(replay, skipFocus) {\n    this.setEditing(null);\n    this.saveReplays();\n  }\n\n  setEditing(editing) {\n    this.setState({editing});\n    saveField('editing', editing);\n  }\n\n  setActiveReplay(activeReplay) {\n    this.setState({activeReplay});\n    saveField('activeReplay', activeReplay);\n  }\n\n  updateReplay({timestamp}, changes, beginReplay) {\n    this.setState(({activeReplay, replays}) => {\n      let newReplay;\n      const newState = {\n        replays: replays.map((replay) => {\n          if (replay.timestamp === timestamp) {\n            newReplay = {\n              ...replay,\n              ...changes,\n            };\n            return newReplay;\n          }\n          return replay;\n        }),\n      };\n\n      if (activeReplay && activeReplay.timestamp === timestamp) {\n        newState.activeReplay = {\n          ...activeReplay,\n          ...changes,\n        };\n      }\n\n      if (newReplay && beginReplay) {\n        setTimeout(() => {\n          this.beginReplay({\n            ...newReplay,\n            timeSight: activeReplay && activeReplay.timeSight,\n          });\n        });\n      }\n\n      return newState;\n    });\n  }\n\n  editName(replay, name, beginReplay) {\n    this.updateReplay(replay, {name}, beginReplay);\n  }\n\n  editPreflightCutoff(replay, preflightCutoff, beginReplay) {\n    const snapshot = preflightCutoff > replay.postflightCutoff * 0.99;\n    this.updateReplay(replay, {preflightCutoff, snapshot}, beginReplay);\n  }\n\n  editPostflightCutoff(replay, postflightCutoff, beginReplay) {\n    const snapshot = replay.preflightCutoff > postflightCutoff * 0.99;\n    this.updateReplay(replay, {postflightCutoff, snapshot}, beginReplay);\n  }\n\n  editCutoffs(replay, preflightCutoff, postflightCutoff, beginReplay) {\n    const snapshot = preflightCutoff > postflightCutoff * 0.99;\n    this.updateReplay(replay, {preflightCutoff, postflightCutoff, snapshot}, beginReplay);\n  }\n\n  deleteReplay({timestamp}) {\n    this.setState(({activeReplay, replays}) => {\n      const newReplays = replays.filter((replay) => replay.timestamp !== timestamp);\n\n      setTimeout(() => {\n        saveField('replays', newReplays);\n      });\n\n      if (activeReplay && activeReplay.timestamp === timestamp) {\n        setTimeout(() => this.stopReplay());\n      }\n\n      return {replays: newReplays};\n    });\n  }\n\n  copyReplay(replay) {\n    const newReplay = {\n      ...replay,\n      timestamp: Date.now(),\n      name: `Copy of ${replay.name}`,\n    };\n\n    this.setState(({replays}) => {\n      const newReplays = [newReplay, ...replays];\n\n      setTimeout(() => {\n        saveField('replays', newReplays);\n      });\n\n      return {replays: newReplays};\n    });\n  }\n\n  cutoffTimeSightEnter() {\n    window.game.cutoffTimeSightEnter();\n  }\n\n  cutoffTimeSightChanged(start, end) {\n    window.game.cutoffTimeSightChanged(start, end);\n  }\n\n  cutoffTimeSightLeave() {\n    window.game.cutoffTimeSightLeave();\n  }\n\n  renderEditReplay(replay) {\n    const {activeReplay} = this.state;\n    let highlight1 = null;\n    let highlight2 = null;\n\n    const {game} = window;\n    const scene = game && game.topScene();\n    let cursor = scene && scene.command ? scene.command.replayTicks : null;\n\n    if (activeReplay && activeReplay.timestamp !== replay.timestamp) {\n      cursor = null;\n    }\n\n    if (activeReplay && activeReplay.timestamp === replay.timestamp && activeReplay.timeSight) {\n      cursor = null;\n\n      const {sceneTransitions} = replay;\n      if (!sceneTransitions || sceneTransitions.length === 0) {\n        highlight1 = replay.preflightCutoff;\n        highlight2 = replay.postflightCutoff;\n      } else {\n        const latestTransition = scene && scene._replayLatestTransition;\n        if (!scene) {\n          // if we haven't rendered yet, the default is preflightCutoff until the next scene transition\n          highlight1 = replay.preflightCutoff;\n          for (let i = 0; i < sceneTransitions.length; i += 1) {\n            if (sceneTransitions[i].tickCount > highlight1) {\n              highlight2 = Math.min(replay.postflightCutoff, sceneTransitions[i].tickCount);\n              break;\n            }\n          }\n        } else if (!latestTransition) {\n          // no transition yet, so take the first segment\n          highlight1 = replay.preflightCutoff;\n          highlight2 = Math.min(replay.postflightCutoff, sceneTransitions[0].tickCount);\n        } else {\n          // take the intersection of the scene's ticks and pre/post flight\n          const firstTick = latestTransition ? (latestTransition.tickCount || 0) : 0;\n          let lastTick = replay.postflightCutoff;\n\n          highlight1 = Math.max(firstTick, replay.preflightCutoff);\n\n          for (let i = 0; i < sceneTransitions.length; i += 1) {\n            if (sceneTransitions[i].tickCount >= firstTick) {\n              if (i + 1 < sceneTransitions.length) {\n                lastTick = sceneTransitions[i + 1].tickCount;\n              }\n              break;\n            }\n          }\n\n          highlight2 = Math.min(lastTick, replay.postflightCutoff);\n        }\n      }\n\n      if (highlight1 > highlight2) {\n        highlight1 = highlight2 = null;\n      }\n    }\n\n    return (\n      <form onSubmit={(e) => {\n        e.preventDefault();\n        this.finishEdit(replay);\n      }}\n      >\n        <input\n          type=\"text\"\n          autoFocus\n          value={replay.name}\n          onChange={(e) => this.editName(replay, e.target.value)}\n        />\n        <span className=\"play button\" title=\"Load snapshot (load state)\" onClick={() => this.beginReplay({...replay, snapshot: true, commands: []})}>🎆</span>\n        <span className=\"tweak button\" title=\"Tweak replay\" onClick={() => this.tweakReplay(replay)}>ℹ</span>\n        <span className=\"copy button\" title=\"Copy replay\" onClick={() => this.copyReplay(replay)}>🔃</span>\n        <span className=\"delete button\" title=\"Delete replay\" onClick={() => this.deleteReplay(replay)}>🚮</span>\n        <span className=\"detail\">\n          {replay.preflightCutoff}\n-\n          {replay.postflightCutoff}\n          {replay.postflightCutoff !== replay.tickCount && ` / ${replay.tickCount}`}\n        </span>\n        <br />\n        <DoubleEnder\n          min={0}\n          max={replay.tickCount}\n          value1={replay.preflightCutoff}\n          value2={replay.postflightCutoff}\n          highlight1={highlight1}\n          highlight2={highlight2}\n          cursor={cursor}\n          notches={(replay.sceneTransitions || []).map((t) => ({value: t.tickCount, title: 'Scene transition'}))}\n          replayTimestamp={replay.timestamp}\n          onMouseEnter={(e) => {\n            this._inCutoffs = true;\n            if (activeReplay && activeReplay.timeSight && activeReplay.timestamp === replay.timestamp) {\n              this.cutoffTimeSightEnter();\n            }\n          }}\n          onMouseLeave={(e) => {\n            this._inCutoffs = false;\n            if (activeReplay && activeReplay.timeSight && activeReplay.timestamp === replay.timestamp) {\n              if (!this._changingCutoffs) {\n                this.cutoffTimeSightLeave();\n              }\n              this.saveReplays();\n            }\n          }}\n          onBeginChange={(e) => {\n            this._changingCutoffs = true;\n          }}\n          onEndChange={(e) => {\n            this._changingCutoffs = false;\n\n            if (activeReplay && activeReplay.timeSight && activeReplay.timestamp === replay.timestamp) {\n              if (!this._inCutoffs) {\n                this.cutoffTimeSightLeave();\n              }\n              this.saveReplays();\n            } else {\n              setTimeout(() => {\n                const {replays} = this.state;\n                const newReplay = replays.find((r) => r.timestamp === replay.timestamp);\n                this.beginReplay(newReplay);\n                this.saveReplays();\n              });\n            }\n          }}\n          onChange1={(preflight) => {\n            this.editPreflightCutoff(replay, Math.floor(preflight));\n            if (activeReplay && activeReplay.timeSight && activeReplay.timestamp === replay.timestamp) {\n              setTimeout(() => {\n                this.cutoffTimeSightChanged(Math.floor(preflight), this.state.activeReplay.postflightCutoff);\n              });\n            }\n          }}\n          onChange2={(postflight) => {\n            this.editPostflightCutoff(replay, Math.floor(postflight));\n            if (activeReplay && activeReplay.timeSight && activeReplay.timestamp === replay.timestamp) {\n              setTimeout(() => {\n                this.cutoffTimeSightChanged(this.state.activeReplay.preflightCutoff, Math.floor(postflight));\n              });\n            }\n          }}\n        />\n        {(replay.preflightCutoff !== replay.originalPreflightCutoff || replay.postflightCutoff !== replay.tickCount) && (\n          <input\n            type=\"button\"\n            onClick={(e) => {\n              e.preventDefault();\n              this.editCutoffs(replay, replay.originalPreflightCutoff, replay.tickCount, true);\n            }}\n            value=\"⤺\"\n          />\n        )}\n      </form>\n    );\n  }\n\n  tweakReplay(replay) {\n    const metadata = {...replay};\n    const tweaking = {replay};\n    ReplayEditFields.forEach((field) => {\n      if (field !== 'metadata') {\n        tweaking[field] = JSON.stringify(metadata[field], null, 2);\n        delete metadata[field];\n      }\n    });\n    tweaking.metadata = JSON.stringify(metadata, null, 2);\n\n    ReplayEditFields.forEach((field) => {\n      tweaking[`${field}_original`] = tweaking[field];\n    });\n\n    this.setState({tweaking});\n    saveField('tweaking', tweaking);\n  }\n\n  updateTweak(field, value) {\n    this.setState(({tweaking}) => {\n      const t = {\n        ...tweaking,\n        [field]: value,\n        [`${field}_error`]: null,\n        [`${field}_changed`]: value !== tweaking[`${field}_original`],\n      };\n\n      setTimeout(() => saveField('tweaking', t));\n\n      return {tweaking: t};\n    });\n  }\n\n  revertTweak(field) {\n    // eslint-disable-next-line react/destructuring-assignment\n    this.updateTweak(field, this.state.tweaking[`${field}_original`]);\n  }\n\n  discardTweaks() {\n    setTimeout(() => { saveField('tweaking', null); });\n    this.setState({\n      tweaking: null,\n    });\n  }\n\n  saveTweaks() {\n    this.setState(({tweaking}) => {\n      let replay;\n      let sawError = false;\n      const newState = {...tweaking};\n\n      ReplayEditFields.forEach((field) => {\n        try {\n          const value = JSON.parse(tweaking[field]);\n          if (field === 'metadata') {\n            replay = value;\n          } else {\n            if (replay) {\n              replay[field] = value;\n            }\n          }\n\n          newState[`${field}_error`] = null;\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.error(e);\n          sawError = true;\n          newState[`${field}_error`] = e.toString();\n        }\n      });\n\n      if (sawError) {\n        setTimeout(() => { saveField('tweaking', newState); });\n        return {tweaking: newState};\n      } else {\n        setTimeout(() => {\n          this.updateReplay(tweaking.replay, replay, false);\n          setTimeout(() => { saveField('tweaking', null); });\n        });\n\n        return {tweaking: null};\n      }\n    });\n  }\n\n  renderTweaking() {\n    const {tweaking} = this.state;\n\n    return (\n      <div className=\"Replay tweaking\">\n        <div className=\"controls tweaking\">\n          <span className=\"button\" title=\"Cancel tweaks\" onClick={() => this.discardTweaks()}>🚮</span>\n          <span className=\"button\" title=\"Save tweaks\" onClick={() => this.saveTweaks()}>🆙</span>\n        </div>\n        <div className=\"fields\">\n          {ReplayEditFields.map((field) => (\n            <div key={field} className={`field ${tweaking[`${field}_error`] ? 'error' : ''} ${tweaking[`${field}_changed`] ? 'changed' : ''}`}>\n              <label>\n                {field}\n                {' '}\n                <span style={{visibility: tweaking[`${field}_changed`] ? 'visible' : 'hidden'}} className=\"button\" title=\"Discard these tweaks\" onClick={() => this.revertTweak(field)}>🚮</span>\n              </label>\n              {tweaking[`${field}_error`] && (\n                <span className=\"info\">{tweaking[`${field}_error`]}</span>\n              )}\n              <textarea value={tweaking[field]} onChange={(e) => this.updateTweak(field, e.target.value)} />\n            </div>\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    const {\n      replays, activeRecording, activeReplay, editing, repeat, tweaking,\n    } = this.state;\n\n    if (tweaking) {\n      return this.renderTweaking();\n    }\n\n    return (\n      <div className=\"Replay\">\n        <div className={`controls ${activeReplay ? 'active-replay' : ''} ${activeReplay && activeReplay.timeSight ? 'timeSight' : ''}`}>\n          {activeReplay && (\n            <React.Fragment>\n\n              <span\n                className={`button repeat ${repeat ? 'repeat-on' : 'repeat-off'}`}\n                title={repeat ? 'Disable automatic repeat' : 'Enable automatic repeat'}\n                onClick={() => this.toggleRepeat()}\n              >\n                🔁\n              </span>\n              <span className=\"button\" title=\"Stop replay\" onClick={() => this.stopReplay()}>⏹</span>\n              {activeReplay.timeSight && (\n                <span className=\"button\" title=\"Disable timeSight\" onClick={() => this.toggleTimeSight()}>📺</span>\n              )}\n              {!activeReplay.timeSight && (\n                <span className=\"button\" title=\"Enable timeSight\" onClick={() => this.toggleTimeSight()}>⚛</span>\n              )}\n            </React.Fragment>\n          )}\n          {!activeReplay && (\n            activeRecording ? (\n              <React.Fragment>\n                <span className=\"recording button\" title=\"Stop recording\" onClick={() => this.stopRecording()}>⏺️</span>\n                <span className=\"button\" title=\"Discard recording\" onClick={() => this.trashRecording()}>🚮</span>\n              </React.Fragment>\n            ) : (\n              <React.Fragment>\n                <span className=\"record button\" title=\"Start recording replay\" onClick={() => this.beginRecording()}>🎦</span>\n                <span className=\"snapshot button\" title=\"Take snapshot (save state)\" onClick={() => this.beginRecording({snapshot: true})}>🎆</span>\n              </React.Fragment>\n            )\n          )}\n        </div>\n        <ul className=\"replays\">\n          {replays.map((replay) => (\n            <li\n              className={`\n                replay\n                ${activeReplay && activeReplay.timestamp === replay.timestamp ? 'active' : ''}\n                ${editing === replay.timestamp ? 'editing' : ''}\n              `}\n              key={replay.timestamp}\n            >\n              <span className=\"drag\">⋮⋮</span>\n              {activeReplay && activeReplay.timeSight && activeReplay.timestamp === replay.timestamp && (\n                <span className=\"play button\" title=\"Restart timeSight\" onClick={() => this.beginReplay({...replay, timeSight: true}, true)}>⚛</span>\n              )}\n              {activeReplay && !activeReplay.timeSight && activeReplay.timestamp === replay.timestamp && (\n                <span className=\"play button\" title=\"Restart replay\" onClick={() => this.beginReplay(replay, true)}>📺</span>\n              )}\n              {(!activeReplay || activeReplay.timestamp !== replay.timestamp) && !replay.snapshot && (\n                <span className=\"play button\" title=\"Start replay\" onClick={() => this.beginReplay(replay, true)}>▶️</span>\n              )}\n              {(!activeReplay || activeReplay.timestamp !== replay.timestamp) && replay.snapshot && (\n                <span className=\"play button\" title=\"Load snapshot (load state)\" onClick={() => this.beginReplay(replay, true)}>🎆</span>\n              )}\n              {editing === replay.timestamp && (\n                this.renderEditReplay(replay)\n              )}\n              <span className=\"name\" onClick={() => this.beginReplay(replay, true)}>{replay.name}</span>\n              <span className=\"edit button\" title=\"Edit replay\" onClick={() => this.setEditing(replay.timestamp)}>ℹ</span>\n            </li>\n          ))}\n        </ul>\n\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './Logging.css';\nimport {saveField, loadField} from './lib/store';\n\nexport default class Logging extends React.Component {\n  constructor(props) {\n    super(props);\n    const log = loadField('log', []).map((line) => ({...line, recent: false, old: true}));\n    this.state = {\n      log,\n    };\n    this.logId = 1 + Number(log.map(({id}) => id).reduce((a, b) => (a > b ? a : b), 0));\n    this.timers = [];\n    this.ref = React.createRef();\n  }\n\n  componentDidMount() {\n    this.original = {};\n    const component = this;\n    ['trace', 'debug', 'log', 'info', 'warn', 'error'].forEach((level) => {\n      // eslint-disable-next-line no-console\n      const original = this.original[level] = console[level];\n      // eslint-disable-next-line no-console\n      console[level] = function(...args) {\n        const context = component.extractContext(...args);\n        component.prependLog(args.join(' '), level, context);\n        return original(...args);\n      };\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    const {game} = this.props;\n    if (!prevProps.game && game) {\n      game.onDisableDebugUI(() => {\n        this.removeLogging();\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    this.removeLogging();\n  }\n\n  removeLogging() {\n    this.timers.forEach((timer) => {\n      clearTimeout(timer);\n    });\n\n    Object.entries(this.original).forEach(([level, original]) => {\n      // eslint-disable-next-line no-console\n      console[level] = original;\n    });\n  }\n\n  extractContext(msg) {\n    if (msg instanceof Error) {\n      const {stack} = msg;\n      const match = stack.match(/ at (\\w+) \\(http/);\n      if (match) {\n        return match[1];\n      }\n    }\n    return null;\n  }\n\n  prependLog(originalMsg, level, context) {\n    const msg = originalMsg.replace(/^Error: /, '');\n\n    if (msg.match(/https:\\/\\/phaser\\.io/)) {\n      return;\n    }\n\n    const id = (this.logId += 1);\n\n    {\n      const timer = setTimeout(() => {\n        this.setState(({log}) => ({\n          log: log.map((line) => (line.id === id ? {...line, recent: true} : line)),\n        }));\n      }, 500);\n\n      this.timers.push(timer);\n    }\n\n    {\n      const timer = setTimeout(() => {\n        this.setState(({log}) => ({\n          log: log.map((line) => (line.id === id ? {...line, recent: false, old: true} : line)),\n        }));\n      }, 5000);\n\n      this.timers.push(timer);\n    }\n\n    this.ref.current.scrollTop = 0;\n\n    this.setState(({log}) => {\n      const newLog = [\n        {\n          msg, level, id, context,\n        },\n        ...log.filter((_, n) => n < 19),\n      ];\n\n      setTimeout(() => {\n        saveField('log', newLog);\n      });\n\n      return {\n        log: newLog,\n      };\n    });\n  }\n\n  render() {\n    const {log} = this.state;\n    return (\n      <div className=\"Logging\" ref={this.ref}>\n        <ol>\n          {log.map(({\n            msg, level, id, recent, old, context,\n          }) => (\n            <li key={id} className={`${level} ${recent ? 'recent' : ''} ${old ? 'old' : ''}`}>\n              <span className=\"level\">{level}</span>\n              <span className=\"msg\">{msg}</span>\n              {context && (\n                <span className=\"context\">\n                  {context}\n                </span>\n              )}\n            </li>\n          ))}\n        </ol>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './Development.css';\nimport Engine from './Engine';\nimport Manage from './Manage';\nimport Replay from './Replay';\nimport Logging from './Logging';\nimport {developmentDisplay} from '../../package.json';\n\nexport default class Development extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      game: null,\n      activateGame: null,\n    };\n  }\n\n  loadedGame = (game, activateGame) => {\n    window.game = game;\n    this.setState({game, activateGame});\n  }\n\n  render() {\n    const {game, activateGame} = this.state;\n\n    return (\n      <div className=\"development\">\n        <Engine\n          debug\n          loadedGame={this.loadedGame}\n        />\n\n        <Logging game={game} />\n\n        <div className=\"sidebar\">\n          <ul className=\"links\">\n            {developmentDisplay.links.map(([href, label]) => (\n              <li key={href}>\n                <a target=\"_blank\" rel=\"noopener noreferrer\" href={href}>{label}</a>\n              </li>\n            ))}\n          </ul>\n\n          <Manage />\n          <Replay activateGame={activateGame} />\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './Production.css';\nimport Engine from './Engine';\nimport twitchLogo from './twitchLogo.png';\nimport twitterLogo from './twitterLogo.png';\nimport {productionDisplay} from '../../package.json';\n\nexport default class Production extends React.Component {\n  render() {\n    return (\n      <div className=\"production\">\n        <Engine />\n\n        <div className=\"game-metadata\">\n          <h1>{productionDisplay.displayName}</h1>\n          {productionDisplay.authorName && (\n            <h3>\n              by\n              <br />\n              {productionDisplay.authorURL ? (\n                <a href={productionDisplay.authorURL}>{productionDisplay.authorName}</a>\n              ) : (\n                productionDisplay.authorName\n              )}\n              <br />\n              {productionDisplay.authorTwitter && (\n                <a href={`https://twitter.com/${productionDisplay.authorTwitter}`}>\n                  <img src={twitterLogo} alt={`@${productionDisplay.authorTwitter} on Twitter`} />\n                </a>\n              )}\n              {productionDisplay.authorTwitch && (\n                <a href={`https://twitch.tv/${productionDisplay.authorTwitch}`}>\n                  <img src={twitchLogo} alt={`${productionDisplay.authorTwitch} on Twitch`} />\n                </a>\n              )}\n            </h3>\n          )}\n          <p>\n            {productionDisplay.eventDescription && (\n              <React.Fragment>\n                {productionDisplay.eventDescription}\n                <br />\n              </React.Fragment>\n            )}\n            {productionDisplay.eventNamePre}\n            {' '}\n            <strong>{productionDisplay.eventNameBold}</strong>\n            {' '}\n            {productionDisplay.eventNamePost}\n          </p>\n          {productionDisplay.eventURL && (\n            <p>\n              <a href={productionDisplay.eventURL}>\n                {productionDisplay.eventURL}\n              </a>\n            </p>\n          )}\n          <p>\n            {productionDisplay.themeDescription && (\n              <React.Fragment>\n                {productionDisplay.themeDescription}\n                <br />\n              </React.Fragment>\n            )}\n            {productionDisplay.themePre}\n            {' '}\n            <em>{productionDisplay.themeItalic}</em>\n            {' '}\n            {productionDisplay.themePost}\n          </p>\n          {productionDisplay.repoURL && (\n            <p>\n              code at\n              <br />\n              <a className=\"url\" href={productionDisplay.repoURL}>\n                {productionDisplay.repoURL}\n              </a>\n            </p>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport './Production.css';\nimport Engine from './Engine';\n\nexport default class Embed extends React.Component {\n  render() {\n    return (\n      <div className=\"production embed\">\n        <Engine disableFullscreen />\n      </div>\n    );\n  }\n}\n","import {hot} from 'react-hot-loader/root';\nimport React from 'react';\nimport Development from './Development';\nimport Production from './Production';\nimport Embed from './Embed';\nimport {productionDisplay} from '../../package.json';\n\nclass App extends React.Component {\n  render() {\n    const {debug} = this.props;\n\n    if (productionDisplay.embed) {\n      return <Embed />;\n    } else if (debug) {\n      return <Development />;\n    } else {\n      return <Production />;\n    }\n  }\n}\n\nexport default hot(App);\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './base.css';\nimport App from './App';\n\nconst debug = !process.env.NODE_ENV || process.env.NODE_ENV === 'development';\n\nReactDOM.render(<App debug={debug} />, document.getElementById('root'));\n","import Phaser from 'phaser';\nimport deepEqual from 'deep-equal';\nimport prop, {propsWithPrefix, manageableProps, propSpecs} from '../props';\nimport {updatePropsFromStep, overrideProps, refreshUI} from './lib/manage-gui';\nimport massageParticleProps, {injectEmitterOpSeededRandom, injectParticleEmitterManagerPreUpdate, particlePropFromProp} from './lib/particles';\nimport massageTransitionProps, {baseTransitionProps, applyPause} from './lib/transitions';\nimport {injectAddSpriteTimeScale} from './lib/sprites';\nimport {injectAnimationUpdate} from './lib/anims';\nimport massageTweenProps, {injectTweenManagerAdd} from './lib/tweens';\nimport {shaderTypeMeta, propNamesForUniform} from './lib/shaders';\nimport {saveField, loadField} from './lib/store';\n\nimport {parseMaps, parseLevelLines} from './lib/level-parser';\nimport mapsFile from '../assets/maps.txt';\nimport * as assets from '../assets/index';\nimport {preloadAssets, reloadAssets} from './lib/assets';\n\nconst baseConfig = {\n};\n\nexport default class SuperScene extends Phaser.Scene {\n  constructor(subconfig) {\n    const config = {\n      ...baseConfig,\n      ...subconfig,\n    };\n    super(config);\n\n    this.rnd = {};\n    this.timeScale = 1;\n    this.sounds = [];\n    this.timers = [];\n    this.performanceFrames = 0;\n    this.performanceAcceptable = true;\n    this.scene_time = 0;\n    this.shockwave_time = 0;\n    this._paused = {\n      physics: false,\n      particles: false,\n      timers: false,\n      tweens: false,\n      anims: false,\n    };\n  }\n\n  init(config) {\n    if (!config.seed) {\n      throw new Error(`You must provide a \"seed\" (e.g. Date.now()) to ${this.constructor.name}`);\n    }\n\n    if (!config.sceneId) {\n      throw new Error(`You must provide a \"sceneId\" (e.g. Date.now()) to ${this.constructor.name}`);\n    }\n\n    this.sceneId = config.sceneId;\n\n    this.command = this.game.command;\n    this.command.attachScene(this, config._timeSightTarget);\n\n    this.camera = this.cameras.main;\n    this.camera.setBackgroundColor(this.cameraColor());\n\n    if (config.save) {\n      this.save = config.save;\n    } else if (!this.save && this.saveStateFieldName()) {\n      this.save = loadField(this.saveStateFieldName(), () => {\n        const save = this.initialSaveState();\n        save.version = this.saveStateVersion();\n        return save;\n      });\n    }\n\n    if (this.save) {\n      this.save = this.migrateSaveState(this.save);\n    }\n\n    if (!this.save) {\n      this.save = {};\n    }\n\n    this._initialSave = JSON.parse(JSON.stringify(this.save));\n\n    if (this.physics && this.physics.world) {\n      injectAddSpriteTimeScale(this);\n      injectTweenManagerAdd(this.tweens);\n\n      if (prop('scene.debugDraw')) {\n        this.physics.world.createDebugGraphic();\n      }\n\n      // there's no event for physics step, so interject one {\n      if (this.fixedUpdate) {\n        // make tweens use a fixed update\n        const {tweens} = this.scene.systems;\n        const eventEmitter = tweens.systems.events;\n        eventEmitter.off('update', tweens.update, tweens);\n\n        const {physics} = this;\n        const {world} = physics;\n        const originalStep = world.step;\n        let time = 0;\n        physics.time = physics.dt = 0;\n        world.step = (originalDelta) => {\n          const delta = originalDelta * world.timeScale * world.timeScale;\n\n          const dt = delta * 1000;\n          time += dt;\n          physics.dt = dt;\n          physics.time = time;\n          this.scene_time = time;\n\n          if (this.game._stepExceptions > 100) {\n            return;\n          }\n\n          try {\n            const isTopScene = this.isTopScene();\n\n            if (this.timeSightFrozen) {\n              if (isTopScene) {\n                this.command.processInput(this, time, dt, true);\n              }\n              this.updateTweens(time, dt);\n              this.timeSightMouseDrag();\n              return;\n            }\n\n            if (!this._paused.physics) {\n              originalStep.call(world, delta);\n            }\n\n            if (isTopScene) {\n              this.command.processInput(this, time, dt);\n            }\n\n            if (this.game.updateReplayCursor) {\n              this.game.updateReplayCursor(this.command.replayTicks, this._replay);\n            }\n\n            if (!this._paused.physics) {\n              this.fixedUpdate(time, dt);\n            }\n\n            this.updateTimers(time, dt);\n\n            if (this.performanceProps && this.performanceProps.length) {\n              this.recoverPerformance();\n            }\n\n            this.updateTweens(time, dt);\n\n            this.game._stepExceptions = 0;\n          } catch (e) {\n            // eslint-disable-next-line no-console\n            console.error(e);\n\n            this.game._stepExceptions = (this.game._stepExceptions || 0) + 1;\n            if (this.game._stepExceptions > 100) {\n              // eslint-disable-next-line no-console\n              console.error('Too many errors; pausing update cycle until hot reload');\n            }\n          }\n        };\n      }\n      // }\n    }\n\n    this.sound.pauseOnBlur = false;\n\n    this.particleSystems = [];\n\n    this.sys.events.on('destroy', this.destroy, this);\n\n    ['_recording', '_replay', '_replayOptions'].forEach((key) => {\n      this[key] = config[key];\n      delete config[key];\n    });\n\n    if (this._recording) {\n      this._recording.sceneTransitions.push({\n        tickCount: this._recording.tickCount,\n        timestamp: Date.now(),\n        seed: config.seed,\n        sceneName: this.constructor.name,\n        initData: this.scene.settings.data,\n        sceneSaveState: JSON.parse(JSON.stringify(this._initialSave)),\n        parentSceneId: config.parentSceneId,\n        sceneId: this.sceneId,\n        commandState: this.command.freezeCommandState(),\n      });\n    }\n\n    if (this._replay) {\n      const {sceneTransitions} = this._replay;\n      const {replayTicks} = this.command;\n      for (let i = 0; i < sceneTransitions.length; i += 1) {\n        if (sceneTransitions[i].tickCount <= replayTicks) {\n          this._replayLatestTransition = sceneTransitions[i];\n        } else {\n          break;\n        }\n      }\n    }\n\n    const {\n      width, height, tileWidth, tileHeight,\n    } = this.game.config;\n    const mapWidth = Math.floor(width / (tileWidth + 2));\n    const mapHeight = Math.floor(height / (tileHeight + 3));\n\n    this.xBorder = (width - (mapWidth * tileWidth)) / 2;\n    this.yBorder = (height - (mapHeight * tileHeight)) / 2;\n\n    this.game.sceneDidInit(this);\n  }\n\n  saveStateFieldName() {\n    return `game_${this.constructor.name}`;\n  }\n\n  saveStateVersion() {\n    return 0;\n  }\n\n  migrateSaveState(originalSave) {\n    const target = this.saveStateVersion();\n    if (originalSave.version === target) {\n      return originalSave;\n    }\n\n    const save = JSON.parse(JSON.stringify(originalSave));\n    if (!save.version) {\n      save.version = 0;\n    }\n\n    while (save.version < target) {\n      const method = `migrateSaveStateVersion${save.version}`;\n      // eslint-disable-next-line no-console\n      console.debug(method);\n      if (!this[method]) {\n        throw new Error(`Missing migration method ${method}`);\n      }\n      this[method](save);\n      save.version += 1;\n    }\n\n    return save;\n  }\n\n  initialSaveState() {\n    return {};\n  }\n\n  saveState() {\n    saveField(this.saveStateFieldName(), this.save);\n  }\n\n  isTopScene() {\n    return this.game.topScene() === this;\n  }\n\n  vendRNG(name) {\n    if (!name) {\n      throw new Error('You must provide a name for each RNG sequence');\n    }\n\n    if (!this.rnd[name]) {\n      const {seed} = this.scene.settings.data;\n      this.rnd[name] = new Phaser.Math.RandomDataGenerator([seed, name]);\n    }\n\n    return this.rnd[name];\n  }\n\n  randFloat(name) {\n    return this.vendRNG(name).frac();\n  }\n\n  randBetween(name, min, max) {\n    return this.randFloat(name) * (max - min) + min;\n  }\n\n  randElement(name, list) {\n    return list[Math.floor(this.randBetween(name, 0, list.length))];\n  }\n\n  create() {\n    this.command.attachInputs(this);\n\n    this.startedAt = new Date();\n\n    if (this.setupAnimations) {\n      this.setupAnimations();\n    }\n\n    const {transition} = this.scene.settings.data;\n    if (!transition || !transition.delayNewSceneShader) {\n      this._setupShader();\n    }\n  }\n\n  _setupShader() {\n    if (!('shaderName' in this)) {\n      this.shaderName = 'main';\n    }\n\n    if (this.shaderName) {\n      this.game.initializeShader(this.shaderName);\n      this.shader = this.game.shaderInstance(this.shaderName);\n      if (this.shader) {\n        this._shaderInitialize(true);\n        this._shaderUpdate();\n        this.camera.setRenderToTexture(this.shader);\n      }\n    }\n  }\n\n  preload() {\n    this.load.text('_mapsFile', mapsFile);\n\n    preloadAssets(this, assets);\n  }\n\n  levelIds() {\n    if (!this.game._ldMapFiles) {\n      this.game._ldMapFiles = parseMaps(this.cache.text.get('_mapsFile'));\n    }\n\n    return this.game._ldMapFiles.map(([, config]) => config.id);\n  }\n\n  loadLevel(id) {\n    if (!this.game._ldMapFiles) {\n      this.game._ldMapFiles = parseMaps(this.cache.text.get('_mapsFile'));\n    }\n    const mapFiles = this.game._ldMapFiles;\n\n    let index;\n    let spec = mapFiles[id];\n    if (spec) {\n      index = id;\n    } else {\n      index = mapFiles.findIndex((m) => m[1].id === id);\n      spec = mapFiles[index];\n    }\n\n    if (!spec) {\n      throw new Error(`Cannot find level with id ${id}`);\n    }\n\n    const [lines, config] = spec;\n    const {map, mapText, lookups} = parseLevelLines(lines, this.mapsAreRectangular);\n\n    const {tileWidth, tileHeight} = this.game.config;\n    const heightInTiles = map.length;\n    const height = tileHeight * heightInTiles;\n    const widthInTiles = Math.max(...map.map((a) => a.length));\n    const width = tileWidth * widthInTiles;\n\n    const level = {\n      ...config,\n      heightInTiles,\n      widthInTiles,\n      height,\n      width,\n      map,\n      mapText,\n      mapLookups: lookups,\n      index,\n    };\n\n    if (level.background) {\n      level.background = this.add.sprite(0, 0, level.background);\n      level.background.setPosition(level.background.width * 0.5, level.background.height * 0.5);\n    }\n\n    return level;\n  }\n\n  setCameraBounds() {\n    const {level} = this;\n\n    if (!prop('scene.camera.hasBounds')) {\n      this.camera.removeBounds();\n      return;\n    }\n\n    if (level && level.width && level.height) {\n      const boundsX = 0;\n      const boundsY = 0;\n      let boundsWidth = level.width;\n      let boundsHeight = level.height;\n\n      if (this.xBorder) {\n        boundsWidth += this.xBorder * 2;\n      }\n\n      if (this.yBorder) {\n        boundsHeight += this.yBorder * 2;\n      }\n\n      this.camera.setBounds(boundsX, boundsY, boundsWidth, boundsHeight);\n    }\n  }\n\n  setCameraDeadzone() {\n    this.camera.setDeadzone(\n      prop('scene.camera.deadzoneX'),\n      prop('scene.camera.deadzoneY'),\n    );\n  }\n\n  setCameraLerp() {\n    this.camera.setLerp(prop('scene.camera.lerp'));\n  }\n\n  firstUpdate(time, dt) {\n    this.setCameraBounds();\n    this.setCameraDeadzone();\n    this.setCameraLerp();\n  }\n\n  update(time, dt) {\n    if (!this._firstUpdated) {\n      this.firstUpdate(time, dt);\n      this._firstUpdated = true;\n    }\n\n    if (this.physics && this.physics.world.isPaused && !this.timeSightFrozen && this.isTopScene()) {\n      this.command.processInput(this, time, dt, true);\n    }\n\n    if (this.renderUpdate) {\n      this.renderUpdate(time, dt);\n    }\n    if (this.shader) {\n      this._shaderUpdate();\n    }\n\n    this.positionBackground();\n  }\n\n  positionBackground() {\n    const {\n      level, game, xBorder, yBorder, camera,\n    } = this;\n    if (!level) {\n      return;\n    }\n\n    const {background, width: levelWidth, height: levelHeight} = level;\n    if (!background) {\n      return;\n    }\n\n    const {width: gameWidth, height: gameHeight} = game.config;\n    const {width: backgroundWidth, height: backgroundHeight} = background;\n    const {scrollX, scrollY} = camera;\n\n    const xDivisor = levelWidth - gameWidth + xBorder * 2;\n    if (xDivisor === 0) {\n      background.x = backgroundWidth * 0.5;\n    } else {\n      const xFactor = scrollX / xDivisor;\n      background.x = xBorder + backgroundWidth * 0.5 + xFactor * (levelWidth - backgroundWidth);\n    }\n\n    const yDivisor = levelHeight - gameHeight + yBorder * 2;\n    if (yDivisor === 0) {\n      background.y = backgroundHeight * 0.5;\n    } else {\n      const yFactor = scrollY / yDivisor;\n      background.y = yBorder + backgroundHeight * 0.5 + yFactor * (levelHeight - backgroundHeight);\n    }\n  }\n\n  _shaderInitialize(initializeListeners) {\n    this.game.shaderFragments.forEach(([fragmentName, uniforms]) => {\n      Object.entries(uniforms).forEach(([uniformName, spec]) => {\n        const name = `${fragmentName}_${uniformName}`;\n        const [type, listenerInitial, listenerIfNull] = spec;\n        if (listenerIfNull === null) {\n          if (initializeListeners || !(name in this)) {\n            this[name] = listenerInitial;\n          }\n        } else {\n          const [, , setter] = shaderTypeMeta[type];\n\n          const propNames = propNamesForUniform(fragmentName, uniformName, spec);\n          let initialValue;\n\n          if (propNames.length === 1) {\n            initialValue = prop(propNames[0]);\n          } else {\n            initialValue = [];\n            propNames.forEach((n) => {\n              const v = prop(n);\n              if (Array.isArray(v)) {\n                initialValue.push(...v);\n              } else {\n                initialValue.push(v);\n              }\n            });\n          }\n\n          if (type === 'rgb' || type === 'rgba') {\n            initialValue = initialValue.map((c, i) => (i < 3 ? c / 255.0 : c));\n          }\n\n          this.shader[setter](name, initialValue);\n        }\n      });\n    });\n\n    // generate this._shaderUpdate based on what's being used\n\n    // eslint-disable-next-line no-unused-vars\n    const {shader, camera} = this;\n\n    if (!shader) {\n      this._shaderUpdate = function() {};\n    }\n\n    const shaderUpdate = [\n      '(function () {',\n      `  shader.setFloat2('camera_scroll', camera.scrollX / ${this.game.config.width}, camera.scrollY / ${this.game.config.height});`,\n      '  shader.setFloat1(\\'scene_time\\', this.scene_time);',\n    ];\n\n    this.game.shaderFragments.forEach(([fragmentName, uniforms]) => {\n      if (!prop(`shader.${fragmentName}.enabled`)) {\n        return;\n      }\n\n      Object.entries(uniforms).forEach(([uniformName, [type, , listenerIfNull]]) => {\n        const name = `${fragmentName}_${uniformName}`;\n        if (listenerIfNull !== null) {\n          return;\n        }\n\n        const [, , setter] = shaderTypeMeta[type];\n\n        if (type === 'bool') {\n          shaderUpdate.push(`  shader.${setter}('${name}', this['${name}'] ? 1.0 : 0.0);`);\n        } else {\n          shaderUpdate.push(`  shader.${setter}('${name}', this['${name}']);`);\n        }\n      });\n    });\n\n    shaderUpdate.push('})');\n\n    // eslint-disable-next-line no-eval\n    this._shaderUpdate = eval(shaderUpdate.join('\\n'));\n  }\n\n  replaceWithSceneNamed(name, reseed, config = {}, originalTransition = null) {\n    const {game} = this;\n\n    if (!this.scene.settings) {\n      // this can happen when HMR happens during timeSight; SuperScene's\n      // builtinHot causes the top scene to get replaced out of the scene\n      // graph, but proxy.js still calls _hot on it\n      return;\n    }\n\n    if (this.scene.settings.data._timeSightTarget) {\n      this.endedReplay();\n      return;\n    }\n\n    let {seed} = this.scene.settings.data;\n    if (reseed === true) {\n      seed = this.randFloat('replaceWithSceneNamed');\n    } else if (reseed) {\n      seed = reseed;\n    }\n\n    let sceneId;\n\n    if (this._replay) {\n      (this._replay.sceneTransitions || []).forEach((t) => {\n        if (t.parentSceneId === this.sceneId) {\n          // eslint-disable-next-line prefer-destructuring\n          sceneId = t.sceneId;\n        }\n      });\n    }\n\n    if (!sceneId) {\n      sceneId = String(this.randFloat('sceneId'));\n    }\n\n    const target = `scene-${this.randFloat('sceneId') * Date.now()}`;\n\n    if (this._isTransitioning) {\n      // eslint-disable-next-line no-console\n      console.error('replaceWithSceneName called again even though this scene is already transitioning. Ignoring.');\n      return;\n    }\n\n    this._isTransitioning = true;\n\n    const oldScene = this;\n    const {_replay, _replayOptions, _recording} = this;\n\n    const transition = this._transitionProps(originalTransition);\n\n    const returnPromise = new Promise((resolve, reject) => {\n      this.game.onSceneInit(target, (newScene) => {\n        this.willTransitionTo(newScene, transition);\n        newScene.willTransitionFrom(oldScene, transition);\n        this._sceneTransition(oldScene, newScene, transition);\n        resolve(newScene, transition);\n      });\n    });\n\n    this.scene.add(\n      target,\n      game._sceneConstructors[name],\n      true,\n      {\n        ...this.scene.settings.data,\n        ...{\n          _replay,\n          _replayOptions,\n          _recording,\n          sceneId,\n          parentSceneId: this.sceneId,\n        },\n        ...config,\n        transition,\n        seed,\n      },\n    );\n\n    return returnPromise;\n  }\n\n  replaceWithSelf(reseed, config = {}, transition = null) {\n    return this.replaceWithSceneNamed(this.constructor.name, reseed, config, transition);\n  }\n\n  _sceneTransition(oldScene, newScene, transition) {\n    const {\n      animation, ease, duration, onUpdate, oldPauseTime, newUnpauseTime,\n    } = transition || {};\n\n    let newUnpauseFn = () => {\n      // eslint-disable-next-line no-console\n      console.error('Transition did not instantiate newUnpauseFn');\n    };\n\n    let swapScenes = true;\n\n    let _hasCutover = false;\n    const cutoverPrimary = (overrideSwapScenes) => {\n      if (_hasCutover) {\n        return;\n      }\n      _hasCutover = true;\n\n      if (overrideSwapScenes !== undefined) {\n        swapScenes = overrideSwapScenes;\n      }\n\n      if (transition && transition.onCutover) {\n        transition.onCutover(oldScene, newScene, transition);\n      }\n\n      if (oldPauseTime === 'cutover') {\n        applyPause(oldScene, transition, transition.oldPause);\n      }\n\n      if (newUnpauseTime === 'cutover') {\n        newUnpauseFn();\n      }\n\n      newScene.playMusicIfSet();\n\n      if (swapScenes) {\n        newScene.game.scene.bringToTop(newScene.scene.key);\n      }\n    };\n\n    let _hasCompleted = false;\n    const completeTransition = () => {\n      if (_hasCompleted) {\n        return;\n      }\n\n      if (!_hasCutover) {\n        // eslint-disable-next-line no-console\n        console.error('completeTransition called, but cutoverPrimary hasn\\'t been yet');\n        cutoverPrimary();\n      }\n\n      if (transition && transition.onComplete) {\n        transition.onComplete(oldScene, newScene, transition);\n      }\n\n      if (oldPauseTime === 'complete') {\n        applyPause(oldScene, transition, transition.oldPause);\n      }\n\n      if (newUnpauseTime === 'complete') {\n        newUnpauseFn();\n      }\n\n      _hasCompleted = true;\n\n      newScene.timer(() => {\n        oldScene.didTransitionTo(newScene, transition);\n        newScene.didTransitionFrom(oldScene, transition);\n        oldScene.scene.remove();\n      }).ignoresScenePause = true;\n\n      if (transition) {\n        const waitTimer = newScene.timer(() => {\n          if (transition && transition.onWaitEnd) {\n            transition.onWaitEnd(oldScene, newScene, transition);\n          }\n\n          if (newUnpauseTime === 'waitEnd') {\n            newUnpauseFn();\n          }\n        }, transition.wait);\n        waitTimer.ignoresScenePause = true;\n      }\n    };\n\n    if (transition) {\n      if (transition.removeOldSceneShader) {\n        oldScene.shader = null;\n        oldScene.camera.clearRenderToTexture();\n      }\n\n      let animate;\n\n      if (typeof animation === 'function') {\n        animate = () => animation(oldScene, newScene, cutoverPrimary, completeTransition, transition);\n      } else if (animation === 'fadeInOut') {\n        swapScenes = true;\n\n        newScene.camera.setBackgroundColor(0);\n        oldScene.camera.setBackgroundColor(0);\n        newScene.camera.alpha = 0;\n        oldScene.camera.alpha = 1;\n\n        animate = () => {\n          const tween = this.tweenInOut(\n            duration / 2,\n            duration / 2,\n            (factor, firstHalf) => {\n              if (firstHalf) {\n                oldScene.camera.alpha = 1 - factor;\n              } else {\n                newScene.camera.alpha = 1 - factor;\n              }\n\n              if (onUpdate) {\n                const percent = firstHalf ? factor / 2 : 1 - factor / 2;\n                onUpdate(percent, oldScene, newScene, transition);\n              }\n            },\n            (followupTween) => {\n              followupTween.ignoresScenePause = true;\n              cutoverPrimary();\n            },\n            () => {\n              newScene.camera.alpha = 1;\n              oldScene.camera.alpha = 0;\n              completeTransition();\n            },\n            0,\n            ease,\n          );\n          tween.ignoresScenePause = true;\n        };\n      } else if (animation === 'crossFade') {\n        // crossfade doesn't really care about scene order, so help the\n        // shader out if we can\n        if (!oldScene.shader && newScene.shader) {\n          oldScene.game.scene.bringToTop(oldScene.scene.key);\n          swapScenes = false;\n        } else if (oldScene.shader && !newScene.shader) {\n          newScene.game.scene.bringToTop(newScene.scene.key);\n          swapScenes = false;\n        } else {\n          swapScenes = true;\n        }\n\n        newScene.camera.alpha = 0;\n        oldScene.camera.alpha = 1;\n\n        animate = () => {\n          const tween = this.tweenPercent(\n            duration,\n            (factor) => {\n              newScene.camera.alpha = factor;\n              oldScene.camera.alpha = 1 - factor;\n              if (factor >= 0.5) {\n                cutoverPrimary();\n              }\n\n              if (onUpdate) {\n                onUpdate(factor, oldScene, newScene, transition);\n              }\n            },\n            () => {\n              newScene.camera.alpha = 1;\n              oldScene.camera.alpha = 0;\n\n              if (!transition.suppressShaderCheck && !transition.delayNewSceneShader && oldScene.shader && newScene.shader) {\n                // eslint-disable-next-line no-console, max-len\n                console.error('crossFade transitions do not render correctly if the both scenes have a shader; provide delayNewSceneShader, removeOldSceneShader, or suppressShaderCheck to the transition, or use fadeInOut animation');\n              }\n\n              completeTransition();\n            },\n            0,\n            ease,\n          );\n          tween.ignoresScenePause = true;\n        };\n      } else if (animation === 'pushRight' || animation === 'pushLeft' || animation === 'pushUp' || animation === 'pushDown') {\n        const {height, width} = this.game.config;\n\n        swapScenes = true;\n\n        oldScene.camera.x = 0;\n        oldScene.camera.y = 0;\n\n        let dx = 0;\n        let dy = 0;\n\n        if (animation === 'pushRight') {\n          newScene.camera.x = -width;\n          dx = 1;\n        } else if (animation === 'pushLeft') {\n          newScene.camera.x = width;\n          dx = -1;\n        } else if (animation === 'pushUp') {\n          newScene.camera.y = -height;\n          dy = -1;\n        } else if (animation === 'pushDown') {\n          newScene.camera.y = height;\n          dy = 1;\n        }\n\n        animate = () => {\n          const tween = this.tweenPercent(\n            duration,\n            (factor) => {\n              newScene.camera.x = dx * (factor - 1) * width;\n              oldScene.camera.x = dx * factor * width;\n              newScene.camera.y = dy * (factor - 1) * height;\n              oldScene.camera.y = dy * factor * height;\n\n              if (factor >= 0.5) {\n                cutoverPrimary();\n              }\n\n              if (onUpdate) {\n                onUpdate(factor, oldScene, newScene, transition);\n              }\n            },\n            () => {\n              newScene.camera.x = 0;\n              newScene.camera.y = 0;\n              completeTransition();\n            },\n            0,\n            ease,\n          );\n          tween.ignoresScenePause = true;\n        };\n      } else if (animation === 'wipeRight' || animation === 'wipeLeft' || animation === 'wipeUp' || animation === 'wipeDown') {\n        const {height, width} = this.game.config;\n\n        swapScenes = false;\n\n        let newCamera;\n        let oldCamera;\n\n        // we cannot wipe with the builtin camera\n        if (animation === 'wipeRight' || animation === 'wipeDown') {\n          newScene.camera.alpha = 0;\n\n          newCamera = newScene.cameras.add(0, 0, width, height);\n          newCamera.setBackgroundColor(newScene.cameraColor());\n          newCamera.scrollX = newScene.camera.scrollX;\n          newCamera.scrollY = newScene.camera.scrollY;\n\n          if (animation === 'wipeRight') {\n            newCamera.width = 1;\n          } else {\n            newCamera.height = 1;\n          }\n        } else {\n          oldScene.game.scene.bringToTop(oldScene.scene.key);\n          oldScene.camera.alpha = 0;\n\n          oldCamera = oldScene.cameras.add(0, 0, width, height);\n          oldCamera.setBackgroundColor(oldScene.cameraColor());\n          oldCamera.scrollX = oldScene.camera.scrollX;\n          oldCamera.scrollY = oldScene.camera.scrollY;\n\n          if (oldScene.shader) {\n            oldCamera.setRenderToTexture(oldScene.shader);\n          }\n        }\n\n        let firstCall = true;\n\n        animate = () => {\n          const tween = this.tweenPercent(\n            duration,\n            (factor) => {\n              if (newCamera && firstCall) {\n                if (newScene.shader) {\n                  newCamera.setRenderToTexture(newScene.shader);\n                }\n                firstCall = false;\n              }\n\n              if (animation === 'wipeRight') {\n                newCamera.setSize(Math.max(1, factor * width), height);\n              } else if (animation === 'wipeLeft') {\n                oldCamera.setSize(Math.max(1, (1 - factor) * width), height);\n              } else if (animation === 'wipeUp') {\n                oldCamera.setSize(width, Math.max(1, (1 - factor) * height));\n              } else if (animation === 'wipeDown') {\n                newCamera.setSize(width, Math.max(1, factor * height));\n              }\n\n              if (factor >= 0.5) {\n                cutoverPrimary();\n              }\n\n              if (onUpdate) {\n                onUpdate(factor, oldScene, newScene, transition);\n              }\n            },\n            () => {\n              if (newCamera) {\n                newScene.cameras.main.alpha = 1;\n                newScene.camera.scrollX = newCamera.scrollX;\n                newScene.camera.scrollY = newCamera.scrollY;\n                newScene.cameras.remove(newCamera);\n              }\n\n              if (!transition.suppressShaderCheck) {\n                if (!transition.delayNewSceneShader && newScene.shader && newCamera) {\n                  // eslint-disable-next-line no-console, max-len\n                  console.error(`${animation} transitions do not render correctly if the new scene has a shader; provide delayNewSceneShader or suppressShaderCheck to the transition, or use a different animation`);\n                }\n                if (oldScene.shader && oldCamera) {\n                  // eslint-disable-next-line no-console, max-len\n                  console.error(`${animation} transitions do not render correctly if the old scene has a shader; provide removeOldSceneShader or suppressShaderCheck to the transition, or use a different animation`);\n                }\n              }\n\n              completeTransition();\n            },\n            0,\n            ease,\n          );\n          tween.ignoresScenePause = true;\n        };\n      } else {\n        // eslint-disable-next-line no-console\n        console.error(`Invalid transition animation '${animation}'`);\n        cutoverPrimary();\n        completeTransition();\n        return;\n      }\n\n      if (swapScenes) {\n        oldScene.game.scene.bringToTop(oldScene.scene.key);\n      }\n\n      if (oldPauseTime === 'begin') {\n        applyPause(oldScene, transition, transition.oldPause);\n      }\n\n      if (newUnpauseTime !== 'begin') {\n        newUnpauseFn = applyPause(newScene, transition, transition.newPause);\n      }\n\n      const oldAnimate = animate;\n      animate = () => {\n        if (transition && transition.onDelayEnd) {\n          transition.onDelayEnd(oldScene, newScene, transition);\n        }\n\n        if (oldPauseTime === 'delayEnd') {\n          applyPause(oldScene, transition, transition.oldPause);\n        }\n\n        if (newUnpauseTime === 'delayEnd') {\n          newUnpauseFn();\n        }\n\n        oldAnimate();\n      };\n\n      if (transition.delay) {\n        const delayTimer = this.timer(animate, transition.delay);\n        delayTimer.ignoresScenePause = true;\n      } else {\n        animate();\n      }\n    } else {\n      cutoverPrimary();\n      completeTransition();\n    }\n  }\n\n  preemitEmitter(emitter) {\n    const maxLifespan = emitter.lifespan.staticValueEmit();\n    const quantity = emitter.quantity.staticValueEmit();\n    const {frequency} = emitter;\n    for (let i = maxLifespan; i > 0; i -= frequency) {\n      for (let j = 0; j < quantity; j += 1) {\n        const particle = emitter.emitParticle(1);\n        particle.update(i, i / 1000, []);\n      }\n    }\n  }\n\n  beginReplay(replay, replayOptions) {\n    const {command, game} = this;\n    const {loop} = game;\n\n    this._replay = replay;\n    this._replayOptions = replayOptions;\n    this._replayLatestTransition = replayOptions.startFromTransition;\n    const startTick = replayOptions.startTick || (this._replayLatestTransition ? (this._replayLatestTransition.tickCount || 0) : 0);\n\n    command.beginReplay(replay, {\n      ...replayOptions,\n      startTick,\n      onEnd: () => {\n        this.game.topScene().endedReplay();\n      },\n      onStop: () => {\n        this.game.topScene().stopReplay(true);\n      },\n    });\n\n    let time = window.performance.now();\n    const dt = 1000 / this.physics.world.fps;\n\n    game._replayPreflight += 1;\n\n    const manager = this.command.getManager(this);\n\n    loop.sleep();\n    this.scene.setVisible(false);\n    while (command.hasPreflight()) {\n      if (replay.timeSightFrameCallback) {\n        replay.timeSightFrameCallback(this, time, dt, manager, true, false, false);\n      }\n\n      time += dt;\n      loop.step(time);\n\n      if (game._stepExceptions > 100) {\n        // eslint-disable-next-line no-console\n        console.error('Too many errors in preflight; bailing out…');\n        return;\n      }\n    }\n    loop.resetDelta();\n\n    game._replayPreflight -= 1;\n\n    // now that preflight is done, beware that if it had a scene transition,\n    // then `this` may have been removed from the scene graph and instead\n    // should use topScene\n    const topScene = game.topScene();\n\n    if (replay.timeSight) {\n      topScene.calculateTimeSight();\n    } else if (replay.timeSightFrameCallback) {\n      game._replayPreflight += 1;\n      topScene._timeSightTargetEnded = () => {\n        replay.timeSightFrameCallback(topScene, time, dt, manager, false, true, true);\n      };\n\n      let postflightCutoff;\n      if ('postflightCutoff' in replay) {\n        postflightCutoff = replay.postflightCutoff;\n        delete replay.postflightCutoff;\n      }\n\n      while (!topScene._timeSightTargetDone) {\n        const isPostflight = postflightCutoff !== undefined && this.command.replayTicks >= postflightCutoff;\n        replay.timeSightFrameCallback(topScene, time, dt, manager, false, isPostflight, false);\n        time += dt;\n        loop.step(time);\n\n        if (game._stepExceptions > 100) {\n          // eslint-disable-next-line no-console\n          console.error('Too many errors in timeSight; bailing out…');\n          return;\n        }\n      }\n      topScene.scene.remove();\n      game._replayPreflight -= 1;\n    } else {\n      topScene.scene.setVisible(true);\n      loop.wake();\n    }\n  }\n\n  calculateTimeSight() {\n    // eslint-disable-next-line no-console\n    console.info('Calculating timeSight');\n\n    this._timeSightFrames = [];\n\n    this.scene.setActive(false);\n    this.scene.setVisible(false);\n\n    this.launchTimeSight();\n\n    const target = `scene-${Math.random() * Date.now()}`;\n    const targetScene = this.game.scene.add(target, this.constructor, true, {...this.scene.settings.data, _timeSightTarget: true});\n    this.game.scene.bringToTop(target);\n\n    let objectDt = 0;\n\n    targetScene.beginReplay(\n      {\n        ...this._replay,\n        timeSight: false,\n        startTick: (this._replayLatestTransition ? this._replayLatestTransition.tickCount : 0) || 0,\n        timeSightFrameCallback: (scene, frameTime, frameDt, manager, isPreflight, isPostflight, isLast) => {\n          objectDt += frameDt;\n\n          const frame = this.timeSightTargetStep(scene, objectDt, frameTime, frameDt, manager, isPreflight, isPostflight, isLast);\n          if (frame) {\n            objectDt = 0;\n          }\n        },\n      },\n      {\n        onEnd: () => {\n          targetScene._timeSightTargetDone = true;\n\n          this.scene.setVisible(true);\n          this.scene.setActive(true);\n\n          this.game.loop.wake();\n\n          this.beginTimeSightAlphaAnimation();\n        },\n      },\n    );\n  }\n\n  timeSightTargetStep(scene, objectDt, frameTime, frameDt, manager, isPreflight, isPostflight, isLast) {\n    const objects = scene.renderTimeSightFrameInto(this, objectDt, frameTime, frameDt, isLast);\n    if (!objects || !objects.length) {\n      return;\n    }\n\n    updatePropsFromStep(true);\n\n    const frame = {\n      objects,\n      props: {...manageableProps},\n      commands: [...manager.commands],\n      tickCount: manager.tickCount,\n      isPreflight,\n      isPostflight,\n    };\n\n    objects.forEach((object) => {\n      if (object.scene !== this) {\n        // eslint-disable-next-line no-console\n        console.error(`renderTimeSightFrameInto rendered this object into the wrong scene: ${JSON.stringify(object)}`);\n      }\n\n      object._timeSightAlpha = object.alpha;\n      object._timeSightFrame = frame;\n\n      if (isPreflight || isPostflight) {\n        object.alpha = 0;\n      }\n    });\n\n    this._timeSightFrames.push(frame);\n    return frame;\n  }\n\n  beginTimeSightAlphaAnimation() {\n    const frames = this._timeSightFrames;\n    const activeFrames = frames.filter((frame) => !frame.isPreflight && !frame.isPostflight);\n\n    if (!activeFrames.length) {\n      return;\n    }\n\n    overrideProps(activeFrames[0].props);\n\n    if (this.game.updateReplayCursor) {\n      this.game.updateReplayCursor();\n    }\n\n    let loopAlpha;\n    // eslint-disable-next-line prefer-const\n    loopAlpha = (frame, n) => {\n      const {objects, props} = frame;\n\n      overrideProps(props);\n\n      objects.forEach((object, i) => {\n        object._timeSightAlphaTween = this.tweens.add({\n          targets: object,\n          alpha: 0.7,\n          duration: 200,\n          onComplete: () => {\n            object._timeSightAlphaTween = this.tweens.add({\n              targets: object,\n              alpha: object._timeSightAlpha,\n              duration: 200,\n              onComplete: () => {\n                if (i === 0) {\n                  frame.timer = this.time.addEvent({\n                    delay: 100 * activeFrames.length + 1000,\n                    callback: () => loopAlpha(frame, n),\n                  });\n                }\n              },\n            });\n          },\n        });\n      });\n    };\n\n    activeFrames.forEach((frame, n) => {\n      frame.timer = this.time.addEvent({\n        delay: 100 * n + 1000,\n        callback: () => {\n          loopAlpha(frame, n);\n        },\n      });\n    });\n\n    if (this._timeSightMouseInput) {\n      activeFrames.forEach((frame) => {\n        frame.objects.forEach((object) => {\n          object.alpha = object._timeSightAlpha;\n        });\n      });\n\n      return;\n    }\n\n    this._timeSightMouseInput = true;\n\n    this.input.topOnly = true;\n\n    activeFrames.forEach((frame) => {\n      frame.objects.forEach((object) => {\n        object.setInteractive();\n      });\n    });\n\n    this.input.on('gameobjectover', (pointer, activeObject) => {\n      if (this._timeSightRemoveFocusTimer) {\n        this._timeSightRemoveFocusTimer.destroy();\n      }\n\n      this.game.canvas.style.cursor = 'pointer';\n\n      let matchedFrame;\n      activeFrames.forEach((frame) => {\n        if (frame.timer) {\n          frame.timer.destroy();\n        }\n\n        frame.objects.forEach((object) => {\n          if (object._timeSightAlphaTween) {\n            object._timeSightAlphaTween.stop();\n          }\n\n          object.alpha = object._timeSightAlpha;\n\n          if (object === activeObject) {\n            matchedFrame = frame;\n            object.alpha = 1;\n          }\n        });\n      });\n\n      if (matchedFrame) {\n        overrideProps(matchedFrame.props);\n\n        if (this.game.updateReplayCursor) {\n          this.game.updateReplayCursor(matchedFrame.tickCount, this._replay);\n        }\n      }\n    });\n\n    this.input.on('gameobjectout', (pointer, activeObject) => {\n      if (this._timeSightRemoveFocusTimer) {\n        this._timeSightRemoveFocusTimer.destroy();\n      }\n\n      this._timeSightRemoveFocusTimer = this.time.addEvent({\n        delay: 100,\n        callback: () => {\n          this.game.canvas.style.cursor = '';\n          this.beginTimeSightAlphaAnimation();\n        },\n      });\n    });\n\n    this.input.on('gameobjectdown', (pointer, activeObject) => {\n      if (this._timeSightRemoveFocusTimer) {\n        this._timeSightRemoveFocusTimer.destroy();\n      }\n\n      this.game.canvas.style.cursor = '';\n\n      const replay = this._replay;\n\n      const {commands} = activeObject._timeSightFrame;\n      const preflightCutoff = commands.reduce((cutoff, frame) => cutoff + (frame._repeat || 1), 0);\n\n      this.game.stopReplay();\n      this.game.beginReplay({\n        ...replay,\n        ...(this._replayLatestTransition || {}),\n        timeSight: false,\n        snapshot: true,\n        commands,\n        preflightCutoff,\n      }, {\n        startFromTransition: this._replayLatestTransition,\n        startTick: -1, // TODO\n      });\n    });\n  }\n\n  endedReplay() {\n    if (!this._replay) {\n      return;\n    }\n\n    const {onEnd} = this._replayOptions;\n    const replay = this._replay;\n\n    delete this._replay;\n    delete this._replayOptions;\n\n    if (replay.timeSight) {\n      this.replaceWithSelf(false);\n      return;\n    }\n\n    if (this._timeSightTargetEnded) {\n      this._timeSightTargetEnded();\n    }\n\n    if (onEnd) {\n      onEnd();\n    }\n  }\n\n  stopReplay(skipDownward) {\n    if (!this._replay) {\n      return;\n    }\n\n    const {onStop} = this._replayOptions;\n    const replay = this._replay;\n\n    delete this._replay;\n    delete this._replayOptions;\n\n    if (replay.timeSight) {\n      this.replaceWithSelf(false);\n      return;\n    }\n\n    if (!skipDownward) {\n      this.command.stopReplay();\n    }\n\n    if (onStop) {\n      onStop();\n    }\n  }\n\n  launchTimeSight() {\n    this.timeSightFrozen = true;\n\n    [...this.tweens._active, ...this.tweens._add].forEach((tween) => tween._skipFreezeTimeSight || tween.stop());\n    this.add.displayList.list.filter((node) => node.type === 'Sprite').map((node) => node._skipFreezeTimeSight || node.anims.stop());\n\n    // this intentionally uses the base Phaser timer so existing particles get\n    // paused after only a frame of rendering, but any particles that\n    // renderTimeSightFrameInto creates are unaffected\n    const particles = this.add.displayList.list.filter((node) => node.type === 'ParticleEmitterManager');\n    this.time.addEvent({\n      callback: () => {\n        particles.forEach((node) => {\n          if (!node._skipFreezeTimeSight) {\n            node.pause();\n          }\n        });\n      },\n    });\n  }\n\n  cutoffTimeSightEnter() {\n    const frames = this._timeSightFrames;\n\n    if (!frames) {\n      return;\n    }\n\n    if (this._timeSightRemoveFocusTimer) {\n      this._timeSightRemoveFocusTimer.destroy();\n    }\n\n    frames.forEach((frame) => {\n      if (frame.timer) {\n        frame.timer.destroy();\n      }\n\n      frame.objects.forEach((object) => {\n        if (object._timeSightAlphaTween) {\n          object._timeSightAlphaTween.stop();\n        }\n\n        object.alpha = object._timeSightAlpha;\n      });\n    });\n\n    this.cutoffTimeSightChanged(this._replay.preflightCutoff, this._replay.postflightCutoff);\n  }\n\n  cutoffTimeSightChanged(start, end) {\n    const frames = this._timeSightFrames;\n    if (!frames) {\n      return;\n    }\n\n    // ordinarily to be avoided, but we don't want to start a new replay\n    // to take the update from Replay.jsx\n    this._replay.preflightCutoff = start;\n    this._replay.postflightCutoff = end;\n\n    frames.forEach((frame, f) => {\n      const tick = frame.tickCount + ((this._replayLatestTransition ? this._replayLatestTransition.tickCount : 0) || 0);\n      frame.isPreflight = tick < start;\n      frame.isPostflight = tick > end;\n\n      frame.objects.forEach((object) => {\n        object.alpha = (frame.isPreflight || frame.isPostflight) ? object._timeSightAlpha : 1;\n      });\n    });\n  }\n\n  cutoffTimeSightLeave() {\n    const frames = this._timeSightFrames;\n    if (!frames) {\n      return;\n    }\n\n    frames.forEach((frame) => {\n      frame.objects.forEach((object) => {\n        object.alpha = (frame.isPreflight || frame.isPostflight) ? 0 : object._timeSightAlpha;\n      });\n    });\n\n    this.beginTimeSightAlphaAnimation();\n  }\n\n  propDidChange(key, value) {\n    this.replayParticleSystems(key);\n  }\n\n  propDidFinishChange(key, value) {\n    if (this._replay && this._replay.timeSight) {\n      const replay = this._replay;\n      this.game.stopReplay();\n      this.game.beginReplay(replay, {\n        startFromTransition: this._replayLatestTransition,\n      });\n    }\n  }\n\n  beginRecording(recording) {\n    this._recording = recording;\n    recording.sceneSaveState = JSON.parse(JSON.stringify(this._initialSave));\n    recording.sceneTransitions = [];\n    recording.sceneId = this.sceneId;\n\n    this.command.beginRecording(this, recording);\n  }\n\n  stopRecording() {\n    const recording = this._recording;\n    delete this._recording;\n    this.command.stopRecording();\n    return recording;\n  }\n\n  replayParticleSystems(changedKey) {\n    const {particleSystems} = this;\n    this.particleSystems = [];\n\n    particleSystems.forEach((config) => {\n      const {\n        particles, emitter, name, options,\n      } = config;\n\n      if (!particles.active || particles.moribund) {\n        return;\n      }\n\n      // keep other systems as-is\n      if (changedKey && !changedKey.startsWith(name)) {\n        this.particleSystems.push(config);\n        return;\n      }\n\n      const {seed} = emitter;\n      emitter.killAll();\n      emitter.stop();\n      particles.destroy();\n\n      this.particleSystem(name, options, seed);\n    });\n  }\n\n  _builtinHot() {\n    // eslint-disable-next-line no-console\n    console.info(`Hot-loading ${this.constructor.name}`);\n\n    if (this.game._stepExceptions > 100) {\n      // eslint-disable-next-line no-console\n      console.info('Resetting after recovering from errors');\n      this.game._stepExceptions = 0;\n      return;\n    }\n\n    if (this._replay && this._replay.timeSight) {\n      const replay = this._replay;\n      this.game.stopReplay();\n      this.game.beginReplay(replay, {\n        startFromTransition: this._replayLatestTransition,\n      });\n    } else {\n      this.replayParticleSystems();\n    }\n\n    if (this.setupAnimations) {\n      this.reloadAnimations();\n    } else {\n      this.removeAnimations();\n    }\n\n    this.game.recompileMainShaders();\n\n    this.playMusic();\n  }\n\n  _hotReloadCurrentLevel(...args) {\n    return this.replaceWithSelf(false, ...args);\n  }\n\n  removeAnimations() {\n    if (this.physics && this.physics.world && this.physics.world.bodies && this.physics.world.bodies.entries) {\n      this.physics.world.bodies.entries.forEach((body) => {\n        if (body.gameObject && body.gameObject.anims) {\n          body.gameObject.anims.pause();\n          body.gameObject.anims.stop();\n          body.gameObject.anims.remove();\n        }\n      });\n    }\n\n    Object.keys(this.anims.anims.entries).forEach((key) => {\n      this.anims.remove(key);\n    });\n  }\n\n  reloadAnimations() {\n    Object.keys(this.anims.anims.entries).forEach((key) => {\n      this.anims.remove(key);\n    });\n\n    this.setupAnimations();\n\n    if (this.physics && this.physics.world && this.physics.world.bodies && this.physics.world.bodies.entries) {\n      this.physics.world.bodies.entries.forEach((body) => {\n        if (body.gameObject && body.gameObject.anims && body.gameObject.anims.currentAnim) {\n          const {key} = body.gameObject.anims.currentAnim;\n          body.gameObject.anims.stop();\n          body.gameObject.anims.currentAnim = null;\n          this.timer(() => body.gameObject.anims.play(key)).ignoresScenePause = true;\n        }\n      });\n    }\n  }\n\n  particleSystem(name, options = {}, reloadSeed) {\n    // throws error if invalid\n    prop(`${name}.image`);\n\n    const props = {\n      ...propsWithPrefix(`${name}.`),\n      ...options,\n    };\n\n    const {onAdd, image} = props;\n\n    const particles = this.add.particles(image);\n\n    const emitterProps = massageParticleProps(props);\n    const emitter = particles.createEmitter(emitterProps);\n\n    particles.timeScale = this.timeScale;\n\n    injectEmitterOpSeededRandom(emitter, reloadSeed || this.randFloat('particles'));\n\n    if (onAdd) {\n      onAdd(particles, emitter);\n    }\n\n    if (props.preemit || (reloadSeed && props.preemitOnReload)) {\n      this.preemitEmitter(emitter);\n    }\n\n    emitter.ignoresScenePause = emitterProps.ignoresScenePause;\n    emitter.updatesOnceOnPause = emitterProps.updatesOnceOnPause;\n\n    this.particleSystems.push({\n      particles, emitter, name, options,\n    });\n  }\n\n  tween(name, target, options = {}) {\n    if (name !== null) {\n      // throws error if invalid\n      prop(`${name}.duration`);\n    }\n\n    const props = name === null ? {...options} : {\n      ...propsWithPrefix(`${name}.`),\n      ...options,\n    };\n\n    const params = massageTweenProps(target, props, options);\n\n    return this.tweens.add(params);\n  }\n\n  _transitionProps(input) {\n    if (!input) {\n      return input;\n    }\n\n    const prefix = typeof input === 'object' ? input.name : input;\n    const options = typeof input === 'object' ? input : {};\n\n    let props;\n\n    if (prefix) {\n      // throws error if invalid\n      prop(`${prefix}.animation`);\n\n      props = {\n        ...propsWithPrefix(`${prefix}.`),\n        ...options,\n      };\n    } else {\n      props = {\n        ...baseTransitionProps,\n        ...options,\n      };\n    }\n\n    return massageTransitionProps(props, options);\n  }\n\n  tweenPercent(duration, update, onComplete, startPoint = 0, ease = 'Linear') {\n    const tween = this.tweens.addCounter({\n      from: startPoint,\n      to: 100,\n      ease,\n      duration,\n      onUpdate: () => {\n        const factor = tween.getValue() / 100.0;\n        update(factor);\n      },\n      onComplete,\n    });\n\n    return tween;\n  }\n\n  tweenPercentExclusive(fieldName, duration, update, onComplete, ease = 'Linear') {\n    let startPoint = 0;\n    if (this[fieldName]) {\n      startPoint = this[fieldName].getValue();\n      this[fieldName].stop();\n    }\n\n    this[fieldName] = this.tweenPercent(\n      duration * (1 - startPoint / 100.0),\n      update,\n      (...args) => {\n        if (onComplete) {\n          onComplete(...args);\n        }\n        delete this[fieldName];\n      },\n      startPoint,\n      ease,\n    );\n\n    return this[fieldName];\n  }\n\n  tweenInOut(inDuration, outDuration, update, onMidpoint, onComplete, startPoint = 0, inEase = 'Linear', outEase = inEase) {\n    let tween;\n\n    tween = this.tweens.addCounter({\n      from: startPoint,\n      to: 100,\n      ease: inEase,\n      duration: inDuration,\n      onUpdate: () => {\n        const factor = tween.getValue() / 100.0;\n        update(factor, true);\n      },\n      onComplete: () => {\n        tween = this.tweens.addCounter({\n          from: 100,\n          to: 0,\n          ease: outEase,\n          duration: outDuration,\n          onUpdate: () => {\n            const factor = tween.getValue() / 100.0;\n            update(factor, false);\n          },\n          onComplete,\n        });\n\n        if (onMidpoint) {\n          onMidpoint(tween);\n        }\n      },\n    });\n\n    return tween;\n  }\n\n  tweenInOutExclusive(fieldName, inDuration, outDuration, update, onMidpoint, onComplete, inEase = 'Linear', outEase = inEase) {\n    let startPoint = 0;\n    if (this[fieldName]) {\n      startPoint = this[fieldName].getValue();\n      this[fieldName].stop();\n    }\n\n    this[fieldName] = this.tweenInOut(\n      inDuration * (1 - startPoint / 100.0),\n      outDuration,\n      update,\n      (tween, ...args) => {\n        if (onMidpoint) {\n          onMidpoint(tween, ...args);\n        }\n\n        this[fieldName] = tween;\n      },\n      (...args) => {\n        if (onComplete) {\n          onComplete(...args);\n        }\n        delete this[fieldName];\n      },\n      startPoint,\n      inEase,\n      outEase,\n    );\n\n    return this[fieldName];\n  }\n\n  tweenSustain(inDuration, sustainDuration, outDuration, update, onSustain, onOut, onComplete, startPoint = 0, inEase = 'Linear', outEase = inEase) {\n    let tween;\n\n    tween = this.tweens.addCounter({\n      from: startPoint,\n      to: 100,\n      ease: inEase,\n      duration: inDuration,\n      onUpdate: () => {\n        const factor = tween.getValue() / 100.0;\n        update(factor, 'in');\n      },\n      onComplete: () => {\n        tween = this.tweens.addCounter({\n          from: 0,\n          to: 100,\n          duration: sustainDuration,\n          onUpdate: () => {\n            const factor = tween.getValue() / 100.0;\n            update(1, 'sustain', factor);\n          },\n          onComplete: () => {\n            tween = this.tweens.addCounter({\n              from: 100,\n              to: 0,\n              ease: outEase,\n              duration: outDuration,\n              onUpdate: () => {\n                const factor = tween.getValue() / 100.0;\n                update(factor, 'out');\n              },\n              onComplete,\n            });\n\n            if (onOut) {\n              onOut(tween);\n            }\n          },\n        });\n\n        if (onSustain) {\n          onSustain(tween);\n        }\n      },\n    });\n\n    return tween;\n  }\n\n  tweenSustainExclusive(fieldName, inDuration, sustainDuration, outDuration, update, onSustain, onOut, onComplete, inEase = 'Linear', outEase = inEase) {\n    let startPoint = 0;\n    if (this[fieldName]) {\n      startPoint = this[fieldName].getValue();\n      this[fieldName].stop();\n    }\n\n    this[fieldName] = this.tweenSustain(\n      inDuration * (1 - startPoint / 100.0),\n      sustainDuration,\n      outDuration,\n      update,\n      (tween, ...args) => {\n        if (onSustain) {\n          onSustain(tween, ...args);\n        }\n\n        this[fieldName] = tween;\n      },\n      (tween, ...args) => {\n        if (onOut) {\n          onOut(tween, ...args);\n        }\n\n        this[fieldName] = tween;\n      },\n      (...args) => {\n        if (onComplete) {\n          onComplete(...args);\n        }\n        delete this[fieldName];\n      },\n      startPoint,\n      inEase,\n      outEase,\n    );\n\n    return this[fieldName];\n  }\n\n  playSound(baseName, variants, volume = 1.0) {\n    // preflight etc\n    if (!this.scene.isVisible() || this.game._replayPreflight) {\n      return;\n    }\n\n    let name = baseName;\n    if (variants) {\n      name += 1 + Math.floor(this.randBetween(`sound/${name}`, 0, variants));\n    }\n\n    const sound = this.sound.add(name);\n\n    sound.timeScale = 1;\n    sound.requestedVolume = volume;\n\n    sound.setVolume(volume * this.game.volume * prop('scene.soundVolume'));\n\n    this.sounds.push(sound);\n\n    sound.on('complete', () => {\n      this.sounds = this.sounds.filter((s) => s !== sound);\n    });\n\n    sound.play();\n  }\n\n  changeVolume(newVolume) {\n    const {sounds} = this;\n\n    const multiplier = newVolume * prop('scene.soundVolume');\n\n    sounds.forEach((sound) => sound.setVolume(sound.requestedVolume * multiplier));\n  }\n\n  playMusic(name = this.musicName(), forceRestart = false) {\n    this.game.playMusic(name, forceRestart);\n  }\n\n  playMusicIfSet(name = this.musicName(), forceRestart = false) {\n    if (name) {\n      return this.playMusic(name, forceRestart);\n    }\n  }\n\n  musicName() {\n    return null;\n  }\n\n  timer(callback, time) {\n    const timer = {callback, time};\n    this.timers.push(timer);\n    return timer;\n  }\n\n  updateTimers(time, dt) {\n    const {timers} = this;\n    const newTimers = this.timers = [];\n    const isPaused = this._paused.timers;\n\n    timers.forEach((timer) => {\n      if (isPaused && !timer.ignoresScenePause) {\n        newTimers.push(timer);\n        return;\n      }\n\n      if (timer.time) {\n        timer.time -= dt;\n        if (timer.time > 0) {\n          newTimers.push(timer);\n          return;\n        }\n      }\n\n      timer.callback();\n    });\n  }\n\n  updateTweens(time, origDt) {\n    const {tweens} = this.scene.systems;\n    const isPaused = this._paused.tweens;\n\n    // taken from Phaser TweenManager.update\n    const dt = origDt * tweens.timeScale;\n\n    tweens._active.forEach((tween) => {\n      if (isPaused && !tween.ignoresScenePause) {\n        return;\n      }\n\n      if (tween.update(time, dt)) {\n        tweens._destroy.push(tween);\n        tweens._toProcess += 1;\n      }\n    });\n  }\n\n  recoverPerformance() {\n    this.performanceFrames += 1;\n\n    if (!this.performanceAcceptable) {\n      this.performanceAcceptable = this.game.loop.actualFps > 50;\n    }\n\n    if (this.performanceFrames < 300) {\n      return;\n    }\n\n    this.performanceFrames = 0;\n\n    if (this.performanceAcceptable) {\n      this.performanceAcceptable = false;\n      return;\n    }\n\n    if (this.performanceProps.length) {\n      let changes = this.performanceProps.shift();\n      if (!Array.isArray(changes)) {\n        changes = [changes];\n      }\n\n      const applyPropChanges = (props) => {\n        if (props.length) {\n          if (this.game.debug) {\n            refreshUI();\n          }\n\n          props.forEach((propName) => {\n            const particleProp = particlePropFromProp(propName);\n            if (particleProp) {\n              propsWithPrefix(`${particleProp}.`, true);\n\n              this.replayParticleSystems(particleProp);\n            }\n          });\n        }\n      };\n\n      let batch = true;\n      const changedProps = [];\n      const setProp = (key, value) => {\n        changedProps.push(key);\n        const spec = propSpecs[key];\n\n        if (this.game.debug) {\n          manageableProps[key] = value;\n        } else {\n          propSpecs[key][0] = value;\n        }\n\n        if (spec.length > 1 && spec[1] !== null) {\n          if (typeof spec[spec.length - 1] === 'function') {\n            const changeCallback = spec[spec.length - 1];\n            changeCallback(value, this, this.game);\n          }\n        }\n\n        if (!batch) {\n          applyPropChanges([key]);\n        }\n      };\n\n      changes.forEach((change) => {\n        if (typeof change === 'string') {\n          if (change === 'disableMainShaders') {\n            this.game.disableMainShaders();\n          } else {\n            setProp(change, !prop(change));\n          }\n        } else if (typeof change === 'function') {\n          change(setProp);\n        }\n      });\n\n      batch = false;\n\n      // eslint-disable-next-line no-console\n      console.log(`Performance seems iffy; applying ${changes.join(', ')}`);\n\n      applyPropChanges(changedProps);\n    }\n  }\n\n  handlePointerEvent(event) {\n    const camelName = event.name.charAt(0).toUpperCase() + event.name.slice(1);\n    const method = `handle${camelName}`;\n    if (this[method]) {\n      this[method](event);\n    } else if (prop('config.debug')) {\n      const debugMethod = `debugHandle${camelName}`;\n      if (this[debugMethod]) {\n        this[debugMethod](event);\n      }\n    }\n  }\n\n  cameraFollow(object, offsetX = 0, offsetY = 0) {\n    if (object) {\n      const lerp = prop('scene.camera.lerp');\n      // true is roundPixels to avoid subpixel rendering\n      this.camera.startFollow(object, true, lerp, lerp, offsetX, offsetY);\n    } else {\n      this.camera.stopFollow();\n    }\n  }\n\n  get timeScale() {\n    return this._timeScale;\n  }\n\n  set timeScale(scale) {\n    this._timeScale = scale;\n\n    if (this.particleSystems) {\n      this.particleSystems.forEach((p) => {\n        p.particles.timeScale = scale;\n      });\n    }\n\n    if (this.physics) {\n      this.physics.world.timeScale = scale;\n      this.physics.world.bodies.entries.forEach((body) => {\n        if (body.gameObject && body.gameObject.anims) {\n          body.gameObject.anims.setTimeScale(scale);\n        }\n      });\n    }\n\n    // None of these are necessary thanks to us rewiring the event loop:\n    /*\n    this.tweens.timeScale = scale;\n    this.time.timeScale = scale;\n    this.anims.globalTimeScale = scale;\n    */\n  }\n\n  shockwave(x, y) {\n    this.shockwave_time = this.scene_time;\n    this.shockwave_center = [x / this.game.config.width, y / this.game.config.height];\n  }\n\n  positionToScreenCoordinate(x, y) {\n    const {tileWidth, tileHeight} = this.game.config;\n    return [x * tileWidth + this.xBorder, y * tileHeight + this.yBorder];\n  }\n\n  timeSightMouseDrag() {\n    const {activePointer} = this.game.input;\n    if (activePointer.isDown) {\n      this.cameraFollow();\n\n      if (this._timeSightMouseDragX) {\n        this.camera.scrollX += this._timeSightMouseDragX - activePointer.position.x;\n      }\n\n      if (this._timeSightMouseDragY) {\n        this.camera.scrollY += this._timeSightMouseDragY - activePointer.position.y;\n      }\n\n      this._timeSightMouseDragX = activePointer.position.x;\n      this._timeSightMouseDragY = activePointer.position.y;\n    } else {\n      delete this._timeSightMouseDragX;\n      delete this._timeSightMouseDragY;\n    }\n  }\n\n  willTransitionTo(newScene, transition) {\n  }\n\n  willTransitionFrom(oldScene, transition) {\n  }\n\n  didTransitionTo(newScene, transition) {\n  }\n\n  didTransitionFrom(oldScene, transition) {\n    if (transition && transition.delayNewSceneShader) {\n      this._setupShader();\n    }\n\n    this.playMusic();\n  }\n\n  pauseInputForTransition(transition) {\n    this.command.ignoreAll('_transition', true);\n  }\n\n  unpauseInputForTransition(transition) {\n    this.command.ignoreAll('_transition', false);\n  }\n\n  pausePhysicsForTransition(transition) {\n    this.pauseInputForTransition(transition);\n\n    this._paused.physics = true;\n\n    this.pauseAllAnimations();\n  }\n\n  unpausePhysicsForTransition(transition) {\n    this.unpauseInputForTransition(transition);\n\n    this._paused.physics = false;\n\n    this.resumeAllAnimations();\n  }\n\n  pauseEverythingForTransition(transition) {\n    this.pausePhysicsForTransition(transition);\n\n    this._paused.timers = true;\n    this.pauseAllParticleSystems();\n    this.pauseAllTweens();\n  }\n\n  unpauseEverythingForTransition(transition) {\n    this.unpausePhysicsForTransition(transition);\n\n    this._paused.timers = false;\n    this.resumeAllParticleSystems();\n    this.resumeAllTweens();\n  }\n\n  pauseAllParticleSystems() {\n    this._paused.particles = true;\n\n    if (this.particleSystems.length) {\n      injectParticleEmitterManagerPreUpdate(this.particleSystems[0].particles);\n    }\n  }\n\n  pauseAllTweens() {\n    this._paused.tweens = true;\n  }\n\n  pauseAllAnimations() {\n    this._paused.anims = true;\n\n    if (this._injectedAnimsUpdate) {\n      return;\n    }\n\n    if (this.physics && this.physics.world && this.physics.world.bodies && this.physics.world.bodies.entries) {\n      this.physics.world.bodies.entries.forEach((body) => {\n        if (body.gameObject && body.gameObject.anims) {\n          if (injectAnimationUpdate(body.gameObject.anims)) {\n            this._injectedAnimsUpdate = true;\n          }\n        }\n      });\n    }\n  }\n\n  resumeAllParticleSystems() {\n    this._paused.particles = false;\n\n    this.particleSystems.forEach((p) => {\n      p.particles.resume();\n    });\n  }\n\n  resumeAllTweens() {\n    this._paused.tweens = false;\n  }\n\n  resumeAllAnimations() {\n    this._paused.anims = false;\n  }\n\n  cameraColor() {\n    return 0;\n  }\n\n  destroy() {\n    this.command.detachScene(this);\n  }\n}\n\nif (module.hot) {\n  module.hot.accept('../assets/maps.txt', () => {\n    try {\n      const next = require('../assets/maps.txt');\n\n      fetch(next).then((res) => {\n        res.text().then((text) => {\n          try {\n            const {game} = window;\n\n            const previous = game._ldMapFiles;\n            const nextMaps = parseMaps(text);\n\n            if (!previous || !nextMaps) {\n              return;\n            }\n\n            game._ldMapFiles = nextMaps;\n\n            let reloadCurrent = true;\n\n            const scene = game.topScene();\n            const activeId = scene.level && scene.level.id;\n\n            const prevById = {};\n            previous.forEach((spec) => { prevById[spec[1].id] = spec; });\n            const nextById = {};\n            nextMaps.forEach((spec) => { nextById[spec[1].id] = spec; });\n\n            const changes = [];\n\n            const leftover = {...prevById};\n\n            Object.entries(nextById).forEach(([id, nextSpec]) => {\n              if (!prevById[id]) {\n                if (id !== activeId) {\n                  changes.push(`+${id}`);\n                }\n              } else {\n                const previousSpec = prevById[id];\n                delete leftover[id];\n\n                if (!deepEqual(previousSpec, nextSpec)) {\n                  if (id !== activeId) {\n                    changes.push(`Δ${id}`);\n                  }\n                }\n              }\n            });\n\n            changes.push(...Object.keys(leftover).filter((id) => id !== activeId).map((id) => `-${id}`));\n\n            if (!deepEqual(previous.map((spec) => spec[1].id), nextMaps.map((spec) => spec[1].id))) {\n              changes.push('(order)');\n            }\n\n            if (activeId) {\n              const p = prevById[activeId];\n              const n = nextById[activeId];\n\n              if (deepEqual(p, n)) {\n                reloadCurrent = false;\n              } else {\n                changes.unshift(`active level ${activeId}`);\n              }\n            }\n\n            // eslint-disable-next-line no-console\n            console.info(`Hot-loading levels: ${changes.join(', ')}`);\n\n            if (!reloadCurrent) {\n              return;\n            }\n\n            if (scene._builtinHot) {\n              scene._builtinHot();\n            }\n            if (scene._hot) {\n              scene._hot();\n            }\n\n            scene._hotReloadCurrentLevel();\n          } catch (e) {\n            // eslint-disable-next-line no-console\n            console.error(e);\n          }\n        });\n      });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n    }\n  });\n\n  module.hot.accept('../assets/index', () => {\n    try {\n      const next = require('../assets/index');\n      const {game} = window;\n\n      reloadAssets(game.topScene(), next).then(([changedAssets, changesByType]) => {\n        const scene = game.topScene();\n        let sawChanges = false;\n\n        Object.entries(changedAssets).forEach(([type, changed]) => {\n          if (changesByType[type] && changesByType[type].length) {\n            sawChanges = true;\n            // eslint-disable-next-line no-console\n            console.info(`Hot-loading ${type}: ${changesByType[type].join(', ')}`);\n          }\n\n          if (type === 'musicAssets') {\n            const {currentMusicName} = game;\n            if (changed[currentMusicName]) {\n              game.playMusic(currentMusicName, true);\n            }\n          } else if (type === 'imageAssets' || type === 'spriteAssets') {\n            Object.entries(changed).forEach(([key, texture]) => {\n              scene.add.displayList.list.forEach((object) => {\n                if (object.texture && object.texture.key === key) {\n                  if (object.setTexture) {\n                    object.setTexture(key);\n                  } else {\n                    object.texture = texture;\n                  }\n                }\n              });\n            });\n          }\n        });\n\n        if (!sawChanges) {\n          return;\n        }\n\n        if (scene._builtinHot) {\n          scene._builtinHot();\n        }\n        if (scene._hot) {\n          scene._hot();\n        }\n      });\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n    }\n  });\n}\n","import deepEqual from 'deep-equal';\nimport {tileDefinitions} from '../../props';\n\nlet tileSpecs;\nexport function updateTileDefinitions(newDefinitions) {\n  const previousTileSpecs = tileSpecs;\n  tileSpecs = preprocessTileDefinitions(newDefinitions);\n\n  if (!previousTileSpecs) {\n    return null;\n  }\n\n  const changes = [];\n\n  const leftoverKeys = {};\n  Object.keys(previousTileSpecs).forEach((key) => {\n    leftoverKeys[key] = true;\n  });\n\n  Object.keys(tileSpecs).forEach((key) => {\n    const oldValue = previousTileSpecs[key];\n    const newValue = tileSpecs[key];\n\n    if (key in previousTileSpecs) {\n      delete leftoverKeys[key];\n    }\n\n    if (!deepEqual(oldValue, newValue)) {\n      changes.push(key);\n    }\n  });\n\n  changes.push(...Object.keys(leftoverKeys));\n  return changes;\n}\n\nupdateTileDefinitions(tileDefinitions);\n\nexport function tileSpec(glyph) {\n  return tileSpecs[glyph];\n}\n\nfunction flattenInheritance(specs) {\n  Object.entries(specs).forEach(([key, config]) => {\n    if (!config || !config._inherit) {\n      return;\n    }\n\n    const seen = {[key]: true};\n    const nodes = [{...config}];\n\n    let parent = config._inherit;\n    if (!(parent in specs)) {\n      throw new Error(`Inherited from nonexistent parent: ${key} → ${parent}`);\n    }\n\n    while (specs[parent]) {\n      if (seen[parent]) {\n        throw new Error(`Loop detected in tileDefinitions _inherit: ${[...Object.keys(seen), key].join(' → ')}`);\n      }\n\n      seen[parent] = true;\n      nodes.unshift(specs[parent]);\n      parent = specs[parent]._inherit;\n    }\n\n    Object.assign(config, ...nodes);\n  });\n\n  return specs;\n}\n\nexport function preprocessTileDefinitions(specs) {\n  return flattenInheritance(specs);\n}\n\nexport function parseMaps(content) {\n  const maps = [];\n\n  const allLines = content.split('\\n');\n  if (allLines.length === 0) {\n    return maps;\n  }\n\n  // simplify end checking\n  allLines.push('');\n\n  let mapLines = [];\n  let configLines = [];\n  let prevLineIsEmpty = true;\n  let parsingConfig = false;\n\n  allLines.forEach((line, i) => {\n    if (line === '') {\n      if (prevLineIsEmpty) {\n        return;\n      }\n      prevLineIsEmpty = true;\n\n      if (mapLines.length && configLines.length) {\n        const config = JSON.parse(configLines.join('\\n'));\n        if (!config.id) {\n          console.warn(`Config line ${i}: level is missing an 'id'`);\n        }\n        maps.push([[...mapLines], config]);\n        mapLines = [];\n        configLines = [];\n        parsingConfig = false;\n      } else if (mapLines.length) {\n        parsingConfig = true;\n      }\n    } else {\n      prevLineIsEmpty = false;\n\n      if (parsingConfig) {\n        configLines.push(line);\n      } else {\n        mapLines.push(line);\n      }\n    }\n  });\n\n  return maps;\n}\n\nexport function parseLevelLines(lines, isRectangular) {\n  const lookups = {};\n  const map = [];\n  lines.forEach((line, y) => {\n    const row = [];\n    line.split('').forEach((glyph, x) => {\n      if (!(glyph in tileSpecs)) {\n        throw new Error(`Unknown glyph at (${x}, ${y}): ${glyph}`);\n      }\n\n      const tile = {\n        x,\n        y,\n        glyph,\n        ...tileSpecs[glyph],\n      };\n\n      row.push(tile);\n\n      if (!lookups[glyph]) {\n        lookups[glyph] = [];\n      }\n      lookups[glyph].push(tile);\n    });\n\n    map.push(row);\n  });\n\n  if (isRectangular) {\n    map.forEach((row, y) => {\n      if (y === map.length - 1) {\n        return;\n      }\n\n      if (row.length !== map[y + 1].length) {\n        throw new Error(`Inconsistent row width at ${y + 1}. Expected ${row.length}, got ${map[y + 1].length}`);\n      }\n    });\n  }\n\n  const mapText = lines.join(\"\\n\");\n\n  return {map, mapText, lookups};\n}\n\nexport default function parseLevel(content, isRectangular) {\n  const allLines = content.split('\\n');\n\n  // trailing empty lines\n  while (allLines[allLines.length - 1].length === 0) {\n    allLines.pop();\n  }\n\n  // find last empty line\n  let i;\n  for (i = allLines.length - 1; i >= 0; i -= 1) {\n    if (allLines[i].length === 0) {\n      break;\n    }\n  }\n\n  if (i < 0) {\n    throw new Error('No empty line for parseLevel');\n  }\n\n  const {lookups, map} = parseLevelLines(allLines.slice(0, i), isRectangular);\n  const config = JSON.parse(allLines.slice(i).join('\\n'));\n\n  return {map, config, lookups};\n}\n\nif (module.hot) {\n  module.hot.accept('../../props', () => {\n    try {\n      const next = require('../../props');\n\n      const changes = updateTileDefinitions(next.tileDefinitions);\n      if (changes.length === 0) {\n        return;\n      }\n\n      // eslint-disable-next-line no-console\n      console.info(`Hot-loading tile definitions: ${changes}`);\n\n      const {game} = window;\n      const scene = game.topScene();\n      if (scene._builtinHot) {\n        scene._builtinHot();\n      }\n      if (scene._hot) {\n        scene._hot();\n      }\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n    }\n  });\n}\n","import {\n  builtinPropSpecs, ManageableProps, PropLoader, makePropsWithPrefix,\n  preprocessPropSpecs,\n} from './scaffolding/lib/props';\nimport {tweenEases} from './scaffolding/lib/tweens';\n\nconst particleImages = [\n  'imageCloud',\n];\n\nexport const commands = {\n  dash: { // ekks\n    input: ['keyboard.Z', 'gamepad.A'],\n  },\n  stun: { // square\n    input: ['keyboard.X', 'gamepad.X'],\n  },\n  /*\n  : { // triangle\n    input: ['keyboard.', 'gamepad.Y'],\n  },\n  */\n  up: {\n    input: ['keyboard.UP', 'gamepad.UP'],\n  },\n  down: {\n    input: ['keyboard.DOWN', 'gamepad.DOWN'],\n  },\n  left: {\n    input: ['keyboard.LEFT', 'gamepad.LEFT'],\n  },\n  right: {\n    input: ['keyboard.RIGHT', 'gamepad.RIGHT'],\n  },\n  lstick: {\n    input: ['gamepad.LSTICK.RAW'],\n    joystick: true,\n  },\n  rstick: {\n    input: ['gamepad.RSTICK.RAW'],\n    joystick: true,\n  },\n\n  restart: {\n    input: ['keyboard.R'],\n    execute: (scene) => scene.replaceWithSelf(),\n    debug: true,\n    unignorable: true,\n    unreplayable: true,\n  },\n  quit: {\n    input: ['keyboard.Q'],\n    execute: 'forceQuit',\n    debug: true,\n    unignorable: true,\n    unreplayable: true,\n  },\n  recordCycle: {\n    input: ['gamepad.R1'],\n    unreplayable: true,\n    debug: true,\n    unignorable: true,\n    execute: (scene, game) => {\n      const {_replay, _recording} = game;\n      if (_replay && _replay.timeSight) {\n        game.stopReplay();\n      } else if (_replay) {\n        setTimeout(() => {\n          game.stopReplay();\n          game.beginReplay({..._replay, timeSight: true});\n        });\n      } else if (_recording) {\n        game.stopRecording();\n      } else {\n        game.beginRecording();\n      }\n    },\n  },\n};\n\nexport const shaderCoordFragments = [\n  'shockwave',\n];\n\nexport const shaderColorFragments = [\n  'blur',\n\n  ['night', {\n    color: ['rgb', [205 / 255, 67 / 255, 67 / 255]],\n    alpha_factor: ['float', 0.31, 0, 1, 0.01],\n    tint_factor: ['float', 0.36, 0, 1, 0.01],\n    amount: ['float', 0, null],\n  }, `\n      c.r = c.r * (1.0 - night_alpha_factor) + c.r * night_alpha_factor * (1.0 - night_amount);\n      c.g = c.g * (1.0 - night_alpha_factor) + c.g * night_alpha_factor * (1.0 - night_amount);\n      c.b = c.b * (1.0 - night_alpha_factor) + c.b * night_alpha_factor * (1.0 - night_amount);\n\n      c.r = c.r + night_amount * night_tint_factor * night_color.r;\n      c.g = c.g + night_amount * night_tint_factor * night_color.g;\n      c.b = c.b + night_amount * night_tint_factor * night_color.b;\n  `],\n\n  ['flock', {\n    color: ['rgb', [1, 1, 1]],\n    alpha_factor: ['float', 0.11, 0, 1, 0.01],\n    tint_factor: ['float', 0.15, 0, 1, 0.01],\n    amount: ['float', 0, null],\n    // amount: ['float', 0, 0, 1, 0.01],\n  }, `\n      c.r = c.r * (1.0 - flock_alpha_factor) + c.r * flock_alpha_factor * (1.0 - flock_amount);\n      c.g = c.g * (1.0 - flock_alpha_factor) + c.g * flock_alpha_factor * (1.0 - flock_amount);\n      c.b = c.b * (1.0 - flock_alpha_factor) + c.b * flock_alpha_factor * (1.0 - flock_amount);\n\n      c.r = c.r + flock_amount * flock_tint_factor * flock_color.r;\n      c.g = c.g - flock_amount * flock_tint_factor * flock_color.g;\n      c.b = c.b - flock_amount * flock_tint_factor * flock_color.b;\n  `],\n];\n\nexport const propSpecs = {\n  ...builtinPropSpecs(commands, shaderCoordFragments, shaderColorFragments),\n\n  'command.ignore_all.blockade': [false, null, (scene) => scene.command.ignoreAll('blockade')],\n  // 'rules.base_gravity': [400, 0, 1000],\n\n  'level.id': ['', null],\n  'level.width': [0, null],\n  'level.height': [0, null],\n\n  'player.x': [0.1, null, 'level.player.x'],\n  'player.y': [0.1, null, 'level.player.y'],\n  'player.velocity_x': [0.1, null, 'level.player.body.velocity.x'],\n  'player.velocity_y': [0.1, null, 'level.player.body.velocity.y'],\n  'player.acceleration_x': [0.1, null, 'level.player.body.acceleration.x'],\n  'player.acceleration_y': [0.1, null, 'level.player.body.acceleration.y'],\n  'player.acceleration': [3000, 0, 5000],\n  'player.mass': [1, 0, 100, (value, scene) => scene.level.player.body.setMass(value)],\n  'player.drag': [0.8, 0, 1, (value, scene) => scene.level.player.setDrag(value)],\n  'player.friction': [1, 0, 100, (value, scene) => scene.level.player.setFriction(value)],\n  'player.bounce': [1, 0, 100, (value, scene) => scene.level.player.setBounce(value)],\n  'player.maxVelocity': [200, 0, 1000, (value, scene) => scene.level.player.setMaxVelocity(value)],\n\n  'player.dash.active': [false, null, 'level.player.dash.active'],\n  'player.dash.cooldown': [false, null, 'level.player.dash.cooldown'],\n  'player.dash.velocity': [500, 0, 1000],\n  'player.dash.in_duration': [100, 0, 1000],\n  'player.dash.sustain_duration': [200, 0, 1000],\n  'player.dash.out_duration': [100, 0, 1000],\n  'player.dash.in_ease': ['Cubic.easeIn', tweenEases],\n  'player.dash.out_ease': ['Cubic.easeOut', tweenEases],\n  'player.dash.cooldown_duration': [300, 0, 1000],\n\n  'player.stun.active': [false, null, 'level.player.stun.active'],\n  'player.stun.cooldown': [false, null, 'level.player.stun.cooldown'],\n\n  'follower.mass': [1, 0, 100, (value, scene) => scene.level.followers.forEach((f) => f.body.setMass(value))],\n  'follower.drag': [0.95, 0, 1, (value, scene) => scene.level.followers.forEach((f) => f.setDrag(value))],\n  'follower.friction': [1, 0, 100, (value, scene) => scene.level.followers.forEach((f) => f.setFriction(value))],\n  'follower.bounce': [1, 0, 100, (value, scene) => scene.level.followers.forEach((f) => f.setBounce(value))],\n  'follower.maxVelocity': [50, 0, 1000, (value, scene) => scene.level.followers.forEach((f) => f.setMaxVelocity(value))],\n  'follower.velocityLerp': [0.2, 0, 1],\n  'follower.flockAcceleration': [75, 0, 1000],\n  'follower.cohereRadius': [1000, 0, 1000],\n  'follower.cohereFactor': [1, 0, 100],\n  'follower.spreadRadius': [100, 0, 1000],\n  'follower.spreadFactor': [15, 0, 100],\n  'follower.playerRadius': [300, 0, 1000],\n  'follower.playerFactor': [4, 0, 100],\n  'follower.obstacleRadius': [100, 0, 1000],\n  'follower.obstacleFactor': [1000, 0, 1000],\n  'follower.enemyRadius': [200, 0, 1000],\n  'follower.enemyFactor': [4, 0, 100],\n  'follower.killerRadius': [200, 0, 1000],\n  'follower.killerFactor': [200, 0, 1000],\n  'follower.killerAcceleration': [1000, 0, 1000],\n  'follower.killerVelocity': [20, 0, 1000],\n\n  'enemy.mass': [1, 0, 100, (value, scene) => scene.level.enemies.forEach((f) => f.body.setMass(value))],\n  'enemy.drag': [0.95, 0, 1, (value, scene) => scene.level.enemies.forEach((f) => f.setDrag(value))],\n  'enemy.friction': [1, 0, 100, (value, scene) => scene.level.enemies.forEach((f) => f.setFriction(value))],\n  'enemy.bounce': [4, 0, 100, (value, scene) => scene.level.enemies.forEach((f) => f.setBounce(value))],\n  'enemy.maxVelocity': [100, 0, 1000, (value, scene) => scene.level.enemies.forEach((f) => f.setMaxVelocity(value))],\n  'enemy.velocityLerp': [0.2, 0, 1],\n  'enemy.flockAcceleration': [200, 0, 10000],\n  'enemy.cohereRadius': [1000, 0, 1000],\n  'enemy.cohereFactor': [20, 0, 100],\n  'enemy.spreadRadius': [100, 0, 1000],\n  'enemy.spreadFactor': [1000, 0, 1000],\n  'enemy.avoidPlayerRadius': [100, 0, 1000],\n  'enemy.avoidPlayerFactor': [500, 0, 100],\n  'enemy.seekPlayerRadius': [1000, 0, 1000],\n  'enemy.seekPlayerFactor': [1, 0, 100],\n  'enemy.obstacleRadius': [80, 0, 1000],\n  'enemy.obstacleFactor': [1000, 0, 1000],\n  'enemy.followerRadius': [1000, 0, 1000],\n  'enemy.followerFactor': [25, 0, 1000],\n  'enemy.victimRadius': [300, 0, 1000],\n  'enemy.victimFactor': [700, 0, 1000],\n  'enemy.victimAcceleration': [1000, 0, 1000],\n  'enemy.victimVelocity': [10, 0, 1000],\n\n  'effects.sceneTransition.transition': [{\n    animation: 'pushLeft',\n    ease: 'Cubic.easeInOut',\n  }],\n\n  'effects.zoomOnLoss.distance': [15, 0, 1000],\n  'effects.zoomOnLoss.pan_duration': [1000, 0, 1000],\n  'effects.zoomOnLoss.pan_ease': ['Cubic.easeInOut', tweenEases],\n  'effects.zoomOnLoss.zoom_duration': [1000, 0, 1000],\n  'effects.zoomOnLoss.zoom_ease': ['Cubic.easeInOut', tweenEases],\n  'effects.zoomOnLoss.zoom_scale': [1.2, 0, 10],\n  'effects.zoomOnLoss.time_scale': [0.1, 0, 1],\n  'effects.zoomOnLoss.recover_linger_duration': [100, 0, 10000],\n  'effects.zoomOnLoss.recover_zoom_duration': [500, 0, 10000],\n  'effects.zoomOnLoss.recover_zoom_ease': ['Cubic.easeInOut', tweenEases],\n  'effects.zoomOnLoss.recover_pan_duration': [500, 0, 10000],\n  'effects.zoomOnLoss.recover_pan_ease': ['Cubic.easeInOut', tweenEases],\n  'effects.zoomOnLoss.recover_time_scale_duration': [100, 0, 10000],\n  'effects.zoomOnLoss.recover_time_scale_ease': ['Cubic.easeInOut', tweenEases],\n\n  'effects.followerDie.duration': [100, 0, 10000],\n\n  'effects.dashPuff.particles': [{\n    frequency: 50,\n    lifespan: 500,\n  }],\n\n  'effects.glow.particles': [{\n    scaleX: 0.1,\n    scaleY: 0.1,\n    speedY: -10,\n    lifespan: 5000,\n    frequency: 100,\n  }],\n\n  'effects.loseTransition.transition': [{\n    animation: 'fadeInOut',\n    oldPause: 'everything',\n    delay: 1000,\n  }],\n};\n\npropSpecs['scene.camera.lerp'][0] = 0.05;\npropSpecs['scene.camera.deadzoneX'][0] = 200;\npropSpecs['scene.camera.deadzoneY'][0] = 200;\n\nexport const tileDefinitions = {\n  '.': null,\n  '@': null,\n  '+': null,\n  $: null,\n  F: {\n    image: 'spriteFarmer',\n    group: 'farmer',\n    isStatic: true,\n    isObstacle: true,\n  },\n\n  '*': {\n    image: 'tileWall',\n    group: 'wall',\n    isStatic: true,\n    isObstacle: true,\n  },\n  0: {\n    image: 'tileGrassRock',\n    group: 'rock',\n    isStatic: true,\n    isCircle: true,\n    isObstacle: true,\n  },\n  ';': {\n    image: null,\n    group: 'transition',\n    isStatic: true, // for followers\n    isObstacle: true, // for followers\n  },\n  '^': {\n    _inherit: ';',\n  },\n  '[': {\n    image: 'tileCoop',\n    group: 'coop',\n    isStatic: true,\n    isObstacle: true,\n    isCoop: true,\n    health: 4,\n  },\n  ']': {\n    _inherit: '[',\n  },\n  A: {\n    enemy: 'spriteEnemyA',\n  },\n};\n\npreprocessPropSpecs(propSpecs, particleImages);\n\nexport const manageableProps = new ManageableProps(propSpecs);\nexport const propsWithPrefix = makePropsWithPrefix(propSpecs, manageableProps);\nexport default PropLoader(propSpecs, manageableProps);\n","export const tweenEases = [\n  'Linear',\n  'Quad.easeIn',\n  'Quad.easeOut',\n  'Quad.easeInOut',\n  'Cubic.easeIn',\n  'Cubic.easeOut',\n  'Cubic.easeInOut',\n  'Quart.easeIn',\n  'Quart.easeOut',\n  'Quart.easeInOut',\n  'Quint.easeIn',\n  'Quint.easeOut',\n  'Quint.easeInOut',\n  'Sine.easeIn',\n  'Sine.easeOut',\n  'Sine.easeInOut',\n  'Expo.easeIn',\n  'Expo.easeOut',\n  'Expo.easeInOut',\n  'Circ.easeIn',\n  'Circ.easeOut',\n  'Circ.easeInOut',\n  'Back.easeIn',\n  'Back.easeOut',\n  'Back.easeInOut',\n  'Bounce.easeIn',\n  'Bounce.easeOut',\n  'Bounce.easeInOut',\n];\n\nconst defaultTweenProps = {\n  delay_enabled: [true],\n  delay: [0, 0, 10000],\n  duration: [0, 0, 10000],\n  ease: ['Linear', tweenEases],\n\n  dx_enabled: [false],\n  dx: [0, -1000, 1000],\n  dy_enabled: [false],\n  dy: [0, -1000, 1000],\n  alpha_enabled: [false],\n  alpha: [1.0, 0, 1, 0.01],\n  rotation_enabled: [false],\n  rotation: [0, -1080, 1080, 1],\n  scaleX_enabled: [false],\n  scaleX: [1.0, 0, 10, 0.1],\n  scaleY_enabled: [false],\n  scaleY: [1.0, 0, 10, 0.1],\n\n  yoyo: [false],\n  loop: [0, -1, 100, 1],\n  ignoresScenePause: [false],\n  refreshPhysics: [false],\n  destroyOnComplete: [false],\n  animated: [true],\n};\n\nexport function expandTweenProps(props) {\n  Object.entries(props).forEach(([name, spec]) => {\n    if (!name.endsWith('.tween')) {\n      return;\n    }\n\n    const prefix = name.substr(0, name.length - '.tween'.length);\n\n    if (!Array.isArray(spec) || spec.length !== 1 || typeof spec[0] !== 'object') {\n      throw new Error(`Expected ${name} prop to have the shape [{…}]; did you mean to end it in .tween?`);\n    }\n\n    delete props[name];\n\n    const [config] = spec;\n\n    const seen = {...config};\n\n    Object.entries(defaultTweenProps).forEach(([key, value]) => {\n      if (key in config) {\n        props[`${prefix}.${key}`] = [config[key], ...value.slice(1)];\n        delete seen[key];\n      } else if (key.endsWith('_enabled')) {\n        const targetKey = key.substr(0, key.length - '_enabled'.length);\n        props[`${prefix}.${key}`] = [targetKey in config];\n      } else {\n        props[`${prefix}.${key}`] = value;\n      }\n    });\n\n    if (Object.keys(seen).length) {\n      throw new Error(`Got unexpected tween config settings: ${Object.keys(seen).join(', ')}`);\n    }\n  });\n}\n\nexport default function massageTweenProps(target, {...props}, options) {\n  const {massageProps} = props;\n\n  delete props.massageProps;\n\n  Object.entries(props).forEach(([key, config]) => {\n    if (key.endsWith('_enabled')) {\n      const main = key.substr(0, key.length - '_enabled'.length);\n      if (!config && !options[main]) {\n        delete props[main];\n      }\n      delete props[key];\n    }\n  });\n\n  props.targets = target;\n\n  if (props.destroyOnComplete) {\n    delete props.destroyOnComplete;\n    const {onComplete} = props;\n    if (onComplete) {\n      props.onComplete = (...args) => {\n        onComplete(...args);\n        target.destroy();\n      };\n    } else {\n      props.onComplete = () => {\n        target.destroy();\n      };\n    }\n  }\n\n  if ('dx' in props) {\n    const {dx} = props;\n    props.x = target.x + dx;\n  }\n\n  if ('dy' in props) {\n    const {dy} = props;\n    props.y = target.y + dy;\n  }\n\n  const originalX = props.x;\n  const originalY = props.y;\n\n  if (props.refreshPhysics) {\n    delete props.refreshPhysics;\n    const {onUpdate} = props;\n    if (onUpdate) {\n      props.onUpdate = (...args) => {\n        onUpdate(...args);\n        if (target.body) {\n          target.refreshBody();\n        }\n      };\n    } else {\n      props.onUpdate = () => {\n        if (target.body) {\n          target.refreshBody();\n        }\n      };\n    }\n  }\n\n  if (massageProps) {\n    massageProps(props);\n  }\n\n  if ('dx' in props && (!('x' in props) || props.x === originalX)) {\n    const {dx} = props;\n    props.x = target.x + dx;\n  }\n  delete props.dx;\n\n  if ('dy' in props && (!('y' in props) || props.y === originalY)) {\n    const {dy} = props;\n    props.y = target.y + dy;\n  }\n  delete props.dy;\n\n  // convert degrees to radians\n  if (props.rotation) {\n    props.rotation *= Math.PI / 180;\n  }\n\n  if ('animated' in props && !props.animated) {\n    props.duration = 0;\n    delete props.loop;\n\n    // yoyo ends up where we began, so just don't animate anything\n    if (props.yoyo) {\n      delete props.x;\n      delete props.y;\n      delete props.dx;\n      delete props.dy;\n      delete props.rotation;\n      delete props.scaleX;\n      delete props.scaleY;\n\n      delete props.yoyo;\n\n      // make sure we animate \"something\"\n      props.alpha = target.alpha;\n    }\n  }\n  delete props.animated;\n\n  return props;\n}\n\nlet injected = false;\nexport function injectTweenManagerAdd(tweens) {\n  if (injected) {\n    return;\n  }\n\n  // eslint-disable-next-line no-proto\n  const proto = tweens.__proto__;\n\n  const origAdd = proto.add;\n  proto.add = function(config) {\n    const tween = origAdd.call(this, config);\n    tween.ignoresScenePause = config.ignoresScenePause;\n    return tween;\n  };\n\n  injected = true;\n}\n","import _ from 'lodash';\nimport * as dat from 'dat.gui';\nimport prop, {manageableProps, propSpecs} from '../../props';\nimport {saveField} from './store';\nimport {savedChangedProps} from './props';\n\nlet gui;\n\nconst folders = {};\nconst controllers = {};\nconst parentOfFolder = new Map();\nconst changedProps = {};\n\nconst originalProp = prop;\nlet proxiedManageableProps = manageableProps;\nconst manageablePropsProxy = new Proxy({}, {\n  get(target, key) {\n    return proxiedManageableProps[key];\n  },\n\n  set(target, key, value) {\n    proxiedManageableProps[key] = value;\n    return true;\n  },\n});\n\nexport function initializeManage() {\n  if (!gui) {\n    gui = new dat.GUI({autoPlace: false});\n\n    Object.keys(propSpecs).forEach((key) => addNestedFolder(key));\n    Object.keys(propSpecs).forEach((key) => addController(\n      key,\n      propSpecs[key],\n      false,\n      key in savedChangedProps || `${key}_enabled` in savedChangedProps,\n    ));\n  }\n\n  return gui;\n}\n\nfunction upcase(word) {\n  return word.charAt(0).toUpperCase() + word.slice(1);\n}\n\nfunction sentenceCase(name) {\n  const words = name.split(/[-_ ]/);\n  return words.map(upcase).join(' ');\n}\n\nfunction addNestedFolder(key) {\n  const sections = key.split('.');\n  let folderKey = '';\n  let folder = gui;\n\n  while (sections.length > 1) {\n    const section = sections.shift();\n    folderKey += `.${section}`;\n\n    if (!folders[folderKey]) {\n      folders[folderKey] = folder.addFolder(sentenceCase(section));\n      parentOfFolder.set(folders[folderKey], folder);\n\n      const title = folders[folderKey].domElement.querySelector('li.title');\n      title.addEventListener('click', () => {\n        regenerateListenPropsCache();\n      });\n    }\n\n    folder = folders[folderKey];\n  }\n\n  return folder;\n}\n\nfunction removeEmptyFolders() {\n  let deletedFolder = false;\n\n  Object.entries(folders).forEach(([name, folder]) => {\n    if (folder.__controllers.length || Object.keys(folder.__folders).length) {\n      return;\n    }\n\n    const parent = parentOfFolder.get(folder);\n    parent.removeFolder(folder);\n\n    parentOfFolder.delete(folder);\n    delete folders[name];\n\n    deletedFolder = true;\n  });\n\n  // recurse now that the parent of the deleted folder could now be empty\n  if (deletedFolder) {\n    removeEmptyFolders();\n  }\n}\n\nlet batchSaveChangedProps = 0;\nfunction saveChangedProps() {\n  if (batchSaveChangedProps) {\n    return;\n  }\n\n  saveField('changedProps', changedProps);\n}\n\nfunction setChangedProp(key) {\n  changedProps[key] = [manageableProps[key], propSpecs[key][0]];\n  document.body.classList.add('changed-props');\n}\n\nfunction setUnchangedProp(key) {\n  delete changedProps[key];\n  if (!Object.keys(changedProps).length) {\n    document.body.classList.remove('changed-props');\n  }\n}\n\nfunction addController(key, spec, open, saved) {\n  const [originalValue, ...options] = propSpecs[key];\n  const folder = addNestedFolder(key);\n\n  if (manageablePropsProxy[key] === null) {\n    throw new Error(`Prop ${key} must not be initialized to null`);\n  }\n\n  if (key.endsWith('_enabled')) {\n    const prefix = key.substr(0, key.length - '_enabled'.length);\n    if (!(prefix in propSpecs)) {\n      throw new Error(`Prop ${key} does not have corresponding ${prefix}`);\n    }\n    return;\n  }\n\n  const enabledKey = `${key}_enabled`;\n\n  let controller;\n  if (options.length >= 1 && options[0] === null) {\n    if (key.match(/color$/i)) {\n      controller = folder.addColor(manageablePropsProxy, key).listen();\n    } else {\n      controller = folder.add(manageablePropsProxy, key).listen();\n    }\n    controller.domElement.closest('.cr').classList.add('listen');\n    controller.domElement.querySelectorAll('input, select').forEach((node) => {\n      node.tabIndex = -1;\n      node.onclick = (e) => {\n        e.preventDefault();\n      };\n    });\n\n    if (options.length > 1 && typeof options[options.length - 1] === 'function') {\n      controller.__ldListenCallback = options[options.length - 1];\n    }\n  } else {\n    let callback;\n    if (options.length >= 1 && typeof options[options.length - 1] === 'function') {\n      callback = options.pop();\n    }\n\n    if (key.match(/color$/i)) {\n      controller = folder.addColor(manageablePropsProxy, key, ...options);\n    } else {\n      controller = folder.add(manageablePropsProxy, key, ...options);\n    }\n\n    if (callback) {\n      controller.__ldChangeCallback = callback;\n    }\n\n    if (typeof originalValue === 'function') {\n      controller.__ldActionCallback = originalValue;\n    }\n\n    const crNode = controller.domElement.closest('.cr');\n\n    let enabledCheckbox;\n    let enabledValue;\n    const originalEnabled = enabledKey in propSpecs ? propSpecs[enabledKey][0] : null;\n\n    if (enabledKey in manageableProps) {\n      enabledValue = manageableProps[enabledKey];\n\n      const container = document.createElement('div');\n      container.classList.add('toggle');\n\n      enabledCheckbox = document.createElement('input');\n      enabledCheckbox.setAttribute('type', 'checkbox');\n      if (enabledValue) {\n        enabledCheckbox.setAttribute('checked', 'checked');\n        enabledCheckbox.checked = true;\n      }\n\n      container.appendChild(enabledCheckbox);\n\n      crNode.classList.add('disableable');\n\n      const {parentNode} = controller.domElement;\n      parentNode.appendChild(container);\n\n      controller.__ldEnabledSpec = propSpecs[enabledKey];\n\n      enabledCheckbox.onchange = (e) => {\n        e.preventDefault();\n        const {checked} = e.target;\n        manageableProps[enabledKey] = checked;\n\n        enabledCheckbox.__suppressChange = true;\n        try {\n          controller.__onChange(manageableProps[key]);\n          controller.__onFinishChange(manageableProps[key]);\n        } catch (err) {\n          enabledCheckbox.__suppressChange = false;\n          throw err;\n        }\n\n        enabledCheckbox.__suppressChange = false;\n      };\n    }\n\n    if (typeof originalValue !== 'function') {\n      const container = document.createElement('div');\n      container.classList.add('reset');\n\n      const resetButton = document.createElement('input');\n      resetButton.setAttribute('type', 'button');\n      resetButton.value = '⤺';\n\n      container.appendChild(resetButton);\n\n      const {parentNode} = controller.domElement;\n      parentNode.appendChild(container);\n\n      resetButton.onclick = (e) => {\n        if (e) {\n          e.preventDefault();\n          e.stopPropagation();\n        }\n\n        manageableProps[key] = originalValue;\n\n        if (enabledCheckbox) {\n          enabledCheckbox.__suppressChange = true;\n          manageableProps[enabledKey] = originalEnabled;\n          if (originalEnabled) {\n            enabledCheckbox.setAttribute('checked', 'checked');\n            enabledCheckbox.checked = true;\n          } else {\n            enabledCheckbox.removeAttribute('checked');\n            enabledCheckbox.checked = false;\n          }\n        }\n\n        controller.updateDisplay();\n\n        try {\n          controller.__onChange(manageableProps[key]);\n          controller.__onFinishChange(manageableProps[key]);\n        } catch (err) {\n          if (enabledCheckbox) {\n            enabledCheckbox.__suppressChange = false;\n          }\n\n          throw err;\n        }\n\n        if (enabledCheckbox) {\n          enabledCheckbox.__suppressChange = false;\n        }\n      };\n    }\n\n    if (typeof originalValue !== 'function') {\n      controller.onFinishChange((value) => {\n        let ret;\n        try {\n          const {game} = window;\n          const scene = game.topScene();\n          scene.propDidFinishChange(key, value);\n          saveChangedProps();\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.error(e);\n        }\n\n        return ret;\n      });\n\n      controller.onChange((value) => {\n        let ret;\n        try {\n          if (enabledCheckbox && !enabledCheckbox.__suppressChange) {\n            manageableProps[enabledKey] = true;\n            enabledCheckbox.setAttribute('checked', 'checked');\n            enabledCheckbox.checked = true;\n          }\n\n          const {game} = window;\n          const scene = game.topScene();\n          scene.propDidChange(key, value);\n\n          let isChanged = false;\n          if (enabledCheckbox) {\n            if (manageableProps[enabledKey] !== originalEnabled) {\n              isChanged = true;\n              setChangedProp(enabledKey);\n            } else {\n              setUnchangedProp(enabledKey);\n            }\n          }\n\n          if (value !== originalValue) {\n            isChanged = true;\n            setChangedProp(key);\n          } else {\n            setUnchangedProp(key);\n          }\n\n          saveChangedProps();\n\n          if (isChanged) {\n            crNode.classList.add('changed');\n          } else {\n            crNode.classList.remove('changed');\n          }\n\n          if (controller.__ldChangeCallback) {\n            ret = controller.__ldChangeCallback(value, scene, game);\n          }\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.error(e);\n        }\n\n        return ret;\n      });\n\n      if (saved) {\n        setChangedProp(key);\n        crNode.classList.add('changed');\n      }\n    }\n  }\n\n  const container = controller.domElement.closest('.cr');\n  container.title = key;\n  container.dataset.prop = key;\n\n  controllers[key] = controller;\n  controller.__ldSpec = spec;\n\n  if (open) {\n    let f = folder;\n    while (f) {\n      f.open();\n      f = parentOfFolder.get(f);\n    }\n  }\n\n  return controller;\n}\n\nfunction removeProp(key) {\n  const controller = controllers[key];\n  const folder = addNestedFolder(key);\n  folder.remove(controller);\n  delete controllers[key];\n}\n\nexport function refreshUI() {\n  gui.updateDisplay();\n  Object.values(folders).forEach((folder) => folder.updateDisplay());\n}\n\nconst listenPropsCache = [];\nfunction regenerateListenPropsCache() {\n  listenPropsCache.length = 0;\n  document.querySelectorAll('.Manage ul:not(.closed) > li.listen:not(.filtered)').forEach((node) => {\n    const key = node.dataset.prop;\n    const spec = propSpecs[key];\n    listenPropsCache.push([key, spec]);\n  });\n}\n\nexport function updatePropsFromStep(skipCache) {\n  const {game} = window;\n  const scene = game.topScene();\n\n  const updateProp = ([key, spec]) => {\n    if (spec[1] === null) {\n      if (!spec[2]) {\n        manageableProps[key] = _.get(game, key) || _.get(scene, key);\n      } else if (typeof spec[2] === 'string') {\n        manageableProps[key] = _.get(game, spec[2]) || _.get(scene, spec[2]);\n      } else if (typeof spec[2] === 'function') {\n        try {\n          manageableProps[key] = spec[2](game.topScene(), game);\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.error(e);\n        }\n      }\n    }\n  };\n\n  if (skipCache) {\n    Object.entries(propSpecs).forEach(updateProp);\n  } else {\n    listenPropsCache.forEach(updateProp);\n  }\n}\n\nexport function overrideProps(newProps) {\n  Object.entries(propSpecs).forEach(([key, spec]) => {\n    if (spec[1] === null) {\n      manageableProps[key] = newProps[key];\n    }\n  });\n}\n\nfunction specDiffers(old, next) {\n  let differsInFunction;\n\n  if ((!next && old) || (!old && next)) {\n    return true;\n  }\n\n  if (old.length !== next.length) {\n    return true;\n  }\n\n  for (let i = next.length - 1; i >= 0; i -= 1) {\n    if (i === next.length - 1 && typeof next[i] === 'function' && typeof old[i] === 'function') {\n      differsInFunction = true;\n    } else if ((i === 0 || i === 1) && Array.isArray(next[i]) && Array.isArray(old[i])) {\n      // compare enum values\n      const nextArray = next[i];\n      const oldArray = old[i];\n\n      if (nextArray.length !== oldArray.length) {\n        return true;\n      }\n\n      for (let j = nextArray.length - 1; j >= 0; j -= 1) {\n        if (nextArray[j] !== oldArray[j]) {\n          return true;\n        }\n      }\n    } else if (next[i] !== old[i]) {\n      return true;\n    }\n  }\n\n  if (differsInFunction) {\n    return 'function';\n  }\n\n  return false;\n}\n\nfunction requiresControllerRecreation(key, next) {\n  const spec = next[key];\n  const controller = controllers[key];\n  const oldSpec = controller.__ldSpec;\n\n  // listeners don't need to regenerate unless the type changes\n  if (oldSpec[1] === null && spec[1] === null) {\n    if (typeof oldSpec[0] !== typeof spec[0]) {\n      return true;\n    }\n\n    return false;\n  }\n\n  const nextEnabledSpec = next[`${key}_enabled`];\n  if ('__ldEnabledSpec' in controller) {\n    if (specDiffers(controller.__ldEnabledSpec, nextEnabledSpec)) {\n      return true;\n    }\n  } else if (nextEnabledSpec) {\n    return true;\n  }\n\n  return specDiffers(oldSpec, spec);\n}\n\nfunction updatePropsFromReload(oldValues, nextSpecs) {\n  const changes = [];\n\n  const leftoverKeys = {};\n  Object.keys(controllers).forEach((key) => {\n    leftoverKeys[key] = true;\n  });\n\n  Object.keys(nextSpecs).forEach((key) => addNestedFolder(key, true));\n\n  Object.entries(nextSpecs).forEach(([key, spec]) => {\n    if (!(key in controllers)) {\n      addController(key, spec, true);\n\n      if (!key.endsWith('_enabled')) {\n        changes.push(key);\n      }\n    } else {\n      delete leftoverKeys[key];\n      const controller = controllers[key];\n\n      const requiresRecreation = requiresControllerRecreation(key, nextSpecs);\n      if (!requiresRecreation || requiresRecreation === 'function') {\n        if (!requiresRecreation && spec.length > 1 && spec[1] === null && typeof spec[spec.length - 1] === 'function') {\n          if (String(spec[spec.length - 1]) !== String(controller.__ldListenCallback)) {\n            changes.push(key);\n          }\n          controller.__ldListenCallback = spec[spec.length - 1];\n        } else if (requiresRecreation === 'function') {\n          if (controller.__ldChangeCallback) {\n            if (String(spec[spec.length - 1]) !== String(controller.__ldChangeCallback)) {\n              changes.push(key);\n            }\n            controller.__ldChangeCallback = spec[spec.length - 1];\n          } else {\n            if (String(spec[spec.length - 1]) !== String(controller.__ldActionCallback)) {\n              changes.push(key);\n            }\n            controller.__ldActionCallback = spec[spec.length - 1];\n          }\n        } else if (spec[1] !== null && manageableProps[key] !== oldValues[key]) {\n          manageableProps[key] = oldValues[key];\n          setChangedProp(key);\n          changes.push(key);\n        }\n\n        return;\n      }\n\n      changes.push(key);\n\n      setUnchangedProp(`${key}_enabled`);\n      setUnchangedProp(key);\n\n      // regenerate this controller with the new config\n      const container = controller.domElement.closest('.cr');\n      const parent = container.parentNode;\n      const {children} = parent;\n      const index = Array.prototype.indexOf.call(children, container);\n      const nextContainer = index > -1 ? children[index + 1] : null;\n\n      controller.remove();\n\n      const newController = addController(key, spec, true);\n\n      if (nextContainer) {\n        const newContainer = newController.domElement.closest('.cr');\n        parent.removeChild(newContainer);\n        parent.insertBefore(newContainer, nextContainer);\n      }\n    }\n  });\n\n  changes.forEach((key) => {\n    let f = addNestedFolder(key);\n    while (f) {\n      f.open();\n      f = parentOfFolder.get(f);\n    }\n  });\n\n  if (leftoverKeys.length) {\n    changes.push(...leftoverKeys);\n  }\n\n  Object.keys(leftoverKeys).forEach(removeProp);\n  removeEmptyFolders();\n\n  // refresh UI with new values\n  refreshUI();\n\n  return changes;\n}\n\nfunction queryize(query) {\n  const characters = query.split('');\n  let hasUppercase = false;\n\n  const escapedCharacters = characters.map((character) => {\n    if (character !== character.toLowerCase()) {\n      hasUppercase = true;\n    }\n\n    if ('.*+?^${}()|[]\\\\'.includes(character)) {\n      return `\\\\${character}`;\n    } else {\n      return character;\n    }\n  });\n\n  const subsequence = escapedCharacters.join('.*');\n\n  if (query.startsWith('/')) {\n    try {\n      return new RegExp(query.substring(1), hasUppercase ? '' : 'i');\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n    }\n    return new RegExp('(?!)');\n  }\n\n  return new RegExp(subsequence, hasUppercase ? '' : 'i');\n}\n\nlet previousQuery = '';\nexport function updateSearch(query, isStarted) {\n  previousQuery = query;\n\n  const queryRegex = queryize(query);\n\n  const container = document.querySelector('.Manage .dg.main');\n  if (query === '') {\n    Object.values(folders).forEach((folder) => folder.close());\n    container.querySelectorAll('.filtered').forEach((node) => {\n      node.classList.remove('filtered');\n    });\n  } else {\n    Object.values(folders).forEach((folder) => {\n      if (isStarted) {\n        folder.open();\n      }\n\n      folder.domElement.classList.add('filtered');\n    });\n\n    container.querySelectorAll('li[data-prop]').forEach((node) => {\n      let isFiltered = true;\n\n      if (query.toLowerCase() === 'change') {\n        if (node.classList.contains('changed')) {\n          isFiltered = false;\n        }\n      } else {\n        const {prop} = node.dataset;\n        if (prop.match(queryRegex)) {\n          isFiltered = false;\n        }\n      }\n\n      if (isFiltered) {\n        node.classList.add('filtered');\n      } else {\n        let folder = node;\n        while (folder) {\n          folder.classList.remove('filtered');\n          folder = folder.parentNode.closest('.filtered');\n        }\n      }\n    });\n  }\n  regenerateListenPropsCache();\n}\n\nexport function serializeChangedProps() {\n  return Object.entries(changedProps).map(([key, [current]]) => (\n    `propSpecs['${key}'][0] = ${JSON.stringify(current)};`\n  )).join('\\n');\n}\n\nexport function resetChangedProps() {\n  batchSaveChangedProps += 1;\n  document.querySelectorAll('.Manage .cr.changed .reset input').forEach((button) => {\n    button.onclick();\n  });\n  batchSaveChangedProps -= 1;\n  saveChangedProps();\n}\n\nif (module.hot) {\n  module.hot.accept('../../props', () => {\n    try {\n      const next = require('../../props');\n\n      const oldProps = proxiedManageableProps;\n      proxiedManageableProps = next.manageableProps;\n      const changes = updatePropsFromReload(oldProps, next.propSpecs);\n\n      originalProp(null, next.manageableProps);\n\n      if (changes.length) {\n        // eslint-disable-next-line no-console\n        console.info(`Hot-loading props: ${changes.join(', ')}`);\n      }\n\n      const {game} = window;\n      game.command.updateCommandsFromReload(next.commands);\n\n      game.updateShaderFragments(next.shaderCoordFragments, next.shaderColorFragments);\n\n      regenerateListenPropsCache();\n\n      updateSearch(previousQuery, true);\n    } catch (e) {\n      // eslint-disable-next-line no-console\n      console.error(e);\n    }\n  });\n}\n","import Phaser from 'phaser';\nimport {expandParticleProps} from './particles';\nimport {expandTweenProps} from './tweens';\nimport {expandTransitionProps} from './transitions';\nimport {freezeStorage, removeAllFields, loadField} from './store';\nimport {shaderProps} from './shaders.js';\n\nconst savedChangedProps = loadField('changedProps', {});\nexport {savedChangedProps};\n\nconst rendererName = {\n  [Phaser.AUTO]: 'auto',\n  [Phaser.CANVAS]: 'canvas',\n  [Phaser.WEBGL]: 'webgl',\n};\n\nconst debug = !process.env.NODE_ENV || process.env.NODE_ENV === 'development';\n\nexport function builtinPropSpecs(commands, shaderCoordFragments, shaderColorFragments) {\n  if (!debug) {\n    Object.keys(commands).forEach((key) => {\n      if (commands[key].debug) {\n        delete commands[key];\n      }\n    });\n  }\n\n  return {\n    'engine.time': [0.01, null, 'loop.time'],\n    'engine.frameTime': [0.01, null, 'loop.delta'],\n    'engine.actualFps': [0.01, null, 'loop.actualFps'],\n    'engine.targetFps': [0.01, null, 'loop.targetFps'],\n    'engine.renderer': [rendererName[Phaser.AUTO], null, (scene, game) => rendererName[game.renderer.type]],\n    'engine.focused': [false, null, 'scene.game.focused'],\n    'engine.throttle': [false],\n    'engine.stepping': [false, (value, scene, game) => (value ? game.loop.sleep() : game.loop.wake())],\n    'engine.step': [(scene, game) => game.prop('engine.stepping') && game.loop.tick()],\n    'engine.clearLocalStorage': [() => { removeAllFields(); freezeStorage(); window.location = window.location; }],\n    'engine.clearGameState': [() => { removeAllFields('game_'); freezeStorage(); window.location = window.location; }],\n    'engine.disableDebugUI': [(scene, game) => game.disableDebugUI()],\n\n    'config.debug': [debug, null, () => debug],\n    'config.width': [0, null, (scene, game) => game.config.width],\n    'config.height': [0, null, (scene, game) => game.config.height],\n    'config.tileWidth': [0, null, (scene, game) => game.config.tileWidth],\n    'config.tileHeight': [0, null, (scene, game) => game.config.tileHeight],\n    'config.xBorder': [0, null, (scene, game) => scene.xBorder],\n    'config.yBorder': [0, null, (scene, game) => scene.xBorder],\n\n    'scene.count': ['', null, 'scene.scenes.length'],\n    'scene.commandScenes': ['', null, (scene) => scene.command._scenes.size],\n    'scene.class': ['', null, (scene) => scene.constructor.name],\n    'scene.sceneId': ['', null, 'sceneId'],\n    'scene.parentSceneId': ['', null, 'scene.settings.data.parentSceneId'],\n    'scene.key': ['', null, 'scene.key'],\n    'scene.seed': ['', null, 'scene.settings.data.seed'],\n    'scene.scene_time': [0.01, null, 'scene_time'],\n    'scene.music': ['', null, 'currentMusicName'],\n    'scene.timeScale': [0.01, null, 'timeScale'],\n    'scene.physicsFps': [0.01, null, 'physics.world.fps'],\n    'scene.images': [0, null, (scene) => scene.add.displayList.list.filter((node) => node.type === 'Image').length],\n    'scene.sprites': [0, null, (scene) => scene.add.displayList.list.filter((node) => node.type === 'Sprite').length],\n    'scene.particles': [0, null, (scene) => scene.add.displayList.list.filter((node) => node.type === 'ParticleEmitterManager').length],\n    'scene.text': [0, null, (scene) => scene.add.displayList.list.filter((node) => node.type === 'Text').length],\n    'scene.sounds': [0, null, 'sounds.length'],\n    'scene.timers': [0, null, 'timers.length'],\n    'scene.physicsColliders': [0, null, 'physics.world.colliders._active.length'],\n    'scene.musicVolume': [1, 0, 1, (value, scene, game) => {\n      game.changeVolume(game.volume);\n    }],\n    'scene.soundVolume': [1, 0, 1, (value, scene, game) => {\n      game.changeVolume(game.volume);\n    }],\n    'scene.debugDraw': [false, (value, scene) => {\n      if (value) {\n        scene.physics.world.createDebugGraphic();\n      } else {\n        scene.physics.world.debugGraphic.destroy();\n      }\n    }],\n    'scene.replaceWithSelf': [(scene) => scene.replaceWithSelf(false)],\n\n    'scene.camera.width': [0, null, 'camera.width'],\n    'scene.camera.height': [0, null, 'camera.height'],\n    'scene.camera.alpha': [0.1, null, 'camera.alpha'],\n    'scene.camera.zoom': [0.1, null, 'camera.zoom'],\n    'scene.camera.rotation': [0.1, null, 'camera.rotation'],\n    'scene.camera.x': [0, null, 'camera.x'],\n    'scene.camera.y': [0, null, 'camera.y'],\n    'scene.camera.scrollX': [0, null, 'camera.scrollX'],\n    'scene.camera.scrollY': [0, null, 'camera.scrollY'],\n    'scene.camera.centerX': [0, null, 'camera.centerX'],\n    'scene.camera.centerY': [0, null, 'camera.centerY'],\n    'scene.camera.boundsX': [0, null, 'camera._bounds.x'],\n    'scene.camera.boundsY': [0, null, 'camera._bounds.y'],\n    'scene.camera.boundsWidth': [0, null, 'camera._bounds.width'],\n    'scene.camera.boundsHeight': [0, null, 'camera._bounds.height'],\n    'scene.camera.useBounds': [true, null, 'camera.useBounds'],\n\n    'scene.camera.follow': ['', null, objectIdentifier(\n      (scene) => scene.level,\n      (scene) => scene.camera._follow,\n    )],\n    'scene.camera.followOffsetX': [0, null, 'camera.followOffset.x'],\n    'scene.camera.followOffsetY': [0, null, 'camera.followOffset.y'],\n\n    'scene.camera.lerp': [1, 0, 1, (value, scene) => {\n      scene.setCameraLerp();\n    }],\n    'scene.camera.deadzoneX': [0, 0, 1000, (value, scene) => {\n      scene.setCameraDeadzone();\n    }],\n    'scene.camera.deadzoneY': [0, 0, 1000, (value, scene) => {\n      scene.setCameraDeadzone();\n    }],\n    'scene.camera.hasBounds': [true, (value, scene) => {\n      scene.setCameraBounds();\n    }],\n\n    ...commandKeyProps(commands),\n\n    'command.gamepad.total': [0, null],\n    'command.gamepad.A': [false, null],\n    'command.gamepad.B': [false, null],\n    'command.gamepad.X': [false, null],\n    'command.gamepad.Y': [false, null],\n    'command.gamepad.L1': [false, null],\n    'command.gamepad.L2': [false, null],\n    'command.gamepad.R1': [false, null],\n    'command.gamepad.R2': [false, null],\n    'command.gamepad.UP': [false, null],\n    'command.gamepad.DOWN': [false, null],\n    'command.gamepad.LEFT': [false, null],\n    'command.gamepad.RIGHT': [false, null],\n    'command.gamepad.LSTICKX': [0.01, null],\n    'command.gamepad.LSTICKY': [0.01, null],\n    'command.gamepad.RSTICKX': [0.01, null],\n    'command.gamepad.RSTICKY': [0.01, null],\n\n    'command.ignore_all.any': [false, null, (scene) => scene.command.ignoreAll()],\n    'command.ignore_all._transition': [false, null, (scene) => scene.command.ignoreAll('_transition')],\n\n    ...commandProps(commands),\n    ...shaderProps(shaderCoordFragments, shaderColorFragments),\n  };\n}\n\nfunction commandProps(commands) {\n  const props = {};\n\n  Object.entries(commands).forEach(([name, config]) => {\n    if (config.joystick) {\n      props[`command.${name}.x`] = [0.1, null, `command.${name}.held[0]`];\n      props[`command.${name}.y`] = [0.1, null, `command.${name}.held[1]`];\n    } else {\n      props[`command.${name}.held`] = [false, null];\n    }\n\n    props[`command.${name}.started`] = [false, null];\n    props[`command.${name}.continued`] = [false, null];\n    props[`command.${name}.released`] = [false, null];\n\n    props[`command.${name}.heldFrames`] = [0, null];\n    props[`command.${name}.releasedFrames`] = [0, null];\n    props[`command.${name}.heldDuration`] = [0, null];\n    props[`command.${name}.releasedDuration`] = [0, null];\n\n    props[`command.${name}.enabled`] = [true];\n\n    if (!config.joystick && config.execute) {\n      const execute = typeof config.execute === 'function'\n        ? (scene, game) => config.execute(scene, game)\n        : (scene, game) => scene[config.execute](scene, game);\n      props[`command.${name}.execute`] = [execute];\n    }\n  });\n\n  return props;\n}\n\nconst knownInputs = [\n  'gamepad.A',\n  'gamepad.B',\n  'gamepad.X',\n  'gamepad.Y',\n  'gamepad.L1',\n  'gamepad.L2',\n  'gamepad.R1',\n  'gamepad.R2',\n  'gamepad.UP',\n  'gamepad.DOWN',\n  'gamepad.LEFT',\n  'gamepad.RIGHT',\n  'gamepad.LSTICK.UP',\n  'gamepad.LSTICK.DOWN',\n  'gamepad.LSTICK.LEFT',\n  'gamepad.LSTICK.RIGHT',\n  'gamepad.RSTICK.UP',\n  'gamepad.RSTICK.DOWN',\n  'gamepad.RSTICK.LEFT',\n  'gamepad.RSTICK.RIGHT',\n  'gamepad.LSTICK.RAW',\n  'gamepad.RSTICK.RAW',\n\n  ...(Object.keys(Phaser.Input.Keyboard.KeyCodes).map((x) => `keyboard.${x}`)),\n].reduce((a, b) => {\n  a[b] = true;\n  return a;\n}, {});\n\nexport function keysWithPrefix(commands, prefix, skipWarning) {\n  const keys = [];\n\n  Object.entries(commands).forEach(([command, config]) => {\n    if (!config.input) {\n      return;\n    }\n\n    config.input.forEach((inputPath) => {\n      if (!knownInputs[inputPath]) {\n        if (!skipWarning) {\n          // eslint-disable-next-line no-console\n          console.error(`Unknown input path ${inputPath} for command ${command}`);\n        }\n        return;\n      }\n\n      if (inputPath.startsWith(prefix)) {\n        keys.push(inputPath.substr(prefix.length));\n      }\n    });\n  });\n\n  return keys;\n}\n\nexport function commandKeys(commands, skipWarning) {\n  return keysWithPrefix(commands, 'keyboard.', skipWarning);\n}\n\nexport function gamepadKeys(commands, skipWarning) {\n  return keysWithPrefix(commands, 'gamepad.', skipWarning);\n}\n\nexport function commandKeyProps(commands) {\n  const props = {};\n\n  commandKeys(commands).sort().forEach((key) => {\n    props[`command.keyboard.${key}`] = [false, null];\n  });\n\n  return props;\n}\n\nexport function preprocessPropSpecs(propSpecs, particleImages) {\n  expandParticleProps(propSpecs, particleImages);\n  expandTweenProps(propSpecs, particleImages);\n  expandTransitionProps(propSpecs, particleImages);\n}\n\nexport function ManageableProps(propSpecs) {\n  Object.entries(propSpecs).forEach(([key, spec]) => {\n    if (!Array.isArray(spec)) {\n      throw new Error(`Invalid spec for prop ${key}; expected array, got ${spec}`);\n    }\n\n    let [value] = spec;\n    // interject the scene and game, and wrap in a try\n    if (typeof value === 'function') {\n      const original = value;\n      value = () => {\n        try {\n          const {game} = window;\n          const scene = game.topScene();\n          scene.command.recordPropExecution(key);\n          original(scene, game);\n        } catch (e) {\n          // eslint-disable-next-line no-console\n          console.error(e);\n        }\n      };\n    }\n\n    if (key in savedChangedProps) {\n      const [current, original] = savedChangedProps[key];\n      if (JSON.stringify(value) === JSON.stringify(original)) {\n        value = current;\n      } else {\n        delete savedChangedProps[key];\n      }\n    }\n\n    this[key] = value;\n  });\n}\n\nexport function makePropsWithPrefix(propSpecs, manageableProps) {\n  if (debug) {\n    return (prefix) => {\n      const props = {};\n      Object.entries(manageableProps).forEach(([key, value]) => {\n        if (key.startsWith(prefix)) {\n          const name = key.substr(prefix.length);\n          props[name] = value;\n        }\n      });\n      return props;\n    };\n  }\n\n  const cache = {};\n  return (prefix, clearCache) => {\n    if (clearCache) {\n      if (prefix) {\n        delete cache[prefix];\n      } else {\n        Object.keys(cache).forEach((key) => delete cache[key]);\n      }\n    }\n\n    if (!cache[prefix]) {\n      const props = {};\n      Object.entries(propSpecs).forEach(([key, spec]) => {\n        if (key.startsWith(prefix)) {\n          const [value] = spec;\n          const name = key.substr(prefix.length);\n          props[name] = value;\n        }\n      });\n      cache[prefix] = props;\n    }\n    return cache[prefix];\n  };\n}\n\nexport function PropLoader(propSpecs, manageableProps) {\n  if (debug) {\n    let p = manageableProps;\n    return (name, update) => {\n      if (update) {\n        p = update;\n        return;\n      }\n\n      if (!(name in p)) {\n        throw new Error(`Invalid prop named ${name}`);\n      }\n\n      return p[name];\n    };\n  }\n\n  return (name) => propSpecs[name][0];\n}\n\nexport function objectIdentifier(getContainer, getObject) {\n  let cacheInput;\n  let cacheOutput;\n  return (...args) => {\n    const object = getObject(...args);\n    if (object === cacheInput) {\n      return cacheOutput;\n    }\n\n    cacheInput = object;\n\n    if (!object) {\n      cacheOutput = object;\n      return cacheOutput;\n    }\n\n    if (typeof object === 'object' && object.name) {\n      cacheOutput = object.name;\n      return cacheOutput;\n    }\n\n    const container = getContainer(...args);\n    if (container && typeof container === 'object') {\n      // eslint-disable-next-line guard-for-in, no-restricted-syntax\n      for (const key in container) {\n        const value = container[key];\n\n        if (value === object) {\n          cacheOutput = key;\n          return cacheOutput;\n        }\n      }\n    }\n\n    if (typeof object === 'object' && object.texture && object.texture.key) {\n      cacheOutput = object.texture.key;\n      return cacheOutput;\n    }\n\n    cacheOutput = undefined;\n    return cacheOutput;\n  };\n}\n","let injected = false;\nexport function injectAddSpriteTimeScale(scene) {\n  if (injected) {\n    return;\n  }\n\n  // eslint-disable-next-line no-proto\n  const proto = scene.physics.add.__proto__;\n\n  const origAdd = proto.sprite;\n\n  proto.sprite = function(...args) {\n    const sprite = origAdd.call(this, ...args);\n    if (sprite && sprite.anims) {\n      sprite.anims.setTimeScale(sprite.scene.timeScale);\n      sprite.anims.ignoresScenePause = false;\n    }\n    return sprite;\n  };\n\n  injected = true;\n}\n","let injected = false;\nexport function injectAnimationUpdate(animation) {\n  if (injected || !animation) {\n    return injected;\n  }\n\n  // eslint-disable-next-line no-proto\n  const proto = animation.__proto__;\n\n  const origUpdate = proto.update;\n\n  proto.update = function(...args) {\n    if (this.parent.scene._paused.anims && !this.ignoresScenePause && (!this.currentAnim || !this.currentAnim.ignoresScenePause)) {\n      return;\n    }\n\n    return origUpdate.call(this, ...args);\n  };\n\n  injected = true;\n\n  return injected;\n}\n","module.exports = __webpack_public_path__ + \"static/media/maps.02d396d1.txt\";","// This file is automatically generated by asset scripts in scripts/\n\nimport imageBackground from './image/background.png';\nimport imageCloud from './image/cloud.png';\nimport musicPeace from './music/peace.mp3';\nimport musicWar from './music/war.mp3';\nimport musicWin from './music/win.mp3';\nimport soundBorder from './sound/border.wav';\nimport soundCoopBreak from './sound/coopbreak.wav';\nimport soundCoopHit from './sound/coop.wav';\nimport soundDash from './sound/dash.wav';\nimport soundDashFollower from './sound/dashfollower.wav';\nimport soundDashKill from './sound/dashkill.wav';\nimport soundHit from './sound/hit.wav';\nimport soundHowl from './sound/howl.wav';\nimport soundKill from './sound/kill.wav';\nimport soundLose from './sound/lose.wav';\nimport soundMurder from './sound/murder.wav';\nimport soundStun from './sound/stun.wav';\nimport soundTreasure from './sound/treasure.wav';\nimport soundWin from './sound/win.wav';\nimport spriteEnemyA from './sprite/enemyA.png';\nimport spriteFarmer from './sprite/farmer.png';\nimport spriteFollower from './sprite/follower.png';\nimport spritePlayer from './sprite/player.png';\nimport tileCoop from './tile/coop.png';\nimport tileGrass from './tile/grass.png';\nimport tileGrassRock from './tile/grassrock.png';\nimport tileTreasureClosed from './tile/treasure-closed.png';\nimport tileTreasureOpen from './tile/treasure-open.png';\nimport tileWall from './tile/wall.png';\n\nexport const imageAssets = {\n  imageBackground,\n  imageCloud,\n  tileGrass,\n  tileGrassRock,\n  tileWall,\n};\n\nexport const spriteAssets = {\n  spriteEnemyA: {\n    file: spriteEnemyA,\n    frameWidth: 26,\n    frameHeight: 24,\n  },\n  spriteFarmer,\n  spriteFollower,\n  spritePlayer,\n  tileCoop,\n  tileTreasureClosed,\n  tileTreasureOpen,\n};\n\nexport const musicAssets = {\n  musicPeace,\n  musicWar,\n  musicWin,\n};\n\nexport const soundAssets = {\n  soundBorder,\n  soundCoopBreak,\n  soundCoopHit,\n  soundDash,\n  soundDashFollower,\n  soundDashKill,\n  soundHit,\n  soundHowl,\n  soundKill,\n  soundLose,\n  soundMurder,\n  soundStun,\n  soundTreasure,\n  soundWin,\n};\n","module.exports = __webpack_public_path__ + \"static/media/background.63b601c6.png\";","module.exports = __webpack_public_path__ + \"static/media/cloud.e621469f.png\";","module.exports = __webpack_public_path__ + \"static/media/peace.978f1992.mp3\";","module.exports = __webpack_public_path__ + \"static/media/war.d9d74241.mp3\";","module.exports = __webpack_public_path__ + \"static/media/win.65db3627.mp3\";","module.exports = __webpack_public_path__ + \"static/media/border.1bb3750e.wav\";","module.exports = __webpack_public_path__ + \"static/media/coopbreak.5cd1729e.wav\";","module.exports = __webpack_public_path__ + \"static/media/coop.a57beb4f.wav\";","module.exports = __webpack_public_path__ + \"static/media/dash.dae9c2df.wav\";","module.exports = __webpack_public_path__ + \"static/media/dashfollower.eb8a51d1.wav\";","module.exports = __webpack_public_path__ + \"static/media/dashkill.4a6f45be.wav\";","module.exports = __webpack_public_path__ + \"static/media/hit.a20d0d9f.wav\";","module.exports = __webpack_public_path__ + \"static/media/howl.74a2cf92.wav\";","module.exports = __webpack_public_path__ + \"static/media/kill.45919452.wav\";","module.exports = __webpack_public_path__ + \"static/media/lose.c87553f5.wav\";","module.exports = __webpack_public_path__ + \"static/media/murder.4836a129.wav\";","module.exports = __webpack_public_path__ + \"static/media/stun.f8f18331.wav\";","module.exports = __webpack_public_path__ + \"static/media/treasure.295b29e7.wav\";","module.exports = __webpack_public_path__ + \"static/media/win.8232f32e.wav\";","module.exports = __webpack_public_path__ + \"static/media/enemyA.67ff470f.png\";","module.exports = __webpack_public_path__ + \"static/media/farmer.4200b1fe.png\";","module.exports = __webpack_public_path__ + \"static/media/follower.b3ca7148.png\";","module.exports = __webpack_public_path__ + \"static/media/player.8603b7b5.png\";","module.exports = __webpack_public_path__ + \"static/media/coop.b3e202cd.png\";","module.exports = __webpack_public_path__ + \"static/media/grass.00597678.png\";","module.exports = __webpack_public_path__ + \"static/media/grassrock.525b8daa.png\";","module.exports = __webpack_public_path__ + \"static/media/treasure-closed.3278bd56.png\";","module.exports = __webpack_public_path__ + \"static/media/treasure-open.ea7f909d.png\";","module.exports = __webpack_public_path__ + \"static/media/wall.1c9c0e9d.png\";","const loaderMethod = {\n  imageAssets: 'image',\n  spriteAssets: 'spritesheet',\n  musicAssets: 'audio',\n  soundAssets: 'audio',\n};\n\nconst unloadFunction = {\n  imageAssets: (scene, key) => {\n    scene.load.textureManager.remove(key);\n  },\n  musicAssets: (scene, key) => {\n    scene.cache.audio.remove(key);\n  },\n};\n\nunloadFunction.spriteAssets = unloadFunction.imageAssets;\nunloadFunction.soundAssets = unloadFunction.musicAssets;\n\nfunction massageInput(type, game, input) {\n  if (type === 'spriteAssets') {\n    if (typeof input === 'string') {\n      const {spriteWidth, spriteHeight} = game.config;\n      if (spriteWidth && spriteHeight) {\n        return [input, {frameWidth: spriteWidth, frameHeight: spriteHeight}];\n      }\n\n      const {tileWidth, tileHeight} = game.config;\n      return [input, {frameWidth: tileWidth, frameHeight: tileHeight}];\n    } else {\n      const {file} = input;\n      return [file, input];\n    }\n  }\n\n  return [input];\n}\n\nexport function loadAsset(scene, type, key, input) {\n  const {game} = scene;\n  const method = loaderMethod[type];\n\n  const params = massageInput(type, game, input);\n\n  scene.load[method](key, ...params);\n\n  game.assets[type][key] = input;\n}\n\nexport function preloadAssets(scene, assets) {\n  const {game} = scene;\n\n  Object.entries(assets).forEach(([type, entries]) => {\n    if (!loaderMethod[type]) {\n      // eslint-disable-next-line no-console\n      console.error(`No loader for assets of type ${type}`);\n      return;\n    }\n\n    if (!game.assets[type]) {\n      game.assets[type] = {};\n    }\n\n    Object.entries(entries).forEach(([key, input]) => {\n      loadAsset(scene, type, key, input);\n    });\n  });\n}\n\nlet isLoading = false;\nexport function assetReloader(scene) {\n  const {game} = scene;\n\n  if (isLoading) {\n    throw new Error('assetReloader does not yet support concurrency');\n  }\n  isLoading = true;\n\n  const assets = {\n  };\n\n  const typeForKey = {\n  };\n\n  // eslint-disable-next-line no-proto\n  const proto = scene.load.__proto__;\n\n  const origKeyExists = proto.keyExists;\n  proto.keyExists = () => false;\n\n  const origFileProcessComplete = proto.fileProcessComplete;\n  proto.fileProcessComplete = (file) => {\n    const type = typeForKey[file.key];\n    unloadFunction[type](scene, file.key);\n    return origFileProcessComplete.call(scene.load, file);\n  };\n\n  const reload = (type, key, value, isNew) => {\n    if (!assets[type]) {\n      assets[type] = {};\n    }\n\n    typeForKey[key] = type;\n    assets[type][key] = undefined;\n    loadAsset(scene, type, key, value);\n  };\n\n  const remove = (type, key) => {\n    if (!assets[type]) {\n      assets[type] = {};\n    }\n\n    typeForKey[key] = type;\n    assets[type][key] = null;\n    unloadFunction[type](scene, key);\n    delete game.assets[type][key];\n  };\n\n  const done = (...args) => {\n    scene.load.on('filecomplete', (key, _, object) => {\n      const type = typeForKey[key];\n\n      if (!assets[type]) {\n        assets[type] = {};\n      }\n\n      assets[type][key] = object;\n    });\n\n    let completeResolve;\n    scene.load.on('complete', () => {\n      if (completeResolve) {\n        completeResolve();\n      }\n    });\n\n    const promise = new Promise((resolve, reject) => {\n      completeResolve = () => {\n        completeResolve = null;\n\n        proto.keyExists = origKeyExists;\n        proto.fileProcessComplete = origFileProcessComplete;\n\n        isLoading = false;\n\n        resolve([assets, ...args]);\n      };\n    });\n\n    scene.load.start();\n\n    // we didn't load anything\n    if (scene.load.isReady()) {\n      if (completeResolve) {\n        completeResolve();\n      }\n    }\n\n    return promise;\n  };\n\n  return [reload, remove, done];\n}\n\nexport function reloadAssets(scene, assets) {\n  const {game} = scene;\n  const [reloadAsset, removeAsset, startReload] = assetReloader(scene);\n  const changesByType = {};\n\n  ['imageAssets', 'spriteAssets', 'musicAssets', 'soundAssets'].forEach((type) => {\n    const gameAssets = game.assets[type];\n    const leftover = {...gameAssets};\n    const changes = changesByType[type] = [];\n\n    Object.entries(assets[type]).forEach(([key, value]) => {\n      if (!gameAssets[key]) {\n        changes.push(`+${key}`);\n        reloadAsset(type, key, value, true);\n      } else {\n        delete leftover[key];\n\n        if (JSON.stringify(gameAssets[key]) === JSON.stringify(value)) {\n          return;\n        }\n\n        changes.push(`Δ${key}`);\n        reloadAsset(type, key, value, false);\n      }\n    });\n\n    Object.entries(leftover).forEach(([key, value]) => {\n      changes.push(`-${key}`);\n      removeAsset(type, key);\n    });\n  });\n\n  return startReload(changesByType);\n}\n","module.exports = __webpack_public_path__ + \"static/media/cover.a5c04f29.png\";","module.exports = __webpack_public_path__ + \"static/media/twitchLogo.754c9f3b.png\";","module.exports = __webpack_public_path__ + \"static/media/twitterLogo.5ee804a1.png\";","import {tweenEases} from './tweens';\n\nexport const transitionAnimations = [\n  'fadeInOut',\n  'crossFade',\n\n  'pushLeft',\n  'pushRight',\n  'pushUp',\n  'pushDown',\n\n  'wipeLeft',\n  'wipeRight',\n  'wipeUp',\n  'wipeDown',\n];\n\nexport const transitionPauses = [\n  'nothing',\n  'input',\n  'physics',\n  'everything',\n];\n\nexport const transitionPauseTimes = [\n  'begin',\n  'delayEnd',\n  'cutover',\n  'complete',\n  'waitEnd',\n];\n\nexport const defaultTransitionProps = {\n  animation: ['fadeInOut', transitionAnimations],\n\n  delay_enabled: [true],\n  delay: [0, 0, 10000],\n  duration: [1000, 0, 10000],\n  ease: ['Linear', tweenEases],\n  wait_enabled: [true],\n  wait: [0, 0, 10000],\n\n  oldPause: ['input', transitionPauses],\n  oldPauseTime: ['begin', transitionPauseTimes.filter((t) => t !== 'waitEnd')],\n  newPause: ['input', transitionPauses],\n  newUnpauseTime: ['waitEnd', transitionPauseTimes],\n\n  delayNewSceneShader: [false],\n  removeOldSceneShader: [false],\n  suppressShaderCheck: [false],\n\n  animated: [true],\n};\n\nexport const baseTransitionProps = {};\nObject.entries(defaultTransitionProps).forEach(([key, [value]]) => {\n  baseTransitionProps[key] = value;\n});\n\nexport function expandTransitionProps(props) {\n  Object.entries(props).forEach(([name, spec]) => {\n    if (!name.endsWith('.transition')) {\n      return;\n    }\n\n    const prefix = name.substr(0, name.length - '.transition'.length);\n\n    if (!Array.isArray(spec) || spec.length !== 1 || typeof spec[0] !== 'object') {\n      throw new Error(`Expected ${name} prop to have the shape [{…}]; did you mean to end it in .transition?`);\n    }\n\n    delete props[name];\n\n    const [config] = spec;\n\n    const seen = {...config};\n\n    Object.entries(defaultTransitionProps).forEach(([key, value]) => {\n      if (key in config) {\n        props[`${prefix}.${key}`] = [config[key], ...value.slice(1)];\n        delete seen[key];\n      } else if (key.endsWith('_enabled')) {\n        const targetKey = key.substr(0, key.length - '_enabled'.length);\n        props[`${prefix}.${key}`] = [targetKey in config];\n      } else {\n        props[`${prefix}.${key}`] = value;\n      }\n    });\n\n    props[`${prefix}.execute`] = [(scene, game) => {\n      scene.replaceWithSelf(false, null, prefix);\n    }];\n\n    if (Object.keys(seen).length) {\n      throw new Error(`Got unexpected transition config settings: ${Object.keys(seen).join(', ')}`);\n    }\n  });\n}\n\nexport default function massageTransitionProps(props, options) {\n  const {massageProps} = props;\n\n  delete props.massageProps;\n\n  Object.entries(props).forEach(([key, config]) => {\n    if (key.endsWith('_enabled')) {\n      const main = key.substr(0, key.length - '_enabled'.length);\n      if (!config && !options[main]) {\n        delete props[main];\n      }\n      delete props[key];\n    }\n  });\n\n  if (massageProps) {\n    massageProps(props);\n  }\n\n  if ('animated' in props && !props.animated) {\n    props.duration = 0;\n  }\n  delete props.animated;\n\n  return props;\n}\n\nexport function applyPause(scene, transition, type) {\n  if (type === 'nothing') {\n    return () => {};\n  } else if (type === 'input') {\n    scene.pauseInputForTransition(transition);\n    return () => {\n      scene.unpauseInputForTransition(transition);\n    };\n  } else if (type === 'physics') {\n    scene.pausePhysicsForTransition(transition);\n    return () => {\n      scene.unpausePhysicsForTransition(transition);\n    };\n  } else if (type === 'everything') {\n    scene.pauseEverythingForTransition(transition);\n    return () => {\n      scene.unpauseEverythingForTransition(transition);\n    };\n  } else {\n    // eslint-disable-next-line no-console\n    console.error(`Invalid transition pause '${type}'`);\n    return () => {};\n  }\n}\n\n","export const builtinCoordFragments = [\n  ['shockwave', {\n    time: ['float', 0, null],\n    center: ['vec2', [0.5, 0.5], null],\n    scale: ['float', 10.0, 0, 500],\n    range: ['float', 0.8, 0, 10],\n    thickness: ['float', 0.1, 0, 10],\n    speed: ['float', 3.0, 0, 50],\n    inner: ['float', 0.09, 0, 1],\n    dropoff: ['float', 40.0, 0, 500],\n  }, `\n      float shockwave_dt = (scene_time - shockwave_time) / 3333.0;\n      if (shockwave_time > 0.0 && shockwave_dt < 10.0) {\n        float dist = distance(uv, shockwave_center - camera_scroll);\n        float t = shockwave_dt * shockwave_speed;\n        if (dist <= t + shockwave_thickness && dist >= t - shockwave_thickness && dist >= shockwave_inner) {\n          float diff = dist - t;\n          float scaleDiff = 1.0 - pow(abs(diff * shockwave_scale), shockwave_range);\n          float diffTime = diff * scaleDiff;\n          vec2 diffTexCoord = normalize(uv - (shockwave_center - camera_scroll));\n          uv += (diffTexCoord * diffTime) / (t * dist * shockwave_dropoff);\n        }\n      }\n  `],\n];\n\nexport const builtinColorFragments = [\n  ['blur', {\n    amount: ['float', 0, null],\n  }, `\n      if (blur_amount > 0.0) {\n        float b = blur_amount / resolution.x;\n        c *= 0.2270270270;\n        c += texture2D(u_texture, vec2(uv.x - 4.0*b, uv.y - 4.0*b)) * 0.0162162162;\n        c += texture2D(u_texture, vec2(uv.x - 3.0*b, uv.y - 3.0*b)) * 0.0540540541;\n        c += texture2D(u_texture, vec2(uv.x - 2.0*b, uv.y - 2.0*b)) * 0.1216216216;\n        c += texture2D(u_texture, vec2(uv.x - 1.0*b, uv.y - 1.0*b)) * 0.1945945946;\n        c += texture2D(u_texture, vec2(uv.x + 1.0*b, uv.y + 1.0*b)) * 0.1945945946;\n        c += texture2D(u_texture, vec2(uv.x + 2.0*b, uv.y + 2.0*b)) * 0.1216216216;\n        c += texture2D(u_texture, vec2(uv.x + 3.0*b, uv.y + 3.0*b)) * 0.0540540541;\n        c += texture2D(u_texture, vec2(uv.x + 4.0*b, uv.y + 4.0*b)) * 0.0162162162;\n      }\n  `],\n\n  ['aberration', {\n    red: ['vec2', [0, 0], null],\n    green: ['vec2', [0, 0], null],\n    blue: ['vec2', [0, 0], null],\n  }, `\n    c.r += texture2D(u_texture, vec2(uv.x - aberration_red.x, uv.y - aberration_red.y)).r;\n    c.r -= texture2D(u_texture, vec2(uv.x + aberration_red.x, uv.y + aberration_red.y)).r;\n\n    c.g += texture2D(u_texture, vec2(uv.x - aberration_green.x, uv.y - aberration_green.y)).g;\n    c.g -= texture2D(u_texture, vec2(uv.x + aberration_green.x, uv.y + aberration_green.y)).g;\n\n    c.b += texture2D(u_texture, vec2(uv.x - aberration_blue.x, uv.y - aberration_blue.y)).b;\n    c.b -= texture2D(u_texture, vec2(uv.x + aberration_blue.x, uv.y + aberration_blue.y)).b;\n  `],\n\n  ['tint', {\n    color: ['rgba', [1, 1, 1, 1]],\n  }, `\n      c.r *= tint_color.r * tint_color.a;\n      c.g *= tint_color.g * tint_color.a;\n      c.b *= tint_color.b * tint_color.a;\n  `],\n];\n\nexport const shaderTypeMeta = {\n  float: [1, 'float', 'setFloat1'],\n  bool: [1, 'float', 'setFloat1'],\n  vec2: [2, 'vec2', 'setFloat2v', 'x', 'y'],\n  vec3: [3, 'vec3', 'setFloat3v', 'x', 'y', 'z'],\n  vec4: [4, 'vec4', 'setFloat4v', 'x', 'y', 'z', 'w'],\n  rgb: [3, 'vec3', 'setFloat3v', 'r', 'g', 'b'],\n  rgba: [4, 'vec4', 'setFloat4v', 'r', 'g', 'b', 'a'],\n};\n\nexport function propNamesForUniform(fragmentName, uniformName, spec) {\n  let [type] = spec;\n\n  if (!type) {\n    type = 'float';\n  }\n\n  const [count, , , ...subvariables] = shaderTypeMeta[type];\n\n  if (type === 'rgb') {\n    let sub = '';\n    if (!uniformName.match(/color$/i)) {\n      sub = '_color';\n    }\n\n    return [`shader.${fragmentName}.${uniformName}${sub}`];\n  } else if (type === 'rgba') {\n    return [\n      `shader.${fragmentName}.${uniformName}_color`,\n      `shader.${fragmentName}.${uniformName}_alpha`,\n    ];\n  } else if (count === 1) {\n    return [`shader.${fragmentName}.${uniformName}`];\n  } else {\n    return subvariables.map((sub, i) => {\n      return `shader.${fragmentName}.${uniformName}_${sub}`;\n    });\n  }\n}\n\nfunction injectBuiltinFragment(fragments, isCoord) {\n  let primary = builtinColorFragments;\n  let secondary = builtinCoordFragments;\n  let primaryName = 'shaderColorFragments';\n  let secondaryName = 'shaderCoordFragments';\n\n  if (!fragments) {\n    return [];\n  }\n\n  if (isCoord) {\n    [primary, secondary] = [secondary, primary];\n    [primaryName, secondaryName] = [secondaryName, primaryName];\n  }\n\n  if (fragments.length === 0) {\n    fragments.push(...primary);\n    return;\n  }\n\n  for (let i = 0; i < fragments.length; i += 1) {\n    if (typeof fragments[i] === 'string') {\n      const name = fragments[i];\n      const replacement = primary.find(([p]) => name === p);\n      if (replacement) {\n        fragments[i] = replacement;\n      } else {\n        // eslint-disable-next-line no-console\n        console.error(`Unable to find builtin ${primaryName} '${name}'; available are: ${primary.map(([p]) => p).join(', ')}`);\n\n        const suggestion = secondary.find(([p]) => name === p);\n        if (suggestion) {\n          // eslint-disable-next-line no-console\n          console.error(`Perhaps you meant the builtin ${secondaryName} '${name}'?`);\n        }\n\n        fragments.splice(i, 1);\n        i -= 1;\n      }\n    }\n  }\n}\n\nexport function shaderProps(coordFragments, colorFragments) {\n  const props = {};\n\n  injectBuiltinFragment(coordFragments, true);\n  injectBuiltinFragment(colorFragments, false);\n\n  [...(coordFragments || []), ...(colorFragments || [])].forEach(([fragmentName, uniforms]) => {\n    props[`shader.${fragmentName}.enabled`] = [true, (value, scene, game) => game.recompileMainShaders()];\n\n    Object.entries(uniforms).forEach(([uniformName, spec]) => {\n      // eslint-disable-next-line prefer-const\n      let [type, ...config] = spec;\n\n      const name = `${fragmentName}_${uniformName}`;\n\n      if (!type) {\n        type = 'float';\n      }\n\n      if (!shaderTypeMeta[type]) {\n        throw new Error(`Unknown type ${type} for shader ${name}`);\n      }\n\n      const [count, , setter, ...subvariables] = shaderTypeMeta[type];\n\n      if (uniformName.match(/color$/i) && type !== 'rgb' && type !== 'rgba') {\n        throw new Error(`Shader uniform ${name} ends with /color$/i but it isn't using type rgb or rgba`);\n      }\n\n      if (type === 'rgb') {\n        if (config.length > 2\n            || config.length === 0\n            || !Array.isArray(config[0])\n            || config[0].length !== 3\n            || (config.length === 2 && config[1] !== null)) {\n          throw new Error(`Expected rgb shader uniform ${name} to have shape ['rgb', [0.95, 0.25, 0.5]] or ['rgb', [0.95, 0.25, 0.5], null]`);\n        }\n\n        let sub = '';\n        if (!uniformName.match(/color$/i)) {\n          sub = '_color';\n        }\n\n        if (config[1] === null) {\n          config.push((scene) => (scene[name] ? scene[name].map((c) => c * 255.0) : undefined));\n        } else {\n          config.push((_, scene, game) => {\n            if (!scene.shader) {\n              return;\n            }\n            const value = game.prop(`shader.${fragmentName}.${uniformName}${sub}`).map((c) => c / 255.0);\n            scene.shader[setter](name, value);\n          });\n        }\n\n        config[0] = config[0].map((c) => c * 255.0);\n        props[`shader.${fragmentName}.${uniformName}${sub}`] = config;\n      } else if (type === 'rgba') {\n        if (config.length > 2\n            || config.length === 0\n            || !Array.isArray(config[0])\n            || config[0].length !== 4\n            || (config.length === 2 && config[1] !== null)) {\n          throw new Error(`Expected rgbs shader uniform ${name} to have shape ['rgba', [0.95, 0.25, 0.5, 1]] or ['rgb', [0.95, 0.25, 0.5, 1], null]`);\n        }\n\n        const colorConfig = [config[0].filter((_, i) => i < 3)];\n        const alphaConfig = [config[0][3]];\n\n        if (config[1] === null) {\n          colorConfig.push(null);\n          alphaConfig.push(null);\n\n          colorConfig.push((scene) => (scene[name] ? scene[name].filter((_, i) => i < 3).map((c) => c * 255.0) : undefined));\n          alphaConfig.push((scene) => (scene[name] ? scene[name][3] : undefined));\n        } else {\n          alphaConfig.push(0, 1); // min and max\n\n          const cb = (value, scene, game) => {\n            if (!scene.shader) {\n              return;\n            }\n\n            scene.shader[setter](name, [\n              ...game.prop(`shader.${fragmentName}.${uniformName}_color`).map((c) => c / 255.0),\n              game.prop(`shader.${fragmentName}.${uniformName}_alpha`),\n            ]);\n          };\n          colorConfig.push(cb);\n          alphaConfig.push(cb);\n        }\n\n        colorConfig[0] = colorConfig[0].map((c) => c * 255.0);\n        props[`shader.${fragmentName}.${uniformName}_color`] = colorConfig;\n        props[`shader.${fragmentName}.${uniformName}_alpha`] = alphaConfig;\n      } else if (type === 'bool') {\n        if (config[1] === null) {\n          config.push((scene) => scene[name]);\n        } else if (typeof config[config.length - 1] !== 'function') {\n          config.push((value, scene) => scene.shader && scene.shader[setter](name, value ? 1.0 : 0.0));\n        }\n\n        props[`shader.${fragmentName}.${uniformName}`] = config;\n      } else if (count === 1) {\n        if (config[1] === null) {\n          config.push((scene) => scene[name]);\n        } else if (typeof config[config.length - 1] !== 'function') {\n          config.push((value, scene) => scene.shader && scene.shader[setter](name, value));\n        }\n\n        if (config[0] === 0 && config[1] === null) {\n          config[0] = 0.1;\n        }\n\n        props[`shader.${fragmentName}.${uniformName}`] = config;\n      } else {\n        subvariables.forEach((sub, i) => {\n          const c = [...config];\n          c[0] = c[0][i];\n\n          if (c[1] === null) {\n            c.push((scene) => (scene[name] ? scene[name][i] : undefined));\n          } else if (typeof c[c.length - 1] !== 'function') {\n            c.push((_, scene, game) => {\n              if (!scene.shader) {\n                return;\n              }\n\n              const value = subvariables.map((s) => game.prop(`shader.${fragmentName}.${uniformName}_${s}`));\n              scene.shader[setter](name, value);\n            });\n          }\n\n          if (c[0] === 0 && c[1] === null) {\n            c[0] = 0.1;\n          }\n\n          props[`shader.${fragmentName}.${uniformName}_${sub}`] = c;\n        });\n      }\n    });\n  });\n\n  return props;\n}\n"],"sourceRoot":""}